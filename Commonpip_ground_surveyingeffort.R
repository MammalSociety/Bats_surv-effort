#clear data
rm(list=ls())

library(plyr)
library(data.table)
library(reshape)
library(ggplot2)
library(doBy) 

#link to folder
setwd("C:/Users/prl204/Google Drive/Exeter Postdoc/Surveying effort Dec 2015/2016 analysis")

#read in file
allspp<-read.csv('Allspp.csv')

###Stratifying the dataset###

##Problems with the detector

# remove all nights with dodgy mic settings (Dodgymic_gainsettings = 1)

allspp1<- subset(allspp, Dodgymic_gainsettings=="0") 
# this removes 10893 records

##Weather conditions

#Remove all nights where temperature at dusk was less than 10°C (MinTempC)

allspp2<- subset(allspp1, MinTempC >=10) 
#this removes 27900 records

#Remove all nights where maximum ground level wind speed was greater than 5m/s (AvgHrRFmm)

allspp3<- subset(allspp2, AvgHrRFmm <=5) 
#this removes 14729 records

#Remove all nights where rainfall was greater than 2.5mm/hr (AvgHrRFmm)
allspp4<- subset(allspp3, AvgHrRFmm <= 2.5) 
#this removes 5194 records

###Splitting by height###

#Only include records at ground level
allspp4gr <- subset(allspp4, Height == "Ground")
allspp4nac <- subset(allspp4, Height == "Nacelle")

###Stratify by species###

#common pip
allspp4gr_ppip <- subset(allspp4gr, Species == "PIPI") 


##now assess reference range threshold for 'low', 'moderate' and 'high' levels 
#of activity for this dataset

#exlude all zeroes from the dataset
allspp4gr_ppip_ref <- subset(allspp4gr_ppip, Passes > 0) 

quantile_df <- function(x, probs, na.rm =T, names = F, type = 7, ...){
  z <- quantile(x, probs, na.rm, names, type)
  return(data.frame(id = probs, values = z))}

##find low threshold (set this at 30%)
allsppgr_ppip_ref_low <- quantile_df(allspp4gr_ppip_ref$Passes, probs = c(.30))
allsppgr_ppip_ref_low<-allsppgr_ppip_ref_low $values

##find high threshold (set this at 70%)
allsppgr_ppip_ref_high <- quantile_df(allspp4gr_ppip_ref$Passes, probs = c(.70))
allsppgr_ppip_ref_high<-allsppgr_ppip_ref_high $values

##Alltwalis

Alltwalispipgr<-subset(allspp4gr_ppip, Site=="Alltwalis")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Alltwalispipgr<-max(Alltwalispipgr$Passes)

#calculate 20% from maximum nightly record

max20_Alltwalispipgr<- (max_Alltwalispipgr/100)*80

##calculate the site classification (reference range)

Alltwalishigh<- max_Alltwalispipgr > allsppgr_ppip_ref_high

Alltwalislow<- allsppgr_ppip_ref_low > max_Alltwalispipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Alltwalispipgr
Alltwalismod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Alltwalis1_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 1, replace=F))))
Alltwalis1_gr_max <- sum(Alltwalis1_gr > max20_Alltwalispipgr)
Alltwalis1_gr_max
Alltwalis1_gr_pres <- sum(Alltwalis1_gr > 0)
Alltwalis1_gr_pres
#number of sites which would be classified as low
Alltwalis1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis1_gr)
Alltwalis1_gr_lw_ref
#number of sites which would be classified as high
Alltwalis1_gr_high_ref <- sum( Alltwalis1_gr > allsppgr_ppip_ref_high)
Alltwalis1_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis1_gr_mod_ref <- 1000 - (Alltwalis1_gr_high_ref + Alltwalis1_gr_lw_ref)
Alltwalis1_gr_mod_ref


#2 nights
Alltwalis2_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Alltwalis2_grframe<-data.frame(Alltwalis2_gr, samp2)
Alltwalis2_grframelong <- melt(Alltwalis2_grframe,id.vars="samp2")
Alltwalis2_grframelong_sum <- ddply(Alltwalis2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis2_gr_max <- sum(Alltwalis2_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis2_gr_max
Alltwalis2_gr_pres <- sum(Alltwalis2_grframelong_sum $max > 0)
Alltwalis2_gr_pres

#number of sites which would be classified as low
Alltwalis2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis2_grframelong_sum$max)
Alltwalis2_gr_lw_ref
#number of sites which would be classified as high
Alltwalis2_gr_high_ref <- sum( Alltwalis2_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis2_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis2_gr_mod_ref <- 1000 - (Alltwalis2_gr_high_ref + Alltwalis2_gr_lw_ref)
Alltwalis2_gr_mod_ref


#3 nights
Alltwalis3_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Alltwalis3_grframe<-data.frame(Alltwalis3_gr, samp2)
Alltwalis3_grframelong <- melt(Alltwalis3_grframe,id.vars="samp2")
Alltwalis3_grframelong_sum <- ddply(Alltwalis3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis3_gr_max <- sum(Alltwalis3_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis3_gr_max
Alltwalis3_gr_pres <- sum(Alltwalis3_grframelong_sum $max > 0)
Alltwalis3_gr_pres

#number of sites which would be classified as low
Alltwalis3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis3_grframelong_sum$max)
Alltwalis3_gr_lw_ref
#number of sites which would be classified as high
Alltwalis3_gr_high_ref <- sum( Alltwalis3_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis3_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis3_gr_mod_ref <- 1000 - (Alltwalis3_gr_high_ref + Alltwalis3_gr_lw_ref)
Alltwalis3_gr_mod_ref

#4 nights
Alltwalis4_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Alltwalis4_grframe<-data.frame(Alltwalis4_gr, samp2)
Alltwalis4_grframelong <- melt(Alltwalis4_grframe,id.vars="samp2")
Alltwalis4_grframelong_sum <- ddply(Alltwalis4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis4_gr_max <- sum(Alltwalis4_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis4_gr_max
Alltwalis4_gr_pres <- sum(Alltwalis4_grframelong_sum $max > 0)
Alltwalis4_gr_pres

#number of sites which would be classified as low
Alltwalis4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis4_grframelong_sum$max)
Alltwalis4_gr_lw_ref
#number of sites which would be classified as high
Alltwalis4_gr_high_ref <- sum( Alltwalis4_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis4_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis4_gr_mod_ref <- 1000 - (Alltwalis4_gr_high_ref + Alltwalis4_gr_lw_ref)
Alltwalis4_gr_mod_ref

#5 nights
Alltwalis5_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Alltwalis5_grframe<-data.frame(Alltwalis5_gr, samp2)
Alltwalis5_grframelong <- melt(Alltwalis5_grframe,id.vars="samp2")
Alltwalis5_grframelong_sum <- ddply(Alltwalis5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis5_gr_max <- sum(Alltwalis5_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis5_gr_max
Alltwalis5_gr_pres <- sum(Alltwalis5_grframelong_sum $max > 0)
Alltwalis5_gr_pres

#number of sites which would be classified as low
Alltwalis5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis5_grframelong_sum$max)
Alltwalis5_gr_lw_ref
#number of sites which would be classified as high
Alltwalis5_gr_high_ref <- sum( Alltwalis5_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis5_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis5_gr_mod_ref <- 1000 - (Alltwalis5_gr_high_ref + Alltwalis5_gr_lw_ref)
Alltwalis5_gr_mod_ref

#6 nights
Alltwalis6_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Alltwalis6_grframe<-data.frame(Alltwalis6_gr, samp2)
Alltwalis6_grframelong <- melt(Alltwalis6_grframe,id.vars="samp2")
Alltwalis6_grframelong_sum <- ddply(Alltwalis6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis6_gr_max <- sum(Alltwalis6_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis6_gr_max
Alltwalis6_gr_pres <- sum(Alltwalis6_grframelong_sum $max > 0)
Alltwalis6_gr_pres

#number of sites which would be classified as low
Alltwalis6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis6_grframelong_sum$max)
Alltwalis6_gr_lw_ref
#number of sites which would be classified as high
Alltwalis6_gr_high_ref <- sum( Alltwalis6_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis6_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis6_gr_mod_ref <- 1000 - (Alltwalis6_gr_high_ref + Alltwalis6_gr_lw_ref)
Alltwalis6_gr_mod_ref

#7 nights
Alltwalis7_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Alltwalis7_grframe<-data.frame(Alltwalis7_gr, samp2)
Alltwalis7_grframelong <- melt(Alltwalis7_grframe,id.vars="samp2")
Alltwalis7_grframelong_sum <- ddply(Alltwalis7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis7_gr_max <- sum(Alltwalis7_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis7_gr_max
Alltwalis7_gr_pres <- sum(Alltwalis7_grframelong_sum $max > 0)
Alltwalis7_gr_pres

#number of sites which would be classified as low
Alltwalis7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis7_grframelong_sum$max)
Alltwalis7_gr_lw_ref
#number of sites which would be classified as high
Alltwalis7_gr_high_ref <- sum( Alltwalis7_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis7_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis7_gr_mod_ref <- 1000 - (Alltwalis7_gr_high_ref + Alltwalis7_gr_lw_ref)
Alltwalis7_gr_mod_ref

#8 nights
Alltwalis8_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Alltwalis8_grframe<-data.frame(Alltwalis8_gr, samp2)
Alltwalis8_grframelong <- melt(Alltwalis8_grframe,id.vars="samp2")
Alltwalis8_grframelong_sum <- ddply(Alltwalis8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis8_gr_max <- sum(Alltwalis8_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis8_gr_max
Alltwalis8_gr_pres <- sum(Alltwalis8_grframelong_sum $max > 0)
Alltwalis8_gr_pres

#number of sites which would be classified as low
Alltwalis8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis8_grframelong_sum$max)
Alltwalis8_gr_lw_ref
#number of sites which would be classified as high
Alltwalis8_gr_high_ref <- sum( Alltwalis8_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis8_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis8_gr_mod_ref <- 1000 - (Alltwalis8_gr_high_ref + Alltwalis8_gr_lw_ref)
Alltwalis8_gr_mod_ref

#9 nights
Alltwalis9_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Alltwalis9_grframe<-data.frame(Alltwalis9_gr, samp2)
Alltwalis9_grframelong <- melt(Alltwalis9_grframe,id.vars="samp2")
Alltwalis9_grframelong_sum <- ddply(Alltwalis9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Alltwalis9_gr_max <- sum(Alltwalis9_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis9_gr_max
Alltwalis9_gr_pres <- sum(Alltwalis9_grframelong_sum $max > 0)
Alltwalis9_gr_pres

#number of sites which would be classified as low
Alltwalis9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis9_grframelong_sum$max)
Alltwalis9_gr_lw_ref
#number of sites which would be classified as high
Alltwalis9_gr_high_ref <- sum( Alltwalis9_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis9_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis9_gr_mod_ref <- 1000 - (Alltwalis9_gr_high_ref + Alltwalis9_gr_lw_ref)
Alltwalis9_gr_mod_ref

#10 detectors
Alltwalis10_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Alltwalis10_grframe<-data.frame(Alltwalis10_gr, samp2)
Alltwalis10_grframelong <- melt(Alltwalis10_grframe,id.vars="samp2")
Alltwalis10_grframelong_sum <- ddply(Alltwalis10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis10_gr_max <- sum(Alltwalis10_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis10_gr_max
Alltwalis10_gr_pres <- sum(Alltwalis10_grframelong_sum $max > 0)
Alltwalis10_gr_pres

#number of sites which would be classified as low
Alltwalis10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis10_grframelong_sum$max)
Alltwalis10_gr_lw_ref
#number of sites which would be classified as high
Alltwalis10_gr_high_ref <- sum( Alltwalis10_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis10_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis10_gr_mod_ref <- 1000 - (Alltwalis10_gr_high_ref + Alltwalis10_gr_lw_ref)
Alltwalis10_gr_mod_ref

#11 detectors
Alltwalis11_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Alltwalis11_grframe<-data.frame(Alltwalis11_gr, samp2)
Alltwalis11_grframelong <- melt(Alltwalis11_grframe,id.vars="samp2")
Alltwalis11_grframelong_sum <- ddply(Alltwalis11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis11_gr_max <- sum(Alltwalis11_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis11_gr_max
Alltwalis11_gr_pres <- sum(Alltwalis11_grframelong_sum $max > 0)
Alltwalis11_gr_pres

#number of sites which would be classified as low
Alltwalis11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis11_grframelong_sum$max)
Alltwalis11_gr_lw_ref
#number of sites which would be classified as high
Alltwalis11_gr_high_ref <- sum( Alltwalis11_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis11_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis11_gr_mod_ref <- 1000 - (Alltwalis11_gr_high_ref + Alltwalis11_gr_lw_ref)
Alltwalis11_gr_mod_ref

#12 detectors
Alltwalis12_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Alltwalis12_grframe<-data.frame(Alltwalis12_gr, samp2)
Alltwalis12_grframelong <- melt(Alltwalis12_grframe,id.vars="samp2")
Alltwalis12_grframelong_sum <- ddply(Alltwalis12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis12_gr_max <- sum(Alltwalis12_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis12_gr_max
Alltwalis12_gr_pres <- sum(Alltwalis12_grframelong_sum $max > 0)
Alltwalis12_gr_pres

#number of sites which would be classified as low
Alltwalis12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis12_grframelong_sum$max)
Alltwalis12_gr_lw_ref
#number of sites which would be classified as high
Alltwalis12_gr_high_ref <- sum( Alltwalis12_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis12_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis12_gr_mod_ref <- 1000 - (Alltwalis12_gr_high_ref + Alltwalis12_gr_lw_ref)
Alltwalis12_gr_mod_ref

#13 detectors
Alltwalis13_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Alltwalis13_grframe<-data.frame(Alltwalis13_gr, samp2)
Alltwalis13_grframelong <- melt(Alltwalis13_grframe,id.vars="samp2")
Alltwalis13_grframelong_sum <- ddply(Alltwalis13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis13_gr_max <- sum(Alltwalis13_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis13_gr_max
Alltwalis13_gr_pres <- sum(Alltwalis13_grframelong_sum $max > 0)
Alltwalis13_gr_pres

#number of sites which would be classified as low
Alltwalis13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis13_grframelong_sum$max)
Alltwalis13_gr_lw_ref
#number of sites which would be classified as high
Alltwalis13_gr_high_ref <- sum( Alltwalis13_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis13_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis13_gr_mod_ref <- 1000 - (Alltwalis13_gr_high_ref + Alltwalis13_gr_lw_ref)
Alltwalis13_gr_mod_ref

#14 detectors
Alltwalis14_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Alltwalis14_grframe<-data.frame(Alltwalis14_gr, samp2)
Alltwalis14_grframelong <- melt(Alltwalis14_grframe,id.vars="samp2")
Alltwalis14_grframelong_sum <- ddply(Alltwalis14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis14_gr_max <- sum(Alltwalis14_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis14_gr_max
Alltwalis14_gr_pres <- sum(Alltwalis14_grframelong_sum $max > 0)
Alltwalis14_gr_pres

#number of sites which would be classified as low
Alltwalis14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis14_grframelong_sum$max)
Alltwalis14_gr_lw_ref
#number of sites which would be classified as high
Alltwalis14_gr_high_ref <- sum( Alltwalis14_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis14_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis14_gr_mod_ref <- 1000 - (Alltwalis14_gr_high_ref + Alltwalis14_gr_lw_ref)
Alltwalis14_gr_mod_ref

#15 detectors
Alltwalis15_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Alltwalis15_grframe<-data.frame(Alltwalis15_gr, samp2)
Alltwalis15_grframelong <- melt(Alltwalis15_grframe,id.vars="samp2")
Alltwalis15_grframelong_sum <- ddply(Alltwalis15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis15_gr_max <- sum(Alltwalis15_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis15_gr_max
Alltwalis15_gr_pres <- sum(Alltwalis15_grframelong_sum $max > 0)
Alltwalis15_gr_pres

#number of sites which would be classified as low
Alltwalis15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis15_grframelong_sum$max)
Alltwalis15_gr_lw_ref
#number of sites which would be classified as high
Alltwalis15_gr_high_ref <- sum( Alltwalis15_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis15_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis15_gr_mod_ref <- 1000 - (Alltwalis15_gr_high_ref + Alltwalis15_gr_lw_ref)
Alltwalis15_gr_mod_ref

#16 detectors
Alltwalis16_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Alltwalis16_grframe<-data.frame(Alltwalis16_gr, samp2)
Alltwalis16_grframelong <- melt(Alltwalis16_grframe,id.vars="samp2")
Alltwalis16_grframelong_sum <- ddply(Alltwalis16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis16_gr_max <- sum(Alltwalis16_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis16_gr_max
Alltwalis16_gr_pres <- sum(Alltwalis16_grframelong_sum $max > 0)
Alltwalis16_gr_pres

#number of sites which would be classified as low
Alltwalis16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis16_grframelong_sum$max)
Alltwalis16_gr_lw_ref
#number of sites which would be classified as high
Alltwalis16_gr_high_ref <- sum( Alltwalis16_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis16_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis16_gr_mod_ref <- 1000 - (Alltwalis16_gr_high_ref + Alltwalis16_gr_lw_ref)
Alltwalis16_gr_mod_ref

#17 detectors
Alltwalis17_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Alltwalis17_grframe<-data.frame(Alltwalis17_gr, samp2)
Alltwalis17_grframelong <- melt(Alltwalis17_grframe,id.vars="samp2")
Alltwalis17_grframelong_sum <- ddply(Alltwalis17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis17_gr_max <- sum(Alltwalis17_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis17_gr_max
Alltwalis17_gr_pres <- sum(Alltwalis17_grframelong_sum $max > 0)
Alltwalis17_gr_pres

#number of sites which would be classified as low
Alltwalis17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis17_grframelong_sum$max)
Alltwalis17_gr_lw_ref
#number of sites which would be classified as high
Alltwalis17_gr_high_ref <- sum( Alltwalis17_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis17_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis17_gr_mod_ref <- 1000 - (Alltwalis17_gr_high_ref + Alltwalis17_gr_lw_ref)
Alltwalis17_gr_mod_ref

#18 detectors
Alltwalis18_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Alltwalis18_grframe<-data.frame(Alltwalis18_gr, samp2)
Alltwalis18_grframelong <- melt(Alltwalis18_grframe,id.vars="samp2")
Alltwalis18_grframelong_sum <- ddply(Alltwalis18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis18_gr_max <- sum(Alltwalis18_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis18_gr_max
Alltwalis18_gr_pres <- sum(Alltwalis18_grframelong_sum $max > 0)
Alltwalis18_gr_pres

#number of sites which would be classified as low
Alltwalis18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis18_grframelong_sum$max)
Alltwalis18_gr_lw_ref
#number of sites which would be classified as high
Alltwalis18_gr_high_ref <- sum( Alltwalis18_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis18_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis18_gr_mod_ref <- 1000 - (Alltwalis18_gr_high_ref + Alltwalis18_gr_lw_ref)
Alltwalis18_gr_mod_ref

#19 detectors
Alltwalis19_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Alltwalis19_grframe<-data.frame(Alltwalis19_gr, samp2)
Alltwalis19_grframelong <- melt(Alltwalis19_grframe,id.vars="samp2")
Alltwalis19_grframelong_sum <- ddply(Alltwalis19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis19_gr_max <- sum(Alltwalis19_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis19_gr_max
Alltwalis19_gr_pres <- sum(Alltwalis19_grframelong_sum $max > 0)
Alltwalis19_gr_pres

#number of sites which would be classified as low
Alltwalis19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis19_grframelong_sum$max)
Alltwalis19_gr_lw_ref
#number of sites which would be classified as high
Alltwalis19_gr_high_ref <- sum( Alltwalis19_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis19_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis19_gr_mod_ref <- 1000 - (Alltwalis19_gr_high_ref + Alltwalis19_gr_lw_ref)
Alltwalis19_gr_mod_ref

#20 detectors
Alltwalis20_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Alltwalis20_grframe<-data.frame(Alltwalis20_gr, samp2)
Alltwalis20_grframelong <- melt(Alltwalis20_grframe,id.vars="samp2")
Alltwalis20_grframelong_sum <- ddply(Alltwalis20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis20_gr_max <- sum(Alltwalis20_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis20_gr_max
Alltwalis20_gr_pres <- sum(Alltwalis20_grframelong_sum $max > 0)
Alltwalis20_gr_pres

#number of sites which would be classified as low
Alltwalis20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis20_grframelong_sum$max)
Alltwalis20_gr_lw_ref
#number of sites which would be classified as high
Alltwalis20_gr_high_ref <- sum( Alltwalis20_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis20_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis20_gr_mod_ref <- 1000 - (Alltwalis20_gr_high_ref + Alltwalis20_gr_lw_ref)
Alltwalis20_gr_mod_ref

#21 detectors
Alltwalis21_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Alltwalis21_grframe<-data.frame(Alltwalis21_gr, samp2)
Alltwalis21_grframelong <- melt(Alltwalis21_grframe,id.vars="samp2")
Alltwalis21_grframelong_sum <- ddply(Alltwalis21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis21_gr_max <- sum(Alltwalis21_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis21_gr_max
Alltwalis21_gr_pres <- sum(Alltwalis21_grframelong_sum $max > 0)
Alltwalis21_gr_pres

#number of sites which would be classified as low
Alltwalis21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis21_grframelong_sum$max)
Alltwalis21_gr_lw_ref
#number of sites which would be classified as high
Alltwalis21_gr_high_ref <- sum( Alltwalis21_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis21_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis21_gr_mod_ref <- 1000 - (Alltwalis21_gr_high_ref + Alltwalis21_gr_lw_ref)
Alltwalis21_gr_mod_ref

#22 detectors
Alltwalis22_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Alltwalis22_grframe<-data.frame(Alltwalis22_gr, samp2)
Alltwalis22_grframelong <- melt(Alltwalis22_grframe,id.vars="samp2")
Alltwalis22_grframelong_sum <- ddply(Alltwalis22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis22_gr_max <- sum(Alltwalis22_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis22_gr_max
Alltwalis22_gr_pres <- sum(Alltwalis22_grframelong_sum $max > 0)
Alltwalis22_gr_pres

#number of sites which would be classified as low
Alltwalis22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis22_grframelong_sum$max)
Alltwalis22_gr_lw_ref
#number of sites which would be classified as high
Alltwalis22_gr_high_ref <- sum( Alltwalis22_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis22_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis22_gr_mod_ref <- 1000 - (Alltwalis22_gr_high_ref + Alltwalis22_gr_lw_ref)
Alltwalis22_gr_mod_ref

#23 detectors
Alltwalis23_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Alltwalis23_grframe<-data.frame(Alltwalis23_gr, samp2)
Alltwalis23_grframelong <- melt(Alltwalis23_grframe,id.vars="samp2")
Alltwalis23_grframelong_sum <- ddply(Alltwalis23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis23_gr_max <- sum(Alltwalis23_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis23_gr_max
Alltwalis23_gr_pres <- sum(Alltwalis23_grframelong_sum $max > 0)
Alltwalis23_gr_pres

#number of sites which would be classified as low
Alltwalis23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis23_grframelong_sum$max)
Alltwalis23_gr_lw_ref
#number of sites which would be classified as high
Alltwalis23_gr_high_ref <- sum( Alltwalis23_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis23_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis23_gr_mod_ref <- 1000 - (Alltwalis23_gr_high_ref + Alltwalis23_gr_lw_ref)
Alltwalis23_gr_mod_ref

#24 detectors
Alltwalis24_gr<-(replicate(1000, (sample(Alltwalispipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Alltwalis24_grframe<-data.frame(Alltwalis24_gr, samp2)
Alltwalis24_grframelong <- melt(Alltwalis24_grframe,id.vars="samp2")
Alltwalis24_grframelong_sum <- ddply(Alltwalis24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Alltwalis24_gr_max <- sum(Alltwalis24_grframelong_sum $max > max20_Alltwalispipgr)
Alltwalis24_gr_max
Alltwalis24_gr_pres <- sum(Alltwalis24_grframelong_sum $max > 0)
Alltwalis24_gr_pres

#number of sites which would be classified as low
Alltwalis24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Alltwalis24_grframelong_sum$max)
Alltwalis24_gr_lw_ref
#number of sites which would be classified as high
Alltwalis24_gr_high_ref <- sum( Alltwalis24_grframelong_sum$max > allsppgr_ppip_ref_high)
Alltwalis24_gr_high_ref
#number of sites which would be classified as moderate
Alltwalis24_gr_mod_ref <- 1000 - (Alltwalis24_gr_high_ref + Alltwalis24_gr_lw_ref)
Alltwalis24_gr_mod_ref

Present<-c(Alltwalis1_gr_pres,Alltwalis2_gr_pres,
           Alltwalis3_gr_pres,Alltwalis4_gr_pres,
           Alltwalis5_gr_pres,Alltwalis6_gr_pres,
           Alltwalis7_gr_pres,Alltwalis8_gr_pres,
           Alltwalis9_gr_pres,Alltwalis10_gr_pres,
           Alltwalis11_gr_pres,Alltwalis12_gr_pres,
           Alltwalis13_gr_pres,Alltwalis14_gr_pres,
           Alltwalis15_gr_pres,Alltwalis16_gr_pres,
           Alltwalis17_gr_pres,Alltwalis18_gr_pres,
           Alltwalis19_gr_pres,Alltwalis20_gr_pres,
           Alltwalis21_gr_pres,Alltwalis22_gr_pres,
           Alltwalis23_gr_pres,Alltwalis24_gr_pres)


Maximum<-c(Alltwalis1_gr_max,Alltwalis2_gr_max,
           Alltwalis3_gr_max,Alltwalis4_gr_max,
           Alltwalis5_gr_max,Alltwalis6_gr_max,
           Alltwalis7_gr_max,Alltwalis8_gr_max,
           Alltwalis9_gr_max,Alltwalis10_gr_max,
           Alltwalis11_gr_max,Alltwalis12_gr_max,
           Alltwalis13_gr_max,Alltwalis14_gr_max,
           Alltwalis15_gr_max,Alltwalis16_gr_max,
           Alltwalis17_gr_max,Alltwalis18_gr_max,
           Alltwalis19_gr_max,Alltwalis20_gr_max,
           Alltwalis21_gr_max,Alltwalis22_gr_max,
           Alltwalis23_gr_max,Alltwalis24_gr_max)

Low<-c(Alltwalis1_gr_lw_ref, Alltwalis2_gr_lw_ref, Alltwalis3_gr_lw_ref,
       Alltwalis4_gr_lw_ref, Alltwalis5_gr_lw_ref, Alltwalis6_gr_lw_ref,
       Alltwalis7_gr_lw_ref, Alltwalis8_gr_lw_ref, Alltwalis9_gr_lw_ref,
       Alltwalis10_gr_lw_ref, Alltwalis11_gr_lw_ref, Alltwalis12_gr_lw_ref, 
       Alltwalis13_gr_lw_ref, Alltwalis14_gr_lw_ref, Alltwalis15_gr_lw_ref, 
       Alltwalis16_gr_lw_ref, Alltwalis17_gr_lw_ref, Alltwalis18_gr_lw_ref, 
       Alltwalis19_gr_lw_ref, Alltwalis20_gr_lw_ref, Alltwalis21_gr_lw_ref,
       Alltwalis22_gr_lw_ref,Alltwalis23_gr_lw_ref,Alltwalis24_gr_lw_ref)

Moderate<-c(Alltwalis1_gr_mod_ref, Alltwalis2_gr_mod_ref, Alltwalis3_gr_mod_ref,
            Alltwalis4_gr_mod_ref, Alltwalis5_gr_mod_ref, Alltwalis6_gr_mod_ref,
            Alltwalis7_gr_mod_ref, Alltwalis8_gr_mod_ref, Alltwalis9_gr_mod_ref,
            Alltwalis10_gr_mod_ref, Alltwalis11_gr_mod_ref, Alltwalis12_gr_mod_ref, 
            Alltwalis13_gr_mod_ref, Alltwalis14_gr_mod_ref, Alltwalis15_gr_mod_ref, 
            Alltwalis16_gr_mod_ref, Alltwalis17_gr_mod_ref, Alltwalis18_gr_mod_ref, 
            Alltwalis19_gr_mod_ref, Alltwalis20_gr_mod_ref, Alltwalis21_gr_mod_ref,
            Alltwalis22_gr_mod_ref,Alltwalis23_gr_mod_ref,Alltwalis24_gr_mod_ref)

High<-c(Alltwalis1_gr_high_ref, Alltwalis2_gr_high_ref, Alltwalis3_gr_high_ref,
        Alltwalis4_gr_high_ref, Alltwalis5_gr_high_ref, Alltwalis6_gr_high_ref,
        Alltwalis7_gr_high_ref, Alltwalis8_gr_high_ref, Alltwalis9_gr_high_ref,
        Alltwalis10_gr_high_ref, Alltwalis11_gr_high_ref, Alltwalis12_gr_high_ref, 
        Alltwalis13_gr_high_ref, Alltwalis14_gr_high_ref, Alltwalis15_gr_high_ref, 
        Alltwalis16_gr_high_ref, Alltwalis17_gr_high_ref, Alltwalis18_gr_high_ref, 
        Alltwalis19_gr_high_ref, Alltwalis20_gr_high_ref, Alltwalis21_gr_high_ref,
        Alltwalis22_gr_high_ref,Alltwalis23_gr_high_ref,Alltwalis24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Alltwalisgr",24)
Lowsite <- Alltwalislow
Modsite <- Alltwalismod
Highsite <-Alltwalishigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Alltwalisgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##AnSuidhe

AnSuidhepipgr<-subset(allspp4gr_ppip, Site=="AnSuidhe")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_AnSuidhepipgr<-max(AnSuidhepipgr$Passes)

#calculate 20% from maximum nightly record

max20_AnSuidhepipgr<- (max_AnSuidhepipgr/100)*80

##calculate the site classification (reference range)

AnSuidhehigh<- max_AnSuidhepipgr > allsppgr_ppip_ref_high

AnSuidhelow<- allsppgr_ppip_ref_low > max_AnSuidhepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_AnSuidhepipgr
AnSuidhemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
AnSuidhe1_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 1, replace=F))))
AnSuidhe1_gr_max <- sum(AnSuidhe1_gr > max20_AnSuidhepipgr)
AnSuidhe1_gr_max
AnSuidhe1_gr_pres <- sum(AnSuidhe1_gr > 0)
AnSuidhe1_gr_pres
#number of sites which would be classified as low
AnSuidhe1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe1_gr)
AnSuidhe1_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe1_gr_high_ref <- sum( AnSuidhe1_gr > allsppgr_ppip_ref_high)
AnSuidhe1_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe1_gr_mod_ref <- 1000 - (AnSuidhe1_gr_high_ref + AnSuidhe1_gr_lw_ref)
AnSuidhe1_gr_mod_ref


#2 nights
AnSuidhe2_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
AnSuidhe2_grframe<-data.frame(AnSuidhe2_gr, samp2)
AnSuidhe2_grframelong <- melt(AnSuidhe2_grframe,id.vars="samp2")
AnSuidhe2_grframelong_sum <- ddply(AnSuidhe2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe2_gr_max <- sum(AnSuidhe2_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe2_gr_max
AnSuidhe2_gr_pres <- sum(AnSuidhe2_grframelong_sum $max > 0)
AnSuidhe2_gr_pres

#number of sites which would be classified as low
AnSuidhe2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe2_grframelong_sum$max)
AnSuidhe2_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe2_gr_high_ref <- sum( AnSuidhe2_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe2_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe2_gr_mod_ref <- 1000 - (AnSuidhe2_gr_high_ref + AnSuidhe2_gr_lw_ref)
AnSuidhe2_gr_mod_ref


#3 nights
AnSuidhe3_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
AnSuidhe3_grframe<-data.frame(AnSuidhe3_gr, samp2)
AnSuidhe3_grframelong <- melt(AnSuidhe3_grframe,id.vars="samp2")
AnSuidhe3_grframelong_sum <- ddply(AnSuidhe3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe3_gr_max <- sum(AnSuidhe3_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe3_gr_max
AnSuidhe3_gr_pres <- sum(AnSuidhe3_grframelong_sum $max > 0)
AnSuidhe3_gr_pres

#number of sites which would be classified as low
AnSuidhe3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe3_grframelong_sum$max)
AnSuidhe3_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe3_gr_high_ref <- sum( AnSuidhe3_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe3_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe3_gr_mod_ref <- 1000 - (AnSuidhe3_gr_high_ref + AnSuidhe3_gr_lw_ref)
AnSuidhe3_gr_mod_ref

#4 nights
AnSuidhe4_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
AnSuidhe4_grframe<-data.frame(AnSuidhe4_gr, samp2)
AnSuidhe4_grframelong <- melt(AnSuidhe4_grframe,id.vars="samp2")
AnSuidhe4_grframelong_sum <- ddply(AnSuidhe4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe4_gr_max <- sum(AnSuidhe4_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe4_gr_max
AnSuidhe4_gr_pres <- sum(AnSuidhe4_grframelong_sum $max > 0)
AnSuidhe4_gr_pres

#number of sites which would be classified as low
AnSuidhe4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe4_grframelong_sum$max)
AnSuidhe4_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe4_gr_high_ref <- sum( AnSuidhe4_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe4_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe4_gr_mod_ref <- 1000 - (AnSuidhe4_gr_high_ref + AnSuidhe4_gr_lw_ref)
AnSuidhe4_gr_mod_ref

#5 nights
AnSuidhe5_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
AnSuidhe5_grframe<-data.frame(AnSuidhe5_gr, samp2)
AnSuidhe5_grframelong <- melt(AnSuidhe5_grframe,id.vars="samp2")
AnSuidhe5_grframelong_sum <- ddply(AnSuidhe5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe5_gr_max <- sum(AnSuidhe5_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe5_gr_max
AnSuidhe5_gr_pres <- sum(AnSuidhe5_grframelong_sum $max > 0)
AnSuidhe5_gr_pres

#number of sites which would be classified as low
AnSuidhe5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe5_grframelong_sum$max)
AnSuidhe5_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe5_gr_high_ref <- sum( AnSuidhe5_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe5_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe5_gr_mod_ref <- 1000 - (AnSuidhe5_gr_high_ref + AnSuidhe5_gr_lw_ref)
AnSuidhe5_gr_mod_ref

#6 nights
AnSuidhe6_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
AnSuidhe6_grframe<-data.frame(AnSuidhe6_gr, samp2)
AnSuidhe6_grframelong <- melt(AnSuidhe6_grframe,id.vars="samp2")
AnSuidhe6_grframelong_sum <- ddply(AnSuidhe6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe6_gr_max <- sum(AnSuidhe6_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe6_gr_max
AnSuidhe6_gr_pres <- sum(AnSuidhe6_grframelong_sum $max > 0)
AnSuidhe6_gr_pres

#number of sites which would be classified as low
AnSuidhe6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe6_grframelong_sum$max)
AnSuidhe6_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe6_gr_high_ref <- sum( AnSuidhe6_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe6_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe6_gr_mod_ref <- 1000 - (AnSuidhe6_gr_high_ref + AnSuidhe6_gr_lw_ref)
AnSuidhe6_gr_mod_ref

#7 nights
AnSuidhe7_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
AnSuidhe7_grframe<-data.frame(AnSuidhe7_gr, samp2)
AnSuidhe7_grframelong <- melt(AnSuidhe7_grframe,id.vars="samp2")
AnSuidhe7_grframelong_sum <- ddply(AnSuidhe7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe7_gr_max <- sum(AnSuidhe7_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe7_gr_max
AnSuidhe7_gr_pres <- sum(AnSuidhe7_grframelong_sum $max > 0)
AnSuidhe7_gr_pres

#number of sites which would be classified as low
AnSuidhe7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe7_grframelong_sum$max)
AnSuidhe7_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe7_gr_high_ref <- sum( AnSuidhe7_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe7_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe7_gr_mod_ref <- 1000 - (AnSuidhe7_gr_high_ref + AnSuidhe7_gr_lw_ref)
AnSuidhe7_gr_mod_ref

#8 nights
AnSuidhe8_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
AnSuidhe8_grframe<-data.frame(AnSuidhe8_gr, samp2)
AnSuidhe8_grframelong <- melt(AnSuidhe8_grframe,id.vars="samp2")
AnSuidhe8_grframelong_sum <- ddply(AnSuidhe8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe8_gr_max <- sum(AnSuidhe8_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe8_gr_max
AnSuidhe8_gr_pres <- sum(AnSuidhe8_grframelong_sum $max > 0)
AnSuidhe8_gr_pres

#number of sites which would be classified as low
AnSuidhe8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe8_grframelong_sum$max)
AnSuidhe8_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe8_gr_high_ref <- sum( AnSuidhe8_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe8_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe8_gr_mod_ref <- 1000 - (AnSuidhe8_gr_high_ref + AnSuidhe8_gr_lw_ref)
AnSuidhe8_gr_mod_ref

#9 nights
AnSuidhe9_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
AnSuidhe9_grframe<-data.frame(AnSuidhe9_gr, samp2)
AnSuidhe9_grframelong <- melt(AnSuidhe9_grframe,id.vars="samp2")
AnSuidhe9_grframelong_sum <- ddply(AnSuidhe9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
AnSuidhe9_gr_max <- sum(AnSuidhe9_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe9_gr_max
AnSuidhe9_gr_pres <- sum(AnSuidhe9_grframelong_sum $max > 0)
AnSuidhe9_gr_pres

#number of sites which would be classified as low
AnSuidhe9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe9_grframelong_sum$max)
AnSuidhe9_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe9_gr_high_ref <- sum( AnSuidhe9_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe9_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe9_gr_mod_ref <- 1000 - (AnSuidhe9_gr_high_ref + AnSuidhe9_gr_lw_ref)
AnSuidhe9_gr_mod_ref

#10 detectors
AnSuidhe10_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
AnSuidhe10_grframe<-data.frame(AnSuidhe10_gr, samp2)
AnSuidhe10_grframelong <- melt(AnSuidhe10_grframe,id.vars="samp2")
AnSuidhe10_grframelong_sum <- ddply(AnSuidhe10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe10_gr_max <- sum(AnSuidhe10_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe10_gr_max
AnSuidhe10_gr_pres <- sum(AnSuidhe10_grframelong_sum $max > 0)
AnSuidhe10_gr_pres

#number of sites which would be classified as low
AnSuidhe10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe10_grframelong_sum$max)
AnSuidhe10_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe10_gr_high_ref <- sum( AnSuidhe10_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe10_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe10_gr_mod_ref <- 1000 - (AnSuidhe10_gr_high_ref + AnSuidhe10_gr_lw_ref)
AnSuidhe10_gr_mod_ref

#11 detectors
AnSuidhe11_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
AnSuidhe11_grframe<-data.frame(AnSuidhe11_gr, samp2)
AnSuidhe11_grframelong <- melt(AnSuidhe11_grframe,id.vars="samp2")
AnSuidhe11_grframelong_sum <- ddply(AnSuidhe11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe11_gr_max <- sum(AnSuidhe11_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe11_gr_max
AnSuidhe11_gr_pres <- sum(AnSuidhe11_grframelong_sum $max > 0)
AnSuidhe11_gr_pres

#number of sites which would be classified as low
AnSuidhe11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe11_grframelong_sum$max)
AnSuidhe11_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe11_gr_high_ref <- sum( AnSuidhe11_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe11_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe11_gr_mod_ref <- 1000 - (AnSuidhe11_gr_high_ref + AnSuidhe11_gr_lw_ref)
AnSuidhe11_gr_mod_ref

#12 detectors
AnSuidhe12_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
AnSuidhe12_grframe<-data.frame(AnSuidhe12_gr, samp2)
AnSuidhe12_grframelong <- melt(AnSuidhe12_grframe,id.vars="samp2")
AnSuidhe12_grframelong_sum <- ddply(AnSuidhe12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe12_gr_max <- sum(AnSuidhe12_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe12_gr_max
AnSuidhe12_gr_pres <- sum(AnSuidhe12_grframelong_sum $max > 0)
AnSuidhe12_gr_pres

#number of sites which would be classified as low
AnSuidhe12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe12_grframelong_sum$max)
AnSuidhe12_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe12_gr_high_ref <- sum( AnSuidhe12_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe12_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe12_gr_mod_ref <- 1000 - (AnSuidhe12_gr_high_ref + AnSuidhe12_gr_lw_ref)
AnSuidhe12_gr_mod_ref

#13 detectors
AnSuidhe13_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
AnSuidhe13_grframe<-data.frame(AnSuidhe13_gr, samp2)
AnSuidhe13_grframelong <- melt(AnSuidhe13_grframe,id.vars="samp2")
AnSuidhe13_grframelong_sum <- ddply(AnSuidhe13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe13_gr_max <- sum(AnSuidhe13_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe13_gr_max
AnSuidhe13_gr_pres <- sum(AnSuidhe13_grframelong_sum $max > 0)
AnSuidhe13_gr_pres

#number of sites which would be classified as low
AnSuidhe13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe13_grframelong_sum$max)
AnSuidhe13_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe13_gr_high_ref <- sum( AnSuidhe13_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe13_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe13_gr_mod_ref <- 1000 - (AnSuidhe13_gr_high_ref + AnSuidhe13_gr_lw_ref)
AnSuidhe13_gr_mod_ref

#14 detectors
AnSuidhe14_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
AnSuidhe14_grframe<-data.frame(AnSuidhe14_gr, samp2)
AnSuidhe14_grframelong <- melt(AnSuidhe14_grframe,id.vars="samp2")
AnSuidhe14_grframelong_sum <- ddply(AnSuidhe14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe14_gr_max <- sum(AnSuidhe14_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe14_gr_max
AnSuidhe14_gr_pres <- sum(AnSuidhe14_grframelong_sum $max > 0)
AnSuidhe14_gr_pres

#number of sites which would be classified as low
AnSuidhe14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe14_grframelong_sum$max)
AnSuidhe14_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe14_gr_high_ref <- sum( AnSuidhe14_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe14_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe14_gr_mod_ref <- 1000 - (AnSuidhe14_gr_high_ref + AnSuidhe14_gr_lw_ref)
AnSuidhe14_gr_mod_ref

#15 detectors
AnSuidhe15_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
AnSuidhe15_grframe<-data.frame(AnSuidhe15_gr, samp2)
AnSuidhe15_grframelong <- melt(AnSuidhe15_grframe,id.vars="samp2")
AnSuidhe15_grframelong_sum <- ddply(AnSuidhe15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe15_gr_max <- sum(AnSuidhe15_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe15_gr_max
AnSuidhe15_gr_pres <- sum(AnSuidhe15_grframelong_sum $max > 0)
AnSuidhe15_gr_pres

#number of sites which would be classified as low
AnSuidhe15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe15_grframelong_sum$max)
AnSuidhe15_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe15_gr_high_ref <- sum( AnSuidhe15_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe15_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe15_gr_mod_ref <- 1000 - (AnSuidhe15_gr_high_ref + AnSuidhe15_gr_lw_ref)
AnSuidhe15_gr_mod_ref

#16 detectors
AnSuidhe16_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
AnSuidhe16_grframe<-data.frame(AnSuidhe16_gr, samp2)
AnSuidhe16_grframelong <- melt(AnSuidhe16_grframe,id.vars="samp2")
AnSuidhe16_grframelong_sum <- ddply(AnSuidhe16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe16_gr_max <- sum(AnSuidhe16_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe16_gr_max
AnSuidhe16_gr_pres <- sum(AnSuidhe16_grframelong_sum $max > 0)
AnSuidhe16_gr_pres

#number of sites which would be classified as low
AnSuidhe16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe16_grframelong_sum$max)
AnSuidhe16_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe16_gr_high_ref <- sum( AnSuidhe16_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe16_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe16_gr_mod_ref <- 1000 - (AnSuidhe16_gr_high_ref + AnSuidhe16_gr_lw_ref)
AnSuidhe16_gr_mod_ref

#17 detectors
AnSuidhe17_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
AnSuidhe17_grframe<-data.frame(AnSuidhe17_gr, samp2)
AnSuidhe17_grframelong <- melt(AnSuidhe17_grframe,id.vars="samp2")
AnSuidhe17_grframelong_sum <- ddply(AnSuidhe17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe17_gr_max <- sum(AnSuidhe17_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe17_gr_max
AnSuidhe17_gr_pres <- sum(AnSuidhe17_grframelong_sum $max > 0)
AnSuidhe17_gr_pres

#number of sites which would be classified as low
AnSuidhe17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe17_grframelong_sum$max)
AnSuidhe17_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe17_gr_high_ref <- sum( AnSuidhe17_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe17_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe17_gr_mod_ref <- 1000 - (AnSuidhe17_gr_high_ref + AnSuidhe17_gr_lw_ref)
AnSuidhe17_gr_mod_ref

#18 detectors
AnSuidhe18_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
AnSuidhe18_grframe<-data.frame(AnSuidhe18_gr, samp2)
AnSuidhe18_grframelong <- melt(AnSuidhe18_grframe,id.vars="samp2")
AnSuidhe18_grframelong_sum <- ddply(AnSuidhe18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe18_gr_max <- sum(AnSuidhe18_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe18_gr_max
AnSuidhe18_gr_pres <- sum(AnSuidhe18_grframelong_sum $max > 0)
AnSuidhe18_gr_pres

#number of sites which would be classified as low
AnSuidhe18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe18_grframelong_sum$max)
AnSuidhe18_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe18_gr_high_ref <- sum( AnSuidhe18_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe18_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe18_gr_mod_ref <- 1000 - (AnSuidhe18_gr_high_ref + AnSuidhe18_gr_lw_ref)
AnSuidhe18_gr_mod_ref

#19 detectors
AnSuidhe19_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
AnSuidhe19_grframe<-data.frame(AnSuidhe19_gr, samp2)
AnSuidhe19_grframelong <- melt(AnSuidhe19_grframe,id.vars="samp2")
AnSuidhe19_grframelong_sum <- ddply(AnSuidhe19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe19_gr_max <- sum(AnSuidhe19_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe19_gr_max
AnSuidhe19_gr_pres <- sum(AnSuidhe19_grframelong_sum $max > 0)
AnSuidhe19_gr_pres

#number of sites which would be classified as low
AnSuidhe19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe19_grframelong_sum$max)
AnSuidhe19_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe19_gr_high_ref <- sum( AnSuidhe19_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe19_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe19_gr_mod_ref <- 1000 - (AnSuidhe19_gr_high_ref + AnSuidhe19_gr_lw_ref)
AnSuidhe19_gr_mod_ref

#20 detectors
AnSuidhe20_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
AnSuidhe20_grframe<-data.frame(AnSuidhe20_gr, samp2)
AnSuidhe20_grframelong <- melt(AnSuidhe20_grframe,id.vars="samp2")
AnSuidhe20_grframelong_sum <- ddply(AnSuidhe20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe20_gr_max <- sum(AnSuidhe20_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe20_gr_max
AnSuidhe20_gr_pres <- sum(AnSuidhe20_grframelong_sum $max > 0)
AnSuidhe20_gr_pres

#number of sites which would be classified as low
AnSuidhe20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe20_grframelong_sum$max)
AnSuidhe20_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe20_gr_high_ref <- sum( AnSuidhe20_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe20_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe20_gr_mod_ref <- 1000 - (AnSuidhe20_gr_high_ref + AnSuidhe20_gr_lw_ref)
AnSuidhe20_gr_mod_ref

#21 detectors
AnSuidhe21_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
AnSuidhe21_grframe<-data.frame(AnSuidhe21_gr, samp2)
AnSuidhe21_grframelong <- melt(AnSuidhe21_grframe,id.vars="samp2")
AnSuidhe21_grframelong_sum <- ddply(AnSuidhe21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe21_gr_max <- sum(AnSuidhe21_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe21_gr_max
AnSuidhe21_gr_pres <- sum(AnSuidhe21_grframelong_sum $max > 0)
AnSuidhe21_gr_pres

#number of sites which would be classified as low
AnSuidhe21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe21_grframelong_sum$max)
AnSuidhe21_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe21_gr_high_ref <- sum( AnSuidhe21_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe21_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe21_gr_mod_ref <- 1000 - (AnSuidhe21_gr_high_ref + AnSuidhe21_gr_lw_ref)
AnSuidhe21_gr_mod_ref

#22 detectors
AnSuidhe22_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
AnSuidhe22_grframe<-data.frame(AnSuidhe22_gr, samp2)
AnSuidhe22_grframelong <- melt(AnSuidhe22_grframe,id.vars="samp2")
AnSuidhe22_grframelong_sum <- ddply(AnSuidhe22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe22_gr_max <- sum(AnSuidhe22_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe22_gr_max
AnSuidhe22_gr_pres <- sum(AnSuidhe22_grframelong_sum $max > 0)
AnSuidhe22_gr_pres

#number of sites which would be classified as low
AnSuidhe22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe22_grframelong_sum$max)
AnSuidhe22_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe22_gr_high_ref <- sum( AnSuidhe22_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe22_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe22_gr_mod_ref <- 1000 - (AnSuidhe22_gr_high_ref + AnSuidhe22_gr_lw_ref)
AnSuidhe22_gr_mod_ref

#23 detectors
AnSuidhe23_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
AnSuidhe23_grframe<-data.frame(AnSuidhe23_gr, samp2)
AnSuidhe23_grframelong <- melt(AnSuidhe23_grframe,id.vars="samp2")
AnSuidhe23_grframelong_sum <- ddply(AnSuidhe23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe23_gr_max <- sum(AnSuidhe23_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe23_gr_max
AnSuidhe23_gr_pres <- sum(AnSuidhe23_grframelong_sum $max > 0)
AnSuidhe23_gr_pres

#number of sites which would be classified as low
AnSuidhe23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe23_grframelong_sum$max)
AnSuidhe23_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe23_gr_high_ref <- sum( AnSuidhe23_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe23_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe23_gr_mod_ref <- 1000 - (AnSuidhe23_gr_high_ref + AnSuidhe23_gr_lw_ref)
AnSuidhe23_gr_mod_ref

#24 detectors
AnSuidhe24_gr<-(replicate(1000, (sample(AnSuidhepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
AnSuidhe24_grframe<-data.frame(AnSuidhe24_gr, samp2)
AnSuidhe24_grframelong <- melt(AnSuidhe24_grframe,id.vars="samp2")
AnSuidhe24_grframelong_sum <- ddply(AnSuidhe24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
AnSuidhe24_gr_max <- sum(AnSuidhe24_grframelong_sum $max > max20_AnSuidhepipgr)
AnSuidhe24_gr_max
AnSuidhe24_gr_pres <- sum(AnSuidhe24_grframelong_sum $max > 0)
AnSuidhe24_gr_pres

#number of sites which would be classified as low
AnSuidhe24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= AnSuidhe24_grframelong_sum$max)
AnSuidhe24_gr_lw_ref
#number of sites which would be classified as high
AnSuidhe24_gr_high_ref <- sum( AnSuidhe24_grframelong_sum$max > allsppgr_ppip_ref_high)
AnSuidhe24_gr_high_ref
#number of sites which would be classified as moderate
AnSuidhe24_gr_mod_ref <- 1000 - (AnSuidhe24_gr_high_ref + AnSuidhe24_gr_lw_ref)
AnSuidhe24_gr_mod_ref

Present<-c(AnSuidhe1_gr_pres,AnSuidhe2_gr_pres,
           AnSuidhe3_gr_pres,AnSuidhe4_gr_pres,
           AnSuidhe5_gr_pres,AnSuidhe6_gr_pres,
           AnSuidhe7_gr_pres,AnSuidhe8_gr_pres,
           AnSuidhe9_gr_pres,AnSuidhe10_gr_pres,
           AnSuidhe11_gr_pres,AnSuidhe12_gr_pres,
           AnSuidhe13_gr_pres,AnSuidhe14_gr_pres,
           AnSuidhe15_gr_pres,AnSuidhe16_gr_pres,
           AnSuidhe17_gr_pres,AnSuidhe18_gr_pres,
           AnSuidhe19_gr_pres,AnSuidhe20_gr_pres,
           AnSuidhe21_gr_pres,AnSuidhe22_gr_pres,
           AnSuidhe23_gr_pres,AnSuidhe24_gr_pres)


Maximum<-c(AnSuidhe1_gr_max,AnSuidhe2_gr_max,
           AnSuidhe3_gr_max,AnSuidhe4_gr_max,
           AnSuidhe5_gr_max,AnSuidhe6_gr_max,
           AnSuidhe7_gr_max,AnSuidhe8_gr_max,
           AnSuidhe9_gr_max,AnSuidhe10_gr_max,
           AnSuidhe11_gr_max,AnSuidhe12_gr_max,
           AnSuidhe13_gr_max,AnSuidhe14_gr_max,
           AnSuidhe15_gr_max,AnSuidhe16_gr_max,
           AnSuidhe17_gr_max,AnSuidhe18_gr_max,
           AnSuidhe19_gr_max,AnSuidhe20_gr_max,
           AnSuidhe21_gr_max,AnSuidhe22_gr_max,
           AnSuidhe23_gr_max,AnSuidhe24_gr_max)

Low<-c(AnSuidhe1_gr_lw_ref, AnSuidhe2_gr_lw_ref, AnSuidhe3_gr_lw_ref,
       AnSuidhe4_gr_lw_ref, AnSuidhe5_gr_lw_ref, AnSuidhe6_gr_lw_ref,
       AnSuidhe7_gr_lw_ref, AnSuidhe8_gr_lw_ref, AnSuidhe9_gr_lw_ref,
       AnSuidhe10_gr_lw_ref, AnSuidhe11_gr_lw_ref, AnSuidhe12_gr_lw_ref, 
       AnSuidhe13_gr_lw_ref, AnSuidhe14_gr_lw_ref, AnSuidhe15_gr_lw_ref, 
       AnSuidhe16_gr_lw_ref, AnSuidhe17_gr_lw_ref, AnSuidhe18_gr_lw_ref, 
       AnSuidhe19_gr_lw_ref, AnSuidhe20_gr_lw_ref, AnSuidhe21_gr_lw_ref,
       AnSuidhe22_gr_lw_ref,AnSuidhe23_gr_lw_ref,AnSuidhe24_gr_lw_ref)

Moderate<-c(AnSuidhe1_gr_mod_ref, AnSuidhe2_gr_mod_ref, AnSuidhe3_gr_mod_ref,
            AnSuidhe4_gr_mod_ref, AnSuidhe5_gr_mod_ref, AnSuidhe6_gr_mod_ref,
            AnSuidhe7_gr_mod_ref, AnSuidhe8_gr_mod_ref, AnSuidhe9_gr_mod_ref,
            AnSuidhe10_gr_mod_ref, AnSuidhe11_gr_mod_ref, AnSuidhe12_gr_mod_ref, 
            AnSuidhe13_gr_mod_ref, AnSuidhe14_gr_mod_ref, AnSuidhe15_gr_mod_ref, 
            AnSuidhe16_gr_mod_ref, AnSuidhe17_gr_mod_ref, AnSuidhe18_gr_mod_ref, 
            AnSuidhe19_gr_mod_ref, AnSuidhe20_gr_mod_ref, AnSuidhe21_gr_mod_ref,
            AnSuidhe22_gr_mod_ref,AnSuidhe23_gr_mod_ref,AnSuidhe24_gr_mod_ref)

High<-c(AnSuidhe1_gr_high_ref, AnSuidhe2_gr_high_ref, AnSuidhe3_gr_high_ref,
        AnSuidhe4_gr_high_ref, AnSuidhe5_gr_high_ref, AnSuidhe6_gr_high_ref,
        AnSuidhe7_gr_high_ref, AnSuidhe8_gr_high_ref, AnSuidhe9_gr_high_ref,
        AnSuidhe10_gr_high_ref, AnSuidhe11_gr_high_ref, AnSuidhe12_gr_high_ref, 
        AnSuidhe13_gr_high_ref, AnSuidhe14_gr_high_ref, AnSuidhe15_gr_high_ref, 
        AnSuidhe16_gr_high_ref, AnSuidhe17_gr_high_ref, AnSuidhe18_gr_high_ref, 
        AnSuidhe19_gr_high_ref, AnSuidhe20_gr_high_ref, AnSuidhe21_gr_high_ref,
        AnSuidhe22_gr_high_ref,AnSuidhe23_gr_high_ref,AnSuidhe24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("AnSuidhegr",24)
Lowsite <- AnSuidhelow
Modsite <- AnSuidhemod
Highsite <-AnSuidhehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



AnSuidhegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##Artfield

Artfieldpipgr<-subset(allspp4gr_ppip, Site=="Artfield")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Artfieldpipgr<-max(Artfieldpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Artfieldpipgr<- (max_Artfieldpipgr/100)*80

##calculate the site classification (reference range)

Artfieldhigh<- max_Artfieldpipgr > allsppgr_ppip_ref_high

Artfieldlow<- allsppgr_ppip_ref_low > max_Artfieldpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Artfieldpipgr
Artfieldmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Artfield1_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 1, replace=F))))
Artfield1_gr_max <- sum(Artfield1_gr > max20_Artfieldpipgr)
Artfield1_gr_max
Artfield1_gr_pres <- sum(Artfield1_gr > 0)
Artfield1_gr_pres
#number of sites which would be classified as low
Artfield1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield1_gr)
Artfield1_gr_lw_ref
#number of sites which would be classified as high
Artfield1_gr_high_ref <- sum( Artfield1_gr > allsppgr_ppip_ref_high)
Artfield1_gr_high_ref
#number of sites which would be classified as moderate
Artfield1_gr_mod_ref <- 1000 - (Artfield1_gr_high_ref + Artfield1_gr_lw_ref)
Artfield1_gr_mod_ref


#2 nights
Artfield2_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Artfield2_grframe<-data.frame(Artfield2_gr, samp2)
Artfield2_grframelong <- melt(Artfield2_grframe,id.vars="samp2")
Artfield2_grframelong_sum <- ddply(Artfield2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield2_gr_max <- sum(Artfield2_grframelong_sum $max > max20_Artfieldpipgr)
Artfield2_gr_max
Artfield2_gr_pres <- sum(Artfield2_grframelong_sum $max > 0)
Artfield2_gr_pres

#number of sites which would be classified as low
Artfield2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield2_grframelong_sum$max)
Artfield2_gr_lw_ref
#number of sites which would be classified as high
Artfield2_gr_high_ref <- sum( Artfield2_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield2_gr_high_ref
#number of sites which would be classified as moderate
Artfield2_gr_mod_ref <- 1000 - (Artfield2_gr_high_ref + Artfield2_gr_lw_ref)
Artfield2_gr_mod_ref


#3 nights
Artfield3_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Artfield3_grframe<-data.frame(Artfield3_gr, samp2)
Artfield3_grframelong <- melt(Artfield3_grframe,id.vars="samp2")
Artfield3_grframelong_sum <- ddply(Artfield3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield3_gr_max <- sum(Artfield3_grframelong_sum $max > max20_Artfieldpipgr)
Artfield3_gr_max
Artfield3_gr_pres <- sum(Artfield3_grframelong_sum $max > 0)
Artfield3_gr_pres

#number of sites which would be classified as low
Artfield3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield3_grframelong_sum$max)
Artfield3_gr_lw_ref
#number of sites which would be classified as high
Artfield3_gr_high_ref <- sum( Artfield3_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield3_gr_high_ref
#number of sites which would be classified as moderate
Artfield3_gr_mod_ref <- 1000 - (Artfield3_gr_high_ref + Artfield3_gr_lw_ref)
Artfield3_gr_mod_ref

#4 nights
Artfield4_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Artfield4_grframe<-data.frame(Artfield4_gr, samp2)
Artfield4_grframelong <- melt(Artfield4_grframe,id.vars="samp2")
Artfield4_grframelong_sum <- ddply(Artfield4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield4_gr_max <- sum(Artfield4_grframelong_sum $max > max20_Artfieldpipgr)
Artfield4_gr_max
Artfield4_gr_pres <- sum(Artfield4_grframelong_sum $max > 0)
Artfield4_gr_pres

#number of sites which would be classified as low
Artfield4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield4_grframelong_sum$max)
Artfield4_gr_lw_ref
#number of sites which would be classified as high
Artfield4_gr_high_ref <- sum( Artfield4_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield4_gr_high_ref
#number of sites which would be classified as moderate
Artfield4_gr_mod_ref <- 1000 - (Artfield4_gr_high_ref + Artfield4_gr_lw_ref)
Artfield4_gr_mod_ref

#5 nights
Artfield5_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Artfield5_grframe<-data.frame(Artfield5_gr, samp2)
Artfield5_grframelong <- melt(Artfield5_grframe,id.vars="samp2")
Artfield5_grframelong_sum <- ddply(Artfield5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield5_gr_max <- sum(Artfield5_grframelong_sum $max > max20_Artfieldpipgr)
Artfield5_gr_max
Artfield5_gr_pres <- sum(Artfield5_grframelong_sum $max > 0)
Artfield5_gr_pres

#number of sites which would be classified as low
Artfield5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield5_grframelong_sum$max)
Artfield5_gr_lw_ref
#number of sites which would be classified as high
Artfield5_gr_high_ref <- sum( Artfield5_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield5_gr_high_ref
#number of sites which would be classified as moderate
Artfield5_gr_mod_ref <- 1000 - (Artfield5_gr_high_ref + Artfield5_gr_lw_ref)
Artfield5_gr_mod_ref

#6 nights
Artfield6_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Artfield6_grframe<-data.frame(Artfield6_gr, samp2)
Artfield6_grframelong <- melt(Artfield6_grframe,id.vars="samp2")
Artfield6_grframelong_sum <- ddply(Artfield6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield6_gr_max <- sum(Artfield6_grframelong_sum $max > max20_Artfieldpipgr)
Artfield6_gr_max
Artfield6_gr_pres <- sum(Artfield6_grframelong_sum $max > 0)
Artfield6_gr_pres

#number of sites which would be classified as low
Artfield6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield6_grframelong_sum$max)
Artfield6_gr_lw_ref
#number of sites which would be classified as high
Artfield6_gr_high_ref <- sum( Artfield6_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield6_gr_high_ref
#number of sites which would be classified as moderate
Artfield6_gr_mod_ref <- 1000 - (Artfield6_gr_high_ref + Artfield6_gr_lw_ref)
Artfield6_gr_mod_ref

#7 nights
Artfield7_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Artfield7_grframe<-data.frame(Artfield7_gr, samp2)
Artfield7_grframelong <- melt(Artfield7_grframe,id.vars="samp2")
Artfield7_grframelong_sum <- ddply(Artfield7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield7_gr_max <- sum(Artfield7_grframelong_sum $max > max20_Artfieldpipgr)
Artfield7_gr_max
Artfield7_gr_pres <- sum(Artfield7_grframelong_sum $max > 0)
Artfield7_gr_pres

#number of sites which would be classified as low
Artfield7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield7_grframelong_sum$max)
Artfield7_gr_lw_ref
#number of sites which would be classified as high
Artfield7_gr_high_ref <- sum( Artfield7_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield7_gr_high_ref
#number of sites which would be classified as moderate
Artfield7_gr_mod_ref <- 1000 - (Artfield7_gr_high_ref + Artfield7_gr_lw_ref)
Artfield7_gr_mod_ref

#8 nights
Artfield8_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Artfield8_grframe<-data.frame(Artfield8_gr, samp2)
Artfield8_grframelong <- melt(Artfield8_grframe,id.vars="samp2")
Artfield8_grframelong_sum <- ddply(Artfield8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield8_gr_max <- sum(Artfield8_grframelong_sum $max > max20_Artfieldpipgr)
Artfield8_gr_max
Artfield8_gr_pres <- sum(Artfield8_grframelong_sum $max > 0)
Artfield8_gr_pres

#number of sites which would be classified as low
Artfield8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield8_grframelong_sum$max)
Artfield8_gr_lw_ref
#number of sites which would be classified as high
Artfield8_gr_high_ref <- sum( Artfield8_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield8_gr_high_ref
#number of sites which would be classified as moderate
Artfield8_gr_mod_ref <- 1000 - (Artfield8_gr_high_ref + Artfield8_gr_lw_ref)
Artfield8_gr_mod_ref

#9 nights
Artfield9_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Artfield9_grframe<-data.frame(Artfield9_gr, samp2)
Artfield9_grframelong <- melt(Artfield9_grframe,id.vars="samp2")
Artfield9_grframelong_sum <- ddply(Artfield9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Artfield9_gr_max <- sum(Artfield9_grframelong_sum $max > max20_Artfieldpipgr)
Artfield9_gr_max
Artfield9_gr_pres <- sum(Artfield9_grframelong_sum $max > 0)
Artfield9_gr_pres

#number of sites which would be classified as low
Artfield9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield9_grframelong_sum$max)
Artfield9_gr_lw_ref
#number of sites which would be classified as high
Artfield9_gr_high_ref <- sum( Artfield9_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield9_gr_high_ref
#number of sites which would be classified as moderate
Artfield9_gr_mod_ref <- 1000 - (Artfield9_gr_high_ref + Artfield9_gr_lw_ref)
Artfield9_gr_mod_ref

#10 detectors
Artfield10_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Artfield10_grframe<-data.frame(Artfield10_gr, samp2)
Artfield10_grframelong <- melt(Artfield10_grframe,id.vars="samp2")
Artfield10_grframelong_sum <- ddply(Artfield10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield10_gr_max <- sum(Artfield10_grframelong_sum $max > max20_Artfieldpipgr)
Artfield10_gr_max
Artfield10_gr_pres <- sum(Artfield10_grframelong_sum $max > 0)
Artfield10_gr_pres

#number of sites which would be classified as low
Artfield10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield10_grframelong_sum$max)
Artfield10_gr_lw_ref
#number of sites which would be classified as high
Artfield10_gr_high_ref <- sum( Artfield10_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield10_gr_high_ref
#number of sites which would be classified as moderate
Artfield10_gr_mod_ref <- 1000 - (Artfield10_gr_high_ref + Artfield10_gr_lw_ref)
Artfield10_gr_mod_ref

#11 detectors
Artfield11_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Artfield11_grframe<-data.frame(Artfield11_gr, samp2)
Artfield11_grframelong <- melt(Artfield11_grframe,id.vars="samp2")
Artfield11_grframelong_sum <- ddply(Artfield11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield11_gr_max <- sum(Artfield11_grframelong_sum $max > max20_Artfieldpipgr)
Artfield11_gr_max
Artfield11_gr_pres <- sum(Artfield11_grframelong_sum $max > 0)
Artfield11_gr_pres

#number of sites which would be classified as low
Artfield11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield11_grframelong_sum$max)
Artfield11_gr_lw_ref
#number of sites which would be classified as high
Artfield11_gr_high_ref <- sum( Artfield11_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield11_gr_high_ref
#number of sites which would be classified as moderate
Artfield11_gr_mod_ref <- 1000 - (Artfield11_gr_high_ref + Artfield11_gr_lw_ref)
Artfield11_gr_mod_ref

#12 detectors
Artfield12_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Artfield12_grframe<-data.frame(Artfield12_gr, samp2)
Artfield12_grframelong <- melt(Artfield12_grframe,id.vars="samp2")
Artfield12_grframelong_sum <- ddply(Artfield12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield12_gr_max <- sum(Artfield12_grframelong_sum $max > max20_Artfieldpipgr)
Artfield12_gr_max
Artfield12_gr_pres <- sum(Artfield12_grframelong_sum $max > 0)
Artfield12_gr_pres

#number of sites which would be classified as low
Artfield12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield12_grframelong_sum$max)
Artfield12_gr_lw_ref
#number of sites which would be classified as high
Artfield12_gr_high_ref <- sum( Artfield12_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield12_gr_high_ref
#number of sites which would be classified as moderate
Artfield12_gr_mod_ref <- 1000 - (Artfield12_gr_high_ref + Artfield12_gr_lw_ref)
Artfield12_gr_mod_ref

#13 detectors
Artfield13_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Artfield13_grframe<-data.frame(Artfield13_gr, samp2)
Artfield13_grframelong <- melt(Artfield13_grframe,id.vars="samp2")
Artfield13_grframelong_sum <- ddply(Artfield13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield13_gr_max <- sum(Artfield13_grframelong_sum $max > max20_Artfieldpipgr)
Artfield13_gr_max
Artfield13_gr_pres <- sum(Artfield13_grframelong_sum $max > 0)
Artfield13_gr_pres

#number of sites which would be classified as low
Artfield13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield13_grframelong_sum$max)
Artfield13_gr_lw_ref
#number of sites which would be classified as high
Artfield13_gr_high_ref <- sum( Artfield13_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield13_gr_high_ref
#number of sites which would be classified as moderate
Artfield13_gr_mod_ref <- 1000 - (Artfield13_gr_high_ref + Artfield13_gr_lw_ref)
Artfield13_gr_mod_ref

#14 detectors
Artfield14_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Artfield14_grframe<-data.frame(Artfield14_gr, samp2)
Artfield14_grframelong <- melt(Artfield14_grframe,id.vars="samp2")
Artfield14_grframelong_sum <- ddply(Artfield14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield14_gr_max <- sum(Artfield14_grframelong_sum $max > max20_Artfieldpipgr)
Artfield14_gr_max
Artfield14_gr_pres <- sum(Artfield14_grframelong_sum $max > 0)
Artfield14_gr_pres

#number of sites which would be classified as low
Artfield14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield14_grframelong_sum$max)
Artfield14_gr_lw_ref
#number of sites which would be classified as high
Artfield14_gr_high_ref <- sum( Artfield14_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield14_gr_high_ref
#number of sites which would be classified as moderate
Artfield14_gr_mod_ref <- 1000 - (Artfield14_gr_high_ref + Artfield14_gr_lw_ref)
Artfield14_gr_mod_ref

#15 detectors
Artfield15_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Artfield15_grframe<-data.frame(Artfield15_gr, samp2)
Artfield15_grframelong <- melt(Artfield15_grframe,id.vars="samp2")
Artfield15_grframelong_sum <- ddply(Artfield15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield15_gr_max <- sum(Artfield15_grframelong_sum $max > max20_Artfieldpipgr)
Artfield15_gr_max
Artfield15_gr_pres <- sum(Artfield15_grframelong_sum $max > 0)
Artfield15_gr_pres

#number of sites which would be classified as low
Artfield15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield15_grframelong_sum$max)
Artfield15_gr_lw_ref
#number of sites which would be classified as high
Artfield15_gr_high_ref <- sum( Artfield15_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield15_gr_high_ref
#number of sites which would be classified as moderate
Artfield15_gr_mod_ref <- 1000 - (Artfield15_gr_high_ref + Artfield15_gr_lw_ref)
Artfield15_gr_mod_ref

#16 detectors
Artfield16_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Artfield16_grframe<-data.frame(Artfield16_gr, samp2)
Artfield16_grframelong <- melt(Artfield16_grframe,id.vars="samp2")
Artfield16_grframelong_sum <- ddply(Artfield16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield16_gr_max <- sum(Artfield16_grframelong_sum $max > max20_Artfieldpipgr)
Artfield16_gr_max
Artfield16_gr_pres <- sum(Artfield16_grframelong_sum $max > 0)
Artfield16_gr_pres

#number of sites which would be classified as low
Artfield16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield16_grframelong_sum$max)
Artfield16_gr_lw_ref
#number of sites which would be classified as high
Artfield16_gr_high_ref <- sum( Artfield16_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield16_gr_high_ref
#number of sites which would be classified as moderate
Artfield16_gr_mod_ref <- 1000 - (Artfield16_gr_high_ref + Artfield16_gr_lw_ref)
Artfield16_gr_mod_ref

#17 detectors
Artfield17_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Artfield17_grframe<-data.frame(Artfield17_gr, samp2)
Artfield17_grframelong <- melt(Artfield17_grframe,id.vars="samp2")
Artfield17_grframelong_sum <- ddply(Artfield17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield17_gr_max <- sum(Artfield17_grframelong_sum $max > max20_Artfieldpipgr)
Artfield17_gr_max
Artfield17_gr_pres <- sum(Artfield17_grframelong_sum $max > 0)
Artfield17_gr_pres

#number of sites which would be classified as low
Artfield17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield17_grframelong_sum$max)
Artfield17_gr_lw_ref
#number of sites which would be classified as high
Artfield17_gr_high_ref <- sum( Artfield17_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield17_gr_high_ref
#number of sites which would be classified as moderate
Artfield17_gr_mod_ref <- 1000 - (Artfield17_gr_high_ref + Artfield17_gr_lw_ref)
Artfield17_gr_mod_ref

#18 detectors
Artfield18_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Artfield18_grframe<-data.frame(Artfield18_gr, samp2)
Artfield18_grframelong <- melt(Artfield18_grframe,id.vars="samp2")
Artfield18_grframelong_sum <- ddply(Artfield18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield18_gr_max <- sum(Artfield18_grframelong_sum $max > max20_Artfieldpipgr)
Artfield18_gr_max
Artfield18_gr_pres <- sum(Artfield18_grframelong_sum $max > 0)
Artfield18_gr_pres

#number of sites which would be classified as low
Artfield18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield18_grframelong_sum$max)
Artfield18_gr_lw_ref
#number of sites which would be classified as high
Artfield18_gr_high_ref <- sum( Artfield18_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield18_gr_high_ref
#number of sites which would be classified as moderate
Artfield18_gr_mod_ref <- 1000 - (Artfield18_gr_high_ref + Artfield18_gr_lw_ref)
Artfield18_gr_mod_ref

#19 detectors
Artfield19_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Artfield19_grframe<-data.frame(Artfield19_gr, samp2)
Artfield19_grframelong <- melt(Artfield19_grframe,id.vars="samp2")
Artfield19_grframelong_sum <- ddply(Artfield19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield19_gr_max <- sum(Artfield19_grframelong_sum $max > max20_Artfieldpipgr)
Artfield19_gr_max
Artfield19_gr_pres <- sum(Artfield19_grframelong_sum $max > 0)
Artfield19_gr_pres

#number of sites which would be classified as low
Artfield19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield19_grframelong_sum$max)
Artfield19_gr_lw_ref
#number of sites which would be classified as high
Artfield19_gr_high_ref <- sum( Artfield19_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield19_gr_high_ref
#number of sites which would be classified as moderate
Artfield19_gr_mod_ref <- 1000 - (Artfield19_gr_high_ref + Artfield19_gr_lw_ref)
Artfield19_gr_mod_ref

#20 detectors
Artfield20_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Artfield20_grframe<-data.frame(Artfield20_gr, samp2)
Artfield20_grframelong <- melt(Artfield20_grframe,id.vars="samp2")
Artfield20_grframelong_sum <- ddply(Artfield20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield20_gr_max <- sum(Artfield20_grframelong_sum $max > max20_Artfieldpipgr)
Artfield20_gr_max
Artfield20_gr_pres <- sum(Artfield20_grframelong_sum $max > 0)
Artfield20_gr_pres

#number of sites which would be classified as low
Artfield20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield20_grframelong_sum$max)
Artfield20_gr_lw_ref
#number of sites which would be classified as high
Artfield20_gr_high_ref <- sum( Artfield20_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield20_gr_high_ref
#number of sites which would be classified as moderate
Artfield20_gr_mod_ref <- 1000 - (Artfield20_gr_high_ref + Artfield20_gr_lw_ref)
Artfield20_gr_mod_ref

#21 detectors
Artfield21_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Artfield21_grframe<-data.frame(Artfield21_gr, samp2)
Artfield21_grframelong <- melt(Artfield21_grframe,id.vars="samp2")
Artfield21_grframelong_sum <- ddply(Artfield21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield21_gr_max <- sum(Artfield21_grframelong_sum $max > max20_Artfieldpipgr)
Artfield21_gr_max
Artfield21_gr_pres <- sum(Artfield21_grframelong_sum $max > 0)
Artfield21_gr_pres

#number of sites which would be classified as low
Artfield21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield21_grframelong_sum$max)
Artfield21_gr_lw_ref
#number of sites which would be classified as high
Artfield21_gr_high_ref <- sum( Artfield21_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield21_gr_high_ref
#number of sites which would be classified as moderate
Artfield21_gr_mod_ref <- 1000 - (Artfield21_gr_high_ref + Artfield21_gr_lw_ref)
Artfield21_gr_mod_ref

#22 detectors
Artfield22_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Artfield22_grframe<-data.frame(Artfield22_gr, samp2)
Artfield22_grframelong <- melt(Artfield22_grframe,id.vars="samp2")
Artfield22_grframelong_sum <- ddply(Artfield22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield22_gr_max <- sum(Artfield22_grframelong_sum $max > max20_Artfieldpipgr)
Artfield22_gr_max
Artfield22_gr_pres <- sum(Artfield22_grframelong_sum $max > 0)
Artfield22_gr_pres

#number of sites which would be classified as low
Artfield22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield22_grframelong_sum$max)
Artfield22_gr_lw_ref
#number of sites which would be classified as high
Artfield22_gr_high_ref <- sum( Artfield22_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield22_gr_high_ref
#number of sites which would be classified as moderate
Artfield22_gr_mod_ref <- 1000 - (Artfield22_gr_high_ref + Artfield22_gr_lw_ref)
Artfield22_gr_mod_ref

#23 detectors
Artfield23_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Artfield23_grframe<-data.frame(Artfield23_gr, samp2)
Artfield23_grframelong <- melt(Artfield23_grframe,id.vars="samp2")
Artfield23_grframelong_sum <- ddply(Artfield23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield23_gr_max <- sum(Artfield23_grframelong_sum $max > max20_Artfieldpipgr)
Artfield23_gr_max
Artfield23_gr_pres <- sum(Artfield23_grframelong_sum $max > 0)
Artfield23_gr_pres

#number of sites which would be classified as low
Artfield23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield23_grframelong_sum$max)
Artfield23_gr_lw_ref
#number of sites which would be classified as high
Artfield23_gr_high_ref <- sum( Artfield23_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield23_gr_high_ref
#number of sites which would be classified as moderate
Artfield23_gr_mod_ref <- 1000 - (Artfield23_gr_high_ref + Artfield23_gr_lw_ref)
Artfield23_gr_mod_ref

#24 detectors
Artfield24_gr<-(replicate(1000, (sample(Artfieldpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Artfield24_grframe<-data.frame(Artfield24_gr, samp2)
Artfield24_grframelong <- melt(Artfield24_grframe,id.vars="samp2")
Artfield24_grframelong_sum <- ddply(Artfield24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Artfield24_gr_max <- sum(Artfield24_grframelong_sum $max > max20_Artfieldpipgr)
Artfield24_gr_max
Artfield24_gr_pres <- sum(Artfield24_grframelong_sum $max > 0)
Artfield24_gr_pres

#number of sites which would be classified as low
Artfield24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Artfield24_grframelong_sum$max)
Artfield24_gr_lw_ref
#number of sites which would be classified as high
Artfield24_gr_high_ref <- sum( Artfield24_grframelong_sum$max > allsppgr_ppip_ref_high)
Artfield24_gr_high_ref
#number of sites which would be classified as moderate
Artfield24_gr_mod_ref <- 1000 - (Artfield24_gr_high_ref + Artfield24_gr_lw_ref)
Artfield24_gr_mod_ref

Present<-c(Artfield1_gr_pres,Artfield2_gr_pres,
           Artfield3_gr_pres,Artfield4_gr_pres,
           Artfield5_gr_pres,Artfield6_gr_pres,
           Artfield7_gr_pres,Artfield8_gr_pres,
           Artfield9_gr_pres,Artfield10_gr_pres,
           Artfield11_gr_pres,Artfield12_gr_pres,
           Artfield13_gr_pres,Artfield14_gr_pres,
           Artfield15_gr_pres,Artfield16_gr_pres,
           Artfield17_gr_pres,Artfield18_gr_pres,
           Artfield19_gr_pres,Artfield20_gr_pres,
           Artfield21_gr_pres,Artfield22_gr_pres,
           Artfield23_gr_pres,Artfield24_gr_pres)


Maximum<-c(Artfield1_gr_max,Artfield2_gr_max,
           Artfield3_gr_max,Artfield4_gr_max,
           Artfield5_gr_max,Artfield6_gr_max,
           Artfield7_gr_max,Artfield8_gr_max,
           Artfield9_gr_max,Artfield10_gr_max,
           Artfield11_gr_max,Artfield12_gr_max,
           Artfield13_gr_max,Artfield14_gr_max,
           Artfield15_gr_max,Artfield16_gr_max,
           Artfield17_gr_max,Artfield18_gr_max,
           Artfield19_gr_max,Artfield20_gr_max,
           Artfield21_gr_max,Artfield22_gr_max,
           Artfield23_gr_max,Artfield24_gr_max)

Low<-c(Artfield1_gr_lw_ref, Artfield2_gr_lw_ref, Artfield3_gr_lw_ref,
       Artfield4_gr_lw_ref, Artfield5_gr_lw_ref, Artfield6_gr_lw_ref,
       Artfield7_gr_lw_ref, Artfield8_gr_lw_ref, Artfield9_gr_lw_ref,
       Artfield10_gr_lw_ref, Artfield11_gr_lw_ref, Artfield12_gr_lw_ref, 
       Artfield13_gr_lw_ref, Artfield14_gr_lw_ref, Artfield15_gr_lw_ref, 
       Artfield16_gr_lw_ref, Artfield17_gr_lw_ref, Artfield18_gr_lw_ref, 
       Artfield19_gr_lw_ref, Artfield20_gr_lw_ref, Artfield21_gr_lw_ref,
       Artfield22_gr_lw_ref,Artfield23_gr_lw_ref,Artfield24_gr_lw_ref)

Moderate<-c(Artfield1_gr_mod_ref, Artfield2_gr_mod_ref, Artfield3_gr_mod_ref,
            Artfield4_gr_mod_ref, Artfield5_gr_mod_ref, Artfield6_gr_mod_ref,
            Artfield7_gr_mod_ref, Artfield8_gr_mod_ref, Artfield9_gr_mod_ref,
            Artfield10_gr_mod_ref, Artfield11_gr_mod_ref, Artfield12_gr_mod_ref, 
            Artfield13_gr_mod_ref, Artfield14_gr_mod_ref, Artfield15_gr_mod_ref, 
            Artfield16_gr_mod_ref, Artfield17_gr_mod_ref, Artfield18_gr_mod_ref, 
            Artfield19_gr_mod_ref, Artfield20_gr_mod_ref, Artfield21_gr_mod_ref,
            Artfield22_gr_mod_ref,Artfield23_gr_mod_ref,Artfield24_gr_mod_ref)

High<-c(Artfield1_gr_high_ref, Artfield2_gr_high_ref, Artfield3_gr_high_ref,
        Artfield4_gr_high_ref, Artfield5_gr_high_ref, Artfield6_gr_high_ref,
        Artfield7_gr_high_ref, Artfield8_gr_high_ref, Artfield9_gr_high_ref,
        Artfield10_gr_high_ref, Artfield11_gr_high_ref, Artfield12_gr_high_ref, 
        Artfield13_gr_high_ref, Artfield14_gr_high_ref, Artfield15_gr_high_ref, 
        Artfield16_gr_high_ref, Artfield17_gr_high_ref, Artfield18_gr_high_ref, 
        Artfield19_gr_high_ref, Artfield20_gr_high_ref, Artfield21_gr_high_ref,
        Artfield22_gr_high_ref,Artfield23_gr_high_ref,Artfield24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Artfieldgr",24)
Lowsite <- Artfieldlow
Modsite <- Artfieldmod
Highsite <-Artfieldhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Artfieldgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##Bambersfarm

Bambersfarmpipgr<-subset(allspp4gr_ppip, Site=="Bambersfarm")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Bambersfarmpipgr<-max(Bambersfarmpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Bambersfarmpipgr<- (max_Bambersfarmpipgr/100)*80

##calculate the site classification (reference range)

Bambersfarmhigh<- max_Bambersfarmpipgr > allsppgr_ppip_ref_high

Bambersfarmlow<- allsppgr_ppip_ref_low > max_Bambersfarmpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Bambersfarmpipgr
Bambersfarmmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Bambersfarm1_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 1, replace=F))))
Bambersfarm1_gr_max <- sum(Bambersfarm1_gr > max20_Bambersfarmpipgr)
Bambersfarm1_gr_max
Bambersfarm1_gr_pres <- sum(Bambersfarm1_gr > 0)
Bambersfarm1_gr_pres
#number of sites which would be classified as low
Bambersfarm1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm1_gr)
Bambersfarm1_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm1_gr_high_ref <- sum( Bambersfarm1_gr > allsppgr_ppip_ref_high)
Bambersfarm1_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm1_gr_mod_ref <- 1000 - (Bambersfarm1_gr_high_ref + Bambersfarm1_gr_lw_ref)
Bambersfarm1_gr_mod_ref


#2 nights
Bambersfarm2_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Bambersfarm2_grframe<-data.frame(Bambersfarm2_gr, samp2)
Bambersfarm2_grframelong <- melt(Bambersfarm2_grframe,id.vars="samp2")
Bambersfarm2_grframelong_sum <- ddply(Bambersfarm2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm2_gr_max <- sum(Bambersfarm2_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm2_gr_max
Bambersfarm2_gr_pres <- sum(Bambersfarm2_grframelong_sum $max > 0)
Bambersfarm2_gr_pres

#number of sites which would be classified as low
Bambersfarm2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm2_grframelong_sum$max)
Bambersfarm2_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm2_gr_high_ref <- sum( Bambersfarm2_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm2_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm2_gr_mod_ref <- 1000 - (Bambersfarm2_gr_high_ref + Bambersfarm2_gr_lw_ref)
Bambersfarm2_gr_mod_ref


#3 nights
Bambersfarm3_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Bambersfarm3_grframe<-data.frame(Bambersfarm3_gr, samp2)
Bambersfarm3_grframelong <- melt(Bambersfarm3_grframe,id.vars="samp2")
Bambersfarm3_grframelong_sum <- ddply(Bambersfarm3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm3_gr_max <- sum(Bambersfarm3_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm3_gr_max
Bambersfarm3_gr_pres <- sum(Bambersfarm3_grframelong_sum $max > 0)
Bambersfarm3_gr_pres

#number of sites which would be classified as low
Bambersfarm3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm3_grframelong_sum$max)
Bambersfarm3_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm3_gr_high_ref <- sum( Bambersfarm3_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm3_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm3_gr_mod_ref <- 1000 - (Bambersfarm3_gr_high_ref + Bambersfarm3_gr_lw_ref)
Bambersfarm3_gr_mod_ref

#4 nights
Bambersfarm4_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Bambersfarm4_grframe<-data.frame(Bambersfarm4_gr, samp2)
Bambersfarm4_grframelong <- melt(Bambersfarm4_grframe,id.vars="samp2")
Bambersfarm4_grframelong_sum <- ddply(Bambersfarm4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm4_gr_max <- sum(Bambersfarm4_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm4_gr_max
Bambersfarm4_gr_pres <- sum(Bambersfarm4_grframelong_sum $max > 0)
Bambersfarm4_gr_pres

#number of sites which would be classified as low
Bambersfarm4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm4_grframelong_sum$max)
Bambersfarm4_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm4_gr_high_ref <- sum( Bambersfarm4_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm4_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm4_gr_mod_ref <- 1000 - (Bambersfarm4_gr_high_ref + Bambersfarm4_gr_lw_ref)
Bambersfarm4_gr_mod_ref

#5 nights
Bambersfarm5_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Bambersfarm5_grframe<-data.frame(Bambersfarm5_gr, samp2)
Bambersfarm5_grframelong <- melt(Bambersfarm5_grframe,id.vars="samp2")
Bambersfarm5_grframelong_sum <- ddply(Bambersfarm5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm5_gr_max <- sum(Bambersfarm5_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm5_gr_max
Bambersfarm5_gr_pres <- sum(Bambersfarm5_grframelong_sum $max > 0)
Bambersfarm5_gr_pres

#number of sites which would be classified as low
Bambersfarm5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm5_grframelong_sum$max)
Bambersfarm5_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm5_gr_high_ref <- sum( Bambersfarm5_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm5_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm5_gr_mod_ref <- 1000 - (Bambersfarm5_gr_high_ref + Bambersfarm5_gr_lw_ref)
Bambersfarm5_gr_mod_ref

#6 nights
Bambersfarm6_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Bambersfarm6_grframe<-data.frame(Bambersfarm6_gr, samp2)
Bambersfarm6_grframelong <- melt(Bambersfarm6_grframe,id.vars="samp2")
Bambersfarm6_grframelong_sum <- ddply(Bambersfarm6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm6_gr_max <- sum(Bambersfarm6_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm6_gr_max
Bambersfarm6_gr_pres <- sum(Bambersfarm6_grframelong_sum $max > 0)
Bambersfarm6_gr_pres

#number of sites which would be classified as low
Bambersfarm6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm6_grframelong_sum$max)
Bambersfarm6_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm6_gr_high_ref <- sum( Bambersfarm6_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm6_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm6_gr_mod_ref <- 1000 - (Bambersfarm6_gr_high_ref + Bambersfarm6_gr_lw_ref)
Bambersfarm6_gr_mod_ref

#7 nights
Bambersfarm7_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Bambersfarm7_grframe<-data.frame(Bambersfarm7_gr, samp2)
Bambersfarm7_grframelong <- melt(Bambersfarm7_grframe,id.vars="samp2")
Bambersfarm7_grframelong_sum <- ddply(Bambersfarm7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm7_gr_max <- sum(Bambersfarm7_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm7_gr_max
Bambersfarm7_gr_pres <- sum(Bambersfarm7_grframelong_sum $max > 0)
Bambersfarm7_gr_pres

#number of sites which would be classified as low
Bambersfarm7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm7_grframelong_sum$max)
Bambersfarm7_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm7_gr_high_ref <- sum( Bambersfarm7_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm7_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm7_gr_mod_ref <- 1000 - (Bambersfarm7_gr_high_ref + Bambersfarm7_gr_lw_ref)
Bambersfarm7_gr_mod_ref

#8 nights
Bambersfarm8_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Bambersfarm8_grframe<-data.frame(Bambersfarm8_gr, samp2)
Bambersfarm8_grframelong <- melt(Bambersfarm8_grframe,id.vars="samp2")
Bambersfarm8_grframelong_sum <- ddply(Bambersfarm8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm8_gr_max <- sum(Bambersfarm8_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm8_gr_max
Bambersfarm8_gr_pres <- sum(Bambersfarm8_grframelong_sum $max > 0)
Bambersfarm8_gr_pres

#number of sites which would be classified as low
Bambersfarm8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm8_grframelong_sum$max)
Bambersfarm8_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm8_gr_high_ref <- sum( Bambersfarm8_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm8_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm8_gr_mod_ref <- 1000 - (Bambersfarm8_gr_high_ref + Bambersfarm8_gr_lw_ref)
Bambersfarm8_gr_mod_ref

#9 nights
Bambersfarm9_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Bambersfarm9_grframe<-data.frame(Bambersfarm9_gr, samp2)
Bambersfarm9_grframelong <- melt(Bambersfarm9_grframe,id.vars="samp2")
Bambersfarm9_grframelong_sum <- ddply(Bambersfarm9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Bambersfarm9_gr_max <- sum(Bambersfarm9_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm9_gr_max
Bambersfarm9_gr_pres <- sum(Bambersfarm9_grframelong_sum $max > 0)
Bambersfarm9_gr_pres

#number of sites which would be classified as low
Bambersfarm9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm9_grframelong_sum$max)
Bambersfarm9_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm9_gr_high_ref <- sum( Bambersfarm9_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm9_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm9_gr_mod_ref <- 1000 - (Bambersfarm9_gr_high_ref + Bambersfarm9_gr_lw_ref)
Bambersfarm9_gr_mod_ref

#10 detectors
Bambersfarm10_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Bambersfarm10_grframe<-data.frame(Bambersfarm10_gr, samp2)
Bambersfarm10_grframelong <- melt(Bambersfarm10_grframe,id.vars="samp2")
Bambersfarm10_grframelong_sum <- ddply(Bambersfarm10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm10_gr_max <- sum(Bambersfarm10_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm10_gr_max
Bambersfarm10_gr_pres <- sum(Bambersfarm10_grframelong_sum $max > 0)
Bambersfarm10_gr_pres

#number of sites which would be classified as low
Bambersfarm10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm10_grframelong_sum$max)
Bambersfarm10_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm10_gr_high_ref <- sum( Bambersfarm10_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm10_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm10_gr_mod_ref <- 1000 - (Bambersfarm10_gr_high_ref + Bambersfarm10_gr_lw_ref)
Bambersfarm10_gr_mod_ref

#11 detectors
Bambersfarm11_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Bambersfarm11_grframe<-data.frame(Bambersfarm11_gr, samp2)
Bambersfarm11_grframelong <- melt(Bambersfarm11_grframe,id.vars="samp2")
Bambersfarm11_grframelong_sum <- ddply(Bambersfarm11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm11_gr_max <- sum(Bambersfarm11_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm11_gr_max
Bambersfarm11_gr_pres <- sum(Bambersfarm11_grframelong_sum $max > 0)
Bambersfarm11_gr_pres

#number of sites which would be classified as low
Bambersfarm11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm11_grframelong_sum$max)
Bambersfarm11_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm11_gr_high_ref <- sum( Bambersfarm11_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm11_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm11_gr_mod_ref <- 1000 - (Bambersfarm11_gr_high_ref + Bambersfarm11_gr_lw_ref)
Bambersfarm11_gr_mod_ref

#12 detectors
Bambersfarm12_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Bambersfarm12_grframe<-data.frame(Bambersfarm12_gr, samp2)
Bambersfarm12_grframelong <- melt(Bambersfarm12_grframe,id.vars="samp2")
Bambersfarm12_grframelong_sum <- ddply(Bambersfarm12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm12_gr_max <- sum(Bambersfarm12_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm12_gr_max
Bambersfarm12_gr_pres <- sum(Bambersfarm12_grframelong_sum $max > 0)
Bambersfarm12_gr_pres

#number of sites which would be classified as low
Bambersfarm12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm12_grframelong_sum$max)
Bambersfarm12_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm12_gr_high_ref <- sum( Bambersfarm12_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm12_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm12_gr_mod_ref <- 1000 - (Bambersfarm12_gr_high_ref + Bambersfarm12_gr_lw_ref)
Bambersfarm12_gr_mod_ref

#13 detectors
Bambersfarm13_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Bambersfarm13_grframe<-data.frame(Bambersfarm13_gr, samp2)
Bambersfarm13_grframelong <- melt(Bambersfarm13_grframe,id.vars="samp2")
Bambersfarm13_grframelong_sum <- ddply(Bambersfarm13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm13_gr_max <- sum(Bambersfarm13_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm13_gr_max
Bambersfarm13_gr_pres <- sum(Bambersfarm13_grframelong_sum $max > 0)
Bambersfarm13_gr_pres

#number of sites which would be classified as low
Bambersfarm13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm13_grframelong_sum$max)
Bambersfarm13_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm13_gr_high_ref <- sum( Bambersfarm13_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm13_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm13_gr_mod_ref <- 1000 - (Bambersfarm13_gr_high_ref + Bambersfarm13_gr_lw_ref)
Bambersfarm13_gr_mod_ref

#14 detectors
Bambersfarm14_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Bambersfarm14_grframe<-data.frame(Bambersfarm14_gr, samp2)
Bambersfarm14_grframelong <- melt(Bambersfarm14_grframe,id.vars="samp2")
Bambersfarm14_grframelong_sum <- ddply(Bambersfarm14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm14_gr_max <- sum(Bambersfarm14_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm14_gr_max
Bambersfarm14_gr_pres <- sum(Bambersfarm14_grframelong_sum $max > 0)
Bambersfarm14_gr_pres

#number of sites which would be classified as low
Bambersfarm14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm14_grframelong_sum$max)
Bambersfarm14_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm14_gr_high_ref <- sum( Bambersfarm14_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm14_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm14_gr_mod_ref <- 1000 - (Bambersfarm14_gr_high_ref + Bambersfarm14_gr_lw_ref)
Bambersfarm14_gr_mod_ref

#15 detectors
Bambersfarm15_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Bambersfarm15_grframe<-data.frame(Bambersfarm15_gr, samp2)
Bambersfarm15_grframelong <- melt(Bambersfarm15_grframe,id.vars="samp2")
Bambersfarm15_grframelong_sum <- ddply(Bambersfarm15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm15_gr_max <- sum(Bambersfarm15_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm15_gr_max
Bambersfarm15_gr_pres <- sum(Bambersfarm15_grframelong_sum $max > 0)
Bambersfarm15_gr_pres

#number of sites which would be classified as low
Bambersfarm15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm15_grframelong_sum$max)
Bambersfarm15_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm15_gr_high_ref <- sum( Bambersfarm15_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm15_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm15_gr_mod_ref <- 1000 - (Bambersfarm15_gr_high_ref + Bambersfarm15_gr_lw_ref)
Bambersfarm15_gr_mod_ref

#16 detectors
Bambersfarm16_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Bambersfarm16_grframe<-data.frame(Bambersfarm16_gr, samp2)
Bambersfarm16_grframelong <- melt(Bambersfarm16_grframe,id.vars="samp2")
Bambersfarm16_grframelong_sum <- ddply(Bambersfarm16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm16_gr_max <- sum(Bambersfarm16_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm16_gr_max
Bambersfarm16_gr_pres <- sum(Bambersfarm16_grframelong_sum $max > 0)
Bambersfarm16_gr_pres

#number of sites which would be classified as low
Bambersfarm16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm16_grframelong_sum$max)
Bambersfarm16_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm16_gr_high_ref <- sum( Bambersfarm16_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm16_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm16_gr_mod_ref <- 1000 - (Bambersfarm16_gr_high_ref + Bambersfarm16_gr_lw_ref)
Bambersfarm16_gr_mod_ref

#17 detectors
Bambersfarm17_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Bambersfarm17_grframe<-data.frame(Bambersfarm17_gr, samp2)
Bambersfarm17_grframelong <- melt(Bambersfarm17_grframe,id.vars="samp2")
Bambersfarm17_grframelong_sum <- ddply(Bambersfarm17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm17_gr_max <- sum(Bambersfarm17_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm17_gr_max
Bambersfarm17_gr_pres <- sum(Bambersfarm17_grframelong_sum $max > 0)
Bambersfarm17_gr_pres

#number of sites which would be classified as low
Bambersfarm17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm17_grframelong_sum$max)
Bambersfarm17_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm17_gr_high_ref <- sum( Bambersfarm17_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm17_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm17_gr_mod_ref <- 1000 - (Bambersfarm17_gr_high_ref + Bambersfarm17_gr_lw_ref)
Bambersfarm17_gr_mod_ref

#18 detectors
Bambersfarm18_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Bambersfarm18_grframe<-data.frame(Bambersfarm18_gr, samp2)
Bambersfarm18_grframelong <- melt(Bambersfarm18_grframe,id.vars="samp2")
Bambersfarm18_grframelong_sum <- ddply(Bambersfarm18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm18_gr_max <- sum(Bambersfarm18_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm18_gr_max
Bambersfarm18_gr_pres <- sum(Bambersfarm18_grframelong_sum $max > 0)
Bambersfarm18_gr_pres

#number of sites which would be classified as low
Bambersfarm18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm18_grframelong_sum$max)
Bambersfarm18_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm18_gr_high_ref <- sum( Bambersfarm18_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm18_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm18_gr_mod_ref <- 1000 - (Bambersfarm18_gr_high_ref + Bambersfarm18_gr_lw_ref)
Bambersfarm18_gr_mod_ref

#19 detectors
Bambersfarm19_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Bambersfarm19_grframe<-data.frame(Bambersfarm19_gr, samp2)
Bambersfarm19_grframelong <- melt(Bambersfarm19_grframe,id.vars="samp2")
Bambersfarm19_grframelong_sum <- ddply(Bambersfarm19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm19_gr_max <- sum(Bambersfarm19_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm19_gr_max
Bambersfarm19_gr_pres <- sum(Bambersfarm19_grframelong_sum $max > 0)
Bambersfarm19_gr_pres

#number of sites which would be classified as low
Bambersfarm19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm19_grframelong_sum$max)
Bambersfarm19_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm19_gr_high_ref <- sum( Bambersfarm19_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm19_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm19_gr_mod_ref <- 1000 - (Bambersfarm19_gr_high_ref + Bambersfarm19_gr_lw_ref)
Bambersfarm19_gr_mod_ref

#20 detectors
Bambersfarm20_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Bambersfarm20_grframe<-data.frame(Bambersfarm20_gr, samp2)
Bambersfarm20_grframelong <- melt(Bambersfarm20_grframe,id.vars="samp2")
Bambersfarm20_grframelong_sum <- ddply(Bambersfarm20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm20_gr_max <- sum(Bambersfarm20_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm20_gr_max
Bambersfarm20_gr_pres <- sum(Bambersfarm20_grframelong_sum $max > 0)
Bambersfarm20_gr_pres

#number of sites which would be classified as low
Bambersfarm20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm20_grframelong_sum$max)
Bambersfarm20_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm20_gr_high_ref <- sum( Bambersfarm20_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm20_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm20_gr_mod_ref <- 1000 - (Bambersfarm20_gr_high_ref + Bambersfarm20_gr_lw_ref)
Bambersfarm20_gr_mod_ref

#21 detectors
Bambersfarm21_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Bambersfarm21_grframe<-data.frame(Bambersfarm21_gr, samp2)
Bambersfarm21_grframelong <- melt(Bambersfarm21_grframe,id.vars="samp2")
Bambersfarm21_grframelong_sum <- ddply(Bambersfarm21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm21_gr_max <- sum(Bambersfarm21_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm21_gr_max
Bambersfarm21_gr_pres <- sum(Bambersfarm21_grframelong_sum $max > 0)
Bambersfarm21_gr_pres

#number of sites which would be classified as low
Bambersfarm21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm21_grframelong_sum$max)
Bambersfarm21_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm21_gr_high_ref <- sum( Bambersfarm21_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm21_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm21_gr_mod_ref <- 1000 - (Bambersfarm21_gr_high_ref + Bambersfarm21_gr_lw_ref)
Bambersfarm21_gr_mod_ref

#22 detectors
Bambersfarm22_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Bambersfarm22_grframe<-data.frame(Bambersfarm22_gr, samp2)
Bambersfarm22_grframelong <- melt(Bambersfarm22_grframe,id.vars="samp2")
Bambersfarm22_grframelong_sum <- ddply(Bambersfarm22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm22_gr_max <- sum(Bambersfarm22_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm22_gr_max
Bambersfarm22_gr_pres <- sum(Bambersfarm22_grframelong_sum $max > 0)
Bambersfarm22_gr_pres

#number of sites which would be classified as low
Bambersfarm22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm22_grframelong_sum$max)
Bambersfarm22_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm22_gr_high_ref <- sum( Bambersfarm22_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm22_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm22_gr_mod_ref <- 1000 - (Bambersfarm22_gr_high_ref + Bambersfarm22_gr_lw_ref)
Bambersfarm22_gr_mod_ref

#23 detectors
Bambersfarm23_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Bambersfarm23_grframe<-data.frame(Bambersfarm23_gr, samp2)
Bambersfarm23_grframelong <- melt(Bambersfarm23_grframe,id.vars="samp2")
Bambersfarm23_grframelong_sum <- ddply(Bambersfarm23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm23_gr_max <- sum(Bambersfarm23_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm23_gr_max
Bambersfarm23_gr_pres <- sum(Bambersfarm23_grframelong_sum $max > 0)
Bambersfarm23_gr_pres

#number of sites which would be classified as low
Bambersfarm23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm23_grframelong_sum$max)
Bambersfarm23_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm23_gr_high_ref <- sum( Bambersfarm23_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm23_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm23_gr_mod_ref <- 1000 - (Bambersfarm23_gr_high_ref + Bambersfarm23_gr_lw_ref)
Bambersfarm23_gr_mod_ref

#24 detectors
Bambersfarm24_gr<-(replicate(1000, (sample(Bambersfarmpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Bambersfarm24_grframe<-data.frame(Bambersfarm24_gr, samp2)
Bambersfarm24_grframelong <- melt(Bambersfarm24_grframe,id.vars="samp2")
Bambersfarm24_grframelong_sum <- ddply(Bambersfarm24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Bambersfarm24_gr_max <- sum(Bambersfarm24_grframelong_sum $max > max20_Bambersfarmpipgr)
Bambersfarm24_gr_max
Bambersfarm24_gr_pres <- sum(Bambersfarm24_grframelong_sum $max > 0)
Bambersfarm24_gr_pres

#number of sites which would be classified as low
Bambersfarm24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bambersfarm24_grframelong_sum$max)
Bambersfarm24_gr_lw_ref
#number of sites which would be classified as high
Bambersfarm24_gr_high_ref <- sum( Bambersfarm24_grframelong_sum$max > allsppgr_ppip_ref_high)
Bambersfarm24_gr_high_ref
#number of sites which would be classified as moderate
Bambersfarm24_gr_mod_ref <- 1000 - (Bambersfarm24_gr_high_ref + Bambersfarm24_gr_lw_ref)
Bambersfarm24_gr_mod_ref

Present<-c(Bambersfarm1_gr_pres,Bambersfarm2_gr_pres,
           Bambersfarm3_gr_pres,Bambersfarm4_gr_pres,
           Bambersfarm5_gr_pres,Bambersfarm6_gr_pres,
           Bambersfarm7_gr_pres,Bambersfarm8_gr_pres,
           Bambersfarm9_gr_pres,Bambersfarm10_gr_pres,
           Bambersfarm11_gr_pres,Bambersfarm12_gr_pres,
           Bambersfarm13_gr_pres,Bambersfarm14_gr_pres,
           Bambersfarm15_gr_pres,Bambersfarm16_gr_pres,
           Bambersfarm17_gr_pres,Bambersfarm18_gr_pres,
           Bambersfarm19_gr_pres,Bambersfarm20_gr_pres,
           Bambersfarm21_gr_pres,Bambersfarm22_gr_pres,
           Bambersfarm23_gr_pres,Bambersfarm24_gr_pres)


Maximum<-c(Bambersfarm1_gr_max,Bambersfarm2_gr_max,
           Bambersfarm3_gr_max,Bambersfarm4_gr_max,
           Bambersfarm5_gr_max,Bambersfarm6_gr_max,
           Bambersfarm7_gr_max,Bambersfarm8_gr_max,
           Bambersfarm9_gr_max,Bambersfarm10_gr_max,
           Bambersfarm11_gr_max,Bambersfarm12_gr_max,
           Bambersfarm13_gr_max,Bambersfarm14_gr_max,
           Bambersfarm15_gr_max,Bambersfarm16_gr_max,
           Bambersfarm17_gr_max,Bambersfarm18_gr_max,
           Bambersfarm19_gr_max,Bambersfarm20_gr_max,
           Bambersfarm21_gr_max,Bambersfarm22_gr_max,
           Bambersfarm23_gr_max,Bambersfarm24_gr_max)

Low<-c(Bambersfarm1_gr_lw_ref, Bambersfarm2_gr_lw_ref, Bambersfarm3_gr_lw_ref,
       Bambersfarm4_gr_lw_ref, Bambersfarm5_gr_lw_ref, Bambersfarm6_gr_lw_ref,
       Bambersfarm7_gr_lw_ref, Bambersfarm8_gr_lw_ref, Bambersfarm9_gr_lw_ref,
       Bambersfarm10_gr_lw_ref, Bambersfarm11_gr_lw_ref, Bambersfarm12_gr_lw_ref, 
       Bambersfarm13_gr_lw_ref, Bambersfarm14_gr_lw_ref, Bambersfarm15_gr_lw_ref, 
       Bambersfarm16_gr_lw_ref, Bambersfarm17_gr_lw_ref, Bambersfarm18_gr_lw_ref, 
       Bambersfarm19_gr_lw_ref, Bambersfarm20_gr_lw_ref, Bambersfarm21_gr_lw_ref,
       Bambersfarm22_gr_lw_ref,Bambersfarm23_gr_lw_ref,Bambersfarm24_gr_lw_ref)

Moderate<-c(Bambersfarm1_gr_mod_ref, Bambersfarm2_gr_mod_ref, Bambersfarm3_gr_mod_ref,
            Bambersfarm4_gr_mod_ref, Bambersfarm5_gr_mod_ref, Bambersfarm6_gr_mod_ref,
            Bambersfarm7_gr_mod_ref, Bambersfarm8_gr_mod_ref, Bambersfarm9_gr_mod_ref,
            Bambersfarm10_gr_mod_ref, Bambersfarm11_gr_mod_ref, Bambersfarm12_gr_mod_ref, 
            Bambersfarm13_gr_mod_ref, Bambersfarm14_gr_mod_ref, Bambersfarm15_gr_mod_ref, 
            Bambersfarm16_gr_mod_ref, Bambersfarm17_gr_mod_ref, Bambersfarm18_gr_mod_ref, 
            Bambersfarm19_gr_mod_ref, Bambersfarm20_gr_mod_ref, Bambersfarm21_gr_mod_ref,
            Bambersfarm22_gr_mod_ref,Bambersfarm23_gr_mod_ref,Bambersfarm24_gr_mod_ref)

High<-c(Bambersfarm1_gr_high_ref, Bambersfarm2_gr_high_ref, Bambersfarm3_gr_high_ref,
        Bambersfarm4_gr_high_ref, Bambersfarm5_gr_high_ref, Bambersfarm6_gr_high_ref,
        Bambersfarm7_gr_high_ref, Bambersfarm8_gr_high_ref, Bambersfarm9_gr_high_ref,
        Bambersfarm10_gr_high_ref, Bambersfarm11_gr_high_ref, Bambersfarm12_gr_high_ref, 
        Bambersfarm13_gr_high_ref, Bambersfarm14_gr_high_ref, Bambersfarm15_gr_high_ref, 
        Bambersfarm16_gr_high_ref, Bambersfarm17_gr_high_ref, Bambersfarm18_gr_high_ref, 
        Bambersfarm19_gr_high_ref, Bambersfarm20_gr_high_ref, Bambersfarm21_gr_high_ref,
        Bambersfarm22_gr_high_ref,Bambersfarm23_gr_high_ref,Bambersfarm24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Bambersfarmgr",24)
Lowsite <- Bambersfarmlow
Modsite <- Bambersfarmmod
Highsite <-Bambersfarmhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Bambersfarmgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##BickerFen

BickerFenpipgr<-subset(allspp4gr_ppip, Site=="BickerFen")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_BickerFenpipgr<-max(BickerFenpipgr$Passes)

#calculate 20% from maximum nightly record

max20_BickerFenpipgr<- (max_BickerFenpipgr/100)*80

##calculate the site classification (reference range)

BickerFenhigh<- max_BickerFenpipgr > allsppgr_ppip_ref_high

BickerFenlow<- allsppgr_ppip_ref_low > max_BickerFenpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_BickerFenpipgr
BickerFenmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
BickerFen1_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 1, replace=F))))
BickerFen1_gr_max <- sum(BickerFen1_gr > max20_BickerFenpipgr)
BickerFen1_gr_max
BickerFen1_gr_pres <- sum(BickerFen1_gr > 0)
BickerFen1_gr_pres
#number of sites which would be classified as low
BickerFen1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen1_gr)
BickerFen1_gr_lw_ref
#number of sites which would be classified as high
BickerFen1_gr_high_ref <- sum( BickerFen1_gr > allsppgr_ppip_ref_high)
BickerFen1_gr_high_ref
#number of sites which would be classified as moderate
BickerFen1_gr_mod_ref <- 1000 - (BickerFen1_gr_high_ref + BickerFen1_gr_lw_ref)
BickerFen1_gr_mod_ref


#2 nights
BickerFen2_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
BickerFen2_grframe<-data.frame(BickerFen2_gr, samp2)
BickerFen2_grframelong <- melt(BickerFen2_grframe,id.vars="samp2")
BickerFen2_grframelong_sum <- ddply(BickerFen2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen2_gr_max <- sum(BickerFen2_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen2_gr_max
BickerFen2_gr_pres <- sum(BickerFen2_grframelong_sum $max > 0)
BickerFen2_gr_pres

#number of sites which would be classified as low
BickerFen2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen2_grframelong_sum$max)
BickerFen2_gr_lw_ref
#number of sites which would be classified as high
BickerFen2_gr_high_ref <- sum( BickerFen2_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen2_gr_high_ref
#number of sites which would be classified as moderate
BickerFen2_gr_mod_ref <- 1000 - (BickerFen2_gr_high_ref + BickerFen2_gr_lw_ref)
BickerFen2_gr_mod_ref


#3 nights
BickerFen3_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
BickerFen3_grframe<-data.frame(BickerFen3_gr, samp2)
BickerFen3_grframelong <- melt(BickerFen3_grframe,id.vars="samp2")
BickerFen3_grframelong_sum <- ddply(BickerFen3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen3_gr_max <- sum(BickerFen3_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen3_gr_max
BickerFen3_gr_pres <- sum(BickerFen3_grframelong_sum $max > 0)
BickerFen3_gr_pres

#number of sites which would be classified as low
BickerFen3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen3_grframelong_sum$max)
BickerFen3_gr_lw_ref
#number of sites which would be classified as high
BickerFen3_gr_high_ref <- sum( BickerFen3_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen3_gr_high_ref
#number of sites which would be classified as moderate
BickerFen3_gr_mod_ref <- 1000 - (BickerFen3_gr_high_ref + BickerFen3_gr_lw_ref)
BickerFen3_gr_mod_ref

#4 nights
BickerFen4_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
BickerFen4_grframe<-data.frame(BickerFen4_gr, samp2)
BickerFen4_grframelong <- melt(BickerFen4_grframe,id.vars="samp2")
BickerFen4_grframelong_sum <- ddply(BickerFen4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen4_gr_max <- sum(BickerFen4_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen4_gr_max
BickerFen4_gr_pres <- sum(BickerFen4_grframelong_sum $max > 0)
BickerFen4_gr_pres

#number of sites which would be classified as low
BickerFen4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen4_grframelong_sum$max)
BickerFen4_gr_lw_ref
#number of sites which would be classified as high
BickerFen4_gr_high_ref <- sum( BickerFen4_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen4_gr_high_ref
#number of sites which would be classified as moderate
BickerFen4_gr_mod_ref <- 1000 - (BickerFen4_gr_high_ref + BickerFen4_gr_lw_ref)
BickerFen4_gr_mod_ref

#5 nights
BickerFen5_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
BickerFen5_grframe<-data.frame(BickerFen5_gr, samp2)
BickerFen5_grframelong <- melt(BickerFen5_grframe,id.vars="samp2")
BickerFen5_grframelong_sum <- ddply(BickerFen5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen5_gr_max <- sum(BickerFen5_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen5_gr_max
BickerFen5_gr_pres <- sum(BickerFen5_grframelong_sum $max > 0)
BickerFen5_gr_pres

#number of sites which would be classified as low
BickerFen5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen5_grframelong_sum$max)
BickerFen5_gr_lw_ref
#number of sites which would be classified as high
BickerFen5_gr_high_ref <- sum( BickerFen5_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen5_gr_high_ref
#number of sites which would be classified as moderate
BickerFen5_gr_mod_ref <- 1000 - (BickerFen5_gr_high_ref + BickerFen5_gr_lw_ref)
BickerFen5_gr_mod_ref

#6 nights
BickerFen6_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
BickerFen6_grframe<-data.frame(BickerFen6_gr, samp2)
BickerFen6_grframelong <- melt(BickerFen6_grframe,id.vars="samp2")
BickerFen6_grframelong_sum <- ddply(BickerFen6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen6_gr_max <- sum(BickerFen6_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen6_gr_max
BickerFen6_gr_pres <- sum(BickerFen6_grframelong_sum $max > 0)
BickerFen6_gr_pres

#number of sites which would be classified as low
BickerFen6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen6_grframelong_sum$max)
BickerFen6_gr_lw_ref
#number of sites which would be classified as high
BickerFen6_gr_high_ref <- sum( BickerFen6_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen6_gr_high_ref
#number of sites which would be classified as moderate
BickerFen6_gr_mod_ref <- 1000 - (BickerFen6_gr_high_ref + BickerFen6_gr_lw_ref)
BickerFen6_gr_mod_ref

#7 nights
BickerFen7_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
BickerFen7_grframe<-data.frame(BickerFen7_gr, samp2)
BickerFen7_grframelong <- melt(BickerFen7_grframe,id.vars="samp2")
BickerFen7_grframelong_sum <- ddply(BickerFen7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen7_gr_max <- sum(BickerFen7_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen7_gr_max
BickerFen7_gr_pres <- sum(BickerFen7_grframelong_sum $max > 0)
BickerFen7_gr_pres

#number of sites which would be classified as low
BickerFen7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen7_grframelong_sum$max)
BickerFen7_gr_lw_ref
#number of sites which would be classified as high
BickerFen7_gr_high_ref <- sum( BickerFen7_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen7_gr_high_ref
#number of sites which would be classified as moderate
BickerFen7_gr_mod_ref <- 1000 - (BickerFen7_gr_high_ref + BickerFen7_gr_lw_ref)
BickerFen7_gr_mod_ref

#8 nights
BickerFen8_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
BickerFen8_grframe<-data.frame(BickerFen8_gr, samp2)
BickerFen8_grframelong <- melt(BickerFen8_grframe,id.vars="samp2")
BickerFen8_grframelong_sum <- ddply(BickerFen8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen8_gr_max <- sum(BickerFen8_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen8_gr_max
BickerFen8_gr_pres <- sum(BickerFen8_grframelong_sum $max > 0)
BickerFen8_gr_pres

#number of sites which would be classified as low
BickerFen8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen8_grframelong_sum$max)
BickerFen8_gr_lw_ref
#number of sites which would be classified as high
BickerFen8_gr_high_ref <- sum( BickerFen8_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen8_gr_high_ref
#number of sites which would be classified as moderate
BickerFen8_gr_mod_ref <- 1000 - (BickerFen8_gr_high_ref + BickerFen8_gr_lw_ref)
BickerFen8_gr_mod_ref

#9 nights
BickerFen9_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
BickerFen9_grframe<-data.frame(BickerFen9_gr, samp2)
BickerFen9_grframelong <- melt(BickerFen9_grframe,id.vars="samp2")
BickerFen9_grframelong_sum <- ddply(BickerFen9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
BickerFen9_gr_max <- sum(BickerFen9_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen9_gr_max
BickerFen9_gr_pres <- sum(BickerFen9_grframelong_sum $max > 0)
BickerFen9_gr_pres

#number of sites which would be classified as low
BickerFen9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen9_grframelong_sum$max)
BickerFen9_gr_lw_ref
#number of sites which would be classified as high
BickerFen9_gr_high_ref <- sum( BickerFen9_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen9_gr_high_ref
#number of sites which would be classified as moderate
BickerFen9_gr_mod_ref <- 1000 - (BickerFen9_gr_high_ref + BickerFen9_gr_lw_ref)
BickerFen9_gr_mod_ref

#10 detectors
BickerFen10_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
BickerFen10_grframe<-data.frame(BickerFen10_gr, samp2)
BickerFen10_grframelong <- melt(BickerFen10_grframe,id.vars="samp2")
BickerFen10_grframelong_sum <- ddply(BickerFen10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen10_gr_max <- sum(BickerFen10_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen10_gr_max
BickerFen10_gr_pres <- sum(BickerFen10_grframelong_sum $max > 0)
BickerFen10_gr_pres

#number of sites which would be classified as low
BickerFen10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen10_grframelong_sum$max)
BickerFen10_gr_lw_ref
#number of sites which would be classified as high
BickerFen10_gr_high_ref <- sum( BickerFen10_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen10_gr_high_ref
#number of sites which would be classified as moderate
BickerFen10_gr_mod_ref <- 1000 - (BickerFen10_gr_high_ref + BickerFen10_gr_lw_ref)
BickerFen10_gr_mod_ref

#11 detectors
BickerFen11_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
BickerFen11_grframe<-data.frame(BickerFen11_gr, samp2)
BickerFen11_grframelong <- melt(BickerFen11_grframe,id.vars="samp2")
BickerFen11_grframelong_sum <- ddply(BickerFen11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen11_gr_max <- sum(BickerFen11_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen11_gr_max
BickerFen11_gr_pres <- sum(BickerFen11_grframelong_sum $max > 0)
BickerFen11_gr_pres

#number of sites which would be classified as low
BickerFen11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen11_grframelong_sum$max)
BickerFen11_gr_lw_ref
#number of sites which would be classified as high
BickerFen11_gr_high_ref <- sum( BickerFen11_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen11_gr_high_ref
#number of sites which would be classified as moderate
BickerFen11_gr_mod_ref <- 1000 - (BickerFen11_gr_high_ref + BickerFen11_gr_lw_ref)
BickerFen11_gr_mod_ref

#12 detectors
BickerFen12_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
BickerFen12_grframe<-data.frame(BickerFen12_gr, samp2)
BickerFen12_grframelong <- melt(BickerFen12_grframe,id.vars="samp2")
BickerFen12_grframelong_sum <- ddply(BickerFen12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen12_gr_max <- sum(BickerFen12_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen12_gr_max
BickerFen12_gr_pres <- sum(BickerFen12_grframelong_sum $max > 0)
BickerFen12_gr_pres

#number of sites which would be classified as low
BickerFen12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen12_grframelong_sum$max)
BickerFen12_gr_lw_ref
#number of sites which would be classified as high
BickerFen12_gr_high_ref <- sum( BickerFen12_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen12_gr_high_ref
#number of sites which would be classified as moderate
BickerFen12_gr_mod_ref <- 1000 - (BickerFen12_gr_high_ref + BickerFen12_gr_lw_ref)
BickerFen12_gr_mod_ref

#13 detectors
BickerFen13_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
BickerFen13_grframe<-data.frame(BickerFen13_gr, samp2)
BickerFen13_grframelong <- melt(BickerFen13_grframe,id.vars="samp2")
BickerFen13_grframelong_sum <- ddply(BickerFen13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen13_gr_max <- sum(BickerFen13_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen13_gr_max
BickerFen13_gr_pres <- sum(BickerFen13_grframelong_sum $max > 0)
BickerFen13_gr_pres

#number of sites which would be classified as low
BickerFen13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen13_grframelong_sum$max)
BickerFen13_gr_lw_ref
#number of sites which would be classified as high
BickerFen13_gr_high_ref <- sum( BickerFen13_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen13_gr_high_ref
#number of sites which would be classified as moderate
BickerFen13_gr_mod_ref <- 1000 - (BickerFen13_gr_high_ref + BickerFen13_gr_lw_ref)
BickerFen13_gr_mod_ref

#14 detectors
BickerFen14_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
BickerFen14_grframe<-data.frame(BickerFen14_gr, samp2)
BickerFen14_grframelong <- melt(BickerFen14_grframe,id.vars="samp2")
BickerFen14_grframelong_sum <- ddply(BickerFen14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen14_gr_max <- sum(BickerFen14_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen14_gr_max
BickerFen14_gr_pres <- sum(BickerFen14_grframelong_sum $max > 0)
BickerFen14_gr_pres

#number of sites which would be classified as low
BickerFen14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen14_grframelong_sum$max)
BickerFen14_gr_lw_ref
#number of sites which would be classified as high
BickerFen14_gr_high_ref <- sum( BickerFen14_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen14_gr_high_ref
#number of sites which would be classified as moderate
BickerFen14_gr_mod_ref <- 1000 - (BickerFen14_gr_high_ref + BickerFen14_gr_lw_ref)
BickerFen14_gr_mod_ref

#15 detectors
BickerFen15_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
BickerFen15_grframe<-data.frame(BickerFen15_gr, samp2)
BickerFen15_grframelong <- melt(BickerFen15_grframe,id.vars="samp2")
BickerFen15_grframelong_sum <- ddply(BickerFen15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen15_gr_max <- sum(BickerFen15_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen15_gr_max
BickerFen15_gr_pres <- sum(BickerFen15_grframelong_sum $max > 0)
BickerFen15_gr_pres

#number of sites which would be classified as low
BickerFen15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen15_grframelong_sum$max)
BickerFen15_gr_lw_ref
#number of sites which would be classified as high
BickerFen15_gr_high_ref <- sum( BickerFen15_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen15_gr_high_ref
#number of sites which would be classified as moderate
BickerFen15_gr_mod_ref <- 1000 - (BickerFen15_gr_high_ref + BickerFen15_gr_lw_ref)
BickerFen15_gr_mod_ref

#16 detectors
BickerFen16_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
BickerFen16_grframe<-data.frame(BickerFen16_gr, samp2)
BickerFen16_grframelong <- melt(BickerFen16_grframe,id.vars="samp2")
BickerFen16_grframelong_sum <- ddply(BickerFen16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen16_gr_max <- sum(BickerFen16_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen16_gr_max
BickerFen16_gr_pres <- sum(BickerFen16_grframelong_sum $max > 0)
BickerFen16_gr_pres

#number of sites which would be classified as low
BickerFen16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen16_grframelong_sum$max)
BickerFen16_gr_lw_ref
#number of sites which would be classified as high
BickerFen16_gr_high_ref <- sum( BickerFen16_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen16_gr_high_ref
#number of sites which would be classified as moderate
BickerFen16_gr_mod_ref <- 1000 - (BickerFen16_gr_high_ref + BickerFen16_gr_lw_ref)
BickerFen16_gr_mod_ref

#17 detectors
BickerFen17_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
BickerFen17_grframe<-data.frame(BickerFen17_gr, samp2)
BickerFen17_grframelong <- melt(BickerFen17_grframe,id.vars="samp2")
BickerFen17_grframelong_sum <- ddply(BickerFen17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen17_gr_max <- sum(BickerFen17_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen17_gr_max
BickerFen17_gr_pres <- sum(BickerFen17_grframelong_sum $max > 0)
BickerFen17_gr_pres

#number of sites which would be classified as low
BickerFen17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen17_grframelong_sum$max)
BickerFen17_gr_lw_ref
#number of sites which would be classified as high
BickerFen17_gr_high_ref <- sum( BickerFen17_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen17_gr_high_ref
#number of sites which would be classified as moderate
BickerFen17_gr_mod_ref <- 1000 - (BickerFen17_gr_high_ref + BickerFen17_gr_lw_ref)
BickerFen17_gr_mod_ref

#18 detectors
BickerFen18_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
BickerFen18_grframe<-data.frame(BickerFen18_gr, samp2)
BickerFen18_grframelong <- melt(BickerFen18_grframe,id.vars="samp2")
BickerFen18_grframelong_sum <- ddply(BickerFen18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen18_gr_max <- sum(BickerFen18_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen18_gr_max
BickerFen18_gr_pres <- sum(BickerFen18_grframelong_sum $max > 0)
BickerFen18_gr_pres

#number of sites which would be classified as low
BickerFen18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen18_grframelong_sum$max)
BickerFen18_gr_lw_ref
#number of sites which would be classified as high
BickerFen18_gr_high_ref <- sum( BickerFen18_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen18_gr_high_ref
#number of sites which would be classified as moderate
BickerFen18_gr_mod_ref <- 1000 - (BickerFen18_gr_high_ref + BickerFen18_gr_lw_ref)
BickerFen18_gr_mod_ref

#19 detectors
BickerFen19_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
BickerFen19_grframe<-data.frame(BickerFen19_gr, samp2)
BickerFen19_grframelong <- melt(BickerFen19_grframe,id.vars="samp2")
BickerFen19_grframelong_sum <- ddply(BickerFen19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen19_gr_max <- sum(BickerFen19_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen19_gr_max
BickerFen19_gr_pres <- sum(BickerFen19_grframelong_sum $max > 0)
BickerFen19_gr_pres

#number of sites which would be classified as low
BickerFen19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen19_grframelong_sum$max)
BickerFen19_gr_lw_ref
#number of sites which would be classified as high
BickerFen19_gr_high_ref <- sum( BickerFen19_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen19_gr_high_ref
#number of sites which would be classified as moderate
BickerFen19_gr_mod_ref <- 1000 - (BickerFen19_gr_high_ref + BickerFen19_gr_lw_ref)
BickerFen19_gr_mod_ref

#20 detectors
BickerFen20_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
BickerFen20_grframe<-data.frame(BickerFen20_gr, samp2)
BickerFen20_grframelong <- melt(BickerFen20_grframe,id.vars="samp2")
BickerFen20_grframelong_sum <- ddply(BickerFen20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen20_gr_max <- sum(BickerFen20_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen20_gr_max
BickerFen20_gr_pres <- sum(BickerFen20_grframelong_sum $max > 0)
BickerFen20_gr_pres

#number of sites which would be classified as low
BickerFen20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen20_grframelong_sum$max)
BickerFen20_gr_lw_ref
#number of sites which would be classified as high
BickerFen20_gr_high_ref <- sum( BickerFen20_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen20_gr_high_ref
#number of sites which would be classified as moderate
BickerFen20_gr_mod_ref <- 1000 - (BickerFen20_gr_high_ref + BickerFen20_gr_lw_ref)
BickerFen20_gr_mod_ref

#21 detectors
BickerFen21_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
BickerFen21_grframe<-data.frame(BickerFen21_gr, samp2)
BickerFen21_grframelong <- melt(BickerFen21_grframe,id.vars="samp2")
BickerFen21_grframelong_sum <- ddply(BickerFen21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen21_gr_max <- sum(BickerFen21_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen21_gr_max
BickerFen21_gr_pres <- sum(BickerFen21_grframelong_sum $max > 0)
BickerFen21_gr_pres

#number of sites which would be classified as low
BickerFen21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen21_grframelong_sum$max)
BickerFen21_gr_lw_ref
#number of sites which would be classified as high
BickerFen21_gr_high_ref <- sum( BickerFen21_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen21_gr_high_ref
#number of sites which would be classified as moderate
BickerFen21_gr_mod_ref <- 1000 - (BickerFen21_gr_high_ref + BickerFen21_gr_lw_ref)
BickerFen21_gr_mod_ref

#22 detectors
BickerFen22_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
BickerFen22_grframe<-data.frame(BickerFen22_gr, samp2)
BickerFen22_grframelong <- melt(BickerFen22_grframe,id.vars="samp2")
BickerFen22_grframelong_sum <- ddply(BickerFen22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen22_gr_max <- sum(BickerFen22_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen22_gr_max
BickerFen22_gr_pres <- sum(BickerFen22_grframelong_sum $max > 0)
BickerFen22_gr_pres

#number of sites which would be classified as low
BickerFen22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen22_grframelong_sum$max)
BickerFen22_gr_lw_ref
#number of sites which would be classified as high
BickerFen22_gr_high_ref <- sum( BickerFen22_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen22_gr_high_ref
#number of sites which would be classified as moderate
BickerFen22_gr_mod_ref <- 1000 - (BickerFen22_gr_high_ref + BickerFen22_gr_lw_ref)
BickerFen22_gr_mod_ref

#23 detectors
BickerFen23_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
BickerFen23_grframe<-data.frame(BickerFen23_gr, samp2)
BickerFen23_grframelong <- melt(BickerFen23_grframe,id.vars="samp2")
BickerFen23_grframelong_sum <- ddply(BickerFen23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen23_gr_max <- sum(BickerFen23_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen23_gr_max
BickerFen23_gr_pres <- sum(BickerFen23_grframelong_sum $max > 0)
BickerFen23_gr_pres

#number of sites which would be classified as low
BickerFen23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen23_grframelong_sum$max)
BickerFen23_gr_lw_ref
#number of sites which would be classified as high
BickerFen23_gr_high_ref <- sum( BickerFen23_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen23_gr_high_ref
#number of sites which would be classified as moderate
BickerFen23_gr_mod_ref <- 1000 - (BickerFen23_gr_high_ref + BickerFen23_gr_lw_ref)
BickerFen23_gr_mod_ref

#24 detectors
BickerFen24_gr<-(replicate(1000, (sample(BickerFenpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
BickerFen24_grframe<-data.frame(BickerFen24_gr, samp2)
BickerFen24_grframelong <- melt(BickerFen24_grframe,id.vars="samp2")
BickerFen24_grframelong_sum <- ddply(BickerFen24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
BickerFen24_gr_max <- sum(BickerFen24_grframelong_sum $max > max20_BickerFenpipgr)
BickerFen24_gr_max
BickerFen24_gr_pres <- sum(BickerFen24_grframelong_sum $max > 0)
BickerFen24_gr_pres

#number of sites which would be classified as low
BickerFen24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= BickerFen24_grframelong_sum$max)
BickerFen24_gr_lw_ref
#number of sites which would be classified as high
BickerFen24_gr_high_ref <- sum( BickerFen24_grframelong_sum$max > allsppgr_ppip_ref_high)
BickerFen24_gr_high_ref
#number of sites which would be classified as moderate
BickerFen24_gr_mod_ref <- 1000 - (BickerFen24_gr_high_ref + BickerFen24_gr_lw_ref)
BickerFen24_gr_mod_ref

Present<-c(BickerFen1_gr_pres,BickerFen2_gr_pres,
           BickerFen3_gr_pres,BickerFen4_gr_pres,
           BickerFen5_gr_pres,BickerFen6_gr_pres,
           BickerFen7_gr_pres,BickerFen8_gr_pres,
           BickerFen9_gr_pres,BickerFen10_gr_pres,
           BickerFen11_gr_pres,BickerFen12_gr_pres,
           BickerFen13_gr_pres,BickerFen14_gr_pres,
           BickerFen15_gr_pres,BickerFen16_gr_pres,
           BickerFen17_gr_pres,BickerFen18_gr_pres,
           BickerFen19_gr_pres,BickerFen20_gr_pres,
           BickerFen21_gr_pres,BickerFen22_gr_pres,
           BickerFen23_gr_pres,BickerFen24_gr_pres)


Maximum<-c(BickerFen1_gr_max,BickerFen2_gr_max,
           BickerFen3_gr_max,BickerFen4_gr_max,
           BickerFen5_gr_max,BickerFen6_gr_max,
           BickerFen7_gr_max,BickerFen8_gr_max,
           BickerFen9_gr_max,BickerFen10_gr_max,
           BickerFen11_gr_max,BickerFen12_gr_max,
           BickerFen13_gr_max,BickerFen14_gr_max,
           BickerFen15_gr_max,BickerFen16_gr_max,
           BickerFen17_gr_max,BickerFen18_gr_max,
           BickerFen19_gr_max,BickerFen20_gr_max,
           BickerFen21_gr_max,BickerFen22_gr_max,
           BickerFen23_gr_max,BickerFen24_gr_max)

Low<-c(BickerFen1_gr_lw_ref, BickerFen2_gr_lw_ref, BickerFen3_gr_lw_ref,
       BickerFen4_gr_lw_ref, BickerFen5_gr_lw_ref, BickerFen6_gr_lw_ref,
       BickerFen7_gr_lw_ref, BickerFen8_gr_lw_ref, BickerFen9_gr_lw_ref,
       BickerFen10_gr_lw_ref, BickerFen11_gr_lw_ref, BickerFen12_gr_lw_ref, 
       BickerFen13_gr_lw_ref, BickerFen14_gr_lw_ref, BickerFen15_gr_lw_ref, 
       BickerFen16_gr_lw_ref, BickerFen17_gr_lw_ref, BickerFen18_gr_lw_ref, 
       BickerFen19_gr_lw_ref, BickerFen20_gr_lw_ref, BickerFen21_gr_lw_ref,
       BickerFen22_gr_lw_ref,BickerFen23_gr_lw_ref,BickerFen24_gr_lw_ref)

Moderate<-c(BickerFen1_gr_mod_ref, BickerFen2_gr_mod_ref, BickerFen3_gr_mod_ref,
            BickerFen4_gr_mod_ref, BickerFen5_gr_mod_ref, BickerFen6_gr_mod_ref,
            BickerFen7_gr_mod_ref, BickerFen8_gr_mod_ref, BickerFen9_gr_mod_ref,
            BickerFen10_gr_mod_ref, BickerFen11_gr_mod_ref, BickerFen12_gr_mod_ref, 
            BickerFen13_gr_mod_ref, BickerFen14_gr_mod_ref, BickerFen15_gr_mod_ref, 
            BickerFen16_gr_mod_ref, BickerFen17_gr_mod_ref, BickerFen18_gr_mod_ref, 
            BickerFen19_gr_mod_ref, BickerFen20_gr_mod_ref, BickerFen21_gr_mod_ref,
            BickerFen22_gr_mod_ref,BickerFen23_gr_mod_ref,BickerFen24_gr_mod_ref)

High<-c(BickerFen1_gr_high_ref, BickerFen2_gr_high_ref, BickerFen3_gr_high_ref,
        BickerFen4_gr_high_ref, BickerFen5_gr_high_ref, BickerFen6_gr_high_ref,
        BickerFen7_gr_high_ref, BickerFen8_gr_high_ref, BickerFen9_gr_high_ref,
        BickerFen10_gr_high_ref, BickerFen11_gr_high_ref, BickerFen12_gr_high_ref, 
        BickerFen13_gr_high_ref, BickerFen14_gr_high_ref, BickerFen15_gr_high_ref, 
        BickerFen16_gr_high_ref, BickerFen17_gr_high_ref, BickerFen18_gr_high_ref, 
        BickerFen19_gr_high_ref, BickerFen20_gr_high_ref, BickerFen21_gr_high_ref,
        BickerFen22_gr_high_ref,BickerFen23_gr_high_ref,BickerFen24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("BickerFengr",24)
Lowsite <- BickerFenlow
Modsite <- BickerFenmod
Highsite <-BickerFenhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



BickerFengr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##Blackhill

Blackhillpipgr<-subset(allspp4gr_ppip, Site=="Blackhill")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Blackhillpipgr<-max(Blackhillpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Blackhillpipgr<- (max_Blackhillpipgr/100)*80

##calculate the site classification (reference range)

Blackhillhigh<- max_Blackhillpipgr > allsppgr_ppip_ref_high

Blackhilllow<- allsppgr_ppip_ref_low > max_Blackhillpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Blackhillpipgr
Blackhillmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Blackhill1_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 1, replace=F))))
Blackhill1_gr_max <- sum(Blackhill1_gr > max20_Blackhillpipgr)
Blackhill1_gr_max
Blackhill1_gr_pres <- sum(Blackhill1_gr > 0)
Blackhill1_gr_pres
#number of sites which would be classified as low
Blackhill1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill1_gr)
Blackhill1_gr_lw_ref
#number of sites which would be classified as high
Blackhill1_gr_high_ref <- sum( Blackhill1_gr > allsppgr_ppip_ref_high)
Blackhill1_gr_high_ref
#number of sites which would be classified as moderate
Blackhill1_gr_mod_ref <- 1000 - (Blackhill1_gr_high_ref + Blackhill1_gr_lw_ref)
Blackhill1_gr_mod_ref


#2 nights
Blackhill2_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Blackhill2_grframe<-data.frame(Blackhill2_gr, samp2)
Blackhill2_grframelong <- melt(Blackhill2_grframe,id.vars="samp2")
Blackhill2_grframelong_sum <- ddply(Blackhill2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill2_gr_max <- sum(Blackhill2_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill2_gr_max
Blackhill2_gr_pres <- sum(Blackhill2_grframelong_sum $max > 0)
Blackhill2_gr_pres

#number of sites which would be classified as low
Blackhill2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill2_grframelong_sum$max)
Blackhill2_gr_lw_ref
#number of sites which would be classified as high
Blackhill2_gr_high_ref <- sum( Blackhill2_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill2_gr_high_ref
#number of sites which would be classified as moderate
Blackhill2_gr_mod_ref <- 1000 - (Blackhill2_gr_high_ref + Blackhill2_gr_lw_ref)
Blackhill2_gr_mod_ref


#3 nights
Blackhill3_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Blackhill3_grframe<-data.frame(Blackhill3_gr, samp2)
Blackhill3_grframelong <- melt(Blackhill3_grframe,id.vars="samp2")
Blackhill3_grframelong_sum <- ddply(Blackhill3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill3_gr_max <- sum(Blackhill3_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill3_gr_max
Blackhill3_gr_pres <- sum(Blackhill3_grframelong_sum $max > 0)
Blackhill3_gr_pres

#number of sites which would be classified as low
Blackhill3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill3_grframelong_sum$max)
Blackhill3_gr_lw_ref
#number of sites which would be classified as high
Blackhill3_gr_high_ref <- sum( Blackhill3_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill3_gr_high_ref
#number of sites which would be classified as moderate
Blackhill3_gr_mod_ref <- 1000 - (Blackhill3_gr_high_ref + Blackhill3_gr_lw_ref)
Blackhill3_gr_mod_ref

#4 nights
Blackhill4_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Blackhill4_grframe<-data.frame(Blackhill4_gr, samp2)
Blackhill4_grframelong <- melt(Blackhill4_grframe,id.vars="samp2")
Blackhill4_grframelong_sum <- ddply(Blackhill4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill4_gr_max <- sum(Blackhill4_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill4_gr_max
Blackhill4_gr_pres <- sum(Blackhill4_grframelong_sum $max > 0)
Blackhill4_gr_pres

#number of sites which would be classified as low
Blackhill4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill4_grframelong_sum$max)
Blackhill4_gr_lw_ref
#number of sites which would be classified as high
Blackhill4_gr_high_ref <- sum( Blackhill4_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill4_gr_high_ref
#number of sites which would be classified as moderate
Blackhill4_gr_mod_ref <- 1000 - (Blackhill4_gr_high_ref + Blackhill4_gr_lw_ref)
Blackhill4_gr_mod_ref

#5 nights
Blackhill5_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Blackhill5_grframe<-data.frame(Blackhill5_gr, samp2)
Blackhill5_grframelong <- melt(Blackhill5_grframe,id.vars="samp2")
Blackhill5_grframelong_sum <- ddply(Blackhill5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill5_gr_max <- sum(Blackhill5_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill5_gr_max
Blackhill5_gr_pres <- sum(Blackhill5_grframelong_sum $max > 0)
Blackhill5_gr_pres

#number of sites which would be classified as low
Blackhill5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill5_grframelong_sum$max)
Blackhill5_gr_lw_ref
#number of sites which would be classified as high
Blackhill5_gr_high_ref <- sum( Blackhill5_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill5_gr_high_ref
#number of sites which would be classified as moderate
Blackhill5_gr_mod_ref <- 1000 - (Blackhill5_gr_high_ref + Blackhill5_gr_lw_ref)
Blackhill5_gr_mod_ref

#6 nights
Blackhill6_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Blackhill6_grframe<-data.frame(Blackhill6_gr, samp2)
Blackhill6_grframelong <- melt(Blackhill6_grframe,id.vars="samp2")
Blackhill6_grframelong_sum <- ddply(Blackhill6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill6_gr_max <- sum(Blackhill6_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill6_gr_max
Blackhill6_gr_pres <- sum(Blackhill6_grframelong_sum $max > 0)
Blackhill6_gr_pres

#number of sites which would be classified as low
Blackhill6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill6_grframelong_sum$max)
Blackhill6_gr_lw_ref
#number of sites which would be classified as high
Blackhill6_gr_high_ref <- sum( Blackhill6_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill6_gr_high_ref
#number of sites which would be classified as moderate
Blackhill6_gr_mod_ref <- 1000 - (Blackhill6_gr_high_ref + Blackhill6_gr_lw_ref)
Blackhill6_gr_mod_ref

#7 nights
Blackhill7_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Blackhill7_grframe<-data.frame(Blackhill7_gr, samp2)
Blackhill7_grframelong <- melt(Blackhill7_grframe,id.vars="samp2")
Blackhill7_grframelong_sum <- ddply(Blackhill7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill7_gr_max <- sum(Blackhill7_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill7_gr_max
Blackhill7_gr_pres <- sum(Blackhill7_grframelong_sum $max > 0)
Blackhill7_gr_pres

#number of sites which would be classified as low
Blackhill7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill7_grframelong_sum$max)
Blackhill7_gr_lw_ref
#number of sites which would be classified as high
Blackhill7_gr_high_ref <- sum( Blackhill7_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill7_gr_high_ref
#number of sites which would be classified as moderate
Blackhill7_gr_mod_ref <- 1000 - (Blackhill7_gr_high_ref + Blackhill7_gr_lw_ref)
Blackhill7_gr_mod_ref

#8 nights
Blackhill8_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Blackhill8_grframe<-data.frame(Blackhill8_gr, samp2)
Blackhill8_grframelong <- melt(Blackhill8_grframe,id.vars="samp2")
Blackhill8_grframelong_sum <- ddply(Blackhill8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill8_gr_max <- sum(Blackhill8_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill8_gr_max
Blackhill8_gr_pres <- sum(Blackhill8_grframelong_sum $max > 0)
Blackhill8_gr_pres

#number of sites which would be classified as low
Blackhill8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill8_grframelong_sum$max)
Blackhill8_gr_lw_ref
#number of sites which would be classified as high
Blackhill8_gr_high_ref <- sum( Blackhill8_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill8_gr_high_ref
#number of sites which would be classified as moderate
Blackhill8_gr_mod_ref <- 1000 - (Blackhill8_gr_high_ref + Blackhill8_gr_lw_ref)
Blackhill8_gr_mod_ref

#9 nights
Blackhill9_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Blackhill9_grframe<-data.frame(Blackhill9_gr, samp2)
Blackhill9_grframelong <- melt(Blackhill9_grframe,id.vars="samp2")
Blackhill9_grframelong_sum <- ddply(Blackhill9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Blackhill9_gr_max <- sum(Blackhill9_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill9_gr_max
Blackhill9_gr_pres <- sum(Blackhill9_grframelong_sum $max > 0)
Blackhill9_gr_pres

#number of sites which would be classified as low
Blackhill9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill9_grframelong_sum$max)
Blackhill9_gr_lw_ref
#number of sites which would be classified as high
Blackhill9_gr_high_ref <- sum( Blackhill9_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill9_gr_high_ref
#number of sites which would be classified as moderate
Blackhill9_gr_mod_ref <- 1000 - (Blackhill9_gr_high_ref + Blackhill9_gr_lw_ref)
Blackhill9_gr_mod_ref

#10 detectors
Blackhill10_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Blackhill10_grframe<-data.frame(Blackhill10_gr, samp2)
Blackhill10_grframelong <- melt(Blackhill10_grframe,id.vars="samp2")
Blackhill10_grframelong_sum <- ddply(Blackhill10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill10_gr_max <- sum(Blackhill10_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill10_gr_max
Blackhill10_gr_pres <- sum(Blackhill10_grframelong_sum $max > 0)
Blackhill10_gr_pres

#number of sites which would be classified as low
Blackhill10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill10_grframelong_sum$max)
Blackhill10_gr_lw_ref
#number of sites which would be classified as high
Blackhill10_gr_high_ref <- sum( Blackhill10_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill10_gr_high_ref
#number of sites which would be classified as moderate
Blackhill10_gr_mod_ref <- 1000 - (Blackhill10_gr_high_ref + Blackhill10_gr_lw_ref)
Blackhill10_gr_mod_ref

#11 detectors
Blackhill11_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Blackhill11_grframe<-data.frame(Blackhill11_gr, samp2)
Blackhill11_grframelong <- melt(Blackhill11_grframe,id.vars="samp2")
Blackhill11_grframelong_sum <- ddply(Blackhill11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill11_gr_max <- sum(Blackhill11_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill11_gr_max
Blackhill11_gr_pres <- sum(Blackhill11_grframelong_sum $max > 0)
Blackhill11_gr_pres

#number of sites which would be classified as low
Blackhill11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill11_grframelong_sum$max)
Blackhill11_gr_lw_ref
#number of sites which would be classified as high
Blackhill11_gr_high_ref <- sum( Blackhill11_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill11_gr_high_ref
#number of sites which would be classified as moderate
Blackhill11_gr_mod_ref <- 1000 - (Blackhill11_gr_high_ref + Blackhill11_gr_lw_ref)
Blackhill11_gr_mod_ref

#12 detectors
Blackhill12_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Blackhill12_grframe<-data.frame(Blackhill12_gr, samp2)
Blackhill12_grframelong <- melt(Blackhill12_grframe,id.vars="samp2")
Blackhill12_grframelong_sum <- ddply(Blackhill12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill12_gr_max <- sum(Blackhill12_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill12_gr_max
Blackhill12_gr_pres <- sum(Blackhill12_grframelong_sum $max > 0)
Blackhill12_gr_pres

#number of sites which would be classified as low
Blackhill12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill12_grframelong_sum$max)
Blackhill12_gr_lw_ref
#number of sites which would be classified as high
Blackhill12_gr_high_ref <- sum( Blackhill12_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill12_gr_high_ref
#number of sites which would be classified as moderate
Blackhill12_gr_mod_ref <- 1000 - (Blackhill12_gr_high_ref + Blackhill12_gr_lw_ref)
Blackhill12_gr_mod_ref

#13 detectors
Blackhill13_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Blackhill13_grframe<-data.frame(Blackhill13_gr, samp2)
Blackhill13_grframelong <- melt(Blackhill13_grframe,id.vars="samp2")
Blackhill13_grframelong_sum <- ddply(Blackhill13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill13_gr_max <- sum(Blackhill13_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill13_gr_max
Blackhill13_gr_pres <- sum(Blackhill13_grframelong_sum $max > 0)
Blackhill13_gr_pres

#number of sites which would be classified as low
Blackhill13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill13_grframelong_sum$max)
Blackhill13_gr_lw_ref
#number of sites which would be classified as high
Blackhill13_gr_high_ref <- sum( Blackhill13_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill13_gr_high_ref
#number of sites which would be classified as moderate
Blackhill13_gr_mod_ref <- 1000 - (Blackhill13_gr_high_ref + Blackhill13_gr_lw_ref)
Blackhill13_gr_mod_ref

#14 detectors
Blackhill14_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Blackhill14_grframe<-data.frame(Blackhill14_gr, samp2)
Blackhill14_grframelong <- melt(Blackhill14_grframe,id.vars="samp2")
Blackhill14_grframelong_sum <- ddply(Blackhill14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill14_gr_max <- sum(Blackhill14_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill14_gr_max
Blackhill14_gr_pres <- sum(Blackhill14_grframelong_sum $max > 0)
Blackhill14_gr_pres

#number of sites which would be classified as low
Blackhill14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill14_grframelong_sum$max)
Blackhill14_gr_lw_ref
#number of sites which would be classified as high
Blackhill14_gr_high_ref <- sum( Blackhill14_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill14_gr_high_ref
#number of sites which would be classified as moderate
Blackhill14_gr_mod_ref <- 1000 - (Blackhill14_gr_high_ref + Blackhill14_gr_lw_ref)
Blackhill14_gr_mod_ref

#15 detectors
Blackhill15_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Blackhill15_grframe<-data.frame(Blackhill15_gr, samp2)
Blackhill15_grframelong <- melt(Blackhill15_grframe,id.vars="samp2")
Blackhill15_grframelong_sum <- ddply(Blackhill15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill15_gr_max <- sum(Blackhill15_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill15_gr_max
Blackhill15_gr_pres <- sum(Blackhill15_grframelong_sum $max > 0)
Blackhill15_gr_pres

#number of sites which would be classified as low
Blackhill15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill15_grframelong_sum$max)
Blackhill15_gr_lw_ref
#number of sites which would be classified as high
Blackhill15_gr_high_ref <- sum( Blackhill15_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill15_gr_high_ref
#number of sites which would be classified as moderate
Blackhill15_gr_mod_ref <- 1000 - (Blackhill15_gr_high_ref + Blackhill15_gr_lw_ref)
Blackhill15_gr_mod_ref

#16 detectors
Blackhill16_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Blackhill16_grframe<-data.frame(Blackhill16_gr, samp2)
Blackhill16_grframelong <- melt(Blackhill16_grframe,id.vars="samp2")
Blackhill16_grframelong_sum <- ddply(Blackhill16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill16_gr_max <- sum(Blackhill16_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill16_gr_max
Blackhill16_gr_pres <- sum(Blackhill16_grframelong_sum $max > 0)
Blackhill16_gr_pres

#number of sites which would be classified as low
Blackhill16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill16_grframelong_sum$max)
Blackhill16_gr_lw_ref
#number of sites which would be classified as high
Blackhill16_gr_high_ref <- sum( Blackhill16_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill16_gr_high_ref
#number of sites which would be classified as moderate
Blackhill16_gr_mod_ref <- 1000 - (Blackhill16_gr_high_ref + Blackhill16_gr_lw_ref)
Blackhill16_gr_mod_ref

#17 detectors
Blackhill17_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Blackhill17_grframe<-data.frame(Blackhill17_gr, samp2)
Blackhill17_grframelong <- melt(Blackhill17_grframe,id.vars="samp2")
Blackhill17_grframelong_sum <- ddply(Blackhill17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill17_gr_max <- sum(Blackhill17_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill17_gr_max
Blackhill17_gr_pres <- sum(Blackhill17_grframelong_sum $max > 0)
Blackhill17_gr_pres

#number of sites which would be classified as low
Blackhill17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill17_grframelong_sum$max)
Blackhill17_gr_lw_ref
#number of sites which would be classified as high
Blackhill17_gr_high_ref <- sum( Blackhill17_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill17_gr_high_ref
#number of sites which would be classified as moderate
Blackhill17_gr_mod_ref <- 1000 - (Blackhill17_gr_high_ref + Blackhill17_gr_lw_ref)
Blackhill17_gr_mod_ref

#18 detectors
Blackhill18_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Blackhill18_grframe<-data.frame(Blackhill18_gr, samp2)
Blackhill18_grframelong <- melt(Blackhill18_grframe,id.vars="samp2")
Blackhill18_grframelong_sum <- ddply(Blackhill18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill18_gr_max <- sum(Blackhill18_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill18_gr_max
Blackhill18_gr_pres <- sum(Blackhill18_grframelong_sum $max > 0)
Blackhill18_gr_pres

#number of sites which would be classified as low
Blackhill18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill18_grframelong_sum$max)
Blackhill18_gr_lw_ref
#number of sites which would be classified as high
Blackhill18_gr_high_ref <- sum( Blackhill18_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill18_gr_high_ref
#number of sites which would be classified as moderate
Blackhill18_gr_mod_ref <- 1000 - (Blackhill18_gr_high_ref + Blackhill18_gr_lw_ref)
Blackhill18_gr_mod_ref

#19 detectors
Blackhill19_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Blackhill19_grframe<-data.frame(Blackhill19_gr, samp2)
Blackhill19_grframelong <- melt(Blackhill19_grframe,id.vars="samp2")
Blackhill19_grframelong_sum <- ddply(Blackhill19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill19_gr_max <- sum(Blackhill19_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill19_gr_max
Blackhill19_gr_pres <- sum(Blackhill19_grframelong_sum $max > 0)
Blackhill19_gr_pres

#number of sites which would be classified as low
Blackhill19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill19_grframelong_sum$max)
Blackhill19_gr_lw_ref
#number of sites which would be classified as high
Blackhill19_gr_high_ref <- sum( Blackhill19_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill19_gr_high_ref
#number of sites which would be classified as moderate
Blackhill19_gr_mod_ref <- 1000 - (Blackhill19_gr_high_ref + Blackhill19_gr_lw_ref)
Blackhill19_gr_mod_ref

#20 detectors
Blackhill20_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Blackhill20_grframe<-data.frame(Blackhill20_gr, samp2)
Blackhill20_grframelong <- melt(Blackhill20_grframe,id.vars="samp2")
Blackhill20_grframelong_sum <- ddply(Blackhill20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill20_gr_max <- sum(Blackhill20_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill20_gr_max
Blackhill20_gr_pres <- sum(Blackhill20_grframelong_sum $max > 0)
Blackhill20_gr_pres

#number of sites which would be classified as low
Blackhill20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill20_grframelong_sum$max)
Blackhill20_gr_lw_ref
#number of sites which would be classified as high
Blackhill20_gr_high_ref <- sum( Blackhill20_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill20_gr_high_ref
#number of sites which would be classified as moderate
Blackhill20_gr_mod_ref <- 1000 - (Blackhill20_gr_high_ref + Blackhill20_gr_lw_ref)
Blackhill20_gr_mod_ref

#21 detectors
Blackhill21_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Blackhill21_grframe<-data.frame(Blackhill21_gr, samp2)
Blackhill21_grframelong <- melt(Blackhill21_grframe,id.vars="samp2")
Blackhill21_grframelong_sum <- ddply(Blackhill21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill21_gr_max <- sum(Blackhill21_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill21_gr_max
Blackhill21_gr_pres <- sum(Blackhill21_grframelong_sum $max > 0)
Blackhill21_gr_pres

#number of sites which would be classified as low
Blackhill21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill21_grframelong_sum$max)
Blackhill21_gr_lw_ref
#number of sites which would be classified as high
Blackhill21_gr_high_ref <- sum( Blackhill21_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill21_gr_high_ref
#number of sites which would be classified as moderate
Blackhill21_gr_mod_ref <- 1000 - (Blackhill21_gr_high_ref + Blackhill21_gr_lw_ref)
Blackhill21_gr_mod_ref

#22 detectors
Blackhill22_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Blackhill22_grframe<-data.frame(Blackhill22_gr, samp2)
Blackhill22_grframelong <- melt(Blackhill22_grframe,id.vars="samp2")
Blackhill22_grframelong_sum <- ddply(Blackhill22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill22_gr_max <- sum(Blackhill22_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill22_gr_max
Blackhill22_gr_pres <- sum(Blackhill22_grframelong_sum $max > 0)
Blackhill22_gr_pres

#number of sites which would be classified as low
Blackhill22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill22_grframelong_sum$max)
Blackhill22_gr_lw_ref
#number of sites which would be classified as high
Blackhill22_gr_high_ref <- sum( Blackhill22_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill22_gr_high_ref
#number of sites which would be classified as moderate
Blackhill22_gr_mod_ref <- 1000 - (Blackhill22_gr_high_ref + Blackhill22_gr_lw_ref)
Blackhill22_gr_mod_ref

#23 detectors
Blackhill23_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Blackhill23_grframe<-data.frame(Blackhill23_gr, samp2)
Blackhill23_grframelong <- melt(Blackhill23_grframe,id.vars="samp2")
Blackhill23_grframelong_sum <- ddply(Blackhill23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill23_gr_max <- sum(Blackhill23_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill23_gr_max
Blackhill23_gr_pres <- sum(Blackhill23_grframelong_sum $max > 0)
Blackhill23_gr_pres

#number of sites which would be classified as low
Blackhill23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill23_grframelong_sum$max)
Blackhill23_gr_lw_ref
#number of sites which would be classified as high
Blackhill23_gr_high_ref <- sum( Blackhill23_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill23_gr_high_ref
#number of sites which would be classified as moderate
Blackhill23_gr_mod_ref <- 1000 - (Blackhill23_gr_high_ref + Blackhill23_gr_lw_ref)
Blackhill23_gr_mod_ref

#24 detectors
Blackhill24_gr<-(replicate(1000, (sample(Blackhillpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Blackhill24_grframe<-data.frame(Blackhill24_gr, samp2)
Blackhill24_grframelong <- melt(Blackhill24_grframe,id.vars="samp2")
Blackhill24_grframelong_sum <- ddply(Blackhill24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Blackhill24_gr_max <- sum(Blackhill24_grframelong_sum $max > max20_Blackhillpipgr)
Blackhill24_gr_max
Blackhill24_gr_pres <- sum(Blackhill24_grframelong_sum $max > 0)
Blackhill24_gr_pres

#number of sites which would be classified as low
Blackhill24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Blackhill24_grframelong_sum$max)
Blackhill24_gr_lw_ref
#number of sites which would be classified as high
Blackhill24_gr_high_ref <- sum( Blackhill24_grframelong_sum$max > allsppgr_ppip_ref_high)
Blackhill24_gr_high_ref
#number of sites which would be classified as moderate
Blackhill24_gr_mod_ref <- 1000 - (Blackhill24_gr_high_ref + Blackhill24_gr_lw_ref)
Blackhill24_gr_mod_ref

Present<-c(Blackhill1_gr_pres,Blackhill2_gr_pres,
           Blackhill3_gr_pres,Blackhill4_gr_pres,
           Blackhill5_gr_pres,Blackhill6_gr_pres,
           Blackhill7_gr_pres,Blackhill8_gr_pres,
           Blackhill9_gr_pres,Blackhill10_gr_pres,
           Blackhill11_gr_pres,Blackhill12_gr_pres,
           Blackhill13_gr_pres,Blackhill14_gr_pres,
           Blackhill15_gr_pres,Blackhill16_gr_pres,
           Blackhill17_gr_pres,Blackhill18_gr_pres,
           Blackhill19_gr_pres,Blackhill20_gr_pres,
           Blackhill21_gr_pres,Blackhill22_gr_pres,
           Blackhill23_gr_pres,Blackhill24_gr_pres)


Maximum<-c(Blackhill1_gr_max,Blackhill2_gr_max,
           Blackhill3_gr_max,Blackhill4_gr_max,
           Blackhill5_gr_max,Blackhill6_gr_max,
           Blackhill7_gr_max,Blackhill8_gr_max,
           Blackhill9_gr_max,Blackhill10_gr_max,
           Blackhill11_gr_max,Blackhill12_gr_max,
           Blackhill13_gr_max,Blackhill14_gr_max,
           Blackhill15_gr_max,Blackhill16_gr_max,
           Blackhill17_gr_max,Blackhill18_gr_max,
           Blackhill19_gr_max,Blackhill20_gr_max,
           Blackhill21_gr_max,Blackhill22_gr_max,
           Blackhill23_gr_max,Blackhill24_gr_max)

Low<-c(Blackhill1_gr_lw_ref, Blackhill2_gr_lw_ref, Blackhill3_gr_lw_ref,
       Blackhill4_gr_lw_ref, Blackhill5_gr_lw_ref, Blackhill6_gr_lw_ref,
       Blackhill7_gr_lw_ref, Blackhill8_gr_lw_ref, Blackhill9_gr_lw_ref,
       Blackhill10_gr_lw_ref, Blackhill11_gr_lw_ref, Blackhill12_gr_lw_ref, 
       Blackhill13_gr_lw_ref, Blackhill14_gr_lw_ref, Blackhill15_gr_lw_ref, 
       Blackhill16_gr_lw_ref, Blackhill17_gr_lw_ref, Blackhill18_gr_lw_ref, 
       Blackhill19_gr_lw_ref, Blackhill20_gr_lw_ref, Blackhill21_gr_lw_ref,
       Blackhill22_gr_lw_ref,Blackhill23_gr_lw_ref,Blackhill24_gr_lw_ref)

Moderate<-c(Blackhill1_gr_mod_ref, Blackhill2_gr_mod_ref, Blackhill3_gr_mod_ref,
            Blackhill4_gr_mod_ref, Blackhill5_gr_mod_ref, Blackhill6_gr_mod_ref,
            Blackhill7_gr_mod_ref, Blackhill8_gr_mod_ref, Blackhill9_gr_mod_ref,
            Blackhill10_gr_mod_ref, Blackhill11_gr_mod_ref, Blackhill12_gr_mod_ref, 
            Blackhill13_gr_mod_ref, Blackhill14_gr_mod_ref, Blackhill15_gr_mod_ref, 
            Blackhill16_gr_mod_ref, Blackhill17_gr_mod_ref, Blackhill18_gr_mod_ref, 
            Blackhill19_gr_mod_ref, Blackhill20_gr_mod_ref, Blackhill21_gr_mod_ref,
            Blackhill22_gr_mod_ref,Blackhill23_gr_mod_ref,Blackhill24_gr_mod_ref)

High<-c(Blackhill1_gr_high_ref, Blackhill2_gr_high_ref, Blackhill3_gr_high_ref,
        Blackhill4_gr_high_ref, Blackhill5_gr_high_ref, Blackhill6_gr_high_ref,
        Blackhill7_gr_high_ref, Blackhill8_gr_high_ref, Blackhill9_gr_high_ref,
        Blackhill10_gr_high_ref, Blackhill11_gr_high_ref, Blackhill12_gr_high_ref, 
        Blackhill13_gr_high_ref, Blackhill14_gr_high_ref, Blackhill15_gr_high_ref, 
        Blackhill16_gr_high_ref, Blackhill17_gr_high_ref, Blackhill18_gr_high_ref, 
        Blackhill19_gr_high_ref, Blackhill20_gr_high_ref, Blackhill21_gr_high_ref,
        Blackhill22_gr_high_ref,Blackhill23_gr_high_ref,Blackhill24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Blackhillgr",24)
Lowsite <- Blackhilllow
Modsite <- Blackhillmod
Highsite <-Blackhillhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Blackhillgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##Bowbeat

Bowbeatpipgr<-subset(allspp4gr_ppip, Site=="Bowbeat")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Bowbeatpipgr<-max(Bowbeatpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Bowbeatpipgr<- (max_Bowbeatpipgr/100)*80

##calculate the site classification (reference range)

Bowbeathigh<- max_Bowbeatpipgr > allsppgr_ppip_ref_high

Bowbeatlow<- allsppgr_ppip_ref_low > max_Bowbeatpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Bowbeatpipgr
Bowbeatmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Bowbeat1_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 1, replace=F))))
Bowbeat1_gr_max <- sum(Bowbeat1_gr > max20_Bowbeatpipgr)
Bowbeat1_gr_max
Bowbeat1_gr_pres <- sum(Bowbeat1_gr > 0)
Bowbeat1_gr_pres
#number of sites which would be classified as low
Bowbeat1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat1_gr)
Bowbeat1_gr_lw_ref
#number of sites which would be classified as high
Bowbeat1_gr_high_ref <- sum( Bowbeat1_gr > allsppgr_ppip_ref_high)
Bowbeat1_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat1_gr_mod_ref <- 1000 - (Bowbeat1_gr_high_ref + Bowbeat1_gr_lw_ref)
Bowbeat1_gr_mod_ref


#2 nights
Bowbeat2_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Bowbeat2_grframe<-data.frame(Bowbeat2_gr, samp2)
Bowbeat2_grframelong <- melt(Bowbeat2_grframe,id.vars="samp2")
Bowbeat2_grframelong_sum <- ddply(Bowbeat2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat2_gr_max <- sum(Bowbeat2_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat2_gr_max
Bowbeat2_gr_pres <- sum(Bowbeat2_grframelong_sum $max > 0)
Bowbeat2_gr_pres

#number of sites which would be classified as low
Bowbeat2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat2_grframelong_sum$max)
Bowbeat2_gr_lw_ref
#number of sites which would be classified as high
Bowbeat2_gr_high_ref <- sum( Bowbeat2_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat2_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat2_gr_mod_ref <- 1000 - (Bowbeat2_gr_high_ref + Bowbeat2_gr_lw_ref)
Bowbeat2_gr_mod_ref


#3 nights
Bowbeat3_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Bowbeat3_grframe<-data.frame(Bowbeat3_gr, samp2)
Bowbeat3_grframelong <- melt(Bowbeat3_grframe,id.vars="samp2")
Bowbeat3_grframelong_sum <- ddply(Bowbeat3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat3_gr_max <- sum(Bowbeat3_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat3_gr_max
Bowbeat3_gr_pres <- sum(Bowbeat3_grframelong_sum $max > 0)
Bowbeat3_gr_pres

#number of sites which would be classified as low
Bowbeat3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat3_grframelong_sum$max)
Bowbeat3_gr_lw_ref
#number of sites which would be classified as high
Bowbeat3_gr_high_ref <- sum( Bowbeat3_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat3_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat3_gr_mod_ref <- 1000 - (Bowbeat3_gr_high_ref + Bowbeat3_gr_lw_ref)
Bowbeat3_gr_mod_ref

#4 nights
Bowbeat4_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Bowbeat4_grframe<-data.frame(Bowbeat4_gr, samp2)
Bowbeat4_grframelong <- melt(Bowbeat4_grframe,id.vars="samp2")
Bowbeat4_grframelong_sum <- ddply(Bowbeat4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat4_gr_max <- sum(Bowbeat4_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat4_gr_max
Bowbeat4_gr_pres <- sum(Bowbeat4_grframelong_sum $max > 0)
Bowbeat4_gr_pres

#number of sites which would be classified as low
Bowbeat4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat4_grframelong_sum$max)
Bowbeat4_gr_lw_ref
#number of sites which would be classified as high
Bowbeat4_gr_high_ref <- sum( Bowbeat4_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat4_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat4_gr_mod_ref <- 1000 - (Bowbeat4_gr_high_ref + Bowbeat4_gr_lw_ref)
Bowbeat4_gr_mod_ref

#5 nights
Bowbeat5_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Bowbeat5_grframe<-data.frame(Bowbeat5_gr, samp2)
Bowbeat5_grframelong <- melt(Bowbeat5_grframe,id.vars="samp2")
Bowbeat5_grframelong_sum <- ddply(Bowbeat5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat5_gr_max <- sum(Bowbeat5_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat5_gr_max
Bowbeat5_gr_pres <- sum(Bowbeat5_grframelong_sum $max > 0)
Bowbeat5_gr_pres

#number of sites which would be classified as low
Bowbeat5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat5_grframelong_sum$max)
Bowbeat5_gr_lw_ref
#number of sites which would be classified as high
Bowbeat5_gr_high_ref <- sum( Bowbeat5_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat5_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat5_gr_mod_ref <- 1000 - (Bowbeat5_gr_high_ref + Bowbeat5_gr_lw_ref)
Bowbeat5_gr_mod_ref

#6 nights
Bowbeat6_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Bowbeat6_grframe<-data.frame(Bowbeat6_gr, samp2)
Bowbeat6_grframelong <- melt(Bowbeat6_grframe,id.vars="samp2")
Bowbeat6_grframelong_sum <- ddply(Bowbeat6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat6_gr_max <- sum(Bowbeat6_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat6_gr_max
Bowbeat6_gr_pres <- sum(Bowbeat6_grframelong_sum $max > 0)
Bowbeat6_gr_pres

#number of sites which would be classified as low
Bowbeat6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat6_grframelong_sum$max)
Bowbeat6_gr_lw_ref
#number of sites which would be classified as high
Bowbeat6_gr_high_ref <- sum( Bowbeat6_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat6_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat6_gr_mod_ref <- 1000 - (Bowbeat6_gr_high_ref + Bowbeat6_gr_lw_ref)
Bowbeat6_gr_mod_ref

#7 nights
Bowbeat7_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Bowbeat7_grframe<-data.frame(Bowbeat7_gr, samp2)
Bowbeat7_grframelong <- melt(Bowbeat7_grframe,id.vars="samp2")
Bowbeat7_grframelong_sum <- ddply(Bowbeat7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat7_gr_max <- sum(Bowbeat7_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat7_gr_max
Bowbeat7_gr_pres <- sum(Bowbeat7_grframelong_sum $max > 0)
Bowbeat7_gr_pres

#number of sites which would be classified as low
Bowbeat7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat7_grframelong_sum$max)
Bowbeat7_gr_lw_ref
#number of sites which would be classified as high
Bowbeat7_gr_high_ref <- sum( Bowbeat7_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat7_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat7_gr_mod_ref <- 1000 - (Bowbeat7_gr_high_ref + Bowbeat7_gr_lw_ref)
Bowbeat7_gr_mod_ref

#8 nights
Bowbeat8_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Bowbeat8_grframe<-data.frame(Bowbeat8_gr, samp2)
Bowbeat8_grframelong <- melt(Bowbeat8_grframe,id.vars="samp2")
Bowbeat8_grframelong_sum <- ddply(Bowbeat8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat8_gr_max <- sum(Bowbeat8_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat8_gr_max
Bowbeat8_gr_pres <- sum(Bowbeat8_grframelong_sum $max > 0)
Bowbeat8_gr_pres

#number of sites which would be classified as low
Bowbeat8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat8_grframelong_sum$max)
Bowbeat8_gr_lw_ref
#number of sites which would be classified as high
Bowbeat8_gr_high_ref <- sum( Bowbeat8_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat8_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat8_gr_mod_ref <- 1000 - (Bowbeat8_gr_high_ref + Bowbeat8_gr_lw_ref)
Bowbeat8_gr_mod_ref

#9 nights
Bowbeat9_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Bowbeat9_grframe<-data.frame(Bowbeat9_gr, samp2)
Bowbeat9_grframelong <- melt(Bowbeat9_grframe,id.vars="samp2")
Bowbeat9_grframelong_sum <- ddply(Bowbeat9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Bowbeat9_gr_max <- sum(Bowbeat9_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat9_gr_max
Bowbeat9_gr_pres <- sum(Bowbeat9_grframelong_sum $max > 0)
Bowbeat9_gr_pres

#number of sites which would be classified as low
Bowbeat9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat9_grframelong_sum$max)
Bowbeat9_gr_lw_ref
#number of sites which would be classified as high
Bowbeat9_gr_high_ref <- sum( Bowbeat9_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat9_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat9_gr_mod_ref <- 1000 - (Bowbeat9_gr_high_ref + Bowbeat9_gr_lw_ref)
Bowbeat9_gr_mod_ref

#10 detectors
Bowbeat10_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Bowbeat10_grframe<-data.frame(Bowbeat10_gr, samp2)
Bowbeat10_grframelong <- melt(Bowbeat10_grframe,id.vars="samp2")
Bowbeat10_grframelong_sum <- ddply(Bowbeat10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat10_gr_max <- sum(Bowbeat10_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat10_gr_max
Bowbeat10_gr_pres <- sum(Bowbeat10_grframelong_sum $max > 0)
Bowbeat10_gr_pres

#number of sites which would be classified as low
Bowbeat10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat10_grframelong_sum$max)
Bowbeat10_gr_lw_ref
#number of sites which would be classified as high
Bowbeat10_gr_high_ref <- sum( Bowbeat10_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat10_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat10_gr_mod_ref <- 1000 - (Bowbeat10_gr_high_ref + Bowbeat10_gr_lw_ref)
Bowbeat10_gr_mod_ref

#11 detectors
Bowbeat11_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Bowbeat11_grframe<-data.frame(Bowbeat11_gr, samp2)
Bowbeat11_grframelong <- melt(Bowbeat11_grframe,id.vars="samp2")
Bowbeat11_grframelong_sum <- ddply(Bowbeat11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat11_gr_max <- sum(Bowbeat11_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat11_gr_max
Bowbeat11_gr_pres <- sum(Bowbeat11_grframelong_sum $max > 0)
Bowbeat11_gr_pres

#number of sites which would be classified as low
Bowbeat11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat11_grframelong_sum$max)
Bowbeat11_gr_lw_ref
#number of sites which would be classified as high
Bowbeat11_gr_high_ref <- sum( Bowbeat11_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat11_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat11_gr_mod_ref <- 1000 - (Bowbeat11_gr_high_ref + Bowbeat11_gr_lw_ref)
Bowbeat11_gr_mod_ref

#12 detectors
Bowbeat12_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Bowbeat12_grframe<-data.frame(Bowbeat12_gr, samp2)
Bowbeat12_grframelong <- melt(Bowbeat12_grframe,id.vars="samp2")
Bowbeat12_grframelong_sum <- ddply(Bowbeat12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat12_gr_max <- sum(Bowbeat12_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat12_gr_max
Bowbeat12_gr_pres <- sum(Bowbeat12_grframelong_sum $max > 0)
Bowbeat12_gr_pres

#number of sites which would be classified as low
Bowbeat12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat12_grframelong_sum$max)
Bowbeat12_gr_lw_ref
#number of sites which would be classified as high
Bowbeat12_gr_high_ref <- sum( Bowbeat12_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat12_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat12_gr_mod_ref <- 1000 - (Bowbeat12_gr_high_ref + Bowbeat12_gr_lw_ref)
Bowbeat12_gr_mod_ref

#13 detectors
Bowbeat13_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Bowbeat13_grframe<-data.frame(Bowbeat13_gr, samp2)
Bowbeat13_grframelong <- melt(Bowbeat13_grframe,id.vars="samp2")
Bowbeat13_grframelong_sum <- ddply(Bowbeat13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat13_gr_max <- sum(Bowbeat13_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat13_gr_max
Bowbeat13_gr_pres <- sum(Bowbeat13_grframelong_sum $max > 0)
Bowbeat13_gr_pres

#number of sites which would be classified as low
Bowbeat13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat13_grframelong_sum$max)
Bowbeat13_gr_lw_ref
#number of sites which would be classified as high
Bowbeat13_gr_high_ref <- sum( Bowbeat13_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat13_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat13_gr_mod_ref <- 1000 - (Bowbeat13_gr_high_ref + Bowbeat13_gr_lw_ref)
Bowbeat13_gr_mod_ref

#14 detectors
Bowbeat14_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Bowbeat14_grframe<-data.frame(Bowbeat14_gr, samp2)
Bowbeat14_grframelong <- melt(Bowbeat14_grframe,id.vars="samp2")
Bowbeat14_grframelong_sum <- ddply(Bowbeat14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat14_gr_max <- sum(Bowbeat14_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat14_gr_max
Bowbeat14_gr_pres <- sum(Bowbeat14_grframelong_sum $max > 0)
Bowbeat14_gr_pres

#number of sites which would be classified as low
Bowbeat14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat14_grframelong_sum$max)
Bowbeat14_gr_lw_ref
#number of sites which would be classified as high
Bowbeat14_gr_high_ref <- sum( Bowbeat14_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat14_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat14_gr_mod_ref <- 1000 - (Bowbeat14_gr_high_ref + Bowbeat14_gr_lw_ref)
Bowbeat14_gr_mod_ref

#15 detectors
Bowbeat15_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Bowbeat15_grframe<-data.frame(Bowbeat15_gr, samp2)
Bowbeat15_grframelong <- melt(Bowbeat15_grframe,id.vars="samp2")
Bowbeat15_grframelong_sum <- ddply(Bowbeat15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat15_gr_max <- sum(Bowbeat15_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat15_gr_max
Bowbeat15_gr_pres <- sum(Bowbeat15_grframelong_sum $max > 0)
Bowbeat15_gr_pres

#number of sites which would be classified as low
Bowbeat15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat15_grframelong_sum$max)
Bowbeat15_gr_lw_ref
#number of sites which would be classified as high
Bowbeat15_gr_high_ref <- sum( Bowbeat15_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat15_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat15_gr_mod_ref <- 1000 - (Bowbeat15_gr_high_ref + Bowbeat15_gr_lw_ref)
Bowbeat15_gr_mod_ref

#16 detectors
Bowbeat16_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Bowbeat16_grframe<-data.frame(Bowbeat16_gr, samp2)
Bowbeat16_grframelong <- melt(Bowbeat16_grframe,id.vars="samp2")
Bowbeat16_grframelong_sum <- ddply(Bowbeat16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat16_gr_max <- sum(Bowbeat16_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat16_gr_max
Bowbeat16_gr_pres <- sum(Bowbeat16_grframelong_sum $max > 0)
Bowbeat16_gr_pres

#number of sites which would be classified as low
Bowbeat16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat16_grframelong_sum$max)
Bowbeat16_gr_lw_ref
#number of sites which would be classified as high
Bowbeat16_gr_high_ref <- sum( Bowbeat16_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat16_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat16_gr_mod_ref <- 1000 - (Bowbeat16_gr_high_ref + Bowbeat16_gr_lw_ref)
Bowbeat16_gr_mod_ref

#17 detectors
Bowbeat17_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Bowbeat17_grframe<-data.frame(Bowbeat17_gr, samp2)
Bowbeat17_grframelong <- melt(Bowbeat17_grframe,id.vars="samp2")
Bowbeat17_grframelong_sum <- ddply(Bowbeat17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat17_gr_max <- sum(Bowbeat17_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat17_gr_max
Bowbeat17_gr_pres <- sum(Bowbeat17_grframelong_sum $max > 0)
Bowbeat17_gr_pres

#number of sites which would be classified as low
Bowbeat17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat17_grframelong_sum$max)
Bowbeat17_gr_lw_ref
#number of sites which would be classified as high
Bowbeat17_gr_high_ref <- sum( Bowbeat17_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat17_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat17_gr_mod_ref <- 1000 - (Bowbeat17_gr_high_ref + Bowbeat17_gr_lw_ref)
Bowbeat17_gr_mod_ref

#18 detectors
Bowbeat18_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Bowbeat18_grframe<-data.frame(Bowbeat18_gr, samp2)
Bowbeat18_grframelong <- melt(Bowbeat18_grframe,id.vars="samp2")
Bowbeat18_grframelong_sum <- ddply(Bowbeat18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat18_gr_max <- sum(Bowbeat18_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat18_gr_max
Bowbeat18_gr_pres <- sum(Bowbeat18_grframelong_sum $max > 0)
Bowbeat18_gr_pres

#number of sites which would be classified as low
Bowbeat18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat18_grframelong_sum$max)
Bowbeat18_gr_lw_ref
#number of sites which would be classified as high
Bowbeat18_gr_high_ref <- sum( Bowbeat18_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat18_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat18_gr_mod_ref <- 1000 - (Bowbeat18_gr_high_ref + Bowbeat18_gr_lw_ref)
Bowbeat18_gr_mod_ref

#19 detectors
Bowbeat19_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Bowbeat19_grframe<-data.frame(Bowbeat19_gr, samp2)
Bowbeat19_grframelong <- melt(Bowbeat19_grframe,id.vars="samp2")
Bowbeat19_grframelong_sum <- ddply(Bowbeat19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat19_gr_max <- sum(Bowbeat19_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat19_gr_max
Bowbeat19_gr_pres <- sum(Bowbeat19_grframelong_sum $max > 0)
Bowbeat19_gr_pres

#number of sites which would be classified as low
Bowbeat19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat19_grframelong_sum$max)
Bowbeat19_gr_lw_ref
#number of sites which would be classified as high
Bowbeat19_gr_high_ref <- sum( Bowbeat19_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat19_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat19_gr_mod_ref <- 1000 - (Bowbeat19_gr_high_ref + Bowbeat19_gr_lw_ref)
Bowbeat19_gr_mod_ref

#20 detectors
Bowbeat20_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Bowbeat20_grframe<-data.frame(Bowbeat20_gr, samp2)
Bowbeat20_grframelong <- melt(Bowbeat20_grframe,id.vars="samp2")
Bowbeat20_grframelong_sum <- ddply(Bowbeat20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat20_gr_max <- sum(Bowbeat20_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat20_gr_max
Bowbeat20_gr_pres <- sum(Bowbeat20_grframelong_sum $max > 0)
Bowbeat20_gr_pres

#number of sites which would be classified as low
Bowbeat20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat20_grframelong_sum$max)
Bowbeat20_gr_lw_ref
#number of sites which would be classified as high
Bowbeat20_gr_high_ref <- sum( Bowbeat20_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat20_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat20_gr_mod_ref <- 1000 - (Bowbeat20_gr_high_ref + Bowbeat20_gr_lw_ref)
Bowbeat20_gr_mod_ref

#21 detectors
Bowbeat21_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Bowbeat21_grframe<-data.frame(Bowbeat21_gr, samp2)
Bowbeat21_grframelong <- melt(Bowbeat21_grframe,id.vars="samp2")
Bowbeat21_grframelong_sum <- ddply(Bowbeat21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat21_gr_max <- sum(Bowbeat21_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat21_gr_max
Bowbeat21_gr_pres <- sum(Bowbeat21_grframelong_sum $max > 0)
Bowbeat21_gr_pres

#number of sites which would be classified as low
Bowbeat21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat21_grframelong_sum$max)
Bowbeat21_gr_lw_ref
#number of sites which would be classified as high
Bowbeat21_gr_high_ref <- sum( Bowbeat21_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat21_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat21_gr_mod_ref <- 1000 - (Bowbeat21_gr_high_ref + Bowbeat21_gr_lw_ref)
Bowbeat21_gr_mod_ref

#22 detectors
Bowbeat22_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Bowbeat22_grframe<-data.frame(Bowbeat22_gr, samp2)
Bowbeat22_grframelong <- melt(Bowbeat22_grframe,id.vars="samp2")
Bowbeat22_grframelong_sum <- ddply(Bowbeat22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat22_gr_max <- sum(Bowbeat22_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat22_gr_max
Bowbeat22_gr_pres <- sum(Bowbeat22_grframelong_sum $max > 0)
Bowbeat22_gr_pres

#number of sites which would be classified as low
Bowbeat22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat22_grframelong_sum$max)
Bowbeat22_gr_lw_ref
#number of sites which would be classified as high
Bowbeat22_gr_high_ref <- sum( Bowbeat22_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat22_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat22_gr_mod_ref <- 1000 - (Bowbeat22_gr_high_ref + Bowbeat22_gr_lw_ref)
Bowbeat22_gr_mod_ref

#23 detectors
Bowbeat23_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Bowbeat23_grframe<-data.frame(Bowbeat23_gr, samp2)
Bowbeat23_grframelong <- melt(Bowbeat23_grframe,id.vars="samp2")
Bowbeat23_grframelong_sum <- ddply(Bowbeat23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat23_gr_max <- sum(Bowbeat23_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat23_gr_max
Bowbeat23_gr_pres <- sum(Bowbeat23_grframelong_sum $max > 0)
Bowbeat23_gr_pres

#number of sites which would be classified as low
Bowbeat23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat23_grframelong_sum$max)
Bowbeat23_gr_lw_ref
#number of sites which would be classified as high
Bowbeat23_gr_high_ref <- sum( Bowbeat23_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat23_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat23_gr_mod_ref <- 1000 - (Bowbeat23_gr_high_ref + Bowbeat23_gr_lw_ref)
Bowbeat23_gr_mod_ref

#24 detectors
Bowbeat24_gr<-(replicate(1000, (sample(Bowbeatpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Bowbeat24_grframe<-data.frame(Bowbeat24_gr, samp2)
Bowbeat24_grframelong <- melt(Bowbeat24_grframe,id.vars="samp2")
Bowbeat24_grframelong_sum <- ddply(Bowbeat24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Bowbeat24_gr_max <- sum(Bowbeat24_grframelong_sum $max > max20_Bowbeatpipgr)
Bowbeat24_gr_max
Bowbeat24_gr_pres <- sum(Bowbeat24_grframelong_sum $max > 0)
Bowbeat24_gr_pres

#number of sites which would be classified as low
Bowbeat24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Bowbeat24_grframelong_sum$max)
Bowbeat24_gr_lw_ref
#number of sites which would be classified as high
Bowbeat24_gr_high_ref <- sum( Bowbeat24_grframelong_sum$max > allsppgr_ppip_ref_high)
Bowbeat24_gr_high_ref
#number of sites which would be classified as moderate
Bowbeat24_gr_mod_ref <- 1000 - (Bowbeat24_gr_high_ref + Bowbeat24_gr_lw_ref)
Bowbeat24_gr_mod_ref

Present<-c(Bowbeat1_gr_pres,Bowbeat2_gr_pres,
           Bowbeat3_gr_pres,Bowbeat4_gr_pres,
           Bowbeat5_gr_pres,Bowbeat6_gr_pres,
           Bowbeat7_gr_pres,Bowbeat8_gr_pres,
           Bowbeat9_gr_pres,Bowbeat10_gr_pres,
           Bowbeat11_gr_pres,Bowbeat12_gr_pres,
           Bowbeat13_gr_pres,Bowbeat14_gr_pres,
           Bowbeat15_gr_pres,Bowbeat16_gr_pres,
           Bowbeat17_gr_pres,Bowbeat18_gr_pres,
           Bowbeat19_gr_pres,Bowbeat20_gr_pres,
           Bowbeat21_gr_pres,Bowbeat22_gr_pres,
           Bowbeat23_gr_pres,Bowbeat24_gr_pres)


Maximum<-c(Bowbeat1_gr_max,Bowbeat2_gr_max,
           Bowbeat3_gr_max,Bowbeat4_gr_max,
           Bowbeat5_gr_max,Bowbeat6_gr_max,
           Bowbeat7_gr_max,Bowbeat8_gr_max,
           Bowbeat9_gr_max,Bowbeat10_gr_max,
           Bowbeat11_gr_max,Bowbeat12_gr_max,
           Bowbeat13_gr_max,Bowbeat14_gr_max,
           Bowbeat15_gr_max,Bowbeat16_gr_max,
           Bowbeat17_gr_max,Bowbeat18_gr_max,
           Bowbeat19_gr_max,Bowbeat20_gr_max,
           Bowbeat21_gr_max,Bowbeat22_gr_max,
           Bowbeat23_gr_max,Bowbeat24_gr_max)

Low<-c(Bowbeat1_gr_lw_ref, Bowbeat2_gr_lw_ref, Bowbeat3_gr_lw_ref,
       Bowbeat4_gr_lw_ref, Bowbeat5_gr_lw_ref, Bowbeat6_gr_lw_ref,
       Bowbeat7_gr_lw_ref, Bowbeat8_gr_lw_ref, Bowbeat9_gr_lw_ref,
       Bowbeat10_gr_lw_ref, Bowbeat11_gr_lw_ref, Bowbeat12_gr_lw_ref, 
       Bowbeat13_gr_lw_ref, Bowbeat14_gr_lw_ref, Bowbeat15_gr_lw_ref, 
       Bowbeat16_gr_lw_ref, Bowbeat17_gr_lw_ref, Bowbeat18_gr_lw_ref, 
       Bowbeat19_gr_lw_ref, Bowbeat20_gr_lw_ref, Bowbeat21_gr_lw_ref,
       Bowbeat22_gr_lw_ref,Bowbeat23_gr_lw_ref,Bowbeat24_gr_lw_ref)

Moderate<-c(Bowbeat1_gr_mod_ref, Bowbeat2_gr_mod_ref, Bowbeat3_gr_mod_ref,
            Bowbeat4_gr_mod_ref, Bowbeat5_gr_mod_ref, Bowbeat6_gr_mod_ref,
            Bowbeat7_gr_mod_ref, Bowbeat8_gr_mod_ref, Bowbeat9_gr_mod_ref,
            Bowbeat10_gr_mod_ref, Bowbeat11_gr_mod_ref, Bowbeat12_gr_mod_ref, 
            Bowbeat13_gr_mod_ref, Bowbeat14_gr_mod_ref, Bowbeat15_gr_mod_ref, 
            Bowbeat16_gr_mod_ref, Bowbeat17_gr_mod_ref, Bowbeat18_gr_mod_ref, 
            Bowbeat19_gr_mod_ref, Bowbeat20_gr_mod_ref, Bowbeat21_gr_mod_ref,
            Bowbeat22_gr_mod_ref,Bowbeat23_gr_mod_ref,Bowbeat24_gr_mod_ref)

High<-c(Bowbeat1_gr_high_ref, Bowbeat2_gr_high_ref, Bowbeat3_gr_high_ref,
        Bowbeat4_gr_high_ref, Bowbeat5_gr_high_ref, Bowbeat6_gr_high_ref,
        Bowbeat7_gr_high_ref, Bowbeat8_gr_high_ref, Bowbeat9_gr_high_ref,
        Bowbeat10_gr_high_ref, Bowbeat11_gr_high_ref, Bowbeat12_gr_high_ref, 
        Bowbeat13_gr_high_ref, Bowbeat14_gr_high_ref, Bowbeat15_gr_high_ref, 
        Bowbeat16_gr_high_ref, Bowbeat17_gr_high_ref, Bowbeat18_gr_high_ref, 
        Bowbeat19_gr_high_ref, Bowbeat20_gr_high_ref, Bowbeat21_gr_high_ref,
        Bowbeat22_gr_high_ref,Bowbeat23_gr_high_ref,Bowbeat24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Bowbeatgr",24)
Lowsite <- Bowbeatlow
Modsite <- Bowbeatmod
Highsite <-Bowbeathigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Bowbeatgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##CarlandCross

CarlandCrosspipgr<-subset(allspp4gr_ppip, Site=="CarlandCross")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_CarlandCrosspipgr<-max(CarlandCrosspipgr$Passes)

#calculate 20% from maximum nightly record

max20_CarlandCrosspipgr<- (max_CarlandCrosspipgr/100)*80

##calculate the site classification (reference range)

CarlandCrosshigh<- max_CarlandCrosspipgr > allsppgr_ppip_ref_high

CarlandCrosslow<- allsppgr_ppip_ref_low > max_CarlandCrosspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_CarlandCrosspipgr
CarlandCrossmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
CarlandCross1_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 1, replace=F))))
CarlandCross1_gr_max <- sum(CarlandCross1_gr > max20_CarlandCrosspipgr)
CarlandCross1_gr_max
CarlandCross1_gr_pres <- sum(CarlandCross1_gr > 0)
CarlandCross1_gr_pres
#number of sites which would be classified as low
CarlandCross1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross1_gr)
CarlandCross1_gr_lw_ref
#number of sites which would be classified as high
CarlandCross1_gr_high_ref <- sum( CarlandCross1_gr > allsppgr_ppip_ref_high)
CarlandCross1_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross1_gr_mod_ref <- 1000 - (CarlandCross1_gr_high_ref + CarlandCross1_gr_lw_ref)
CarlandCross1_gr_mod_ref


#2 nights
CarlandCross2_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
CarlandCross2_grframe<-data.frame(CarlandCross2_gr, samp2)
CarlandCross2_grframelong <- melt(CarlandCross2_grframe,id.vars="samp2")
CarlandCross2_grframelong_sum <- ddply(CarlandCross2_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross2_gr_max <- sum(CarlandCross2_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross2_gr_max
CarlandCross2_gr_pres <- sum(CarlandCross2_grframelong_sum $max > 0)
CarlandCross2_gr_pres

#number of sites which would be classified as low
CarlandCross2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross2_grframelong_sum$max)
CarlandCross2_gr_lw_ref
#number of sites which would be classified as high
CarlandCross2_gr_high_ref <- sum( CarlandCross2_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross2_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross2_gr_mod_ref <- 1000 - (CarlandCross2_gr_high_ref + CarlandCross2_gr_lw_ref)
CarlandCross2_gr_mod_ref


#3 nights
CarlandCross3_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
CarlandCross3_grframe<-data.frame(CarlandCross3_gr, samp2)
CarlandCross3_grframelong <- melt(CarlandCross3_grframe,id.vars="samp2")
CarlandCross3_grframelong_sum <- ddply(CarlandCross3_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross3_gr_max <- sum(CarlandCross3_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross3_gr_max
CarlandCross3_gr_pres <- sum(CarlandCross3_grframelong_sum $max > 0)
CarlandCross3_gr_pres

#number of sites which would be classified as low
CarlandCross3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross3_grframelong_sum$max)
CarlandCross3_gr_lw_ref
#number of sites which would be classified as high
CarlandCross3_gr_high_ref <- sum( CarlandCross3_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross3_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross3_gr_mod_ref <- 1000 - (CarlandCross3_gr_high_ref + CarlandCross3_gr_lw_ref)
CarlandCross3_gr_mod_ref

#4 nights
CarlandCross4_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
CarlandCross4_grframe<-data.frame(CarlandCross4_gr, samp2)
CarlandCross4_grframelong <- melt(CarlandCross4_grframe,id.vars="samp2")
CarlandCross4_grframelong_sum <- ddply(CarlandCross4_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross4_gr_max <- sum(CarlandCross4_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross4_gr_max
CarlandCross4_gr_pres <- sum(CarlandCross4_grframelong_sum $max > 0)
CarlandCross4_gr_pres

#number of sites which would be classified as low
CarlandCross4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross4_grframelong_sum$max)
CarlandCross4_gr_lw_ref
#number of sites which would be classified as high
CarlandCross4_gr_high_ref <- sum( CarlandCross4_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross4_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross4_gr_mod_ref <- 1000 - (CarlandCross4_gr_high_ref + CarlandCross4_gr_lw_ref)
CarlandCross4_gr_mod_ref

#5 nights
CarlandCross5_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
CarlandCross5_grframe<-data.frame(CarlandCross5_gr, samp2)
CarlandCross5_grframelong <- melt(CarlandCross5_grframe,id.vars="samp2")
CarlandCross5_grframelong_sum <- ddply(CarlandCross5_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross5_gr_max <- sum(CarlandCross5_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross5_gr_max
CarlandCross5_gr_pres <- sum(CarlandCross5_grframelong_sum $max > 0)
CarlandCross5_gr_pres

#number of sites which would be classified as low
CarlandCross5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross5_grframelong_sum$max)
CarlandCross5_gr_lw_ref
#number of sites which would be classified as high
CarlandCross5_gr_high_ref <- sum( CarlandCross5_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross5_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross5_gr_mod_ref <- 1000 - (CarlandCross5_gr_high_ref + CarlandCross5_gr_lw_ref)
CarlandCross5_gr_mod_ref

#6 nights
CarlandCross6_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
CarlandCross6_grframe<-data.frame(CarlandCross6_gr, samp2)
CarlandCross6_grframelong <- melt(CarlandCross6_grframe,id.vars="samp2")
CarlandCross6_grframelong_sum <- ddply(CarlandCross6_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross6_gr_max <- sum(CarlandCross6_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross6_gr_max
CarlandCross6_gr_pres <- sum(CarlandCross6_grframelong_sum $max > 0)
CarlandCross6_gr_pres

#number of sites which would be classified as low
CarlandCross6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross6_grframelong_sum$max)
CarlandCross6_gr_lw_ref
#number of sites which would be classified as high
CarlandCross6_gr_high_ref <- sum( CarlandCross6_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross6_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross6_gr_mod_ref <- 1000 - (CarlandCross6_gr_high_ref + CarlandCross6_gr_lw_ref)
CarlandCross6_gr_mod_ref

#7 nights
CarlandCross7_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
CarlandCross7_grframe<-data.frame(CarlandCross7_gr, samp2)
CarlandCross7_grframelong <- melt(CarlandCross7_grframe,id.vars="samp2")
CarlandCross7_grframelong_sum <- ddply(CarlandCross7_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross7_gr_max <- sum(CarlandCross7_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross7_gr_max
CarlandCross7_gr_pres <- sum(CarlandCross7_grframelong_sum $max > 0)
CarlandCross7_gr_pres

#number of sites which would be classified as low
CarlandCross7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross7_grframelong_sum$max)
CarlandCross7_gr_lw_ref
#number of sites which would be classified as high
CarlandCross7_gr_high_ref <- sum( CarlandCross7_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross7_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross7_gr_mod_ref <- 1000 - (CarlandCross7_gr_high_ref + CarlandCross7_gr_lw_ref)
CarlandCross7_gr_mod_ref

#8 nights
CarlandCross8_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
CarlandCross8_grframe<-data.frame(CarlandCross8_gr, samp2)
CarlandCross8_grframelong <- melt(CarlandCross8_grframe,id.vars="samp2")
CarlandCross8_grframelong_sum <- ddply(CarlandCross8_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross8_gr_max <- sum(CarlandCross8_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross8_gr_max
CarlandCross8_gr_pres <- sum(CarlandCross8_grframelong_sum $max > 0)
CarlandCross8_gr_pres

#number of sites which would be classified as low
CarlandCross8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross8_grframelong_sum$max)
CarlandCross8_gr_lw_ref
#number of sites which would be classified as high
CarlandCross8_gr_high_ref <- sum( CarlandCross8_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross8_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross8_gr_mod_ref <- 1000 - (CarlandCross8_gr_high_ref + CarlandCross8_gr_lw_ref)
CarlandCross8_gr_mod_ref

#9 nights
CarlandCross9_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
CarlandCross9_grframe<-data.frame(CarlandCross9_gr, samp2)
CarlandCross9_grframelong <- melt(CarlandCross9_grframe,id.vars="samp2")
CarlandCross9_grframelong_sum <- ddply(CarlandCross9_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
CarlandCross9_gr_max <- sum(CarlandCross9_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross9_gr_max
CarlandCross9_gr_pres <- sum(CarlandCross9_grframelong_sum $max > 0)
CarlandCross9_gr_pres

#number of sites which would be classified as low
CarlandCross9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross9_grframelong_sum$max)
CarlandCross9_gr_lw_ref
#number of sites which would be classified as high
CarlandCross9_gr_high_ref <- sum( CarlandCross9_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross9_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross9_gr_mod_ref <- 1000 - (CarlandCross9_gr_high_ref + CarlandCross9_gr_lw_ref)
CarlandCross9_gr_mod_ref

#10 detectors
CarlandCross10_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
CarlandCross10_grframe<-data.frame(CarlandCross10_gr, samp2)
CarlandCross10_grframelong <- melt(CarlandCross10_grframe,id.vars="samp2")
CarlandCross10_grframelong_sum <- ddply(CarlandCross10_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross10_gr_max <- sum(CarlandCross10_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross10_gr_max
CarlandCross10_gr_pres <- sum(CarlandCross10_grframelong_sum $max > 0)
CarlandCross10_gr_pres

#number of sites which would be classified as low
CarlandCross10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross10_grframelong_sum$max)
CarlandCross10_gr_lw_ref
#number of sites which would be classified as high
CarlandCross10_gr_high_ref <- sum( CarlandCross10_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross10_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross10_gr_mod_ref <- 1000 - (CarlandCross10_gr_high_ref + CarlandCross10_gr_lw_ref)
CarlandCross10_gr_mod_ref

#11 detectors
CarlandCross11_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
CarlandCross11_grframe<-data.frame(CarlandCross11_gr, samp2)
CarlandCross11_grframelong <- melt(CarlandCross11_grframe,id.vars="samp2")
CarlandCross11_grframelong_sum <- ddply(CarlandCross11_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross11_gr_max <- sum(CarlandCross11_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross11_gr_max
CarlandCross11_gr_pres <- sum(CarlandCross11_grframelong_sum $max > 0)
CarlandCross11_gr_pres

#number of sites which would be classified as low
CarlandCross11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross11_grframelong_sum$max)
CarlandCross11_gr_lw_ref
#number of sites which would be classified as high
CarlandCross11_gr_high_ref <- sum( CarlandCross11_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross11_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross11_gr_mod_ref <- 1000 - (CarlandCross11_gr_high_ref + CarlandCross11_gr_lw_ref)
CarlandCross11_gr_mod_ref

#12 detectors
CarlandCross12_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
CarlandCross12_grframe<-data.frame(CarlandCross12_gr, samp2)
CarlandCross12_grframelong <- melt(CarlandCross12_grframe,id.vars="samp2")
CarlandCross12_grframelong_sum <- ddply(CarlandCross12_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross12_gr_max <- sum(CarlandCross12_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross12_gr_max
CarlandCross12_gr_pres <- sum(CarlandCross12_grframelong_sum $max > 0)
CarlandCross12_gr_pres

#number of sites which would be classified as low
CarlandCross12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross12_grframelong_sum$max)
CarlandCross12_gr_lw_ref
#number of sites which would be classified as high
CarlandCross12_gr_high_ref <- sum( CarlandCross12_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross12_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross12_gr_mod_ref <- 1000 - (CarlandCross12_gr_high_ref + CarlandCross12_gr_lw_ref)
CarlandCross12_gr_mod_ref

#13 detectors
CarlandCross13_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
CarlandCross13_grframe<-data.frame(CarlandCross13_gr, samp2)
CarlandCross13_grframelong <- melt(CarlandCross13_grframe,id.vars="samp2")
CarlandCross13_grframelong_sum <- ddply(CarlandCross13_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross13_gr_max <- sum(CarlandCross13_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross13_gr_max
CarlandCross13_gr_pres <- sum(CarlandCross13_grframelong_sum $max > 0)
CarlandCross13_gr_pres

#number of sites which would be classified as low
CarlandCross13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross13_grframelong_sum$max)
CarlandCross13_gr_lw_ref
#number of sites which would be classified as high
CarlandCross13_gr_high_ref <- sum( CarlandCross13_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross13_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross13_gr_mod_ref <- 1000 - (CarlandCross13_gr_high_ref + CarlandCross13_gr_lw_ref)
CarlandCross13_gr_mod_ref

#14 detectors
CarlandCross14_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
CarlandCross14_grframe<-data.frame(CarlandCross14_gr, samp2)
CarlandCross14_grframelong <- melt(CarlandCross14_grframe,id.vars="samp2")
CarlandCross14_grframelong_sum <- ddply(CarlandCross14_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross14_gr_max <- sum(CarlandCross14_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross14_gr_max
CarlandCross14_gr_pres <- sum(CarlandCross14_grframelong_sum $max > 0)
CarlandCross14_gr_pres

#number of sites which would be classified as low
CarlandCross14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross14_grframelong_sum$max)
CarlandCross14_gr_lw_ref
#number of sites which would be classified as high
CarlandCross14_gr_high_ref <- sum( CarlandCross14_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross14_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross14_gr_mod_ref <- 1000 - (CarlandCross14_gr_high_ref + CarlandCross14_gr_lw_ref)
CarlandCross14_gr_mod_ref

#15 detectors
CarlandCross15_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
CarlandCross15_grframe<-data.frame(CarlandCross15_gr, samp2)
CarlandCross15_grframelong <- melt(CarlandCross15_grframe,id.vars="samp2")
CarlandCross15_grframelong_sum <- ddply(CarlandCross15_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross15_gr_max <- sum(CarlandCross15_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross15_gr_max
CarlandCross15_gr_pres <- sum(CarlandCross15_grframelong_sum $max > 0)
CarlandCross15_gr_pres

#number of sites which would be classified as low
CarlandCross15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross15_grframelong_sum$max)
CarlandCross15_gr_lw_ref
#number of sites which would be classified as high
CarlandCross15_gr_high_ref <- sum( CarlandCross15_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross15_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross15_gr_mod_ref <- 1000 - (CarlandCross15_gr_high_ref + CarlandCross15_gr_lw_ref)
CarlandCross15_gr_mod_ref

#16 detectors
CarlandCross16_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
CarlandCross16_grframe<-data.frame(CarlandCross16_gr, samp2)
CarlandCross16_grframelong <- melt(CarlandCross16_grframe,id.vars="samp2")
CarlandCross16_grframelong_sum <- ddply(CarlandCross16_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross16_gr_max <- sum(CarlandCross16_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross16_gr_max
CarlandCross16_gr_pres <- sum(CarlandCross16_grframelong_sum $max > 0)
CarlandCross16_gr_pres

#number of sites which would be classified as low
CarlandCross16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross16_grframelong_sum$max)
CarlandCross16_gr_lw_ref
#number of sites which would be classified as high
CarlandCross16_gr_high_ref <- sum( CarlandCross16_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross16_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross16_gr_mod_ref <- 1000 - (CarlandCross16_gr_high_ref + CarlandCross16_gr_lw_ref)
CarlandCross16_gr_mod_ref

#17 detectors
CarlandCross17_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
CarlandCross17_grframe<-data.frame(CarlandCross17_gr, samp2)
CarlandCross17_grframelong <- melt(CarlandCross17_grframe,id.vars="samp2")
CarlandCross17_grframelong_sum <- ddply(CarlandCross17_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross17_gr_max <- sum(CarlandCross17_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross17_gr_max
CarlandCross17_gr_pres <- sum(CarlandCross17_grframelong_sum $max > 0)
CarlandCross17_gr_pres

#number of sites which would be classified as low
CarlandCross17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross17_grframelong_sum$max)
CarlandCross17_gr_lw_ref
#number of sites which would be classified as high
CarlandCross17_gr_high_ref <- sum( CarlandCross17_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross17_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross17_gr_mod_ref <- 1000 - (CarlandCross17_gr_high_ref + CarlandCross17_gr_lw_ref)
CarlandCross17_gr_mod_ref

#18 detectors
CarlandCross18_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
CarlandCross18_grframe<-data.frame(CarlandCross18_gr, samp2)
CarlandCross18_grframelong <- melt(CarlandCross18_grframe,id.vars="samp2")
CarlandCross18_grframelong_sum <- ddply(CarlandCross18_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross18_gr_max <- sum(CarlandCross18_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross18_gr_max
CarlandCross18_gr_pres <- sum(CarlandCross18_grframelong_sum $max > 0)
CarlandCross18_gr_pres

#number of sites which would be classified as low
CarlandCross18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross18_grframelong_sum$max)
CarlandCross18_gr_lw_ref
#number of sites which would be classified as high
CarlandCross18_gr_high_ref <- sum( CarlandCross18_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross18_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross18_gr_mod_ref <- 1000 - (CarlandCross18_gr_high_ref + CarlandCross18_gr_lw_ref)
CarlandCross18_gr_mod_ref

#19 detectors
CarlandCross19_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
CarlandCross19_grframe<-data.frame(CarlandCross19_gr, samp2)
CarlandCross19_grframelong <- melt(CarlandCross19_grframe,id.vars="samp2")
CarlandCross19_grframelong_sum <- ddply(CarlandCross19_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross19_gr_max <- sum(CarlandCross19_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross19_gr_max
CarlandCross19_gr_pres <- sum(CarlandCross19_grframelong_sum $max > 0)
CarlandCross19_gr_pres

#number of sites which would be classified as low
CarlandCross19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross19_grframelong_sum$max)
CarlandCross19_gr_lw_ref
#number of sites which would be classified as high
CarlandCross19_gr_high_ref <- sum( CarlandCross19_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross19_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross19_gr_mod_ref <- 1000 - (CarlandCross19_gr_high_ref + CarlandCross19_gr_lw_ref)
CarlandCross19_gr_mod_ref

#20 detectors
CarlandCross20_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
CarlandCross20_grframe<-data.frame(CarlandCross20_gr, samp2)
CarlandCross20_grframelong <- melt(CarlandCross20_grframe,id.vars="samp2")
CarlandCross20_grframelong_sum <- ddply(CarlandCross20_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross20_gr_max <- sum(CarlandCross20_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross20_gr_max
CarlandCross20_gr_pres <- sum(CarlandCross20_grframelong_sum $max > 0)
CarlandCross20_gr_pres

#number of sites which would be classified as low
CarlandCross20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross20_grframelong_sum$max)
CarlandCross20_gr_lw_ref
#number of sites which would be classified as high
CarlandCross20_gr_high_ref <- sum( CarlandCross20_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross20_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross20_gr_mod_ref <- 1000 - (CarlandCross20_gr_high_ref + CarlandCross20_gr_lw_ref)
CarlandCross20_gr_mod_ref

#21 detectors
CarlandCross21_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
CarlandCross21_grframe<-data.frame(CarlandCross21_gr, samp2)
CarlandCross21_grframelong <- melt(CarlandCross21_grframe,id.vars="samp2")
CarlandCross21_grframelong_sum <- ddply(CarlandCross21_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross21_gr_max <- sum(CarlandCross21_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross21_gr_max
CarlandCross21_gr_pres <- sum(CarlandCross21_grframelong_sum $max > 0)
CarlandCross21_gr_pres

#number of sites which would be classified as low
CarlandCross21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross21_grframelong_sum$max)
CarlandCross21_gr_lw_ref
#number of sites which would be classified as high
CarlandCross21_gr_high_ref <- sum( CarlandCross21_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross21_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross21_gr_mod_ref <- 1000 - (CarlandCross21_gr_high_ref + CarlandCross21_gr_lw_ref)
CarlandCross21_gr_mod_ref

#22 detectors
CarlandCross22_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
CarlandCross22_grframe<-data.frame(CarlandCross22_gr, samp2)
CarlandCross22_grframelong <- melt(CarlandCross22_grframe,id.vars="samp2")
CarlandCross22_grframelong_sum <- ddply(CarlandCross22_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross22_gr_max <- sum(CarlandCross22_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross22_gr_max
CarlandCross22_gr_pres <- sum(CarlandCross22_grframelong_sum $max > 0)
CarlandCross22_gr_pres

#number of sites which would be classified as low
CarlandCross22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross22_grframelong_sum$max)
CarlandCross22_gr_lw_ref
#number of sites which would be classified as high
CarlandCross22_gr_high_ref <- sum( CarlandCross22_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross22_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross22_gr_mod_ref <- 1000 - (CarlandCross22_gr_high_ref + CarlandCross22_gr_lw_ref)
CarlandCross22_gr_mod_ref

#23 detectors
CarlandCross23_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
CarlandCross23_grframe<-data.frame(CarlandCross23_gr, samp2)
CarlandCross23_grframelong <- melt(CarlandCross23_grframe,id.vars="samp2")
CarlandCross23_grframelong_sum <- ddply(CarlandCross23_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross23_gr_max <- sum(CarlandCross23_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross23_gr_max
CarlandCross23_gr_pres <- sum(CarlandCross23_grframelong_sum $max > 0)
CarlandCross23_gr_pres

#number of sites which would be classified as low
CarlandCross23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross23_grframelong_sum$max)
CarlandCross23_gr_lw_ref
#number of sites which would be classified as high
CarlandCross23_gr_high_ref <- sum( CarlandCross23_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross23_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross23_gr_mod_ref <- 1000 - (CarlandCross23_gr_high_ref + CarlandCross23_gr_lw_ref)
CarlandCross23_gr_mod_ref

#24 detectors
CarlandCross24_gr<-(replicate(1000, (sample(CarlandCrosspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
CarlandCross24_grframe<-data.frame(CarlandCross24_gr, samp2)
CarlandCross24_grframelong <- melt(CarlandCross24_grframe,id.vars="samp2")
CarlandCross24_grframelong_sum <- ddply(CarlandCross24_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
CarlandCross24_gr_max <- sum(CarlandCross24_grframelong_sum $max > max20_CarlandCrosspipgr)
CarlandCross24_gr_max
CarlandCross24_gr_pres <- sum(CarlandCross24_grframelong_sum $max > 0)
CarlandCross24_gr_pres

#number of sites which would be classified as low
CarlandCross24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarlandCross24_grframelong_sum$max)
CarlandCross24_gr_lw_ref
#number of sites which would be classified as high
CarlandCross24_gr_high_ref <- sum( CarlandCross24_grframelong_sum$max > allsppgr_ppip_ref_high)
CarlandCross24_gr_high_ref
#number of sites which would be classified as moderate
CarlandCross24_gr_mod_ref <- 1000 - (CarlandCross24_gr_high_ref + CarlandCross24_gr_lw_ref)
CarlandCross24_gr_mod_ref

Present<-c(CarlandCross1_gr_pres,CarlandCross2_gr_pres,
           CarlandCross3_gr_pres,CarlandCross4_gr_pres,
           CarlandCross5_gr_pres,CarlandCross6_gr_pres,
           CarlandCross7_gr_pres,CarlandCross8_gr_pres,
           CarlandCross9_gr_pres,CarlandCross10_gr_pres,
           CarlandCross11_gr_pres,CarlandCross12_gr_pres,
           CarlandCross13_gr_pres,CarlandCross14_gr_pres,
           CarlandCross15_gr_pres,CarlandCross16_gr_pres,
           CarlandCross17_gr_pres,CarlandCross18_gr_pres,
           CarlandCross19_gr_pres,CarlandCross20_gr_pres,
           CarlandCross21_gr_pres,CarlandCross22_gr_pres,
           CarlandCross23_gr_pres,CarlandCross24_gr_pres)


Maximum<-c(CarlandCross1_gr_max,CarlandCross2_gr_max,
           CarlandCross3_gr_max,CarlandCross4_gr_max,
           CarlandCross5_gr_max,CarlandCross6_gr_max,
           CarlandCross7_gr_max,CarlandCross8_gr_max,
           CarlandCross9_gr_max,CarlandCross10_gr_max,
           CarlandCross11_gr_max,CarlandCross12_gr_max,
           CarlandCross13_gr_max,CarlandCross14_gr_max,
           CarlandCross15_gr_max,CarlandCross16_gr_max,
           CarlandCross17_gr_max,CarlandCross18_gr_max,
           CarlandCross19_gr_max,CarlandCross20_gr_max,
           CarlandCross21_gr_max,CarlandCross22_gr_max,
           CarlandCross23_gr_max,CarlandCross24_gr_max)

Low<-c(CarlandCross1_gr_lw_ref, CarlandCross2_gr_lw_ref, CarlandCross3_gr_lw_ref,
       CarlandCross4_gr_lw_ref, CarlandCross5_gr_lw_ref, CarlandCross6_gr_lw_ref,
       CarlandCross7_gr_lw_ref, CarlandCross8_gr_lw_ref, CarlandCross9_gr_lw_ref,
       CarlandCross10_gr_lw_ref, CarlandCross11_gr_lw_ref, CarlandCross12_gr_lw_ref, 
       CarlandCross13_gr_lw_ref, CarlandCross14_gr_lw_ref, CarlandCross15_gr_lw_ref, 
       CarlandCross16_gr_lw_ref, CarlandCross17_gr_lw_ref, CarlandCross18_gr_lw_ref, 
       CarlandCross19_gr_lw_ref, CarlandCross20_gr_lw_ref, CarlandCross21_gr_lw_ref,
       CarlandCross22_gr_lw_ref,CarlandCross23_gr_lw_ref,CarlandCross24_gr_lw_ref)

Moderate<-c(CarlandCross1_gr_mod_ref, CarlandCross2_gr_mod_ref, CarlandCross3_gr_mod_ref,
            CarlandCross4_gr_mod_ref, CarlandCross5_gr_mod_ref, CarlandCross6_gr_mod_ref,
            CarlandCross7_gr_mod_ref, CarlandCross8_gr_mod_ref, CarlandCross9_gr_mod_ref,
            CarlandCross10_gr_mod_ref, CarlandCross11_gr_mod_ref, CarlandCross12_gr_mod_ref, 
            CarlandCross13_gr_mod_ref, CarlandCross14_gr_mod_ref, CarlandCross15_gr_mod_ref, 
            CarlandCross16_gr_mod_ref, CarlandCross17_gr_mod_ref, CarlandCross18_gr_mod_ref, 
            CarlandCross19_gr_mod_ref, CarlandCross20_gr_mod_ref, CarlandCross21_gr_mod_ref,
            CarlandCross22_gr_mod_ref,CarlandCross23_gr_mod_ref,CarlandCross24_gr_mod_ref)

High<-c(CarlandCross1_gr_high_ref, CarlandCross2_gr_high_ref, CarlandCross3_gr_high_ref,
        CarlandCross4_gr_high_ref, CarlandCross5_gr_high_ref, CarlandCross6_gr_high_ref,
        CarlandCross7_gr_high_ref, CarlandCross8_gr_high_ref, CarlandCross9_gr_high_ref,
        CarlandCross10_gr_high_ref, CarlandCross11_gr_high_ref, CarlandCross12_gr_high_ref, 
        CarlandCross13_gr_high_ref, CarlandCross14_gr_high_ref, CarlandCross15_gr_high_ref, 
        CarlandCross16_gr_high_ref, CarlandCross17_gr_high_ref, CarlandCross18_gr_high_ref, 
        CarlandCross19_gr_high_ref, CarlandCross20_gr_high_ref, CarlandCross21_gr_high_ref,
        CarlandCross22_gr_high_ref,CarlandCross23_gr_high_ref,CarlandCross24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("CarlandCrossgr",24)
Lowsite <- CarlandCrosslow
Modsite <- CarlandCrossmod
Highsite <-CarlandCrosshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



CarlandCrossgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                   Site, Low, Moderate, High,
                                   Lowsite, Modsite, Highsite)

##CarnoII

CarnoIIpipgr<-subset(allspp4gr_ppip, Site=="CarnoII")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_CarnoIIpipgr<-max(CarnoIIpipgr$Passes)

#calculate 20% from maximum nightly record

max20_CarnoIIpipgr<- (max_CarnoIIpipgr/100)*80

##calculate the site classification (reference range)

CarnoIIhigh<- max_CarnoIIpipgr > allsppgr_ppip_ref_high

CarnoIIlow<- allsppgr_ppip_ref_low > max_CarnoIIpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_CarnoIIpipgr
CarnoIImod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
CarnoII1_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 1, replace=F))))
CarnoII1_gr_max <- sum(CarnoII1_gr > max20_CarnoIIpipgr)
CarnoII1_gr_max
CarnoII1_gr_pres <- sum(CarnoII1_gr > 0)
CarnoII1_gr_pres
#number of sites which would be classified as low
CarnoII1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII1_gr)
CarnoII1_gr_lw_ref
#number of sites which would be classified as high
CarnoII1_gr_high_ref <- sum( CarnoII1_gr > allsppgr_ppip_ref_high)
CarnoII1_gr_high_ref
#number of sites which would be classified as moderate
CarnoII1_gr_mod_ref <- 1000 - (CarnoII1_gr_high_ref + CarnoII1_gr_lw_ref)
CarnoII1_gr_mod_ref


#2 nights
CarnoII2_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
CarnoII2_grframe<-data.frame(CarnoII2_gr, samp2)
CarnoII2_grframelong <- melt(CarnoII2_grframe,id.vars="samp2")
CarnoII2_grframelong_sum <- ddply(CarnoII2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII2_gr_max <- sum(CarnoII2_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII2_gr_max
CarnoII2_gr_pres <- sum(CarnoII2_grframelong_sum $max > 0)
CarnoII2_gr_pres

#number of sites which would be classified as low
CarnoII2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII2_grframelong_sum$max)
CarnoII2_gr_lw_ref
#number of sites which would be classified as high
CarnoII2_gr_high_ref <- sum( CarnoII2_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII2_gr_high_ref
#number of sites which would be classified as moderate
CarnoII2_gr_mod_ref <- 1000 - (CarnoII2_gr_high_ref + CarnoII2_gr_lw_ref)
CarnoII2_gr_mod_ref


#3 nights
CarnoII3_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
CarnoII3_grframe<-data.frame(CarnoII3_gr, samp2)
CarnoII3_grframelong <- melt(CarnoII3_grframe,id.vars="samp2")
CarnoII3_grframelong_sum <- ddply(CarnoII3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII3_gr_max <- sum(CarnoII3_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII3_gr_max
CarnoII3_gr_pres <- sum(CarnoII3_grframelong_sum $max > 0)
CarnoII3_gr_pres

#number of sites which would be classified as low
CarnoII3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII3_grframelong_sum$max)
CarnoII3_gr_lw_ref
#number of sites which would be classified as high
CarnoII3_gr_high_ref <- sum( CarnoII3_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII3_gr_high_ref
#number of sites which would be classified as moderate
CarnoII3_gr_mod_ref <- 1000 - (CarnoII3_gr_high_ref + CarnoII3_gr_lw_ref)
CarnoII3_gr_mod_ref

#4 nights
CarnoII4_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
CarnoII4_grframe<-data.frame(CarnoII4_gr, samp2)
CarnoII4_grframelong <- melt(CarnoII4_grframe,id.vars="samp2")
CarnoII4_grframelong_sum <- ddply(CarnoII4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII4_gr_max <- sum(CarnoII4_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII4_gr_max
CarnoII4_gr_pres <- sum(CarnoII4_grframelong_sum $max > 0)
CarnoII4_gr_pres

#number of sites which would be classified as low
CarnoII4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII4_grframelong_sum$max)
CarnoII4_gr_lw_ref
#number of sites which would be classified as high
CarnoII4_gr_high_ref <- sum( CarnoII4_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII4_gr_high_ref
#number of sites which would be classified as moderate
CarnoII4_gr_mod_ref <- 1000 - (CarnoII4_gr_high_ref + CarnoII4_gr_lw_ref)
CarnoII4_gr_mod_ref

#5 nights
CarnoII5_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
CarnoII5_grframe<-data.frame(CarnoII5_gr, samp2)
CarnoII5_grframelong <- melt(CarnoII5_grframe,id.vars="samp2")
CarnoII5_grframelong_sum <- ddply(CarnoII5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII5_gr_max <- sum(CarnoII5_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII5_gr_max
CarnoII5_gr_pres <- sum(CarnoII5_grframelong_sum $max > 0)
CarnoII5_gr_pres

#number of sites which would be classified as low
CarnoII5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII5_grframelong_sum$max)
CarnoII5_gr_lw_ref
#number of sites which would be classified as high
CarnoII5_gr_high_ref <- sum( CarnoII5_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII5_gr_high_ref
#number of sites which would be classified as moderate
CarnoII5_gr_mod_ref <- 1000 - (CarnoII5_gr_high_ref + CarnoII5_gr_lw_ref)
CarnoII5_gr_mod_ref

#6 nights
CarnoII6_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
CarnoII6_grframe<-data.frame(CarnoII6_gr, samp2)
CarnoII6_grframelong <- melt(CarnoII6_grframe,id.vars="samp2")
CarnoII6_grframelong_sum <- ddply(CarnoII6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII6_gr_max <- sum(CarnoII6_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII6_gr_max
CarnoII6_gr_pres <- sum(CarnoII6_grframelong_sum $max > 0)
CarnoII6_gr_pres

#number of sites which would be classified as low
CarnoII6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII6_grframelong_sum$max)
CarnoII6_gr_lw_ref
#number of sites which would be classified as high
CarnoII6_gr_high_ref <- sum( CarnoII6_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII6_gr_high_ref
#number of sites which would be classified as moderate
CarnoII6_gr_mod_ref <- 1000 - (CarnoII6_gr_high_ref + CarnoII6_gr_lw_ref)
CarnoII6_gr_mod_ref

#7 nights
CarnoII7_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
CarnoII7_grframe<-data.frame(CarnoII7_gr, samp2)
CarnoII7_grframelong <- melt(CarnoII7_grframe,id.vars="samp2")
CarnoII7_grframelong_sum <- ddply(CarnoII7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII7_gr_max <- sum(CarnoII7_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII7_gr_max
CarnoII7_gr_pres <- sum(CarnoII7_grframelong_sum $max > 0)
CarnoII7_gr_pres

#number of sites which would be classified as low
CarnoII7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII7_grframelong_sum$max)
CarnoII7_gr_lw_ref
#number of sites which would be classified as high
CarnoII7_gr_high_ref <- sum( CarnoII7_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII7_gr_high_ref
#number of sites which would be classified as moderate
CarnoII7_gr_mod_ref <- 1000 - (CarnoII7_gr_high_ref + CarnoII7_gr_lw_ref)
CarnoII7_gr_mod_ref

#8 nights
CarnoII8_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
CarnoII8_grframe<-data.frame(CarnoII8_gr, samp2)
CarnoII8_grframelong <- melt(CarnoII8_grframe,id.vars="samp2")
CarnoII8_grframelong_sum <- ddply(CarnoII8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII8_gr_max <- sum(CarnoII8_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII8_gr_max
CarnoII8_gr_pres <- sum(CarnoII8_grframelong_sum $max > 0)
CarnoII8_gr_pres

#number of sites which would be classified as low
CarnoII8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII8_grframelong_sum$max)
CarnoII8_gr_lw_ref
#number of sites which would be classified as high
CarnoII8_gr_high_ref <- sum( CarnoII8_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII8_gr_high_ref
#number of sites which would be classified as moderate
CarnoII8_gr_mod_ref <- 1000 - (CarnoII8_gr_high_ref + CarnoII8_gr_lw_ref)
CarnoII8_gr_mod_ref

#9 nights
CarnoII9_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
CarnoII9_grframe<-data.frame(CarnoII9_gr, samp2)
CarnoII9_grframelong <- melt(CarnoII9_grframe,id.vars="samp2")
CarnoII9_grframelong_sum <- ddply(CarnoII9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
CarnoII9_gr_max <- sum(CarnoII9_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII9_gr_max
CarnoII9_gr_pres <- sum(CarnoII9_grframelong_sum $max > 0)
CarnoII9_gr_pres

#number of sites which would be classified as low
CarnoII9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII9_grframelong_sum$max)
CarnoII9_gr_lw_ref
#number of sites which would be classified as high
CarnoII9_gr_high_ref <- sum( CarnoII9_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII9_gr_high_ref
#number of sites which would be classified as moderate
CarnoII9_gr_mod_ref <- 1000 - (CarnoII9_gr_high_ref + CarnoII9_gr_lw_ref)
CarnoII9_gr_mod_ref

#10 detectors
CarnoII10_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
CarnoII10_grframe<-data.frame(CarnoII10_gr, samp2)
CarnoII10_grframelong <- melt(CarnoII10_grframe,id.vars="samp2")
CarnoII10_grframelong_sum <- ddply(CarnoII10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII10_gr_max <- sum(CarnoII10_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII10_gr_max
CarnoII10_gr_pres <- sum(CarnoII10_grframelong_sum $max > 0)
CarnoII10_gr_pres

#number of sites which would be classified as low
CarnoII10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII10_grframelong_sum$max)
CarnoII10_gr_lw_ref
#number of sites which would be classified as high
CarnoII10_gr_high_ref <- sum( CarnoII10_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII10_gr_high_ref
#number of sites which would be classified as moderate
CarnoII10_gr_mod_ref <- 1000 - (CarnoII10_gr_high_ref + CarnoII10_gr_lw_ref)
CarnoII10_gr_mod_ref

#11 detectors
CarnoII11_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
CarnoII11_grframe<-data.frame(CarnoII11_gr, samp2)
CarnoII11_grframelong <- melt(CarnoII11_grframe,id.vars="samp2")
CarnoII11_grframelong_sum <- ddply(CarnoII11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII11_gr_max <- sum(CarnoII11_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII11_gr_max
CarnoII11_gr_pres <- sum(CarnoII11_grframelong_sum $max > 0)
CarnoII11_gr_pres

#number of sites which would be classified as low
CarnoII11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII11_grframelong_sum$max)
CarnoII11_gr_lw_ref
#number of sites which would be classified as high
CarnoII11_gr_high_ref <- sum( CarnoII11_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII11_gr_high_ref
#number of sites which would be classified as moderate
CarnoII11_gr_mod_ref <- 1000 - (CarnoII11_gr_high_ref + CarnoII11_gr_lw_ref)
CarnoII11_gr_mod_ref

#12 detectors
CarnoII12_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
CarnoII12_grframe<-data.frame(CarnoII12_gr, samp2)
CarnoII12_grframelong <- melt(CarnoII12_grframe,id.vars="samp2")
CarnoII12_grframelong_sum <- ddply(CarnoII12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII12_gr_max <- sum(CarnoII12_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII12_gr_max
CarnoII12_gr_pres <- sum(CarnoII12_grframelong_sum $max > 0)
CarnoII12_gr_pres

#number of sites which would be classified as low
CarnoII12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII12_grframelong_sum$max)
CarnoII12_gr_lw_ref
#number of sites which would be classified as high
CarnoII12_gr_high_ref <- sum( CarnoII12_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII12_gr_high_ref
#number of sites which would be classified as moderate
CarnoII12_gr_mod_ref <- 1000 - (CarnoII12_gr_high_ref + CarnoII12_gr_lw_ref)
CarnoII12_gr_mod_ref

#13 detectors
CarnoII13_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
CarnoII13_grframe<-data.frame(CarnoII13_gr, samp2)
CarnoII13_grframelong <- melt(CarnoII13_grframe,id.vars="samp2")
CarnoII13_grframelong_sum <- ddply(CarnoII13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII13_gr_max <- sum(CarnoII13_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII13_gr_max
CarnoII13_gr_pres <- sum(CarnoII13_grframelong_sum $max > 0)
CarnoII13_gr_pres

#number of sites which would be classified as low
CarnoII13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII13_grframelong_sum$max)
CarnoII13_gr_lw_ref
#number of sites which would be classified as high
CarnoII13_gr_high_ref <- sum( CarnoII13_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII13_gr_high_ref
#number of sites which would be classified as moderate
CarnoII13_gr_mod_ref <- 1000 - (CarnoII13_gr_high_ref + CarnoII13_gr_lw_ref)
CarnoII13_gr_mod_ref

#14 detectors
CarnoII14_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
CarnoII14_grframe<-data.frame(CarnoII14_gr, samp2)
CarnoII14_grframelong <- melt(CarnoII14_grframe,id.vars="samp2")
CarnoII14_grframelong_sum <- ddply(CarnoII14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII14_gr_max <- sum(CarnoII14_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII14_gr_max
CarnoII14_gr_pres <- sum(CarnoII14_grframelong_sum $max > 0)
CarnoII14_gr_pres

#number of sites which would be classified as low
CarnoII14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII14_grframelong_sum$max)
CarnoII14_gr_lw_ref
#number of sites which would be classified as high
CarnoII14_gr_high_ref <- sum( CarnoII14_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII14_gr_high_ref
#number of sites which would be classified as moderate
CarnoII14_gr_mod_ref <- 1000 - (CarnoII14_gr_high_ref + CarnoII14_gr_lw_ref)
CarnoII14_gr_mod_ref

#15 detectors
CarnoII15_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
CarnoII15_grframe<-data.frame(CarnoII15_gr, samp2)
CarnoII15_grframelong <- melt(CarnoII15_grframe,id.vars="samp2")
CarnoII15_grframelong_sum <- ddply(CarnoII15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII15_gr_max <- sum(CarnoII15_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII15_gr_max
CarnoII15_gr_pres <- sum(CarnoII15_grframelong_sum $max > 0)
CarnoII15_gr_pres

#number of sites which would be classified as low
CarnoII15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII15_grframelong_sum$max)
CarnoII15_gr_lw_ref
#number of sites which would be classified as high
CarnoII15_gr_high_ref <- sum( CarnoII15_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII15_gr_high_ref
#number of sites which would be classified as moderate
CarnoII15_gr_mod_ref <- 1000 - (CarnoII15_gr_high_ref + CarnoII15_gr_lw_ref)
CarnoII15_gr_mod_ref

#16 detectors
CarnoII16_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
CarnoII16_grframe<-data.frame(CarnoII16_gr, samp2)
CarnoII16_grframelong <- melt(CarnoII16_grframe,id.vars="samp2")
CarnoII16_grframelong_sum <- ddply(CarnoII16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII16_gr_max <- sum(CarnoII16_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII16_gr_max
CarnoII16_gr_pres <- sum(CarnoII16_grframelong_sum $max > 0)
CarnoII16_gr_pres

#number of sites which would be classified as low
CarnoII16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII16_grframelong_sum$max)
CarnoII16_gr_lw_ref
#number of sites which would be classified as high
CarnoII16_gr_high_ref <- sum( CarnoII16_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII16_gr_high_ref
#number of sites which would be classified as moderate
CarnoII16_gr_mod_ref <- 1000 - (CarnoII16_gr_high_ref + CarnoII16_gr_lw_ref)
CarnoII16_gr_mod_ref

#17 detectors
CarnoII17_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
CarnoII17_grframe<-data.frame(CarnoII17_gr, samp2)
CarnoII17_grframelong <- melt(CarnoII17_grframe,id.vars="samp2")
CarnoII17_grframelong_sum <- ddply(CarnoII17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII17_gr_max <- sum(CarnoII17_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII17_gr_max
CarnoII17_gr_pres <- sum(CarnoII17_grframelong_sum $max > 0)
CarnoII17_gr_pres

#number of sites which would be classified as low
CarnoII17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII17_grframelong_sum$max)
CarnoII17_gr_lw_ref
#number of sites which would be classified as high
CarnoII17_gr_high_ref <- sum( CarnoII17_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII17_gr_high_ref
#number of sites which would be classified as moderate
CarnoII17_gr_mod_ref <- 1000 - (CarnoII17_gr_high_ref + CarnoII17_gr_lw_ref)
CarnoII17_gr_mod_ref

#18 detectors
CarnoII18_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
CarnoII18_grframe<-data.frame(CarnoII18_gr, samp2)
CarnoII18_grframelong <- melt(CarnoII18_grframe,id.vars="samp2")
CarnoII18_grframelong_sum <- ddply(CarnoII18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII18_gr_max <- sum(CarnoII18_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII18_gr_max
CarnoII18_gr_pres <- sum(CarnoII18_grframelong_sum $max > 0)
CarnoII18_gr_pres

#number of sites which would be classified as low
CarnoII18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII18_grframelong_sum$max)
CarnoII18_gr_lw_ref
#number of sites which would be classified as high
CarnoII18_gr_high_ref <- sum( CarnoII18_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII18_gr_high_ref
#number of sites which would be classified as moderate
CarnoII18_gr_mod_ref <- 1000 - (CarnoII18_gr_high_ref + CarnoII18_gr_lw_ref)
CarnoII18_gr_mod_ref

#19 detectors
CarnoII19_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
CarnoII19_grframe<-data.frame(CarnoII19_gr, samp2)
CarnoII19_grframelong <- melt(CarnoII19_grframe,id.vars="samp2")
CarnoII19_grframelong_sum <- ddply(CarnoII19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII19_gr_max <- sum(CarnoII19_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII19_gr_max
CarnoII19_gr_pres <- sum(CarnoII19_grframelong_sum $max > 0)
CarnoII19_gr_pres

#number of sites which would be classified as low
CarnoII19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII19_grframelong_sum$max)
CarnoII19_gr_lw_ref
#number of sites which would be classified as high
CarnoII19_gr_high_ref <- sum( CarnoII19_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII19_gr_high_ref
#number of sites which would be classified as moderate
CarnoII19_gr_mod_ref <- 1000 - (CarnoII19_gr_high_ref + CarnoII19_gr_lw_ref)
CarnoII19_gr_mod_ref

#20 detectors
CarnoII20_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
CarnoII20_grframe<-data.frame(CarnoII20_gr, samp2)
CarnoII20_grframelong <- melt(CarnoII20_grframe,id.vars="samp2")
CarnoII20_grframelong_sum <- ddply(CarnoII20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII20_gr_max <- sum(CarnoII20_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII20_gr_max
CarnoII20_gr_pres <- sum(CarnoII20_grframelong_sum $max > 0)
CarnoII20_gr_pres

#number of sites which would be classified as low
CarnoII20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII20_grframelong_sum$max)
CarnoII20_gr_lw_ref
#number of sites which would be classified as high
CarnoII20_gr_high_ref <- sum( CarnoII20_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII20_gr_high_ref
#number of sites which would be classified as moderate
CarnoII20_gr_mod_ref <- 1000 - (CarnoII20_gr_high_ref + CarnoII20_gr_lw_ref)
CarnoII20_gr_mod_ref

#21 detectors
CarnoII21_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
CarnoII21_grframe<-data.frame(CarnoII21_gr, samp2)
CarnoII21_grframelong <- melt(CarnoII21_grframe,id.vars="samp2")
CarnoII21_grframelong_sum <- ddply(CarnoII21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII21_gr_max <- sum(CarnoII21_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII21_gr_max
CarnoII21_gr_pres <- sum(CarnoII21_grframelong_sum $max > 0)
CarnoII21_gr_pres

#number of sites which would be classified as low
CarnoII21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII21_grframelong_sum$max)
CarnoII21_gr_lw_ref
#number of sites which would be classified as high
CarnoII21_gr_high_ref <- sum( CarnoII21_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII21_gr_high_ref
#number of sites which would be classified as moderate
CarnoII21_gr_mod_ref <- 1000 - (CarnoII21_gr_high_ref + CarnoII21_gr_lw_ref)
CarnoII21_gr_mod_ref

#22 detectors
CarnoII22_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
CarnoII22_grframe<-data.frame(CarnoII22_gr, samp2)
CarnoII22_grframelong <- melt(CarnoII22_grframe,id.vars="samp2")
CarnoII22_grframelong_sum <- ddply(CarnoII22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII22_gr_max <- sum(CarnoII22_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII22_gr_max
CarnoII22_gr_pres <- sum(CarnoII22_grframelong_sum $max > 0)
CarnoII22_gr_pres

#number of sites which would be classified as low
CarnoII22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII22_grframelong_sum$max)
CarnoII22_gr_lw_ref
#number of sites which would be classified as high
CarnoII22_gr_high_ref <- sum( CarnoII22_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII22_gr_high_ref
#number of sites which would be classified as moderate
CarnoII22_gr_mod_ref <- 1000 - (CarnoII22_gr_high_ref + CarnoII22_gr_lw_ref)
CarnoII22_gr_mod_ref

#23 detectors
CarnoII23_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
CarnoII23_grframe<-data.frame(CarnoII23_gr, samp2)
CarnoII23_grframelong <- melt(CarnoII23_grframe,id.vars="samp2")
CarnoII23_grframelong_sum <- ddply(CarnoII23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII23_gr_max <- sum(CarnoII23_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII23_gr_max
CarnoII23_gr_pres <- sum(CarnoII23_grframelong_sum $max > 0)
CarnoII23_gr_pres

#number of sites which would be classified as low
CarnoII23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII23_grframelong_sum$max)
CarnoII23_gr_lw_ref
#number of sites which would be classified as high
CarnoII23_gr_high_ref <- sum( CarnoII23_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII23_gr_high_ref
#number of sites which would be classified as moderate
CarnoII23_gr_mod_ref <- 1000 - (CarnoII23_gr_high_ref + CarnoII23_gr_lw_ref)
CarnoII23_gr_mod_ref

#24 detectors
CarnoII24_gr<-(replicate(1000, (sample(CarnoIIpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
CarnoII24_grframe<-data.frame(CarnoII24_gr, samp2)
CarnoII24_grframelong <- melt(CarnoII24_grframe,id.vars="samp2")
CarnoII24_grframelong_sum <- ddply(CarnoII24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
CarnoII24_gr_max <- sum(CarnoII24_grframelong_sum $max > max20_CarnoIIpipgr)
CarnoII24_gr_max
CarnoII24_gr_pres <- sum(CarnoII24_grframelong_sum $max > 0)
CarnoII24_gr_pres

#number of sites which would be classified as low
CarnoII24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= CarnoII24_grframelong_sum$max)
CarnoII24_gr_lw_ref
#number of sites which would be classified as high
CarnoII24_gr_high_ref <- sum( CarnoII24_grframelong_sum$max > allsppgr_ppip_ref_high)
CarnoII24_gr_high_ref
#number of sites which would be classified as moderate
CarnoII24_gr_mod_ref <- 1000 - (CarnoII24_gr_high_ref + CarnoII24_gr_lw_ref)
CarnoII24_gr_mod_ref

Present<-c(CarnoII1_gr_pres,CarnoII2_gr_pres,
           CarnoII3_gr_pres,CarnoII4_gr_pres,
           CarnoII5_gr_pres,CarnoII6_gr_pres,
           CarnoII7_gr_pres,CarnoII8_gr_pres,
           CarnoII9_gr_pres,CarnoII10_gr_pres,
           CarnoII11_gr_pres,CarnoII12_gr_pres,
           CarnoII13_gr_pres,CarnoII14_gr_pres,
           CarnoII15_gr_pres,CarnoII16_gr_pres,
           CarnoII17_gr_pres,CarnoII18_gr_pres,
           CarnoII19_gr_pres,CarnoII20_gr_pres,
           CarnoII21_gr_pres,CarnoII22_gr_pres,
           CarnoII23_gr_pres,CarnoII24_gr_pres)


Maximum<-c(CarnoII1_gr_max,CarnoII2_gr_max,
           CarnoII3_gr_max,CarnoII4_gr_max,
           CarnoII5_gr_max,CarnoII6_gr_max,
           CarnoII7_gr_max,CarnoII8_gr_max,
           CarnoII9_gr_max,CarnoII10_gr_max,
           CarnoII11_gr_max,CarnoII12_gr_max,
           CarnoII13_gr_max,CarnoII14_gr_max,
           CarnoII15_gr_max,CarnoII16_gr_max,
           CarnoII17_gr_max,CarnoII18_gr_max,
           CarnoII19_gr_max,CarnoII20_gr_max,
           CarnoII21_gr_max,CarnoII22_gr_max,
           CarnoII23_gr_max,CarnoII24_gr_max)

Low<-c(CarnoII1_gr_lw_ref, CarnoII2_gr_lw_ref, CarnoII3_gr_lw_ref,
       CarnoII4_gr_lw_ref, CarnoII5_gr_lw_ref, CarnoII6_gr_lw_ref,
       CarnoII7_gr_lw_ref, CarnoII8_gr_lw_ref, CarnoII9_gr_lw_ref,
       CarnoII10_gr_lw_ref, CarnoII11_gr_lw_ref, CarnoII12_gr_lw_ref, 
       CarnoII13_gr_lw_ref, CarnoII14_gr_lw_ref, CarnoII15_gr_lw_ref, 
       CarnoII16_gr_lw_ref, CarnoII17_gr_lw_ref, CarnoII18_gr_lw_ref, 
       CarnoII19_gr_lw_ref, CarnoII20_gr_lw_ref, CarnoII21_gr_lw_ref,
       CarnoII22_gr_lw_ref,CarnoII23_gr_lw_ref,CarnoII24_gr_lw_ref)

Moderate<-c(CarnoII1_gr_mod_ref, CarnoII2_gr_mod_ref, CarnoII3_gr_mod_ref,
            CarnoII4_gr_mod_ref, CarnoII5_gr_mod_ref, CarnoII6_gr_mod_ref,
            CarnoII7_gr_mod_ref, CarnoII8_gr_mod_ref, CarnoII9_gr_mod_ref,
            CarnoII10_gr_mod_ref, CarnoII11_gr_mod_ref, CarnoII12_gr_mod_ref, 
            CarnoII13_gr_mod_ref, CarnoII14_gr_mod_ref, CarnoII15_gr_mod_ref, 
            CarnoII16_gr_mod_ref, CarnoII17_gr_mod_ref, CarnoII18_gr_mod_ref, 
            CarnoII19_gr_mod_ref, CarnoII20_gr_mod_ref, CarnoII21_gr_mod_ref,
            CarnoII22_gr_mod_ref,CarnoII23_gr_mod_ref,CarnoII24_gr_mod_ref)

High<-c(CarnoII1_gr_high_ref, CarnoII2_gr_high_ref, CarnoII3_gr_high_ref,
        CarnoII4_gr_high_ref, CarnoII5_gr_high_ref, CarnoII6_gr_high_ref,
        CarnoII7_gr_high_ref, CarnoII8_gr_high_ref, CarnoII9_gr_high_ref,
        CarnoII10_gr_high_ref, CarnoII11_gr_high_ref, CarnoII12_gr_high_ref, 
        CarnoII13_gr_high_ref, CarnoII14_gr_high_ref, CarnoII15_gr_high_ref, 
        CarnoII16_gr_high_ref, CarnoII17_gr_high_ref, CarnoII18_gr_high_ref, 
        CarnoII19_gr_high_ref, CarnoII20_gr_high_ref, CarnoII21_gr_high_ref,
        CarnoII22_gr_high_ref,CarnoII23_gr_high_ref,CarnoII24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("CarnoIIgr",24)
Lowsite <- CarnoIIlow
Modsite <- CarnoIImod
Highsite <-CarnoIIhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



CarnoIIgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##Causeymire

Causeymirepipgr<-subset(allspp4gr_ppip, Site=="Causeymire")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Causeymirepipgr<-max(Causeymirepipgr$Passes)

#calculate 20% from maximum nightly record

max20_Causeymirepipgr<- (max_Causeymirepipgr/100)*80

##calculate the site classification (reference range)

Causeymirehigh<- max_Causeymirepipgr > allsppgr_ppip_ref_high

Causeymirelow<- allsppgr_ppip_ref_low > max_Causeymirepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Causeymirepipgr
Causeymiremod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Causeymire1_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 1, replace=F))))
Causeymire1_gr_max <- sum(Causeymire1_gr > max20_Causeymirepipgr)
Causeymire1_gr_max
Causeymire1_gr_pres <- sum(Causeymire1_gr > 0)
Causeymire1_gr_pres
#number of sites which would be classified as low
Causeymire1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire1_gr)
Causeymire1_gr_lw_ref
#number of sites which would be classified as high
Causeymire1_gr_high_ref <- sum( Causeymire1_gr > allsppgr_ppip_ref_high)
Causeymire1_gr_high_ref
#number of sites which would be classified as moderate
Causeymire1_gr_mod_ref <- 1000 - (Causeymire1_gr_high_ref + Causeymire1_gr_lw_ref)
Causeymire1_gr_mod_ref


#2 nights
Causeymire2_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Causeymire2_grframe<-data.frame(Causeymire2_gr, samp2)
Causeymire2_grframelong <- melt(Causeymire2_grframe,id.vars="samp2")
Causeymire2_grframelong_sum <- ddply(Causeymire2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire2_gr_max <- sum(Causeymire2_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire2_gr_max
Causeymire2_gr_pres <- sum(Causeymire2_grframelong_sum $max > 0)
Causeymire2_gr_pres

#number of sites which would be classified as low
Causeymire2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire2_grframelong_sum$max)
Causeymire2_gr_lw_ref
#number of sites which would be classified as high
Causeymire2_gr_high_ref <- sum( Causeymire2_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire2_gr_high_ref
#number of sites which would be classified as moderate
Causeymire2_gr_mod_ref <- 1000 - (Causeymire2_gr_high_ref + Causeymire2_gr_lw_ref)
Causeymire2_gr_mod_ref


#3 nights
Causeymire3_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Causeymire3_grframe<-data.frame(Causeymire3_gr, samp2)
Causeymire3_grframelong <- melt(Causeymire3_grframe,id.vars="samp2")
Causeymire3_grframelong_sum <- ddply(Causeymire3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire3_gr_max <- sum(Causeymire3_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire3_gr_max
Causeymire3_gr_pres <- sum(Causeymire3_grframelong_sum $max > 0)
Causeymire3_gr_pres

#number of sites which would be classified as low
Causeymire3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire3_grframelong_sum$max)
Causeymire3_gr_lw_ref
#number of sites which would be classified as high
Causeymire3_gr_high_ref <- sum( Causeymire3_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire3_gr_high_ref
#number of sites which would be classified as moderate
Causeymire3_gr_mod_ref <- 1000 - (Causeymire3_gr_high_ref + Causeymire3_gr_lw_ref)
Causeymire3_gr_mod_ref

#4 nights
Causeymire4_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Causeymire4_grframe<-data.frame(Causeymire4_gr, samp2)
Causeymire4_grframelong <- melt(Causeymire4_grframe,id.vars="samp2")
Causeymire4_grframelong_sum <- ddply(Causeymire4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire4_gr_max <- sum(Causeymire4_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire4_gr_max
Causeymire4_gr_pres <- sum(Causeymire4_grframelong_sum $max > 0)
Causeymire4_gr_pres

#number of sites which would be classified as low
Causeymire4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire4_grframelong_sum$max)
Causeymire4_gr_lw_ref
#number of sites which would be classified as high
Causeymire4_gr_high_ref <- sum( Causeymire4_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire4_gr_high_ref
#number of sites which would be classified as moderate
Causeymire4_gr_mod_ref <- 1000 - (Causeymire4_gr_high_ref + Causeymire4_gr_lw_ref)
Causeymire4_gr_mod_ref

#5 nights
Causeymire5_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Causeymire5_grframe<-data.frame(Causeymire5_gr, samp2)
Causeymire5_grframelong <- melt(Causeymire5_grframe,id.vars="samp2")
Causeymire5_grframelong_sum <- ddply(Causeymire5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire5_gr_max <- sum(Causeymire5_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire5_gr_max
Causeymire5_gr_pres <- sum(Causeymire5_grframelong_sum $max > 0)
Causeymire5_gr_pres

#number of sites which would be classified as low
Causeymire5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire5_grframelong_sum$max)
Causeymire5_gr_lw_ref
#number of sites which would be classified as high
Causeymire5_gr_high_ref <- sum( Causeymire5_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire5_gr_high_ref
#number of sites which would be classified as moderate
Causeymire5_gr_mod_ref <- 1000 - (Causeymire5_gr_high_ref + Causeymire5_gr_lw_ref)
Causeymire5_gr_mod_ref

#6 nights
Causeymire6_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Causeymire6_grframe<-data.frame(Causeymire6_gr, samp2)
Causeymire6_grframelong <- melt(Causeymire6_grframe,id.vars="samp2")
Causeymire6_grframelong_sum <- ddply(Causeymire6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire6_gr_max <- sum(Causeymire6_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire6_gr_max
Causeymire6_gr_pres <- sum(Causeymire6_grframelong_sum $max > 0)
Causeymire6_gr_pres

#number of sites which would be classified as low
Causeymire6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire6_grframelong_sum$max)
Causeymire6_gr_lw_ref
#number of sites which would be classified as high
Causeymire6_gr_high_ref <- sum( Causeymire6_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire6_gr_high_ref
#number of sites which would be classified as moderate
Causeymire6_gr_mod_ref <- 1000 - (Causeymire6_gr_high_ref + Causeymire6_gr_lw_ref)
Causeymire6_gr_mod_ref

#7 nights
Causeymire7_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Causeymire7_grframe<-data.frame(Causeymire7_gr, samp2)
Causeymire7_grframelong <- melt(Causeymire7_grframe,id.vars="samp2")
Causeymire7_grframelong_sum <- ddply(Causeymire7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire7_gr_max <- sum(Causeymire7_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire7_gr_max
Causeymire7_gr_pres <- sum(Causeymire7_grframelong_sum $max > 0)
Causeymire7_gr_pres

#number of sites which would be classified as low
Causeymire7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire7_grframelong_sum$max)
Causeymire7_gr_lw_ref
#number of sites which would be classified as high
Causeymire7_gr_high_ref <- sum( Causeymire7_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire7_gr_high_ref
#number of sites which would be classified as moderate
Causeymire7_gr_mod_ref <- 1000 - (Causeymire7_gr_high_ref + Causeymire7_gr_lw_ref)
Causeymire7_gr_mod_ref

#8 nights
Causeymire8_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Causeymire8_grframe<-data.frame(Causeymire8_gr, samp2)
Causeymire8_grframelong <- melt(Causeymire8_grframe,id.vars="samp2")
Causeymire8_grframelong_sum <- ddply(Causeymire8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire8_gr_max <- sum(Causeymire8_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire8_gr_max
Causeymire8_gr_pres <- sum(Causeymire8_grframelong_sum $max > 0)
Causeymire8_gr_pres

#number of sites which would be classified as low
Causeymire8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire8_grframelong_sum$max)
Causeymire8_gr_lw_ref
#number of sites which would be classified as high
Causeymire8_gr_high_ref <- sum( Causeymire8_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire8_gr_high_ref
#number of sites which would be classified as moderate
Causeymire8_gr_mod_ref <- 1000 - (Causeymire8_gr_high_ref + Causeymire8_gr_lw_ref)
Causeymire8_gr_mod_ref

#9 nights
Causeymire9_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Causeymire9_grframe<-data.frame(Causeymire9_gr, samp2)
Causeymire9_grframelong <- melt(Causeymire9_grframe,id.vars="samp2")
Causeymire9_grframelong_sum <- ddply(Causeymire9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Causeymire9_gr_max <- sum(Causeymire9_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire9_gr_max
Causeymire9_gr_pres <- sum(Causeymire9_grframelong_sum $max > 0)
Causeymire9_gr_pres

#number of sites which would be classified as low
Causeymire9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire9_grframelong_sum$max)
Causeymire9_gr_lw_ref
#number of sites which would be classified as high
Causeymire9_gr_high_ref <- sum( Causeymire9_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire9_gr_high_ref
#number of sites which would be classified as moderate
Causeymire9_gr_mod_ref <- 1000 - (Causeymire9_gr_high_ref + Causeymire9_gr_lw_ref)
Causeymire9_gr_mod_ref

#10 detectors
Causeymire10_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Causeymire10_grframe<-data.frame(Causeymire10_gr, samp2)
Causeymire10_grframelong <- melt(Causeymire10_grframe,id.vars="samp2")
Causeymire10_grframelong_sum <- ddply(Causeymire10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire10_gr_max <- sum(Causeymire10_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire10_gr_max
Causeymire10_gr_pres <- sum(Causeymire10_grframelong_sum $max > 0)
Causeymire10_gr_pres

#number of sites which would be classified as low
Causeymire10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire10_grframelong_sum$max)
Causeymire10_gr_lw_ref
#number of sites which would be classified as high
Causeymire10_gr_high_ref <- sum( Causeymire10_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire10_gr_high_ref
#number of sites which would be classified as moderate
Causeymire10_gr_mod_ref <- 1000 - (Causeymire10_gr_high_ref + Causeymire10_gr_lw_ref)
Causeymire10_gr_mod_ref

#11 detectors
Causeymire11_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Causeymire11_grframe<-data.frame(Causeymire11_gr, samp2)
Causeymire11_grframelong <- melt(Causeymire11_grframe,id.vars="samp2")
Causeymire11_grframelong_sum <- ddply(Causeymire11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire11_gr_max <- sum(Causeymire11_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire11_gr_max
Causeymire11_gr_pres <- sum(Causeymire11_grframelong_sum $max > 0)
Causeymire11_gr_pres

#number of sites which would be classified as low
Causeymire11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire11_grframelong_sum$max)
Causeymire11_gr_lw_ref
#number of sites which would be classified as high
Causeymire11_gr_high_ref <- sum( Causeymire11_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire11_gr_high_ref
#number of sites which would be classified as moderate
Causeymire11_gr_mod_ref <- 1000 - (Causeymire11_gr_high_ref + Causeymire11_gr_lw_ref)
Causeymire11_gr_mod_ref

#12 detectors
Causeymire12_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Causeymire12_grframe<-data.frame(Causeymire12_gr, samp2)
Causeymire12_grframelong <- melt(Causeymire12_grframe,id.vars="samp2")
Causeymire12_grframelong_sum <- ddply(Causeymire12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire12_gr_max <- sum(Causeymire12_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire12_gr_max
Causeymire12_gr_pres <- sum(Causeymire12_grframelong_sum $max > 0)
Causeymire12_gr_pres

#number of sites which would be classified as low
Causeymire12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire12_grframelong_sum$max)
Causeymire12_gr_lw_ref
#number of sites which would be classified as high
Causeymire12_gr_high_ref <- sum( Causeymire12_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire12_gr_high_ref
#number of sites which would be classified as moderate
Causeymire12_gr_mod_ref <- 1000 - (Causeymire12_gr_high_ref + Causeymire12_gr_lw_ref)
Causeymire12_gr_mod_ref

#13 detectors
Causeymire13_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Causeymire13_grframe<-data.frame(Causeymire13_gr, samp2)
Causeymire13_grframelong <- melt(Causeymire13_grframe,id.vars="samp2")
Causeymire13_grframelong_sum <- ddply(Causeymire13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire13_gr_max <- sum(Causeymire13_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire13_gr_max
Causeymire13_gr_pres <- sum(Causeymire13_grframelong_sum $max > 0)
Causeymire13_gr_pres

#number of sites which would be classified as low
Causeymire13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire13_grframelong_sum$max)
Causeymire13_gr_lw_ref
#number of sites which would be classified as high
Causeymire13_gr_high_ref <- sum( Causeymire13_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire13_gr_high_ref
#number of sites which would be classified as moderate
Causeymire13_gr_mod_ref <- 1000 - (Causeymire13_gr_high_ref + Causeymire13_gr_lw_ref)
Causeymire13_gr_mod_ref

#14 detectors
Causeymire14_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Causeymire14_grframe<-data.frame(Causeymire14_gr, samp2)
Causeymire14_grframelong <- melt(Causeymire14_grframe,id.vars="samp2")
Causeymire14_grframelong_sum <- ddply(Causeymire14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire14_gr_max <- sum(Causeymire14_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire14_gr_max
Causeymire14_gr_pres <- sum(Causeymire14_grframelong_sum $max > 0)
Causeymire14_gr_pres

#number of sites which would be classified as low
Causeymire14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire14_grframelong_sum$max)
Causeymire14_gr_lw_ref
#number of sites which would be classified as high
Causeymire14_gr_high_ref <- sum( Causeymire14_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire14_gr_high_ref
#number of sites which would be classified as moderate
Causeymire14_gr_mod_ref <- 1000 - (Causeymire14_gr_high_ref + Causeymire14_gr_lw_ref)
Causeymire14_gr_mod_ref

#15 detectors
Causeymire15_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Causeymire15_grframe<-data.frame(Causeymire15_gr, samp2)
Causeymire15_grframelong <- melt(Causeymire15_grframe,id.vars="samp2")
Causeymire15_grframelong_sum <- ddply(Causeymire15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire15_gr_max <- sum(Causeymire15_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire15_gr_max
Causeymire15_gr_pres <- sum(Causeymire15_grframelong_sum $max > 0)
Causeymire15_gr_pres

#number of sites which would be classified as low
Causeymire15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire15_grframelong_sum$max)
Causeymire15_gr_lw_ref
#number of sites which would be classified as high
Causeymire15_gr_high_ref <- sum( Causeymire15_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire15_gr_high_ref
#number of sites which would be classified as moderate
Causeymire15_gr_mod_ref <- 1000 - (Causeymire15_gr_high_ref + Causeymire15_gr_lw_ref)
Causeymire15_gr_mod_ref

#16 detectors
Causeymire16_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Causeymire16_grframe<-data.frame(Causeymire16_gr, samp2)
Causeymire16_grframelong <- melt(Causeymire16_grframe,id.vars="samp2")
Causeymire16_grframelong_sum <- ddply(Causeymire16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire16_gr_max <- sum(Causeymire16_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire16_gr_max
Causeymire16_gr_pres <- sum(Causeymire16_grframelong_sum $max > 0)
Causeymire16_gr_pres

#number of sites which would be classified as low
Causeymire16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire16_grframelong_sum$max)
Causeymire16_gr_lw_ref
#number of sites which would be classified as high
Causeymire16_gr_high_ref <- sum( Causeymire16_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire16_gr_high_ref
#number of sites which would be classified as moderate
Causeymire16_gr_mod_ref <- 1000 - (Causeymire16_gr_high_ref + Causeymire16_gr_lw_ref)
Causeymire16_gr_mod_ref

#17 detectors
Causeymire17_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Causeymire17_grframe<-data.frame(Causeymire17_gr, samp2)
Causeymire17_grframelong <- melt(Causeymire17_grframe,id.vars="samp2")
Causeymire17_grframelong_sum <- ddply(Causeymire17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire17_gr_max <- sum(Causeymire17_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire17_gr_max
Causeymire17_gr_pres <- sum(Causeymire17_grframelong_sum $max > 0)
Causeymire17_gr_pres

#number of sites which would be classified as low
Causeymire17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire17_grframelong_sum$max)
Causeymire17_gr_lw_ref
#number of sites which would be classified as high
Causeymire17_gr_high_ref <- sum( Causeymire17_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire17_gr_high_ref
#number of sites which would be classified as moderate
Causeymire17_gr_mod_ref <- 1000 - (Causeymire17_gr_high_ref + Causeymire17_gr_lw_ref)
Causeymire17_gr_mod_ref

#18 detectors
Causeymire18_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Causeymire18_grframe<-data.frame(Causeymire18_gr, samp2)
Causeymire18_grframelong <- melt(Causeymire18_grframe,id.vars="samp2")
Causeymire18_grframelong_sum <- ddply(Causeymire18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire18_gr_max <- sum(Causeymire18_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire18_gr_max
Causeymire18_gr_pres <- sum(Causeymire18_grframelong_sum $max > 0)
Causeymire18_gr_pres

#number of sites which would be classified as low
Causeymire18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire18_grframelong_sum$max)
Causeymire18_gr_lw_ref
#number of sites which would be classified as high
Causeymire18_gr_high_ref <- sum( Causeymire18_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire18_gr_high_ref
#number of sites which would be classified as moderate
Causeymire18_gr_mod_ref <- 1000 - (Causeymire18_gr_high_ref + Causeymire18_gr_lw_ref)
Causeymire18_gr_mod_ref

#19 detectors
Causeymire19_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Causeymire19_grframe<-data.frame(Causeymire19_gr, samp2)
Causeymire19_grframelong <- melt(Causeymire19_grframe,id.vars="samp2")
Causeymire19_grframelong_sum <- ddply(Causeymire19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire19_gr_max <- sum(Causeymire19_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire19_gr_max
Causeymire19_gr_pres <- sum(Causeymire19_grframelong_sum $max > 0)
Causeymire19_gr_pres

#number of sites which would be classified as low
Causeymire19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire19_grframelong_sum$max)
Causeymire19_gr_lw_ref
#number of sites which would be classified as high
Causeymire19_gr_high_ref <- sum( Causeymire19_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire19_gr_high_ref
#number of sites which would be classified as moderate
Causeymire19_gr_mod_ref <- 1000 - (Causeymire19_gr_high_ref + Causeymire19_gr_lw_ref)
Causeymire19_gr_mod_ref

#20 detectors
Causeymire20_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Causeymire20_grframe<-data.frame(Causeymire20_gr, samp2)
Causeymire20_grframelong <- melt(Causeymire20_grframe,id.vars="samp2")
Causeymire20_grframelong_sum <- ddply(Causeymire20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire20_gr_max <- sum(Causeymire20_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire20_gr_max
Causeymire20_gr_pres <- sum(Causeymire20_grframelong_sum $max > 0)
Causeymire20_gr_pres

#number of sites which would be classified as low
Causeymire20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire20_grframelong_sum$max)
Causeymire20_gr_lw_ref
#number of sites which would be classified as high
Causeymire20_gr_high_ref <- sum( Causeymire20_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire20_gr_high_ref
#number of sites which would be classified as moderate
Causeymire20_gr_mod_ref <- 1000 - (Causeymire20_gr_high_ref + Causeymire20_gr_lw_ref)
Causeymire20_gr_mod_ref

#21 detectors
Causeymire21_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Causeymire21_grframe<-data.frame(Causeymire21_gr, samp2)
Causeymire21_grframelong <- melt(Causeymire21_grframe,id.vars="samp2")
Causeymire21_grframelong_sum <- ddply(Causeymire21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire21_gr_max <- sum(Causeymire21_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire21_gr_max
Causeymire21_gr_pres <- sum(Causeymire21_grframelong_sum $max > 0)
Causeymire21_gr_pres

#number of sites which would be classified as low
Causeymire21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire21_grframelong_sum$max)
Causeymire21_gr_lw_ref
#number of sites which would be classified as high
Causeymire21_gr_high_ref <- sum( Causeymire21_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire21_gr_high_ref
#number of sites which would be classified as moderate
Causeymire21_gr_mod_ref <- 1000 - (Causeymire21_gr_high_ref + Causeymire21_gr_lw_ref)
Causeymire21_gr_mod_ref

#22 detectors
Causeymire22_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Causeymire22_grframe<-data.frame(Causeymire22_gr, samp2)
Causeymire22_grframelong <- melt(Causeymire22_grframe,id.vars="samp2")
Causeymire22_grframelong_sum <- ddply(Causeymire22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire22_gr_max <- sum(Causeymire22_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire22_gr_max
Causeymire22_gr_pres <- sum(Causeymire22_grframelong_sum $max > 0)
Causeymire22_gr_pres

#number of sites which would be classified as low
Causeymire22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire22_grframelong_sum$max)
Causeymire22_gr_lw_ref
#number of sites which would be classified as high
Causeymire22_gr_high_ref <- sum( Causeymire22_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire22_gr_high_ref
#number of sites which would be classified as moderate
Causeymire22_gr_mod_ref <- 1000 - (Causeymire22_gr_high_ref + Causeymire22_gr_lw_ref)
Causeymire22_gr_mod_ref

#23 detectors
Causeymire23_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Causeymire23_grframe<-data.frame(Causeymire23_gr, samp2)
Causeymire23_grframelong <- melt(Causeymire23_grframe,id.vars="samp2")
Causeymire23_grframelong_sum <- ddply(Causeymire23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire23_gr_max <- sum(Causeymire23_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire23_gr_max
Causeymire23_gr_pres <- sum(Causeymire23_grframelong_sum $max > 0)
Causeymire23_gr_pres

#number of sites which would be classified as low
Causeymire23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire23_grframelong_sum$max)
Causeymire23_gr_lw_ref
#number of sites which would be classified as high
Causeymire23_gr_high_ref <- sum( Causeymire23_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire23_gr_high_ref
#number of sites which would be classified as moderate
Causeymire23_gr_mod_ref <- 1000 - (Causeymire23_gr_high_ref + Causeymire23_gr_lw_ref)
Causeymire23_gr_mod_ref

#24 detectors
Causeymire24_gr<-(replicate(1000, (sample(Causeymirepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Causeymire24_grframe<-data.frame(Causeymire24_gr, samp2)
Causeymire24_grframelong <- melt(Causeymire24_grframe,id.vars="samp2")
Causeymire24_grframelong_sum <- ddply(Causeymire24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Causeymire24_gr_max <- sum(Causeymire24_grframelong_sum $max > max20_Causeymirepipgr)
Causeymire24_gr_max
Causeymire24_gr_pres <- sum(Causeymire24_grframelong_sum $max > 0)
Causeymire24_gr_pres

#number of sites which would be classified as low
Causeymire24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Causeymire24_grframelong_sum$max)
Causeymire24_gr_lw_ref
#number of sites which would be classified as high
Causeymire24_gr_high_ref <- sum( Causeymire24_grframelong_sum$max > allsppgr_ppip_ref_high)
Causeymire24_gr_high_ref
#number of sites which would be classified as moderate
Causeymire24_gr_mod_ref <- 1000 - (Causeymire24_gr_high_ref + Causeymire24_gr_lw_ref)
Causeymire24_gr_mod_ref

Present<-c(Causeymire1_gr_pres,Causeymire2_gr_pres,
           Causeymire3_gr_pres,Causeymire4_gr_pres,
           Causeymire5_gr_pres,Causeymire6_gr_pres,
           Causeymire7_gr_pres,Causeymire8_gr_pres,
           Causeymire9_gr_pres,Causeymire10_gr_pres,
           Causeymire11_gr_pres,Causeymire12_gr_pres,
           Causeymire13_gr_pres,Causeymire14_gr_pres,
           Causeymire15_gr_pres,Causeymire16_gr_pres,
           Causeymire17_gr_pres,Causeymire18_gr_pres,
           Causeymire19_gr_pres,Causeymire20_gr_pres,
           Causeymire21_gr_pres,Causeymire22_gr_pres,
           Causeymire23_gr_pres,Causeymire24_gr_pres)


Maximum<-c(Causeymire1_gr_max,Causeymire2_gr_max,
           Causeymire3_gr_max,Causeymire4_gr_max,
           Causeymire5_gr_max,Causeymire6_gr_max,
           Causeymire7_gr_max,Causeymire8_gr_max,
           Causeymire9_gr_max,Causeymire10_gr_max,
           Causeymire11_gr_max,Causeymire12_gr_max,
           Causeymire13_gr_max,Causeymire14_gr_max,
           Causeymire15_gr_max,Causeymire16_gr_max,
           Causeymire17_gr_max,Causeymire18_gr_max,
           Causeymire19_gr_max,Causeymire20_gr_max,
           Causeymire21_gr_max,Causeymire22_gr_max,
           Causeymire23_gr_max,Causeymire24_gr_max)

Low<-c(Causeymire1_gr_lw_ref, Causeymire2_gr_lw_ref, Causeymire3_gr_lw_ref,
       Causeymire4_gr_lw_ref, Causeymire5_gr_lw_ref, Causeymire6_gr_lw_ref,
       Causeymire7_gr_lw_ref, Causeymire8_gr_lw_ref, Causeymire9_gr_lw_ref,
       Causeymire10_gr_lw_ref, Causeymire11_gr_lw_ref, Causeymire12_gr_lw_ref, 
       Causeymire13_gr_lw_ref, Causeymire14_gr_lw_ref, Causeymire15_gr_lw_ref, 
       Causeymire16_gr_lw_ref, Causeymire17_gr_lw_ref, Causeymire18_gr_lw_ref, 
       Causeymire19_gr_lw_ref, Causeymire20_gr_lw_ref, Causeymire21_gr_lw_ref,
       Causeymire22_gr_lw_ref,Causeymire23_gr_lw_ref,Causeymire24_gr_lw_ref)

Moderate<-c(Causeymire1_gr_mod_ref, Causeymire2_gr_mod_ref, Causeymire3_gr_mod_ref,
            Causeymire4_gr_mod_ref, Causeymire5_gr_mod_ref, Causeymire6_gr_mod_ref,
            Causeymire7_gr_mod_ref, Causeymire8_gr_mod_ref, Causeymire9_gr_mod_ref,
            Causeymire10_gr_mod_ref, Causeymire11_gr_mod_ref, Causeymire12_gr_mod_ref, 
            Causeymire13_gr_mod_ref, Causeymire14_gr_mod_ref, Causeymire15_gr_mod_ref, 
            Causeymire16_gr_mod_ref, Causeymire17_gr_mod_ref, Causeymire18_gr_mod_ref, 
            Causeymire19_gr_mod_ref, Causeymire20_gr_mod_ref, Causeymire21_gr_mod_ref,
            Causeymire22_gr_mod_ref,Causeymire23_gr_mod_ref,Causeymire24_gr_mod_ref)

High<-c(Causeymire1_gr_high_ref, Causeymire2_gr_high_ref, Causeymire3_gr_high_ref,
        Causeymire4_gr_high_ref, Causeymire5_gr_high_ref, Causeymire6_gr_high_ref,
        Causeymire7_gr_high_ref, Causeymire8_gr_high_ref, Causeymire9_gr_high_ref,
        Causeymire10_gr_high_ref, Causeymire11_gr_high_ref, Causeymire12_gr_high_ref, 
        Causeymire13_gr_high_ref, Causeymire14_gr_high_ref, Causeymire15_gr_high_ref, 
        Causeymire16_gr_high_ref, Causeymire17_gr_high_ref, Causeymire18_gr_high_ref, 
        Causeymire19_gr_high_ref, Causeymire20_gr_high_ref, Causeymire21_gr_high_ref,
        Causeymire22_gr_high_ref,Causeymire23_gr_high_ref,Causeymire24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Causeymiregr",24)
Lowsite <- Causeymirelow
Modsite <- Causeymiremod
Highsite <-Causeymirehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Causeymiregr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Cemmaes

Cemmaespipgr<-subset(allspp4gr_ppip, Site=="Cemmaes")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Cemmaespipgr<-max(Cemmaespipgr$Passes)

#calculate 20% from maximum nightly record

max20_Cemmaespipgr<- (max_Cemmaespipgr/100)*80

##calculate the site classification (reference range)

Cemmaeshigh<- max_Cemmaespipgr > allsppgr_ppip_ref_high

Cemmaeslow<- allsppgr_ppip_ref_low > max_Cemmaespipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Cemmaespipgr
Cemmaesmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Cemmaes1_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 1, replace=F))))
Cemmaes1_gr_max <- sum(Cemmaes1_gr > max20_Cemmaespipgr)
Cemmaes1_gr_max
Cemmaes1_gr_pres <- sum(Cemmaes1_gr > 0)
Cemmaes1_gr_pres
#number of sites which would be classified as low
Cemmaes1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes1_gr)
Cemmaes1_gr_lw_ref
#number of sites which would be classified as high
Cemmaes1_gr_high_ref <- sum( Cemmaes1_gr > allsppgr_ppip_ref_high)
Cemmaes1_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes1_gr_mod_ref <- 1000 - (Cemmaes1_gr_high_ref + Cemmaes1_gr_lw_ref)
Cemmaes1_gr_mod_ref


#2 nights
Cemmaes2_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Cemmaes2_grframe<-data.frame(Cemmaes2_gr, samp2)
Cemmaes2_grframelong <- melt(Cemmaes2_grframe,id.vars="samp2")
Cemmaes2_grframelong_sum <- ddply(Cemmaes2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes2_gr_max <- sum(Cemmaes2_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes2_gr_max
Cemmaes2_gr_pres <- sum(Cemmaes2_grframelong_sum $max > 0)
Cemmaes2_gr_pres

#number of sites which would be classified as low
Cemmaes2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes2_grframelong_sum$max)
Cemmaes2_gr_lw_ref
#number of sites which would be classified as high
Cemmaes2_gr_high_ref <- sum( Cemmaes2_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes2_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes2_gr_mod_ref <- 1000 - (Cemmaes2_gr_high_ref + Cemmaes2_gr_lw_ref)
Cemmaes2_gr_mod_ref


#3 nights
Cemmaes3_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Cemmaes3_grframe<-data.frame(Cemmaes3_gr, samp2)
Cemmaes3_grframelong <- melt(Cemmaes3_grframe,id.vars="samp2")
Cemmaes3_grframelong_sum <- ddply(Cemmaes3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes3_gr_max <- sum(Cemmaes3_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes3_gr_max
Cemmaes3_gr_pres <- sum(Cemmaes3_grframelong_sum $max > 0)
Cemmaes3_gr_pres

#number of sites which would be classified as low
Cemmaes3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes3_grframelong_sum$max)
Cemmaes3_gr_lw_ref
#number of sites which would be classified as high
Cemmaes3_gr_high_ref <- sum( Cemmaes3_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes3_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes3_gr_mod_ref <- 1000 - (Cemmaes3_gr_high_ref + Cemmaes3_gr_lw_ref)
Cemmaes3_gr_mod_ref

#4 nights
Cemmaes4_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Cemmaes4_grframe<-data.frame(Cemmaes4_gr, samp2)
Cemmaes4_grframelong <- melt(Cemmaes4_grframe,id.vars="samp2")
Cemmaes4_grframelong_sum <- ddply(Cemmaes4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes4_gr_max <- sum(Cemmaes4_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes4_gr_max
Cemmaes4_gr_pres <- sum(Cemmaes4_grframelong_sum $max > 0)
Cemmaes4_gr_pres

#number of sites which would be classified as low
Cemmaes4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes4_grframelong_sum$max)
Cemmaes4_gr_lw_ref
#number of sites which would be classified as high
Cemmaes4_gr_high_ref <- sum( Cemmaes4_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes4_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes4_gr_mod_ref <- 1000 - (Cemmaes4_gr_high_ref + Cemmaes4_gr_lw_ref)
Cemmaes4_gr_mod_ref

#5 nights
Cemmaes5_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Cemmaes5_grframe<-data.frame(Cemmaes5_gr, samp2)
Cemmaes5_grframelong <- melt(Cemmaes5_grframe,id.vars="samp2")
Cemmaes5_grframelong_sum <- ddply(Cemmaes5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes5_gr_max <- sum(Cemmaes5_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes5_gr_max
Cemmaes5_gr_pres <- sum(Cemmaes5_grframelong_sum $max > 0)
Cemmaes5_gr_pres

#number of sites which would be classified as low
Cemmaes5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes5_grframelong_sum$max)
Cemmaes5_gr_lw_ref
#number of sites which would be classified as high
Cemmaes5_gr_high_ref <- sum( Cemmaes5_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes5_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes5_gr_mod_ref <- 1000 - (Cemmaes5_gr_high_ref + Cemmaes5_gr_lw_ref)
Cemmaes5_gr_mod_ref

#6 nights
Cemmaes6_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Cemmaes6_grframe<-data.frame(Cemmaes6_gr, samp2)
Cemmaes6_grframelong <- melt(Cemmaes6_grframe,id.vars="samp2")
Cemmaes6_grframelong_sum <- ddply(Cemmaes6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes6_gr_max <- sum(Cemmaes6_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes6_gr_max
Cemmaes6_gr_pres <- sum(Cemmaes6_grframelong_sum $max > 0)
Cemmaes6_gr_pres

#number of sites which would be classified as low
Cemmaes6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes6_grframelong_sum$max)
Cemmaes6_gr_lw_ref
#number of sites which would be classified as high
Cemmaes6_gr_high_ref <- sum( Cemmaes6_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes6_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes6_gr_mod_ref <- 1000 - (Cemmaes6_gr_high_ref + Cemmaes6_gr_lw_ref)
Cemmaes6_gr_mod_ref

#7 nights
Cemmaes7_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Cemmaes7_grframe<-data.frame(Cemmaes7_gr, samp2)
Cemmaes7_grframelong <- melt(Cemmaes7_grframe,id.vars="samp2")
Cemmaes7_grframelong_sum <- ddply(Cemmaes7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes7_gr_max <- sum(Cemmaes7_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes7_gr_max
Cemmaes7_gr_pres <- sum(Cemmaes7_grframelong_sum $max > 0)
Cemmaes7_gr_pres

#number of sites which would be classified as low
Cemmaes7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes7_grframelong_sum$max)
Cemmaes7_gr_lw_ref
#number of sites which would be classified as high
Cemmaes7_gr_high_ref <- sum( Cemmaes7_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes7_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes7_gr_mod_ref <- 1000 - (Cemmaes7_gr_high_ref + Cemmaes7_gr_lw_ref)
Cemmaes7_gr_mod_ref

#8 nights
Cemmaes8_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Cemmaes8_grframe<-data.frame(Cemmaes8_gr, samp2)
Cemmaes8_grframelong <- melt(Cemmaes8_grframe,id.vars="samp2")
Cemmaes8_grframelong_sum <- ddply(Cemmaes8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes8_gr_max <- sum(Cemmaes8_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes8_gr_max
Cemmaes8_gr_pres <- sum(Cemmaes8_grframelong_sum $max > 0)
Cemmaes8_gr_pres

#number of sites which would be classified as low
Cemmaes8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes8_grframelong_sum$max)
Cemmaes8_gr_lw_ref
#number of sites which would be classified as high
Cemmaes8_gr_high_ref <- sum( Cemmaes8_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes8_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes8_gr_mod_ref <- 1000 - (Cemmaes8_gr_high_ref + Cemmaes8_gr_lw_ref)
Cemmaes8_gr_mod_ref

#9 nights
Cemmaes9_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Cemmaes9_grframe<-data.frame(Cemmaes9_gr, samp2)
Cemmaes9_grframelong <- melt(Cemmaes9_grframe,id.vars="samp2")
Cemmaes9_grframelong_sum <- ddply(Cemmaes9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Cemmaes9_gr_max <- sum(Cemmaes9_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes9_gr_max
Cemmaes9_gr_pres <- sum(Cemmaes9_grframelong_sum $max > 0)
Cemmaes9_gr_pres

#number of sites which would be classified as low
Cemmaes9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes9_grframelong_sum$max)
Cemmaes9_gr_lw_ref
#number of sites which would be classified as high
Cemmaes9_gr_high_ref <- sum( Cemmaes9_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes9_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes9_gr_mod_ref <- 1000 - (Cemmaes9_gr_high_ref + Cemmaes9_gr_lw_ref)
Cemmaes9_gr_mod_ref

#10 detectors
Cemmaes10_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Cemmaes10_grframe<-data.frame(Cemmaes10_gr, samp2)
Cemmaes10_grframelong <- melt(Cemmaes10_grframe,id.vars="samp2")
Cemmaes10_grframelong_sum <- ddply(Cemmaes10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes10_gr_max <- sum(Cemmaes10_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes10_gr_max
Cemmaes10_gr_pres <- sum(Cemmaes10_grframelong_sum $max > 0)
Cemmaes10_gr_pres

#number of sites which would be classified as low
Cemmaes10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes10_grframelong_sum$max)
Cemmaes10_gr_lw_ref
#number of sites which would be classified as high
Cemmaes10_gr_high_ref <- sum( Cemmaes10_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes10_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes10_gr_mod_ref <- 1000 - (Cemmaes10_gr_high_ref + Cemmaes10_gr_lw_ref)
Cemmaes10_gr_mod_ref

#11 detectors
Cemmaes11_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Cemmaes11_grframe<-data.frame(Cemmaes11_gr, samp2)
Cemmaes11_grframelong <- melt(Cemmaes11_grframe,id.vars="samp2")
Cemmaes11_grframelong_sum <- ddply(Cemmaes11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes11_gr_max <- sum(Cemmaes11_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes11_gr_max
Cemmaes11_gr_pres <- sum(Cemmaes11_grframelong_sum $max > 0)
Cemmaes11_gr_pres

#number of sites which would be classified as low
Cemmaes11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes11_grframelong_sum$max)
Cemmaes11_gr_lw_ref
#number of sites which would be classified as high
Cemmaes11_gr_high_ref <- sum( Cemmaes11_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes11_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes11_gr_mod_ref <- 1000 - (Cemmaes11_gr_high_ref + Cemmaes11_gr_lw_ref)
Cemmaes11_gr_mod_ref

#12 detectors
Cemmaes12_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Cemmaes12_grframe<-data.frame(Cemmaes12_gr, samp2)
Cemmaes12_grframelong <- melt(Cemmaes12_grframe,id.vars="samp2")
Cemmaes12_grframelong_sum <- ddply(Cemmaes12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes12_gr_max <- sum(Cemmaes12_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes12_gr_max
Cemmaes12_gr_pres <- sum(Cemmaes12_grframelong_sum $max > 0)
Cemmaes12_gr_pres

#number of sites which would be classified as low
Cemmaes12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes12_grframelong_sum$max)
Cemmaes12_gr_lw_ref
#number of sites which would be classified as high
Cemmaes12_gr_high_ref <- sum( Cemmaes12_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes12_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes12_gr_mod_ref <- 1000 - (Cemmaes12_gr_high_ref + Cemmaes12_gr_lw_ref)
Cemmaes12_gr_mod_ref

#13 detectors
Cemmaes13_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Cemmaes13_grframe<-data.frame(Cemmaes13_gr, samp2)
Cemmaes13_grframelong <- melt(Cemmaes13_grframe,id.vars="samp2")
Cemmaes13_grframelong_sum <- ddply(Cemmaes13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes13_gr_max <- sum(Cemmaes13_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes13_gr_max
Cemmaes13_gr_pres <- sum(Cemmaes13_grframelong_sum $max > 0)
Cemmaes13_gr_pres

#number of sites which would be classified as low
Cemmaes13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes13_grframelong_sum$max)
Cemmaes13_gr_lw_ref
#number of sites which would be classified as high
Cemmaes13_gr_high_ref <- sum( Cemmaes13_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes13_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes13_gr_mod_ref <- 1000 - (Cemmaes13_gr_high_ref + Cemmaes13_gr_lw_ref)
Cemmaes13_gr_mod_ref

#14 detectors
Cemmaes14_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Cemmaes14_grframe<-data.frame(Cemmaes14_gr, samp2)
Cemmaes14_grframelong <- melt(Cemmaes14_grframe,id.vars="samp2")
Cemmaes14_grframelong_sum <- ddply(Cemmaes14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes14_gr_max <- sum(Cemmaes14_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes14_gr_max
Cemmaes14_gr_pres <- sum(Cemmaes14_grframelong_sum $max > 0)
Cemmaes14_gr_pres

#number of sites which would be classified as low
Cemmaes14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes14_grframelong_sum$max)
Cemmaes14_gr_lw_ref
#number of sites which would be classified as high
Cemmaes14_gr_high_ref <- sum( Cemmaes14_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes14_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes14_gr_mod_ref <- 1000 - (Cemmaes14_gr_high_ref + Cemmaes14_gr_lw_ref)
Cemmaes14_gr_mod_ref

#15 detectors
Cemmaes15_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Cemmaes15_grframe<-data.frame(Cemmaes15_gr, samp2)
Cemmaes15_grframelong <- melt(Cemmaes15_grframe,id.vars="samp2")
Cemmaes15_grframelong_sum <- ddply(Cemmaes15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes15_gr_max <- sum(Cemmaes15_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes15_gr_max
Cemmaes15_gr_pres <- sum(Cemmaes15_grframelong_sum $max > 0)
Cemmaes15_gr_pres

#number of sites which would be classified as low
Cemmaes15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes15_grframelong_sum$max)
Cemmaes15_gr_lw_ref
#number of sites which would be classified as high
Cemmaes15_gr_high_ref <- sum( Cemmaes15_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes15_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes15_gr_mod_ref <- 1000 - (Cemmaes15_gr_high_ref + Cemmaes15_gr_lw_ref)
Cemmaes15_gr_mod_ref

#16 detectors
Cemmaes16_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Cemmaes16_grframe<-data.frame(Cemmaes16_gr, samp2)
Cemmaes16_grframelong <- melt(Cemmaes16_grframe,id.vars="samp2")
Cemmaes16_grframelong_sum <- ddply(Cemmaes16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes16_gr_max <- sum(Cemmaes16_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes16_gr_max
Cemmaes16_gr_pres <- sum(Cemmaes16_grframelong_sum $max > 0)
Cemmaes16_gr_pres

#number of sites which would be classified as low
Cemmaes16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes16_grframelong_sum$max)
Cemmaes16_gr_lw_ref
#number of sites which would be classified as high
Cemmaes16_gr_high_ref <- sum( Cemmaes16_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes16_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes16_gr_mod_ref <- 1000 - (Cemmaes16_gr_high_ref + Cemmaes16_gr_lw_ref)
Cemmaes16_gr_mod_ref

#17 detectors
Cemmaes17_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Cemmaes17_grframe<-data.frame(Cemmaes17_gr, samp2)
Cemmaes17_grframelong <- melt(Cemmaes17_grframe,id.vars="samp2")
Cemmaes17_grframelong_sum <- ddply(Cemmaes17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes17_gr_max <- sum(Cemmaes17_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes17_gr_max
Cemmaes17_gr_pres <- sum(Cemmaes17_grframelong_sum $max > 0)
Cemmaes17_gr_pres

#number of sites which would be classified as low
Cemmaes17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes17_grframelong_sum$max)
Cemmaes17_gr_lw_ref
#number of sites which would be classified as high
Cemmaes17_gr_high_ref <- sum( Cemmaes17_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes17_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes17_gr_mod_ref <- 1000 - (Cemmaes17_gr_high_ref + Cemmaes17_gr_lw_ref)
Cemmaes17_gr_mod_ref

#18 detectors
Cemmaes18_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Cemmaes18_grframe<-data.frame(Cemmaes18_gr, samp2)
Cemmaes18_grframelong <- melt(Cemmaes18_grframe,id.vars="samp2")
Cemmaes18_grframelong_sum <- ddply(Cemmaes18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes18_gr_max <- sum(Cemmaes18_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes18_gr_max
Cemmaes18_gr_pres <- sum(Cemmaes18_grframelong_sum $max > 0)
Cemmaes18_gr_pres

#number of sites which would be classified as low
Cemmaes18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes18_grframelong_sum$max)
Cemmaes18_gr_lw_ref
#number of sites which would be classified as high
Cemmaes18_gr_high_ref <- sum( Cemmaes18_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes18_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes18_gr_mod_ref <- 1000 - (Cemmaes18_gr_high_ref + Cemmaes18_gr_lw_ref)
Cemmaes18_gr_mod_ref

#19 detectors
Cemmaes19_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Cemmaes19_grframe<-data.frame(Cemmaes19_gr, samp2)
Cemmaes19_grframelong <- melt(Cemmaes19_grframe,id.vars="samp2")
Cemmaes19_grframelong_sum <- ddply(Cemmaes19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes19_gr_max <- sum(Cemmaes19_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes19_gr_max
Cemmaes19_gr_pres <- sum(Cemmaes19_grframelong_sum $max > 0)
Cemmaes19_gr_pres

#number of sites which would be classified as low
Cemmaes19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes19_grframelong_sum$max)
Cemmaes19_gr_lw_ref
#number of sites which would be classified as high
Cemmaes19_gr_high_ref <- sum( Cemmaes19_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes19_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes19_gr_mod_ref <- 1000 - (Cemmaes19_gr_high_ref + Cemmaes19_gr_lw_ref)
Cemmaes19_gr_mod_ref

#20 detectors
Cemmaes20_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Cemmaes20_grframe<-data.frame(Cemmaes20_gr, samp2)
Cemmaes20_grframelong <- melt(Cemmaes20_grframe,id.vars="samp2")
Cemmaes20_grframelong_sum <- ddply(Cemmaes20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes20_gr_max <- sum(Cemmaes20_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes20_gr_max
Cemmaes20_gr_pres <- sum(Cemmaes20_grframelong_sum $max > 0)
Cemmaes20_gr_pres

#number of sites which would be classified as low
Cemmaes20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes20_grframelong_sum$max)
Cemmaes20_gr_lw_ref
#number of sites which would be classified as high
Cemmaes20_gr_high_ref <- sum( Cemmaes20_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes20_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes20_gr_mod_ref <- 1000 - (Cemmaes20_gr_high_ref + Cemmaes20_gr_lw_ref)
Cemmaes20_gr_mod_ref

#21 detectors
Cemmaes21_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Cemmaes21_grframe<-data.frame(Cemmaes21_gr, samp2)
Cemmaes21_grframelong <- melt(Cemmaes21_grframe,id.vars="samp2")
Cemmaes21_grframelong_sum <- ddply(Cemmaes21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes21_gr_max <- sum(Cemmaes21_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes21_gr_max
Cemmaes21_gr_pres <- sum(Cemmaes21_grframelong_sum $max > 0)
Cemmaes21_gr_pres

#number of sites which would be classified as low
Cemmaes21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes21_grframelong_sum$max)
Cemmaes21_gr_lw_ref
#number of sites which would be classified as high
Cemmaes21_gr_high_ref <- sum( Cemmaes21_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes21_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes21_gr_mod_ref <- 1000 - (Cemmaes21_gr_high_ref + Cemmaes21_gr_lw_ref)
Cemmaes21_gr_mod_ref

#22 detectors
Cemmaes22_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Cemmaes22_grframe<-data.frame(Cemmaes22_gr, samp2)
Cemmaes22_grframelong <- melt(Cemmaes22_grframe,id.vars="samp2")
Cemmaes22_grframelong_sum <- ddply(Cemmaes22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes22_gr_max <- sum(Cemmaes22_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes22_gr_max
Cemmaes22_gr_pres <- sum(Cemmaes22_grframelong_sum $max > 0)
Cemmaes22_gr_pres

#number of sites which would be classified as low
Cemmaes22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes22_grframelong_sum$max)
Cemmaes22_gr_lw_ref
#number of sites which would be classified as high
Cemmaes22_gr_high_ref <- sum( Cemmaes22_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes22_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes22_gr_mod_ref <- 1000 - (Cemmaes22_gr_high_ref + Cemmaes22_gr_lw_ref)
Cemmaes22_gr_mod_ref

#23 detectors
Cemmaes23_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Cemmaes23_grframe<-data.frame(Cemmaes23_gr, samp2)
Cemmaes23_grframelong <- melt(Cemmaes23_grframe,id.vars="samp2")
Cemmaes23_grframelong_sum <- ddply(Cemmaes23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes23_gr_max <- sum(Cemmaes23_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes23_gr_max
Cemmaes23_gr_pres <- sum(Cemmaes23_grframelong_sum $max > 0)
Cemmaes23_gr_pres

#number of sites which would be classified as low
Cemmaes23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes23_grframelong_sum$max)
Cemmaes23_gr_lw_ref
#number of sites which would be classified as high
Cemmaes23_gr_high_ref <- sum( Cemmaes23_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes23_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes23_gr_mod_ref <- 1000 - (Cemmaes23_gr_high_ref + Cemmaes23_gr_lw_ref)
Cemmaes23_gr_mod_ref

#24 detectors
Cemmaes24_gr<-(replicate(1000, (sample(Cemmaespipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Cemmaes24_grframe<-data.frame(Cemmaes24_gr, samp2)
Cemmaes24_grframelong <- melt(Cemmaes24_grframe,id.vars="samp2")
Cemmaes24_grframelong_sum <- ddply(Cemmaes24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Cemmaes24_gr_max <- sum(Cemmaes24_grframelong_sum $max > max20_Cemmaespipgr)
Cemmaes24_gr_max
Cemmaes24_gr_pres <- sum(Cemmaes24_grframelong_sum $max > 0)
Cemmaes24_gr_pres

#number of sites which would be classified as low
Cemmaes24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Cemmaes24_grframelong_sum$max)
Cemmaes24_gr_lw_ref
#number of sites which would be classified as high
Cemmaes24_gr_high_ref <- sum( Cemmaes24_grframelong_sum$max > allsppgr_ppip_ref_high)
Cemmaes24_gr_high_ref
#number of sites which would be classified as moderate
Cemmaes24_gr_mod_ref <- 1000 - (Cemmaes24_gr_high_ref + Cemmaes24_gr_lw_ref)
Cemmaes24_gr_mod_ref

Present<-c(Cemmaes1_gr_pres,Cemmaes2_gr_pres,
           Cemmaes3_gr_pres,Cemmaes4_gr_pres,
           Cemmaes5_gr_pres,Cemmaes6_gr_pres,
           Cemmaes7_gr_pres,Cemmaes8_gr_pres,
           Cemmaes9_gr_pres,Cemmaes10_gr_pres,
           Cemmaes11_gr_pres,Cemmaes12_gr_pres,
           Cemmaes13_gr_pres,Cemmaes14_gr_pres,
           Cemmaes15_gr_pres,Cemmaes16_gr_pres,
           Cemmaes17_gr_pres,Cemmaes18_gr_pres,
           Cemmaes19_gr_pres,Cemmaes20_gr_pres,
           Cemmaes21_gr_pres,Cemmaes22_gr_pres,
           Cemmaes23_gr_pres,Cemmaes24_gr_pres)


Maximum<-c(Cemmaes1_gr_max,Cemmaes2_gr_max,
           Cemmaes3_gr_max,Cemmaes4_gr_max,
           Cemmaes5_gr_max,Cemmaes6_gr_max,
           Cemmaes7_gr_max,Cemmaes8_gr_max,
           Cemmaes9_gr_max,Cemmaes10_gr_max,
           Cemmaes11_gr_max,Cemmaes12_gr_max,
           Cemmaes13_gr_max,Cemmaes14_gr_max,
           Cemmaes15_gr_max,Cemmaes16_gr_max,
           Cemmaes17_gr_max,Cemmaes18_gr_max,
           Cemmaes19_gr_max,Cemmaes20_gr_max,
           Cemmaes21_gr_max,Cemmaes22_gr_max,
           Cemmaes23_gr_max,Cemmaes24_gr_max)

Low<-c(Cemmaes1_gr_lw_ref, Cemmaes2_gr_lw_ref, Cemmaes3_gr_lw_ref,
       Cemmaes4_gr_lw_ref, Cemmaes5_gr_lw_ref, Cemmaes6_gr_lw_ref,
       Cemmaes7_gr_lw_ref, Cemmaes8_gr_lw_ref, Cemmaes9_gr_lw_ref,
       Cemmaes10_gr_lw_ref, Cemmaes11_gr_lw_ref, Cemmaes12_gr_lw_ref, 
       Cemmaes13_gr_lw_ref, Cemmaes14_gr_lw_ref, Cemmaes15_gr_lw_ref, 
       Cemmaes16_gr_lw_ref, Cemmaes17_gr_lw_ref, Cemmaes18_gr_lw_ref, 
       Cemmaes19_gr_lw_ref, Cemmaes20_gr_lw_ref, Cemmaes21_gr_lw_ref,
       Cemmaes22_gr_lw_ref,Cemmaes23_gr_lw_ref,Cemmaes24_gr_lw_ref)

Moderate<-c(Cemmaes1_gr_mod_ref, Cemmaes2_gr_mod_ref, Cemmaes3_gr_mod_ref,
            Cemmaes4_gr_mod_ref, Cemmaes5_gr_mod_ref, Cemmaes6_gr_mod_ref,
            Cemmaes7_gr_mod_ref, Cemmaes8_gr_mod_ref, Cemmaes9_gr_mod_ref,
            Cemmaes10_gr_mod_ref, Cemmaes11_gr_mod_ref, Cemmaes12_gr_mod_ref, 
            Cemmaes13_gr_mod_ref, Cemmaes14_gr_mod_ref, Cemmaes15_gr_mod_ref, 
            Cemmaes16_gr_mod_ref, Cemmaes17_gr_mod_ref, Cemmaes18_gr_mod_ref, 
            Cemmaes19_gr_mod_ref, Cemmaes20_gr_mod_ref, Cemmaes21_gr_mod_ref,
            Cemmaes22_gr_mod_ref,Cemmaes23_gr_mod_ref,Cemmaes24_gr_mod_ref)

High<-c(Cemmaes1_gr_high_ref, Cemmaes2_gr_high_ref, Cemmaes3_gr_high_ref,
        Cemmaes4_gr_high_ref, Cemmaes5_gr_high_ref, Cemmaes6_gr_high_ref,
        Cemmaes7_gr_high_ref, Cemmaes8_gr_high_ref, Cemmaes9_gr_high_ref,
        Cemmaes10_gr_high_ref, Cemmaes11_gr_high_ref, Cemmaes12_gr_high_ref, 
        Cemmaes13_gr_high_ref, Cemmaes14_gr_high_ref, Cemmaes15_gr_high_ref, 
        Cemmaes16_gr_high_ref, Cemmaes17_gr_high_ref, Cemmaes18_gr_high_ref, 
        Cemmaes19_gr_high_ref, Cemmaes20_gr_high_ref, Cemmaes21_gr_high_ref,
        Cemmaes22_gr_high_ref,Cemmaes23_gr_high_ref,Cemmaes24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Cemmaesgr",24)
Lowsite <- Cemmaeslow
Modsite <- Cemmaesmod
Highsite <-Cemmaeshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Cemmaesgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##Conisholme

Conisholmepipgr<-subset(allspp4gr_ppip, Site=="Conisholme")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Conisholmepipgr<-max(Conisholmepipgr$Passes)

#calculate 20% from maximum nightly record

max20_Conisholmepipgr<- (max_Conisholmepipgr/100)*80

##calculate the site classification (reference range)

Conisholmehigh<- max_Conisholmepipgr > allsppgr_ppip_ref_high

Conisholmelow<- allsppgr_ppip_ref_low > max_Conisholmepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Conisholmepipgr
Conisholmemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Conisholme1_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 1, replace=F))))
Conisholme1_gr_max <- sum(Conisholme1_gr > max20_Conisholmepipgr)
Conisholme1_gr_max
Conisholme1_gr_pres <- sum(Conisholme1_gr > 0)
Conisholme1_gr_pres
#number of sites which would be classified as low
Conisholme1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme1_gr)
Conisholme1_gr_lw_ref
#number of sites which would be classified as high
Conisholme1_gr_high_ref <- sum( Conisholme1_gr > allsppgr_ppip_ref_high)
Conisholme1_gr_high_ref
#number of sites which would be classified as moderate
Conisholme1_gr_mod_ref <- 1000 - (Conisholme1_gr_high_ref + Conisholme1_gr_lw_ref)
Conisholme1_gr_mod_ref


#2 nights
Conisholme2_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Conisholme2_grframe<-data.frame(Conisholme2_gr, samp2)
Conisholme2_grframelong <- melt(Conisholme2_grframe,id.vars="samp2")
Conisholme2_grframelong_sum <- ddply(Conisholme2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme2_gr_max <- sum(Conisholme2_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme2_gr_max
Conisholme2_gr_pres <- sum(Conisholme2_grframelong_sum $max > 0)
Conisholme2_gr_pres

#number of sites which would be classified as low
Conisholme2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme2_grframelong_sum$max)
Conisholme2_gr_lw_ref
#number of sites which would be classified as high
Conisholme2_gr_high_ref <- sum( Conisholme2_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme2_gr_high_ref
#number of sites which would be classified as moderate
Conisholme2_gr_mod_ref <- 1000 - (Conisholme2_gr_high_ref + Conisholme2_gr_lw_ref)
Conisholme2_gr_mod_ref


#3 nights
Conisholme3_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Conisholme3_grframe<-data.frame(Conisholme3_gr, samp2)
Conisholme3_grframelong <- melt(Conisholme3_grframe,id.vars="samp2")
Conisholme3_grframelong_sum <- ddply(Conisholme3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme3_gr_max <- sum(Conisholme3_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme3_gr_max
Conisholme3_gr_pres <- sum(Conisholme3_grframelong_sum $max > 0)
Conisholme3_gr_pres

#number of sites which would be classified as low
Conisholme3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme3_grframelong_sum$max)
Conisholme3_gr_lw_ref
#number of sites which would be classified as high
Conisholme3_gr_high_ref <- sum( Conisholme3_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme3_gr_high_ref
#number of sites which would be classified as moderate
Conisholme3_gr_mod_ref <- 1000 - (Conisholme3_gr_high_ref + Conisholme3_gr_lw_ref)
Conisholme3_gr_mod_ref

#4 nights
Conisholme4_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Conisholme4_grframe<-data.frame(Conisholme4_gr, samp2)
Conisholme4_grframelong <- melt(Conisholme4_grframe,id.vars="samp2")
Conisholme4_grframelong_sum <- ddply(Conisholme4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme4_gr_max <- sum(Conisholme4_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme4_gr_max
Conisholme4_gr_pres <- sum(Conisholme4_grframelong_sum $max > 0)
Conisholme4_gr_pres

#number of sites which would be classified as low
Conisholme4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme4_grframelong_sum$max)
Conisholme4_gr_lw_ref
#number of sites which would be classified as high
Conisholme4_gr_high_ref <- sum( Conisholme4_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme4_gr_high_ref
#number of sites which would be classified as moderate
Conisholme4_gr_mod_ref <- 1000 - (Conisholme4_gr_high_ref + Conisholme4_gr_lw_ref)
Conisholme4_gr_mod_ref

#5 nights
Conisholme5_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Conisholme5_grframe<-data.frame(Conisholme5_gr, samp2)
Conisholme5_grframelong <- melt(Conisholme5_grframe,id.vars="samp2")
Conisholme5_grframelong_sum <- ddply(Conisholme5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme5_gr_max <- sum(Conisholme5_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme5_gr_max
Conisholme5_gr_pres <- sum(Conisholme5_grframelong_sum $max > 0)
Conisholme5_gr_pres

#number of sites which would be classified as low
Conisholme5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme5_grframelong_sum$max)
Conisholme5_gr_lw_ref
#number of sites which would be classified as high
Conisholme5_gr_high_ref <- sum( Conisholme5_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme5_gr_high_ref
#number of sites which would be classified as moderate
Conisholme5_gr_mod_ref <- 1000 - (Conisholme5_gr_high_ref + Conisholme5_gr_lw_ref)
Conisholme5_gr_mod_ref

#6 nights
Conisholme6_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Conisholme6_grframe<-data.frame(Conisholme6_gr, samp2)
Conisholme6_grframelong <- melt(Conisholme6_grframe,id.vars="samp2")
Conisholme6_grframelong_sum <- ddply(Conisholme6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme6_gr_max <- sum(Conisholme6_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme6_gr_max
Conisholme6_gr_pres <- sum(Conisholme6_grframelong_sum $max > 0)
Conisholme6_gr_pres

#number of sites which would be classified as low
Conisholme6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme6_grframelong_sum$max)
Conisholme6_gr_lw_ref
#number of sites which would be classified as high
Conisholme6_gr_high_ref <- sum( Conisholme6_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme6_gr_high_ref
#number of sites which would be classified as moderate
Conisholme6_gr_mod_ref <- 1000 - (Conisholme6_gr_high_ref + Conisholme6_gr_lw_ref)
Conisholme6_gr_mod_ref

#7 nights
Conisholme7_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Conisholme7_grframe<-data.frame(Conisholme7_gr, samp2)
Conisholme7_grframelong <- melt(Conisholme7_grframe,id.vars="samp2")
Conisholme7_grframelong_sum <- ddply(Conisholme7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme7_gr_max <- sum(Conisholme7_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme7_gr_max
Conisholme7_gr_pres <- sum(Conisholme7_grframelong_sum $max > 0)
Conisholme7_gr_pres

#number of sites which would be classified as low
Conisholme7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme7_grframelong_sum$max)
Conisholme7_gr_lw_ref
#number of sites which would be classified as high
Conisholme7_gr_high_ref <- sum( Conisholme7_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme7_gr_high_ref
#number of sites which would be classified as moderate
Conisholme7_gr_mod_ref <- 1000 - (Conisholme7_gr_high_ref + Conisholme7_gr_lw_ref)
Conisholme7_gr_mod_ref

#8 nights
Conisholme8_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Conisholme8_grframe<-data.frame(Conisholme8_gr, samp2)
Conisholme8_grframelong <- melt(Conisholme8_grframe,id.vars="samp2")
Conisholme8_grframelong_sum <- ddply(Conisholme8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme8_gr_max <- sum(Conisholme8_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme8_gr_max
Conisholme8_gr_pres <- sum(Conisholme8_grframelong_sum $max > 0)
Conisholme8_gr_pres

#number of sites which would be classified as low
Conisholme8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme8_grframelong_sum$max)
Conisholme8_gr_lw_ref
#number of sites which would be classified as high
Conisholme8_gr_high_ref <- sum( Conisholme8_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme8_gr_high_ref
#number of sites which would be classified as moderate
Conisholme8_gr_mod_ref <- 1000 - (Conisholme8_gr_high_ref + Conisholme8_gr_lw_ref)
Conisholme8_gr_mod_ref

#9 nights
Conisholme9_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Conisholme9_grframe<-data.frame(Conisholme9_gr, samp2)
Conisholme9_grframelong <- melt(Conisholme9_grframe,id.vars="samp2")
Conisholme9_grframelong_sum <- ddply(Conisholme9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Conisholme9_gr_max <- sum(Conisholme9_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme9_gr_max
Conisholme9_gr_pres <- sum(Conisholme9_grframelong_sum $max > 0)
Conisholme9_gr_pres

#number of sites which would be classified as low
Conisholme9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme9_grframelong_sum$max)
Conisholme9_gr_lw_ref
#number of sites which would be classified as high
Conisholme9_gr_high_ref <- sum( Conisholme9_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme9_gr_high_ref
#number of sites which would be classified as moderate
Conisholme9_gr_mod_ref <- 1000 - (Conisholme9_gr_high_ref + Conisholme9_gr_lw_ref)
Conisholme9_gr_mod_ref

#10 detectors
Conisholme10_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Conisholme10_grframe<-data.frame(Conisholme10_gr, samp2)
Conisholme10_grframelong <- melt(Conisholme10_grframe,id.vars="samp2")
Conisholme10_grframelong_sum <- ddply(Conisholme10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme10_gr_max <- sum(Conisholme10_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme10_gr_max
Conisholme10_gr_pres <- sum(Conisholme10_grframelong_sum $max > 0)
Conisholme10_gr_pres

#number of sites which would be classified as low
Conisholme10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme10_grframelong_sum$max)
Conisholme10_gr_lw_ref
#number of sites which would be classified as high
Conisholme10_gr_high_ref <- sum( Conisholme10_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme10_gr_high_ref
#number of sites which would be classified as moderate
Conisholme10_gr_mod_ref <- 1000 - (Conisholme10_gr_high_ref + Conisholme10_gr_lw_ref)
Conisholme10_gr_mod_ref

#11 detectors
Conisholme11_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Conisholme11_grframe<-data.frame(Conisholme11_gr, samp2)
Conisholme11_grframelong <- melt(Conisholme11_grframe,id.vars="samp2")
Conisholme11_grframelong_sum <- ddply(Conisholme11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme11_gr_max <- sum(Conisholme11_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme11_gr_max
Conisholme11_gr_pres <- sum(Conisholme11_grframelong_sum $max > 0)
Conisholme11_gr_pres

#number of sites which would be classified as low
Conisholme11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme11_grframelong_sum$max)
Conisholme11_gr_lw_ref
#number of sites which would be classified as high
Conisholme11_gr_high_ref <- sum( Conisholme11_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme11_gr_high_ref
#number of sites which would be classified as moderate
Conisholme11_gr_mod_ref <- 1000 - (Conisholme11_gr_high_ref + Conisholme11_gr_lw_ref)
Conisholme11_gr_mod_ref

#12 detectors
Conisholme12_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Conisholme12_grframe<-data.frame(Conisholme12_gr, samp2)
Conisholme12_grframelong <- melt(Conisholme12_grframe,id.vars="samp2")
Conisholme12_grframelong_sum <- ddply(Conisholme12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme12_gr_max <- sum(Conisholme12_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme12_gr_max
Conisholme12_gr_pres <- sum(Conisholme12_grframelong_sum $max > 0)
Conisholme12_gr_pres

#number of sites which would be classified as low
Conisholme12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme12_grframelong_sum$max)
Conisholme12_gr_lw_ref
#number of sites which would be classified as high
Conisholme12_gr_high_ref <- sum( Conisholme12_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme12_gr_high_ref
#number of sites which would be classified as moderate
Conisholme12_gr_mod_ref <- 1000 - (Conisholme12_gr_high_ref + Conisholme12_gr_lw_ref)
Conisholme12_gr_mod_ref

#13 detectors
Conisholme13_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Conisholme13_grframe<-data.frame(Conisholme13_gr, samp2)
Conisholme13_grframelong <- melt(Conisholme13_grframe,id.vars="samp2")
Conisholme13_grframelong_sum <- ddply(Conisholme13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme13_gr_max <- sum(Conisholme13_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme13_gr_max
Conisholme13_gr_pres <- sum(Conisholme13_grframelong_sum $max > 0)
Conisholme13_gr_pres

#number of sites which would be classified as low
Conisholme13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme13_grframelong_sum$max)
Conisholme13_gr_lw_ref
#number of sites which would be classified as high
Conisholme13_gr_high_ref <- sum( Conisholme13_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme13_gr_high_ref
#number of sites which would be classified as moderate
Conisholme13_gr_mod_ref <- 1000 - (Conisholme13_gr_high_ref + Conisholme13_gr_lw_ref)
Conisholme13_gr_mod_ref

#14 detectors
Conisholme14_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Conisholme14_grframe<-data.frame(Conisholme14_gr, samp2)
Conisholme14_grframelong <- melt(Conisholme14_grframe,id.vars="samp2")
Conisholme14_grframelong_sum <- ddply(Conisholme14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme14_gr_max <- sum(Conisholme14_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme14_gr_max
Conisholme14_gr_pres <- sum(Conisholme14_grframelong_sum $max > 0)
Conisholme14_gr_pres

#number of sites which would be classified as low
Conisholme14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme14_grframelong_sum$max)
Conisholme14_gr_lw_ref
#number of sites which would be classified as high
Conisholme14_gr_high_ref <- sum( Conisholme14_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme14_gr_high_ref
#number of sites which would be classified as moderate
Conisholme14_gr_mod_ref <- 1000 - (Conisholme14_gr_high_ref + Conisholme14_gr_lw_ref)
Conisholme14_gr_mod_ref

#15 detectors
Conisholme15_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Conisholme15_grframe<-data.frame(Conisholme15_gr, samp2)
Conisholme15_grframelong <- melt(Conisholme15_grframe,id.vars="samp2")
Conisholme15_grframelong_sum <- ddply(Conisholme15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme15_gr_max <- sum(Conisholme15_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme15_gr_max
Conisholme15_gr_pres <- sum(Conisholme15_grframelong_sum $max > 0)
Conisholme15_gr_pres

#number of sites which would be classified as low
Conisholme15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme15_grframelong_sum$max)
Conisholme15_gr_lw_ref
#number of sites which would be classified as high
Conisholme15_gr_high_ref <- sum( Conisholme15_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme15_gr_high_ref
#number of sites which would be classified as moderate
Conisholme15_gr_mod_ref <- 1000 - (Conisholme15_gr_high_ref + Conisholme15_gr_lw_ref)
Conisholme15_gr_mod_ref

#16 detectors
Conisholme16_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Conisholme16_grframe<-data.frame(Conisholme16_gr, samp2)
Conisholme16_grframelong <- melt(Conisholme16_grframe,id.vars="samp2")
Conisholme16_grframelong_sum <- ddply(Conisholme16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme16_gr_max <- sum(Conisholme16_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme16_gr_max
Conisholme16_gr_pres <- sum(Conisholme16_grframelong_sum $max > 0)
Conisholme16_gr_pres

#number of sites which would be classified as low
Conisholme16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme16_grframelong_sum$max)
Conisholme16_gr_lw_ref
#number of sites which would be classified as high
Conisholme16_gr_high_ref <- sum( Conisholme16_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme16_gr_high_ref
#number of sites which would be classified as moderate
Conisholme16_gr_mod_ref <- 1000 - (Conisholme16_gr_high_ref + Conisholme16_gr_lw_ref)
Conisholme16_gr_mod_ref

#17 detectors
Conisholme17_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Conisholme17_grframe<-data.frame(Conisholme17_gr, samp2)
Conisholme17_grframelong <- melt(Conisholme17_grframe,id.vars="samp2")
Conisholme17_grframelong_sum <- ddply(Conisholme17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme17_gr_max <- sum(Conisholme17_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme17_gr_max
Conisholme17_gr_pres <- sum(Conisholme17_grframelong_sum $max > 0)
Conisholme17_gr_pres

#number of sites which would be classified as low
Conisholme17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme17_grframelong_sum$max)
Conisholme17_gr_lw_ref
#number of sites which would be classified as high
Conisholme17_gr_high_ref <- sum( Conisholme17_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme17_gr_high_ref
#number of sites which would be classified as moderate
Conisholme17_gr_mod_ref <- 1000 - (Conisholme17_gr_high_ref + Conisholme17_gr_lw_ref)
Conisholme17_gr_mod_ref

#18 detectors
Conisholme18_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Conisholme18_grframe<-data.frame(Conisholme18_gr, samp2)
Conisholme18_grframelong <- melt(Conisholme18_grframe,id.vars="samp2")
Conisholme18_grframelong_sum <- ddply(Conisholme18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme18_gr_max <- sum(Conisholme18_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme18_gr_max
Conisholme18_gr_pres <- sum(Conisholme18_grframelong_sum $max > 0)
Conisholme18_gr_pres

#number of sites which would be classified as low
Conisholme18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme18_grframelong_sum$max)
Conisholme18_gr_lw_ref
#number of sites which would be classified as high
Conisholme18_gr_high_ref <- sum( Conisholme18_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme18_gr_high_ref
#number of sites which would be classified as moderate
Conisholme18_gr_mod_ref <- 1000 - (Conisholme18_gr_high_ref + Conisholme18_gr_lw_ref)
Conisholme18_gr_mod_ref

#19 detectors
Conisholme19_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Conisholme19_grframe<-data.frame(Conisholme19_gr, samp2)
Conisholme19_grframelong <- melt(Conisholme19_grframe,id.vars="samp2")
Conisholme19_grframelong_sum <- ddply(Conisholme19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme19_gr_max <- sum(Conisholme19_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme19_gr_max
Conisholme19_gr_pres <- sum(Conisholme19_grframelong_sum $max > 0)
Conisholme19_gr_pres

#number of sites which would be classified as low
Conisholme19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme19_grframelong_sum$max)
Conisholme19_gr_lw_ref
#number of sites which would be classified as high
Conisholme19_gr_high_ref <- sum( Conisholme19_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme19_gr_high_ref
#number of sites which would be classified as moderate
Conisholme19_gr_mod_ref <- 1000 - (Conisholme19_gr_high_ref + Conisholme19_gr_lw_ref)
Conisholme19_gr_mod_ref

#20 detectors
Conisholme20_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Conisholme20_grframe<-data.frame(Conisholme20_gr, samp2)
Conisholme20_grframelong <- melt(Conisholme20_grframe,id.vars="samp2")
Conisholme20_grframelong_sum <- ddply(Conisholme20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme20_gr_max <- sum(Conisholme20_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme20_gr_max
Conisholme20_gr_pres <- sum(Conisholme20_grframelong_sum $max > 0)
Conisholme20_gr_pres

#number of sites which would be classified as low
Conisholme20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme20_grframelong_sum$max)
Conisholme20_gr_lw_ref
#number of sites which would be classified as high
Conisholme20_gr_high_ref <- sum( Conisholme20_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme20_gr_high_ref
#number of sites which would be classified as moderate
Conisholme20_gr_mod_ref <- 1000 - (Conisholme20_gr_high_ref + Conisholme20_gr_lw_ref)
Conisholme20_gr_mod_ref

#21 detectors
Conisholme21_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Conisholme21_grframe<-data.frame(Conisholme21_gr, samp2)
Conisholme21_grframelong <- melt(Conisholme21_grframe,id.vars="samp2")
Conisholme21_grframelong_sum <- ddply(Conisholme21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme21_gr_max <- sum(Conisholme21_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme21_gr_max
Conisholme21_gr_pres <- sum(Conisholme21_grframelong_sum $max > 0)
Conisholme21_gr_pres

#number of sites which would be classified as low
Conisholme21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme21_grframelong_sum$max)
Conisholme21_gr_lw_ref
#number of sites which would be classified as high
Conisholme21_gr_high_ref <- sum( Conisholme21_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme21_gr_high_ref
#number of sites which would be classified as moderate
Conisholme21_gr_mod_ref <- 1000 - (Conisholme21_gr_high_ref + Conisholme21_gr_lw_ref)
Conisholme21_gr_mod_ref

#22 detectors
Conisholme22_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Conisholme22_grframe<-data.frame(Conisholme22_gr, samp2)
Conisholme22_grframelong <- melt(Conisholme22_grframe,id.vars="samp2")
Conisholme22_grframelong_sum <- ddply(Conisholme22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme22_gr_max <- sum(Conisholme22_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme22_gr_max
Conisholme22_gr_pres <- sum(Conisholme22_grframelong_sum $max > 0)
Conisholme22_gr_pres

#number of sites which would be classified as low
Conisholme22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme22_grframelong_sum$max)
Conisholme22_gr_lw_ref
#number of sites which would be classified as high
Conisholme22_gr_high_ref <- sum( Conisholme22_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme22_gr_high_ref
#number of sites which would be classified as moderate
Conisholme22_gr_mod_ref <- 1000 - (Conisholme22_gr_high_ref + Conisholme22_gr_lw_ref)
Conisholme22_gr_mod_ref

#23 detectors
Conisholme23_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Conisholme23_grframe<-data.frame(Conisholme23_gr, samp2)
Conisholme23_grframelong <- melt(Conisholme23_grframe,id.vars="samp2")
Conisholme23_grframelong_sum <- ddply(Conisholme23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme23_gr_max <- sum(Conisholme23_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme23_gr_max
Conisholme23_gr_pres <- sum(Conisholme23_grframelong_sum $max > 0)
Conisholme23_gr_pres

#number of sites which would be classified as low
Conisholme23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme23_grframelong_sum$max)
Conisholme23_gr_lw_ref
#number of sites which would be classified as high
Conisholme23_gr_high_ref <- sum( Conisholme23_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme23_gr_high_ref
#number of sites which would be classified as moderate
Conisholme23_gr_mod_ref <- 1000 - (Conisholme23_gr_high_ref + Conisholme23_gr_lw_ref)
Conisholme23_gr_mod_ref

#24 detectors
Conisholme24_gr<-(replicate(1000, (sample(Conisholmepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Conisholme24_grframe<-data.frame(Conisholme24_gr, samp2)
Conisholme24_grframelong <- melt(Conisholme24_grframe,id.vars="samp2")
Conisholme24_grframelong_sum <- ddply(Conisholme24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Conisholme24_gr_max <- sum(Conisholme24_grframelong_sum $max > max20_Conisholmepipgr)
Conisholme24_gr_max
Conisholme24_gr_pres <- sum(Conisholme24_grframelong_sum $max > 0)
Conisholme24_gr_pres

#number of sites which would be classified as low
Conisholme24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Conisholme24_grframelong_sum$max)
Conisholme24_gr_lw_ref
#number of sites which would be classified as high
Conisholme24_gr_high_ref <- sum( Conisholme24_grframelong_sum$max > allsppgr_ppip_ref_high)
Conisholme24_gr_high_ref
#number of sites which would be classified as moderate
Conisholme24_gr_mod_ref <- 1000 - (Conisholme24_gr_high_ref + Conisholme24_gr_lw_ref)
Conisholme24_gr_mod_ref

Present<-c(Conisholme1_gr_pres,Conisholme2_gr_pres,
           Conisholme3_gr_pres,Conisholme4_gr_pres,
           Conisholme5_gr_pres,Conisholme6_gr_pres,
           Conisholme7_gr_pres,Conisholme8_gr_pres,
           Conisholme9_gr_pres,Conisholme10_gr_pres,
           Conisholme11_gr_pres,Conisholme12_gr_pres,
           Conisholme13_gr_pres,Conisholme14_gr_pres,
           Conisholme15_gr_pres,Conisholme16_gr_pres,
           Conisholme17_gr_pres,Conisholme18_gr_pres,
           Conisholme19_gr_pres,Conisholme20_gr_pres,
           Conisholme21_gr_pres,Conisholme22_gr_pres,
           Conisholme23_gr_pres,Conisholme24_gr_pres)


Maximum<-c(Conisholme1_gr_max,Conisholme2_gr_max,
           Conisholme3_gr_max,Conisholme4_gr_max,
           Conisholme5_gr_max,Conisholme6_gr_max,
           Conisholme7_gr_max,Conisholme8_gr_max,
           Conisholme9_gr_max,Conisholme10_gr_max,
           Conisholme11_gr_max,Conisholme12_gr_max,
           Conisholme13_gr_max,Conisholme14_gr_max,
           Conisholme15_gr_max,Conisholme16_gr_max,
           Conisholme17_gr_max,Conisholme18_gr_max,
           Conisholme19_gr_max,Conisholme20_gr_max,
           Conisholme21_gr_max,Conisholme22_gr_max,
           Conisholme23_gr_max,Conisholme24_gr_max)

Low<-c(Conisholme1_gr_lw_ref, Conisholme2_gr_lw_ref, Conisholme3_gr_lw_ref,
       Conisholme4_gr_lw_ref, Conisholme5_gr_lw_ref, Conisholme6_gr_lw_ref,
       Conisholme7_gr_lw_ref, Conisholme8_gr_lw_ref, Conisholme9_gr_lw_ref,
       Conisholme10_gr_lw_ref, Conisholme11_gr_lw_ref, Conisholme12_gr_lw_ref, 
       Conisholme13_gr_lw_ref, Conisholme14_gr_lw_ref, Conisholme15_gr_lw_ref, 
       Conisholme16_gr_lw_ref, Conisholme17_gr_lw_ref, Conisholme18_gr_lw_ref, 
       Conisholme19_gr_lw_ref, Conisholme20_gr_lw_ref, Conisholme21_gr_lw_ref,
       Conisholme22_gr_lw_ref,Conisholme23_gr_lw_ref,Conisholme24_gr_lw_ref)

Moderate<-c(Conisholme1_gr_mod_ref, Conisholme2_gr_mod_ref, Conisholme3_gr_mod_ref,
            Conisholme4_gr_mod_ref, Conisholme5_gr_mod_ref, Conisholme6_gr_mod_ref,
            Conisholme7_gr_mod_ref, Conisholme8_gr_mod_ref, Conisholme9_gr_mod_ref,
            Conisholme10_gr_mod_ref, Conisholme11_gr_mod_ref, Conisholme12_gr_mod_ref, 
            Conisholme13_gr_mod_ref, Conisholme14_gr_mod_ref, Conisholme15_gr_mod_ref, 
            Conisholme16_gr_mod_ref, Conisholme17_gr_mod_ref, Conisholme18_gr_mod_ref, 
            Conisholme19_gr_mod_ref, Conisholme20_gr_mod_ref, Conisholme21_gr_mod_ref,
            Conisholme22_gr_mod_ref,Conisholme23_gr_mod_ref,Conisholme24_gr_mod_ref)

High<-c(Conisholme1_gr_high_ref, Conisholme2_gr_high_ref, Conisholme3_gr_high_ref,
        Conisholme4_gr_high_ref, Conisholme5_gr_high_ref, Conisholme6_gr_high_ref,
        Conisholme7_gr_high_ref, Conisholme8_gr_high_ref, Conisholme9_gr_high_ref,
        Conisholme10_gr_high_ref, Conisholme11_gr_high_ref, Conisholme12_gr_high_ref, 
        Conisholme13_gr_high_ref, Conisholme14_gr_high_ref, Conisholme15_gr_high_ref, 
        Conisholme16_gr_high_ref, Conisholme17_gr_high_ref, Conisholme18_gr_high_ref, 
        Conisholme19_gr_high_ref, Conisholme20_gr_high_ref, Conisholme21_gr_high_ref,
        Conisholme22_gr_high_ref,Conisholme23_gr_high_ref,Conisholme24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Conisholmegr",24)
Lowsite <- Conisholmelow
Modsite <- Conisholmemod
Highsite <-Conisholmehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Conisholmegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Craigengelt

Craigengeltpipgr<-subset(allspp4gr_ppip, Site=="Craigengelt")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Craigengeltpipgr<-max(Craigengeltpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Craigengeltpipgr<- (max_Craigengeltpipgr/100)*80

##calculate the site classification (reference range)

Craigengelthigh<- max_Craigengeltpipgr > allsppgr_ppip_ref_high

Craigengeltlow<- allsppgr_ppip_ref_low > max_Craigengeltpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Craigengeltpipgr
Craigengeltmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Craigengelt1_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 1, replace=F))))
Craigengelt1_gr_max <- sum(Craigengelt1_gr > max20_Craigengeltpipgr)
Craigengelt1_gr_max
Craigengelt1_gr_pres <- sum(Craigengelt1_gr > 0)
Craigengelt1_gr_pres
#number of sites which would be classified as low
Craigengelt1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt1_gr)
Craigengelt1_gr_lw_ref
#number of sites which would be classified as high
Craigengelt1_gr_high_ref <- sum( Craigengelt1_gr > allsppgr_ppip_ref_high)
Craigengelt1_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt1_gr_mod_ref <- 1000 - (Craigengelt1_gr_high_ref + Craigengelt1_gr_lw_ref)
Craigengelt1_gr_mod_ref


#2 nights
Craigengelt2_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Craigengelt2_grframe<-data.frame(Craigengelt2_gr, samp2)
Craigengelt2_grframelong <- melt(Craigengelt2_grframe,id.vars="samp2")
Craigengelt2_grframelong_sum <- ddply(Craigengelt2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt2_gr_max <- sum(Craigengelt2_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt2_gr_max
Craigengelt2_gr_pres <- sum(Craigengelt2_grframelong_sum $max > 0)
Craigengelt2_gr_pres

#number of sites which would be classified as low
Craigengelt2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt2_grframelong_sum$max)
Craigengelt2_gr_lw_ref
#number of sites which would be classified as high
Craigengelt2_gr_high_ref <- sum( Craigengelt2_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt2_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt2_gr_mod_ref <- 1000 - (Craigengelt2_gr_high_ref + Craigengelt2_gr_lw_ref)
Craigengelt2_gr_mod_ref


#3 nights
Craigengelt3_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Craigengelt3_grframe<-data.frame(Craigengelt3_gr, samp2)
Craigengelt3_grframelong <- melt(Craigengelt3_grframe,id.vars="samp2")
Craigengelt3_grframelong_sum <- ddply(Craigengelt3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt3_gr_max <- sum(Craigengelt3_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt3_gr_max
Craigengelt3_gr_pres <- sum(Craigengelt3_grframelong_sum $max > 0)
Craigengelt3_gr_pres

#number of sites which would be classified as low
Craigengelt3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt3_grframelong_sum$max)
Craigengelt3_gr_lw_ref
#number of sites which would be classified as high
Craigengelt3_gr_high_ref <- sum( Craigengelt3_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt3_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt3_gr_mod_ref <- 1000 - (Craigengelt3_gr_high_ref + Craigengelt3_gr_lw_ref)
Craigengelt3_gr_mod_ref

#4 nights
Craigengelt4_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Craigengelt4_grframe<-data.frame(Craigengelt4_gr, samp2)
Craigengelt4_grframelong <- melt(Craigengelt4_grframe,id.vars="samp2")
Craigengelt4_grframelong_sum <- ddply(Craigengelt4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt4_gr_max <- sum(Craigengelt4_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt4_gr_max
Craigengelt4_gr_pres <- sum(Craigengelt4_grframelong_sum $max > 0)
Craigengelt4_gr_pres

#number of sites which would be classified as low
Craigengelt4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt4_grframelong_sum$max)
Craigengelt4_gr_lw_ref
#number of sites which would be classified as high
Craigengelt4_gr_high_ref <- sum( Craigengelt4_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt4_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt4_gr_mod_ref <- 1000 - (Craigengelt4_gr_high_ref + Craigengelt4_gr_lw_ref)
Craigengelt4_gr_mod_ref

#5 nights
Craigengelt5_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Craigengelt5_grframe<-data.frame(Craigengelt5_gr, samp2)
Craigengelt5_grframelong <- melt(Craigengelt5_grframe,id.vars="samp2")
Craigengelt5_grframelong_sum <- ddply(Craigengelt5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt5_gr_max <- sum(Craigengelt5_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt5_gr_max
Craigengelt5_gr_pres <- sum(Craigengelt5_grframelong_sum $max > 0)
Craigengelt5_gr_pres

#number of sites which would be classified as low
Craigengelt5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt5_grframelong_sum$max)
Craigengelt5_gr_lw_ref
#number of sites which would be classified as high
Craigengelt5_gr_high_ref <- sum( Craigengelt5_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt5_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt5_gr_mod_ref <- 1000 - (Craigengelt5_gr_high_ref + Craigengelt5_gr_lw_ref)
Craigengelt5_gr_mod_ref

#6 nights
Craigengelt6_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Craigengelt6_grframe<-data.frame(Craigengelt6_gr, samp2)
Craigengelt6_grframelong <- melt(Craigengelt6_grframe,id.vars="samp2")
Craigengelt6_grframelong_sum <- ddply(Craigengelt6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt6_gr_max <- sum(Craigengelt6_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt6_gr_max
Craigengelt6_gr_pres <- sum(Craigengelt6_grframelong_sum $max > 0)
Craigengelt6_gr_pres

#number of sites which would be classified as low
Craigengelt6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt6_grframelong_sum$max)
Craigengelt6_gr_lw_ref
#number of sites which would be classified as high
Craigengelt6_gr_high_ref <- sum( Craigengelt6_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt6_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt6_gr_mod_ref <- 1000 - (Craigengelt6_gr_high_ref + Craigengelt6_gr_lw_ref)
Craigengelt6_gr_mod_ref

#7 nights
Craigengelt7_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Craigengelt7_grframe<-data.frame(Craigengelt7_gr, samp2)
Craigengelt7_grframelong <- melt(Craigengelt7_grframe,id.vars="samp2")
Craigengelt7_grframelong_sum <- ddply(Craigengelt7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt7_gr_max <- sum(Craigengelt7_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt7_gr_max
Craigengelt7_gr_pres <- sum(Craigengelt7_grframelong_sum $max > 0)
Craigengelt7_gr_pres

#number of sites which would be classified as low
Craigengelt7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt7_grframelong_sum$max)
Craigengelt7_gr_lw_ref
#number of sites which would be classified as high
Craigengelt7_gr_high_ref <- sum( Craigengelt7_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt7_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt7_gr_mod_ref <- 1000 - (Craigengelt7_gr_high_ref + Craigengelt7_gr_lw_ref)
Craigengelt7_gr_mod_ref

#8 nights
Craigengelt8_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Craigengelt8_grframe<-data.frame(Craigengelt8_gr, samp2)
Craigengelt8_grframelong <- melt(Craigengelt8_grframe,id.vars="samp2")
Craigengelt8_grframelong_sum <- ddply(Craigengelt8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt8_gr_max <- sum(Craigengelt8_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt8_gr_max
Craigengelt8_gr_pres <- sum(Craigengelt8_grframelong_sum $max > 0)
Craigengelt8_gr_pres

#number of sites which would be classified as low
Craigengelt8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt8_grframelong_sum$max)
Craigengelt8_gr_lw_ref
#number of sites which would be classified as high
Craigengelt8_gr_high_ref <- sum( Craigengelt8_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt8_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt8_gr_mod_ref <- 1000 - (Craigengelt8_gr_high_ref + Craigengelt8_gr_lw_ref)
Craigengelt8_gr_mod_ref

#9 nights
Craigengelt9_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Craigengelt9_grframe<-data.frame(Craigengelt9_gr, samp2)
Craigengelt9_grframelong <- melt(Craigengelt9_grframe,id.vars="samp2")
Craigengelt9_grframelong_sum <- ddply(Craigengelt9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Craigengelt9_gr_max <- sum(Craigengelt9_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt9_gr_max
Craigengelt9_gr_pres <- sum(Craigengelt9_grframelong_sum $max > 0)
Craigengelt9_gr_pres

#number of sites which would be classified as low
Craigengelt9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt9_grframelong_sum$max)
Craigengelt9_gr_lw_ref
#number of sites which would be classified as high
Craigengelt9_gr_high_ref <- sum( Craigengelt9_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt9_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt9_gr_mod_ref <- 1000 - (Craigengelt9_gr_high_ref + Craigengelt9_gr_lw_ref)
Craigengelt9_gr_mod_ref

#10 detectors
Craigengelt10_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Craigengelt10_grframe<-data.frame(Craigengelt10_gr, samp2)
Craigengelt10_grframelong <- melt(Craigengelt10_grframe,id.vars="samp2")
Craigengelt10_grframelong_sum <- ddply(Craigengelt10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt10_gr_max <- sum(Craigengelt10_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt10_gr_max
Craigengelt10_gr_pres <- sum(Craigengelt10_grframelong_sum $max > 0)
Craigengelt10_gr_pres

#number of sites which would be classified as low
Craigengelt10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt10_grframelong_sum$max)
Craigengelt10_gr_lw_ref
#number of sites which would be classified as high
Craigengelt10_gr_high_ref <- sum( Craigengelt10_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt10_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt10_gr_mod_ref <- 1000 - (Craigengelt10_gr_high_ref + Craigengelt10_gr_lw_ref)
Craigengelt10_gr_mod_ref

#11 detectors
Craigengelt11_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Craigengelt11_grframe<-data.frame(Craigengelt11_gr, samp2)
Craigengelt11_grframelong <- melt(Craigengelt11_grframe,id.vars="samp2")
Craigengelt11_grframelong_sum <- ddply(Craigengelt11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt11_gr_max <- sum(Craigengelt11_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt11_gr_max
Craigengelt11_gr_pres <- sum(Craigengelt11_grframelong_sum $max > 0)
Craigengelt11_gr_pres

#number of sites which would be classified as low
Craigengelt11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt11_grframelong_sum$max)
Craigengelt11_gr_lw_ref
#number of sites which would be classified as high
Craigengelt11_gr_high_ref <- sum( Craigengelt11_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt11_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt11_gr_mod_ref <- 1000 - (Craigengelt11_gr_high_ref + Craigengelt11_gr_lw_ref)
Craigengelt11_gr_mod_ref

#12 detectors
Craigengelt12_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Craigengelt12_grframe<-data.frame(Craigengelt12_gr, samp2)
Craigengelt12_grframelong <- melt(Craigengelt12_grframe,id.vars="samp2")
Craigengelt12_grframelong_sum <- ddply(Craigengelt12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt12_gr_max <- sum(Craigengelt12_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt12_gr_max
Craigengelt12_gr_pres <- sum(Craigengelt12_grframelong_sum $max > 0)
Craigengelt12_gr_pres

#number of sites which would be classified as low
Craigengelt12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt12_grframelong_sum$max)
Craigengelt12_gr_lw_ref
#number of sites which would be classified as high
Craigengelt12_gr_high_ref <- sum( Craigengelt12_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt12_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt12_gr_mod_ref <- 1000 - (Craigengelt12_gr_high_ref + Craigengelt12_gr_lw_ref)
Craigengelt12_gr_mod_ref

#13 detectors
Craigengelt13_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Craigengelt13_grframe<-data.frame(Craigengelt13_gr, samp2)
Craigengelt13_grframelong <- melt(Craigengelt13_grframe,id.vars="samp2")
Craigengelt13_grframelong_sum <- ddply(Craigengelt13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt13_gr_max <- sum(Craigengelt13_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt13_gr_max
Craigengelt13_gr_pres <- sum(Craigengelt13_grframelong_sum $max > 0)
Craigengelt13_gr_pres

#number of sites which would be classified as low
Craigengelt13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt13_grframelong_sum$max)
Craigengelt13_gr_lw_ref
#number of sites which would be classified as high
Craigengelt13_gr_high_ref <- sum( Craigengelt13_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt13_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt13_gr_mod_ref <- 1000 - (Craigengelt13_gr_high_ref + Craigengelt13_gr_lw_ref)
Craigengelt13_gr_mod_ref

#14 detectors
Craigengelt14_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Craigengelt14_grframe<-data.frame(Craigengelt14_gr, samp2)
Craigengelt14_grframelong <- melt(Craigengelt14_grframe,id.vars="samp2")
Craigengelt14_grframelong_sum <- ddply(Craigengelt14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt14_gr_max <- sum(Craigengelt14_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt14_gr_max
Craigengelt14_gr_pres <- sum(Craigengelt14_grframelong_sum $max > 0)
Craigengelt14_gr_pres

#number of sites which would be classified as low
Craigengelt14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt14_grframelong_sum$max)
Craigengelt14_gr_lw_ref
#number of sites which would be classified as high
Craigengelt14_gr_high_ref <- sum( Craigengelt14_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt14_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt14_gr_mod_ref <- 1000 - (Craigengelt14_gr_high_ref + Craigengelt14_gr_lw_ref)
Craigengelt14_gr_mod_ref

#15 detectors
Craigengelt15_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Craigengelt15_grframe<-data.frame(Craigengelt15_gr, samp2)
Craigengelt15_grframelong <- melt(Craigengelt15_grframe,id.vars="samp2")
Craigengelt15_grframelong_sum <- ddply(Craigengelt15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt15_gr_max <- sum(Craigengelt15_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt15_gr_max
Craigengelt15_gr_pres <- sum(Craigengelt15_grframelong_sum $max > 0)
Craigengelt15_gr_pres

#number of sites which would be classified as low
Craigengelt15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt15_grframelong_sum$max)
Craigengelt15_gr_lw_ref
#number of sites which would be classified as high
Craigengelt15_gr_high_ref <- sum( Craigengelt15_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt15_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt15_gr_mod_ref <- 1000 - (Craigengelt15_gr_high_ref + Craigengelt15_gr_lw_ref)
Craigengelt15_gr_mod_ref

#16 detectors
Craigengelt16_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Craigengelt16_grframe<-data.frame(Craigengelt16_gr, samp2)
Craigengelt16_grframelong <- melt(Craigengelt16_grframe,id.vars="samp2")
Craigengelt16_grframelong_sum <- ddply(Craigengelt16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt16_gr_max <- sum(Craigengelt16_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt16_gr_max
Craigengelt16_gr_pres <- sum(Craigengelt16_grframelong_sum $max > 0)
Craigengelt16_gr_pres

#number of sites which would be classified as low
Craigengelt16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt16_grframelong_sum$max)
Craigengelt16_gr_lw_ref
#number of sites which would be classified as high
Craigengelt16_gr_high_ref <- sum( Craigengelt16_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt16_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt16_gr_mod_ref <- 1000 - (Craigengelt16_gr_high_ref + Craigengelt16_gr_lw_ref)
Craigengelt16_gr_mod_ref

#17 detectors
Craigengelt17_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Craigengelt17_grframe<-data.frame(Craigengelt17_gr, samp2)
Craigengelt17_grframelong <- melt(Craigengelt17_grframe,id.vars="samp2")
Craigengelt17_grframelong_sum <- ddply(Craigengelt17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt17_gr_max <- sum(Craigengelt17_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt17_gr_max
Craigengelt17_gr_pres <- sum(Craigengelt17_grframelong_sum $max > 0)
Craigengelt17_gr_pres

#number of sites which would be classified as low
Craigengelt17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt17_grframelong_sum$max)
Craigengelt17_gr_lw_ref
#number of sites which would be classified as high
Craigengelt17_gr_high_ref <- sum( Craigengelt17_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt17_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt17_gr_mod_ref <- 1000 - (Craigengelt17_gr_high_ref + Craigengelt17_gr_lw_ref)
Craigengelt17_gr_mod_ref

#18 detectors
Craigengelt18_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Craigengelt18_grframe<-data.frame(Craigengelt18_gr, samp2)
Craigengelt18_grframelong <- melt(Craigengelt18_grframe,id.vars="samp2")
Craigengelt18_grframelong_sum <- ddply(Craigengelt18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt18_gr_max <- sum(Craigengelt18_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt18_gr_max
Craigengelt18_gr_pres <- sum(Craigengelt18_grframelong_sum $max > 0)
Craigengelt18_gr_pres

#number of sites which would be classified as low
Craigengelt18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt18_grframelong_sum$max)
Craigengelt18_gr_lw_ref
#number of sites which would be classified as high
Craigengelt18_gr_high_ref <- sum( Craigengelt18_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt18_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt18_gr_mod_ref <- 1000 - (Craigengelt18_gr_high_ref + Craigengelt18_gr_lw_ref)
Craigengelt18_gr_mod_ref

#19 detectors
Craigengelt19_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Craigengelt19_grframe<-data.frame(Craigengelt19_gr, samp2)
Craigengelt19_grframelong <- melt(Craigengelt19_grframe,id.vars="samp2")
Craigengelt19_grframelong_sum <- ddply(Craigengelt19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt19_gr_max <- sum(Craigengelt19_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt19_gr_max
Craigengelt19_gr_pres <- sum(Craigengelt19_grframelong_sum $max > 0)
Craigengelt19_gr_pres

#number of sites which would be classified as low
Craigengelt19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt19_grframelong_sum$max)
Craigengelt19_gr_lw_ref
#number of sites which would be classified as high
Craigengelt19_gr_high_ref <- sum( Craigengelt19_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt19_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt19_gr_mod_ref <- 1000 - (Craigengelt19_gr_high_ref + Craigengelt19_gr_lw_ref)
Craigengelt19_gr_mod_ref

#20 detectors
Craigengelt20_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Craigengelt20_grframe<-data.frame(Craigengelt20_gr, samp2)
Craigengelt20_grframelong <- melt(Craigengelt20_grframe,id.vars="samp2")
Craigengelt20_grframelong_sum <- ddply(Craigengelt20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt20_gr_max <- sum(Craigengelt20_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt20_gr_max
Craigengelt20_gr_pres <- sum(Craigengelt20_grframelong_sum $max > 0)
Craigengelt20_gr_pres

#number of sites which would be classified as low
Craigengelt20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt20_grframelong_sum$max)
Craigengelt20_gr_lw_ref
#number of sites which would be classified as high
Craigengelt20_gr_high_ref <- sum( Craigengelt20_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt20_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt20_gr_mod_ref <- 1000 - (Craigengelt20_gr_high_ref + Craigengelt20_gr_lw_ref)
Craigengelt20_gr_mod_ref

#21 detectors
Craigengelt21_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Craigengelt21_grframe<-data.frame(Craigengelt21_gr, samp2)
Craigengelt21_grframelong <- melt(Craigengelt21_grframe,id.vars="samp2")
Craigengelt21_grframelong_sum <- ddply(Craigengelt21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt21_gr_max <- sum(Craigengelt21_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt21_gr_max
Craigengelt21_gr_pres <- sum(Craigengelt21_grframelong_sum $max > 0)
Craigengelt21_gr_pres

#number of sites which would be classified as low
Craigengelt21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt21_grframelong_sum$max)
Craigengelt21_gr_lw_ref
#number of sites which would be classified as high
Craigengelt21_gr_high_ref <- sum( Craigengelt21_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt21_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt21_gr_mod_ref <- 1000 - (Craigengelt21_gr_high_ref + Craigengelt21_gr_lw_ref)
Craigengelt21_gr_mod_ref

#22 detectors
Craigengelt22_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Craigengelt22_grframe<-data.frame(Craigengelt22_gr, samp2)
Craigengelt22_grframelong <- melt(Craigengelt22_grframe,id.vars="samp2")
Craigengelt22_grframelong_sum <- ddply(Craigengelt22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt22_gr_max <- sum(Craigengelt22_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt22_gr_max
Craigengelt22_gr_pres <- sum(Craigengelt22_grframelong_sum $max > 0)
Craigengelt22_gr_pres

#number of sites which would be classified as low
Craigengelt22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt22_grframelong_sum$max)
Craigengelt22_gr_lw_ref
#number of sites which would be classified as high
Craigengelt22_gr_high_ref <- sum( Craigengelt22_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt22_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt22_gr_mod_ref <- 1000 - (Craigengelt22_gr_high_ref + Craigengelt22_gr_lw_ref)
Craigengelt22_gr_mod_ref

#23 detectors
Craigengelt23_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Craigengelt23_grframe<-data.frame(Craigengelt23_gr, samp2)
Craigengelt23_grframelong <- melt(Craigengelt23_grframe,id.vars="samp2")
Craigengelt23_grframelong_sum <- ddply(Craigengelt23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt23_gr_max <- sum(Craigengelt23_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt23_gr_max
Craigengelt23_gr_pres <- sum(Craigengelt23_grframelong_sum $max > 0)
Craigengelt23_gr_pres

#number of sites which would be classified as low
Craigengelt23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt23_grframelong_sum$max)
Craigengelt23_gr_lw_ref
#number of sites which would be classified as high
Craigengelt23_gr_high_ref <- sum( Craigengelt23_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt23_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt23_gr_mod_ref <- 1000 - (Craigengelt23_gr_high_ref + Craigengelt23_gr_lw_ref)
Craigengelt23_gr_mod_ref

#24 detectors
Craigengelt24_gr<-(replicate(1000, (sample(Craigengeltpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Craigengelt24_grframe<-data.frame(Craigengelt24_gr, samp2)
Craigengelt24_grframelong <- melt(Craigengelt24_grframe,id.vars="samp2")
Craigengelt24_grframelong_sum <- ddply(Craigengelt24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
Craigengelt24_gr_max <- sum(Craigengelt24_grframelong_sum $max > max20_Craigengeltpipgr)
Craigengelt24_gr_max
Craigengelt24_gr_pres <- sum(Craigengelt24_grframelong_sum $max > 0)
Craigengelt24_gr_pres

#number of sites which would be classified as low
Craigengelt24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Craigengelt24_grframelong_sum$max)
Craigengelt24_gr_lw_ref
#number of sites which would be classified as high
Craigengelt24_gr_high_ref <- sum( Craigengelt24_grframelong_sum$max > allsppgr_ppip_ref_high)
Craigengelt24_gr_high_ref
#number of sites which would be classified as moderate
Craigengelt24_gr_mod_ref <- 1000 - (Craigengelt24_gr_high_ref + Craigengelt24_gr_lw_ref)
Craigengelt24_gr_mod_ref

Present<-c(Craigengelt1_gr_pres,Craigengelt2_gr_pres,
           Craigengelt3_gr_pres,Craigengelt4_gr_pres,
           Craigengelt5_gr_pres,Craigengelt6_gr_pres,
           Craigengelt7_gr_pres,Craigengelt8_gr_pres,
           Craigengelt9_gr_pres,Craigengelt10_gr_pres,
           Craigengelt11_gr_pres,Craigengelt12_gr_pres,
           Craigengelt13_gr_pres,Craigengelt14_gr_pres,
           Craigengelt15_gr_pres,Craigengelt16_gr_pres,
           Craigengelt17_gr_pres,Craigengelt18_gr_pres,
           Craigengelt19_gr_pres,Craigengelt20_gr_pres,
           Craigengelt21_gr_pres,Craigengelt22_gr_pres,
           Craigengelt23_gr_pres,Craigengelt24_gr_pres)


Maximum<-c(Craigengelt1_gr_max,Craigengelt2_gr_max,
           Craigengelt3_gr_max,Craigengelt4_gr_max,
           Craigengelt5_gr_max,Craigengelt6_gr_max,
           Craigengelt7_gr_max,Craigengelt8_gr_max,
           Craigengelt9_gr_max,Craigengelt10_gr_max,
           Craigengelt11_gr_max,Craigengelt12_gr_max,
           Craigengelt13_gr_max,Craigengelt14_gr_max,
           Craigengelt15_gr_max,Craigengelt16_gr_max,
           Craigengelt17_gr_max,Craigengelt18_gr_max,
           Craigengelt19_gr_max,Craigengelt20_gr_max,
           Craigengelt21_gr_max,Craigengelt22_gr_max,
           Craigengelt23_gr_max,Craigengelt24_gr_max)

Low<-c(Craigengelt1_gr_lw_ref, Craigengelt2_gr_lw_ref, Craigengelt3_gr_lw_ref,
       Craigengelt4_gr_lw_ref, Craigengelt5_gr_lw_ref, Craigengelt6_gr_lw_ref,
       Craigengelt7_gr_lw_ref, Craigengelt8_gr_lw_ref, Craigengelt9_gr_lw_ref,
       Craigengelt10_gr_lw_ref, Craigengelt11_gr_lw_ref, Craigengelt12_gr_lw_ref, 
       Craigengelt13_gr_lw_ref, Craigengelt14_gr_lw_ref, Craigengelt15_gr_lw_ref, 
       Craigengelt16_gr_lw_ref, Craigengelt17_gr_lw_ref, Craigengelt18_gr_lw_ref, 
       Craigengelt19_gr_lw_ref, Craigengelt20_gr_lw_ref, Craigengelt21_gr_lw_ref,
       Craigengelt22_gr_lw_ref,Craigengelt23_gr_lw_ref,Craigengelt24_gr_lw_ref)

Moderate<-c(Craigengelt1_gr_mod_ref, Craigengelt2_gr_mod_ref, Craigengelt3_gr_mod_ref,
            Craigengelt4_gr_mod_ref, Craigengelt5_gr_mod_ref, Craigengelt6_gr_mod_ref,
            Craigengelt7_gr_mod_ref, Craigengelt8_gr_mod_ref, Craigengelt9_gr_mod_ref,
            Craigengelt10_gr_mod_ref, Craigengelt11_gr_mod_ref, Craigengelt12_gr_mod_ref, 
            Craigengelt13_gr_mod_ref, Craigengelt14_gr_mod_ref, Craigengelt15_gr_mod_ref, 
            Craigengelt16_gr_mod_ref, Craigengelt17_gr_mod_ref, Craigengelt18_gr_mod_ref, 
            Craigengelt19_gr_mod_ref, Craigengelt20_gr_mod_ref, Craigengelt21_gr_mod_ref,
            Craigengelt22_gr_mod_ref,Craigengelt23_gr_mod_ref,Craigengelt24_gr_mod_ref)

High<-c(Craigengelt1_gr_high_ref, Craigengelt2_gr_high_ref, Craigengelt3_gr_high_ref,
        Craigengelt4_gr_high_ref, Craigengelt5_gr_high_ref, Craigengelt6_gr_high_ref,
        Craigengelt7_gr_high_ref, Craigengelt8_gr_high_ref, Craigengelt9_gr_high_ref,
        Craigengelt10_gr_high_ref, Craigengelt11_gr_high_ref, Craigengelt12_gr_high_ref, 
        Craigengelt13_gr_high_ref, Craigengelt14_gr_high_ref, Craigengelt15_gr_high_ref, 
        Craigengelt16_gr_high_ref, Craigengelt17_gr_high_ref, Craigengelt18_gr_high_ref, 
        Craigengelt19_gr_high_ref, Craigengelt20_gr_high_ref, Craigengelt21_gr_high_ref,
        Craigengelt22_gr_high_ref,Craigengelt23_gr_high_ref,Craigengelt24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Craigengeltgr",24)
Lowsite <- Craigengeltlow
Modsite <- Craigengeltmod
Highsite <-Craigengelthigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Craigengeltgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##DeepingStNicholas

DeepingStNicholaspipgr<-subset(allspp4gr_ppip, Site=="DeepingStNicholas")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_DeepingStNicholaspipgr<-max(DeepingStNicholaspipgr$Passes)

#calculate 20% from maximum nightly record

max20_DeepingStNicholaspipgr<- (max_DeepingStNicholaspipgr/100)*80

##calculate the site classification (reference range)

DeepingStNicholashigh<- max_DeepingStNicholaspipgr > allsppgr_ppip_ref_high

DeepingStNicholaslow<- allsppgr_ppip_ref_low > max_DeepingStNicholaspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_DeepingStNicholaspipgr
DeepingStNicholasmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
DeepingStNicholas1_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 1, replace=F))))
DeepingStNicholas1_gr_max <- sum(DeepingStNicholas1_gr > max20_DeepingStNicholaspipgr)
DeepingStNicholas1_gr_max
DeepingStNicholas1_gr_pres <- sum(DeepingStNicholas1_gr > 0)
DeepingStNicholas1_gr_pres
#number of sites which would be classified as low
DeepingStNicholas1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas1_gr)
DeepingStNicholas1_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas1_gr_high_ref <- sum( DeepingStNicholas1_gr > allsppgr_ppip_ref_high)
DeepingStNicholas1_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas1_gr_mod_ref <- 1000 - (DeepingStNicholas1_gr_high_ref + DeepingStNicholas1_gr_lw_ref)
DeepingStNicholas1_gr_mod_ref


#2 nights
DeepingStNicholas2_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
DeepingStNicholas2_grframe<-data.frame(DeepingStNicholas2_gr, samp2)
DeepingStNicholas2_grframelong <- melt(DeepingStNicholas2_grframe,id.vars="samp2")
DeepingStNicholas2_grframelong_sum <- ddply(DeepingStNicholas2_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas2_gr_max <- sum(DeepingStNicholas2_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas2_gr_max
DeepingStNicholas2_gr_pres <- sum(DeepingStNicholas2_grframelong_sum $max > 0)
DeepingStNicholas2_gr_pres

#number of sites which would be classified as low
DeepingStNicholas2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas2_grframelong_sum$max)
DeepingStNicholas2_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas2_gr_high_ref <- sum( DeepingStNicholas2_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas2_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas2_gr_mod_ref <- 1000 - (DeepingStNicholas2_gr_high_ref + DeepingStNicholas2_gr_lw_ref)
DeepingStNicholas2_gr_mod_ref


#3 nights
DeepingStNicholas3_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
DeepingStNicholas3_grframe<-data.frame(DeepingStNicholas3_gr, samp2)
DeepingStNicholas3_grframelong <- melt(DeepingStNicholas3_grframe,id.vars="samp2")
DeepingStNicholas3_grframelong_sum <- ddply(DeepingStNicholas3_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas3_gr_max <- sum(DeepingStNicholas3_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas3_gr_max
DeepingStNicholas3_gr_pres <- sum(DeepingStNicholas3_grframelong_sum $max > 0)
DeepingStNicholas3_gr_pres

#number of sites which would be classified as low
DeepingStNicholas3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas3_grframelong_sum$max)
DeepingStNicholas3_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas3_gr_high_ref <- sum( DeepingStNicholas3_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas3_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas3_gr_mod_ref <- 1000 - (DeepingStNicholas3_gr_high_ref + DeepingStNicholas3_gr_lw_ref)
DeepingStNicholas3_gr_mod_ref

#4 nights
DeepingStNicholas4_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
DeepingStNicholas4_grframe<-data.frame(DeepingStNicholas4_gr, samp2)
DeepingStNicholas4_grframelong <- melt(DeepingStNicholas4_grframe,id.vars="samp2")
DeepingStNicholas4_grframelong_sum <- ddply(DeepingStNicholas4_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas4_gr_max <- sum(DeepingStNicholas4_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas4_gr_max
DeepingStNicholas4_gr_pres <- sum(DeepingStNicholas4_grframelong_sum $max > 0)
DeepingStNicholas4_gr_pres

#number of sites which would be classified as low
DeepingStNicholas4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas4_grframelong_sum$max)
DeepingStNicholas4_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas4_gr_high_ref <- sum( DeepingStNicholas4_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas4_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas4_gr_mod_ref <- 1000 - (DeepingStNicholas4_gr_high_ref + DeepingStNicholas4_gr_lw_ref)
DeepingStNicholas4_gr_mod_ref

#5 nights
DeepingStNicholas5_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
DeepingStNicholas5_grframe<-data.frame(DeepingStNicholas5_gr, samp2)
DeepingStNicholas5_grframelong <- melt(DeepingStNicholas5_grframe,id.vars="samp2")
DeepingStNicholas5_grframelong_sum <- ddply(DeepingStNicholas5_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas5_gr_max <- sum(DeepingStNicholas5_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas5_gr_max
DeepingStNicholas5_gr_pres <- sum(DeepingStNicholas5_grframelong_sum $max > 0)
DeepingStNicholas5_gr_pres

#number of sites which would be classified as low
DeepingStNicholas5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas5_grframelong_sum$max)
DeepingStNicholas5_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas5_gr_high_ref <- sum( DeepingStNicholas5_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas5_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas5_gr_mod_ref <- 1000 - (DeepingStNicholas5_gr_high_ref + DeepingStNicholas5_gr_lw_ref)
DeepingStNicholas5_gr_mod_ref

#6 nights
DeepingStNicholas6_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
DeepingStNicholas6_grframe<-data.frame(DeepingStNicholas6_gr, samp2)
DeepingStNicholas6_grframelong <- melt(DeepingStNicholas6_grframe,id.vars="samp2")
DeepingStNicholas6_grframelong_sum <- ddply(DeepingStNicholas6_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas6_gr_max <- sum(DeepingStNicholas6_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas6_gr_max
DeepingStNicholas6_gr_pres <- sum(DeepingStNicholas6_grframelong_sum $max > 0)
DeepingStNicholas6_gr_pres

#number of sites which would be classified as low
DeepingStNicholas6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas6_grframelong_sum$max)
DeepingStNicholas6_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas6_gr_high_ref <- sum( DeepingStNicholas6_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas6_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas6_gr_mod_ref <- 1000 - (DeepingStNicholas6_gr_high_ref + DeepingStNicholas6_gr_lw_ref)
DeepingStNicholas6_gr_mod_ref

#7 nights
DeepingStNicholas7_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
DeepingStNicholas7_grframe<-data.frame(DeepingStNicholas7_gr, samp2)
DeepingStNicholas7_grframelong <- melt(DeepingStNicholas7_grframe,id.vars="samp2")
DeepingStNicholas7_grframelong_sum <- ddply(DeepingStNicholas7_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas7_gr_max <- sum(DeepingStNicholas7_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas7_gr_max
DeepingStNicholas7_gr_pres <- sum(DeepingStNicholas7_grframelong_sum $max > 0)
DeepingStNicholas7_gr_pres

#number of sites which would be classified as low
DeepingStNicholas7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas7_grframelong_sum$max)
DeepingStNicholas7_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas7_gr_high_ref <- sum( DeepingStNicholas7_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas7_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas7_gr_mod_ref <- 1000 - (DeepingStNicholas7_gr_high_ref + DeepingStNicholas7_gr_lw_ref)
DeepingStNicholas7_gr_mod_ref

#8 nights
DeepingStNicholas8_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
DeepingStNicholas8_grframe<-data.frame(DeepingStNicholas8_gr, samp2)
DeepingStNicholas8_grframelong <- melt(DeepingStNicholas8_grframe,id.vars="samp2")
DeepingStNicholas8_grframelong_sum <- ddply(DeepingStNicholas8_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas8_gr_max <- sum(DeepingStNicholas8_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas8_gr_max
DeepingStNicholas8_gr_pres <- sum(DeepingStNicholas8_grframelong_sum $max > 0)
DeepingStNicholas8_gr_pres

#number of sites which would be classified as low
DeepingStNicholas8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas8_grframelong_sum$max)
DeepingStNicholas8_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas8_gr_high_ref <- sum( DeepingStNicholas8_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas8_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas8_gr_mod_ref <- 1000 - (DeepingStNicholas8_gr_high_ref + DeepingStNicholas8_gr_lw_ref)
DeepingStNicholas8_gr_mod_ref

#9 nights
DeepingStNicholas9_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
DeepingStNicholas9_grframe<-data.frame(DeepingStNicholas9_gr, samp2)
DeepingStNicholas9_grframelong <- melt(DeepingStNicholas9_grframe,id.vars="samp2")
DeepingStNicholas9_grframelong_sum <- ddply(DeepingStNicholas9_grframelong, "variable", summarise,
                                            N    = length(value),
                                            max  = max(value))
DeepingStNicholas9_gr_max <- sum(DeepingStNicholas9_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas9_gr_max
DeepingStNicholas9_gr_pres <- sum(DeepingStNicholas9_grframelong_sum $max > 0)
DeepingStNicholas9_gr_pres

#number of sites which would be classified as low
DeepingStNicholas9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas9_grframelong_sum$max)
DeepingStNicholas9_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas9_gr_high_ref <- sum( DeepingStNicholas9_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas9_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas9_gr_mod_ref <- 1000 - (DeepingStNicholas9_gr_high_ref + DeepingStNicholas9_gr_lw_ref)
DeepingStNicholas9_gr_mod_ref

#10 detectors
DeepingStNicholas10_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
DeepingStNicholas10_grframe<-data.frame(DeepingStNicholas10_gr, samp2)
DeepingStNicholas10_grframelong <- melt(DeepingStNicholas10_grframe,id.vars="samp2")
DeepingStNicholas10_grframelong_sum <- ddply(DeepingStNicholas10_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas10_gr_max <- sum(DeepingStNicholas10_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas10_gr_max
DeepingStNicholas10_gr_pres <- sum(DeepingStNicholas10_grframelong_sum $max > 0)
DeepingStNicholas10_gr_pres

#number of sites which would be classified as low
DeepingStNicholas10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas10_grframelong_sum$max)
DeepingStNicholas10_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas10_gr_high_ref <- sum( DeepingStNicholas10_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas10_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas10_gr_mod_ref <- 1000 - (DeepingStNicholas10_gr_high_ref + DeepingStNicholas10_gr_lw_ref)
DeepingStNicholas10_gr_mod_ref

#11 detectors
DeepingStNicholas11_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
DeepingStNicholas11_grframe<-data.frame(DeepingStNicholas11_gr, samp2)
DeepingStNicholas11_grframelong <- melt(DeepingStNicholas11_grframe,id.vars="samp2")
DeepingStNicholas11_grframelong_sum <- ddply(DeepingStNicholas11_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas11_gr_max <- sum(DeepingStNicholas11_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas11_gr_max
DeepingStNicholas11_gr_pres <- sum(DeepingStNicholas11_grframelong_sum $max > 0)
DeepingStNicholas11_gr_pres

#number of sites which would be classified as low
DeepingStNicholas11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas11_grframelong_sum$max)
DeepingStNicholas11_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas11_gr_high_ref <- sum( DeepingStNicholas11_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas11_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas11_gr_mod_ref <- 1000 - (DeepingStNicholas11_gr_high_ref + DeepingStNicholas11_gr_lw_ref)
DeepingStNicholas11_gr_mod_ref

#12 detectors
DeepingStNicholas12_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
DeepingStNicholas12_grframe<-data.frame(DeepingStNicholas12_gr, samp2)
DeepingStNicholas12_grframelong <- melt(DeepingStNicholas12_grframe,id.vars="samp2")
DeepingStNicholas12_grframelong_sum <- ddply(DeepingStNicholas12_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas12_gr_max <- sum(DeepingStNicholas12_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas12_gr_max
DeepingStNicholas12_gr_pres <- sum(DeepingStNicholas12_grframelong_sum $max > 0)
DeepingStNicholas12_gr_pres

#number of sites which would be classified as low
DeepingStNicholas12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas12_grframelong_sum$max)
DeepingStNicholas12_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas12_gr_high_ref <- sum( DeepingStNicholas12_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas12_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas12_gr_mod_ref <- 1000 - (DeepingStNicholas12_gr_high_ref + DeepingStNicholas12_gr_lw_ref)
DeepingStNicholas12_gr_mod_ref

#13 detectors
DeepingStNicholas13_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
DeepingStNicholas13_grframe<-data.frame(DeepingStNicholas13_gr, samp2)
DeepingStNicholas13_grframelong <- melt(DeepingStNicholas13_grframe,id.vars="samp2")
DeepingStNicholas13_grframelong_sum <- ddply(DeepingStNicholas13_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas13_gr_max <- sum(DeepingStNicholas13_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas13_gr_max
DeepingStNicholas13_gr_pres <- sum(DeepingStNicholas13_grframelong_sum $max > 0)
DeepingStNicholas13_gr_pres

#number of sites which would be classified as low
DeepingStNicholas13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas13_grframelong_sum$max)
DeepingStNicholas13_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas13_gr_high_ref <- sum( DeepingStNicholas13_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas13_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas13_gr_mod_ref <- 1000 - (DeepingStNicholas13_gr_high_ref + DeepingStNicholas13_gr_lw_ref)
DeepingStNicholas13_gr_mod_ref

#14 detectors
DeepingStNicholas14_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
DeepingStNicholas14_grframe<-data.frame(DeepingStNicholas14_gr, samp2)
DeepingStNicholas14_grframelong <- melt(DeepingStNicholas14_grframe,id.vars="samp2")
DeepingStNicholas14_grframelong_sum <- ddply(DeepingStNicholas14_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas14_gr_max <- sum(DeepingStNicholas14_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas14_gr_max
DeepingStNicholas14_gr_pres <- sum(DeepingStNicholas14_grframelong_sum $max > 0)
DeepingStNicholas14_gr_pres

#number of sites which would be classified as low
DeepingStNicholas14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas14_grframelong_sum$max)
DeepingStNicholas14_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas14_gr_high_ref <- sum( DeepingStNicholas14_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas14_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas14_gr_mod_ref <- 1000 - (DeepingStNicholas14_gr_high_ref + DeepingStNicholas14_gr_lw_ref)
DeepingStNicholas14_gr_mod_ref

#15 detectors
DeepingStNicholas15_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
DeepingStNicholas15_grframe<-data.frame(DeepingStNicholas15_gr, samp2)
DeepingStNicholas15_grframelong <- melt(DeepingStNicholas15_grframe,id.vars="samp2")
DeepingStNicholas15_grframelong_sum <- ddply(DeepingStNicholas15_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas15_gr_max <- sum(DeepingStNicholas15_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas15_gr_max
DeepingStNicholas15_gr_pres <- sum(DeepingStNicholas15_grframelong_sum $max > 0)
DeepingStNicholas15_gr_pres

#number of sites which would be classified as low
DeepingStNicholas15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas15_grframelong_sum$max)
DeepingStNicholas15_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas15_gr_high_ref <- sum( DeepingStNicholas15_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas15_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas15_gr_mod_ref <- 1000 - (DeepingStNicholas15_gr_high_ref + DeepingStNicholas15_gr_lw_ref)
DeepingStNicholas15_gr_mod_ref

#16 detectors
DeepingStNicholas16_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
DeepingStNicholas16_grframe<-data.frame(DeepingStNicholas16_gr, samp2)
DeepingStNicholas16_grframelong <- melt(DeepingStNicholas16_grframe,id.vars="samp2")
DeepingStNicholas16_grframelong_sum <- ddply(DeepingStNicholas16_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas16_gr_max <- sum(DeepingStNicholas16_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas16_gr_max
DeepingStNicholas16_gr_pres <- sum(DeepingStNicholas16_grframelong_sum $max > 0)
DeepingStNicholas16_gr_pres

#number of sites which would be classified as low
DeepingStNicholas16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas16_grframelong_sum$max)
DeepingStNicholas16_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas16_gr_high_ref <- sum( DeepingStNicholas16_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas16_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas16_gr_mod_ref <- 1000 - (DeepingStNicholas16_gr_high_ref + DeepingStNicholas16_gr_lw_ref)
DeepingStNicholas16_gr_mod_ref

#17 detectors
DeepingStNicholas17_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
DeepingStNicholas17_grframe<-data.frame(DeepingStNicholas17_gr, samp2)
DeepingStNicholas17_grframelong <- melt(DeepingStNicholas17_grframe,id.vars="samp2")
DeepingStNicholas17_grframelong_sum <- ddply(DeepingStNicholas17_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas17_gr_max <- sum(DeepingStNicholas17_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas17_gr_max
DeepingStNicholas17_gr_pres <- sum(DeepingStNicholas17_grframelong_sum $max > 0)
DeepingStNicholas17_gr_pres

#number of sites which would be classified as low
DeepingStNicholas17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas17_grframelong_sum$max)
DeepingStNicholas17_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas17_gr_high_ref <- sum( DeepingStNicholas17_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas17_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas17_gr_mod_ref <- 1000 - (DeepingStNicholas17_gr_high_ref + DeepingStNicholas17_gr_lw_ref)
DeepingStNicholas17_gr_mod_ref

#18 detectors
DeepingStNicholas18_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
DeepingStNicholas18_grframe<-data.frame(DeepingStNicholas18_gr, samp2)
DeepingStNicholas18_grframelong <- melt(DeepingStNicholas18_grframe,id.vars="samp2")
DeepingStNicholas18_grframelong_sum <- ddply(DeepingStNicholas18_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas18_gr_max <- sum(DeepingStNicholas18_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas18_gr_max
DeepingStNicholas18_gr_pres <- sum(DeepingStNicholas18_grframelong_sum $max > 0)
DeepingStNicholas18_gr_pres

#number of sites which would be classified as low
DeepingStNicholas18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas18_grframelong_sum$max)
DeepingStNicholas18_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas18_gr_high_ref <- sum( DeepingStNicholas18_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas18_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas18_gr_mod_ref <- 1000 - (DeepingStNicholas18_gr_high_ref + DeepingStNicholas18_gr_lw_ref)
DeepingStNicholas18_gr_mod_ref

#19 detectors
DeepingStNicholas19_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
DeepingStNicholas19_grframe<-data.frame(DeepingStNicholas19_gr, samp2)
DeepingStNicholas19_grframelong <- melt(DeepingStNicholas19_grframe,id.vars="samp2")
DeepingStNicholas19_grframelong_sum <- ddply(DeepingStNicholas19_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas19_gr_max <- sum(DeepingStNicholas19_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas19_gr_max
DeepingStNicholas19_gr_pres <- sum(DeepingStNicholas19_grframelong_sum $max > 0)
DeepingStNicholas19_gr_pres

#number of sites which would be classified as low
DeepingStNicholas19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas19_grframelong_sum$max)
DeepingStNicholas19_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas19_gr_high_ref <- sum( DeepingStNicholas19_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas19_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas19_gr_mod_ref <- 1000 - (DeepingStNicholas19_gr_high_ref + DeepingStNicholas19_gr_lw_ref)
DeepingStNicholas19_gr_mod_ref

#20 detectors
DeepingStNicholas20_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
DeepingStNicholas20_grframe<-data.frame(DeepingStNicholas20_gr, samp2)
DeepingStNicholas20_grframelong <- melt(DeepingStNicholas20_grframe,id.vars="samp2")
DeepingStNicholas20_grframelong_sum <- ddply(DeepingStNicholas20_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas20_gr_max <- sum(DeepingStNicholas20_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas20_gr_max
DeepingStNicholas20_gr_pres <- sum(DeepingStNicholas20_grframelong_sum $max > 0)
DeepingStNicholas20_gr_pres

#number of sites which would be classified as low
DeepingStNicholas20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas20_grframelong_sum$max)
DeepingStNicholas20_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas20_gr_high_ref <- sum( DeepingStNicholas20_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas20_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas20_gr_mod_ref <- 1000 - (DeepingStNicholas20_gr_high_ref + DeepingStNicholas20_gr_lw_ref)
DeepingStNicholas20_gr_mod_ref

#21 detectors
DeepingStNicholas21_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
DeepingStNicholas21_grframe<-data.frame(DeepingStNicholas21_gr, samp2)
DeepingStNicholas21_grframelong <- melt(DeepingStNicholas21_grframe,id.vars="samp2")
DeepingStNicholas21_grframelong_sum <- ddply(DeepingStNicholas21_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas21_gr_max <- sum(DeepingStNicholas21_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas21_gr_max
DeepingStNicholas21_gr_pres <- sum(DeepingStNicholas21_grframelong_sum $max > 0)
DeepingStNicholas21_gr_pres

#number of sites which would be classified as low
DeepingStNicholas21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas21_grframelong_sum$max)
DeepingStNicholas21_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas21_gr_high_ref <- sum( DeepingStNicholas21_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas21_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas21_gr_mod_ref <- 1000 - (DeepingStNicholas21_gr_high_ref + DeepingStNicholas21_gr_lw_ref)
DeepingStNicholas21_gr_mod_ref

#22 detectors
DeepingStNicholas22_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
DeepingStNicholas22_grframe<-data.frame(DeepingStNicholas22_gr, samp2)
DeepingStNicholas22_grframelong <- melt(DeepingStNicholas22_grframe,id.vars="samp2")
DeepingStNicholas22_grframelong_sum <- ddply(DeepingStNicholas22_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas22_gr_max <- sum(DeepingStNicholas22_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas22_gr_max
DeepingStNicholas22_gr_pres <- sum(DeepingStNicholas22_grframelong_sum $max > 0)
DeepingStNicholas22_gr_pres

#number of sites which would be classified as low
DeepingStNicholas22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas22_grframelong_sum$max)
DeepingStNicholas22_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas22_gr_high_ref <- sum( DeepingStNicholas22_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas22_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas22_gr_mod_ref <- 1000 - (DeepingStNicholas22_gr_high_ref + DeepingStNicholas22_gr_lw_ref)
DeepingStNicholas22_gr_mod_ref

#23 detectors
DeepingStNicholas23_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
DeepingStNicholas23_grframe<-data.frame(DeepingStNicholas23_gr, samp2)
DeepingStNicholas23_grframelong <- melt(DeepingStNicholas23_grframe,id.vars="samp2")
DeepingStNicholas23_grframelong_sum <- ddply(DeepingStNicholas23_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas23_gr_max <- sum(DeepingStNicholas23_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas23_gr_max
DeepingStNicholas23_gr_pres <- sum(DeepingStNicholas23_grframelong_sum $max > 0)
DeepingStNicholas23_gr_pres

#number of sites which would be classified as low
DeepingStNicholas23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas23_grframelong_sum$max)
DeepingStNicholas23_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas23_gr_high_ref <- sum( DeepingStNicholas23_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas23_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas23_gr_mod_ref <- 1000 - (DeepingStNicholas23_gr_high_ref + DeepingStNicholas23_gr_lw_ref)
DeepingStNicholas23_gr_mod_ref

#24 detectors
DeepingStNicholas24_gr<-(replicate(1000, (sample(DeepingStNicholaspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
DeepingStNicholas24_grframe<-data.frame(DeepingStNicholas24_gr, samp2)
DeepingStNicholas24_grframelong <- melt(DeepingStNicholas24_grframe,id.vars="samp2")
DeepingStNicholas24_grframelong_sum <- ddply(DeepingStNicholas24_grframelong, "variable", summarise,
                                             N    = length(value),
                                             max  = max(value))
DeepingStNicholas24_gr_max <- sum(DeepingStNicholas24_grframelong_sum $max > max20_DeepingStNicholaspipgr)
DeepingStNicholas24_gr_max
DeepingStNicholas24_gr_pres <- sum(DeepingStNicholas24_grframelong_sum $max > 0)
DeepingStNicholas24_gr_pres

#number of sites which would be classified as low
DeepingStNicholas24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= DeepingStNicholas24_grframelong_sum$max)
DeepingStNicholas24_gr_lw_ref
#number of sites which would be classified as high
DeepingStNicholas24_gr_high_ref <- sum( DeepingStNicholas24_grframelong_sum$max > allsppgr_ppip_ref_high)
DeepingStNicholas24_gr_high_ref
#number of sites which would be classified as moderate
DeepingStNicholas24_gr_mod_ref <- 1000 - (DeepingStNicholas24_gr_high_ref + DeepingStNicholas24_gr_lw_ref)
DeepingStNicholas24_gr_mod_ref

Present<-c(DeepingStNicholas1_gr_pres,DeepingStNicholas2_gr_pres,
           DeepingStNicholas3_gr_pres,DeepingStNicholas4_gr_pres,
           DeepingStNicholas5_gr_pres,DeepingStNicholas6_gr_pres,
           DeepingStNicholas7_gr_pres,DeepingStNicholas8_gr_pres,
           DeepingStNicholas9_gr_pres,DeepingStNicholas10_gr_pres,
           DeepingStNicholas11_gr_pres,DeepingStNicholas12_gr_pres,
           DeepingStNicholas13_gr_pres,DeepingStNicholas14_gr_pres,
           DeepingStNicholas15_gr_pres,DeepingStNicholas16_gr_pres,
           DeepingStNicholas17_gr_pres,DeepingStNicholas18_gr_pres,
           DeepingStNicholas19_gr_pres,DeepingStNicholas20_gr_pres,
           DeepingStNicholas21_gr_pres,DeepingStNicholas22_gr_pres,
           DeepingStNicholas23_gr_pres,DeepingStNicholas24_gr_pres)


Maximum<-c(DeepingStNicholas1_gr_max,DeepingStNicholas2_gr_max,
           DeepingStNicholas3_gr_max,DeepingStNicholas4_gr_max,
           DeepingStNicholas5_gr_max,DeepingStNicholas6_gr_max,
           DeepingStNicholas7_gr_max,DeepingStNicholas8_gr_max,
           DeepingStNicholas9_gr_max,DeepingStNicholas10_gr_max,
           DeepingStNicholas11_gr_max,DeepingStNicholas12_gr_max,
           DeepingStNicholas13_gr_max,DeepingStNicholas14_gr_max,
           DeepingStNicholas15_gr_max,DeepingStNicholas16_gr_max,
           DeepingStNicholas17_gr_max,DeepingStNicholas18_gr_max,
           DeepingStNicholas19_gr_max,DeepingStNicholas20_gr_max,
           DeepingStNicholas21_gr_max,DeepingStNicholas22_gr_max,
           DeepingStNicholas23_gr_max,DeepingStNicholas24_gr_max)

Low<-c(DeepingStNicholas1_gr_lw_ref, DeepingStNicholas2_gr_lw_ref, DeepingStNicholas3_gr_lw_ref,
       DeepingStNicholas4_gr_lw_ref, DeepingStNicholas5_gr_lw_ref, DeepingStNicholas6_gr_lw_ref,
       DeepingStNicholas7_gr_lw_ref, DeepingStNicholas8_gr_lw_ref, DeepingStNicholas9_gr_lw_ref,
       DeepingStNicholas10_gr_lw_ref, DeepingStNicholas11_gr_lw_ref, DeepingStNicholas12_gr_lw_ref, 
       DeepingStNicholas13_gr_lw_ref, DeepingStNicholas14_gr_lw_ref, DeepingStNicholas15_gr_lw_ref, 
       DeepingStNicholas16_gr_lw_ref, DeepingStNicholas17_gr_lw_ref, DeepingStNicholas18_gr_lw_ref, 
       DeepingStNicholas19_gr_lw_ref, DeepingStNicholas20_gr_lw_ref, DeepingStNicholas21_gr_lw_ref,
       DeepingStNicholas22_gr_lw_ref,DeepingStNicholas23_gr_lw_ref,DeepingStNicholas24_gr_lw_ref)

Moderate<-c(DeepingStNicholas1_gr_mod_ref, DeepingStNicholas2_gr_mod_ref, DeepingStNicholas3_gr_mod_ref,
            DeepingStNicholas4_gr_mod_ref, DeepingStNicholas5_gr_mod_ref, DeepingStNicholas6_gr_mod_ref,
            DeepingStNicholas7_gr_mod_ref, DeepingStNicholas8_gr_mod_ref, DeepingStNicholas9_gr_mod_ref,
            DeepingStNicholas10_gr_mod_ref, DeepingStNicholas11_gr_mod_ref, DeepingStNicholas12_gr_mod_ref, 
            DeepingStNicholas13_gr_mod_ref, DeepingStNicholas14_gr_mod_ref, DeepingStNicholas15_gr_mod_ref, 
            DeepingStNicholas16_gr_mod_ref, DeepingStNicholas17_gr_mod_ref, DeepingStNicholas18_gr_mod_ref, 
            DeepingStNicholas19_gr_mod_ref, DeepingStNicholas20_gr_mod_ref, DeepingStNicholas21_gr_mod_ref,
            DeepingStNicholas22_gr_mod_ref,DeepingStNicholas23_gr_mod_ref,DeepingStNicholas24_gr_mod_ref)

High<-c(DeepingStNicholas1_gr_high_ref, DeepingStNicholas2_gr_high_ref, DeepingStNicholas3_gr_high_ref,
        DeepingStNicholas4_gr_high_ref, DeepingStNicholas5_gr_high_ref, DeepingStNicholas6_gr_high_ref,
        DeepingStNicholas7_gr_high_ref, DeepingStNicholas8_gr_high_ref, DeepingStNicholas9_gr_high_ref,
        DeepingStNicholas10_gr_high_ref, DeepingStNicholas11_gr_high_ref, DeepingStNicholas12_gr_high_ref, 
        DeepingStNicholas13_gr_high_ref, DeepingStNicholas14_gr_high_ref, DeepingStNicholas15_gr_high_ref, 
        DeepingStNicholas16_gr_high_ref, DeepingStNicholas17_gr_high_ref, DeepingStNicholas18_gr_high_ref, 
        DeepingStNicholas19_gr_high_ref, DeepingStNicholas20_gr_high_ref, DeepingStNicholas21_gr_high_ref,
        DeepingStNicholas22_gr_high_ref,DeepingStNicholas23_gr_high_ref,DeepingStNicholas24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("DeepingStNicholasgr",24)
Lowsite <- DeepingStNicholaslow
Modsite <- DeepingStNicholasmod
Highsite <-DeepingStNicholashigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



DeepingStNicholasgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                        Site, Low, Moderate, High,
                                        Lowsite, Modsite, Highsite)

##Drumderg

Drumdergpipgr<-subset(allspp4gr_ppip, Site=="Drumderg")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Drumdergpipgr<-max(Drumdergpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Drumdergpipgr<- (max_Drumdergpipgr/100)*80

##calculate the site classification (reference range)

Drumderghigh<- max_Drumdergpipgr > allsppgr_ppip_ref_high

Drumderglow<- allsppgr_ppip_ref_low > max_Drumdergpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Drumdergpipgr
Drumdergmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Drumderg1_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 1, replace=F))))
Drumderg1_gr_max <- sum(Drumderg1_gr > max20_Drumdergpipgr)
Drumderg1_gr_max
Drumderg1_gr_pres <- sum(Drumderg1_gr > 0)
Drumderg1_gr_pres
#number of sites which would be classified as low
Drumderg1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg1_gr)
Drumderg1_gr_lw_ref
#number of sites which would be classified as high
Drumderg1_gr_high_ref <- sum( Drumderg1_gr > allsppgr_ppip_ref_high)
Drumderg1_gr_high_ref
#number of sites which would be classified as moderate
Drumderg1_gr_mod_ref <- 1000 - (Drumderg1_gr_high_ref + Drumderg1_gr_lw_ref)
Drumderg1_gr_mod_ref


#2 nights
Drumderg2_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Drumderg2_grframe<-data.frame(Drumderg2_gr, samp2)
Drumderg2_grframelong <- melt(Drumderg2_grframe,id.vars="samp2")
Drumderg2_grframelong_sum <- ddply(Drumderg2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg2_gr_max <- sum(Drumderg2_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg2_gr_max
Drumderg2_gr_pres <- sum(Drumderg2_grframelong_sum $max > 0)
Drumderg2_gr_pres

#number of sites which would be classified as low
Drumderg2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg2_grframelong_sum$max)
Drumderg2_gr_lw_ref
#number of sites which would be classified as high
Drumderg2_gr_high_ref <- sum( Drumderg2_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg2_gr_high_ref
#number of sites which would be classified as moderate
Drumderg2_gr_mod_ref <- 1000 - (Drumderg2_gr_high_ref + Drumderg2_gr_lw_ref)
Drumderg2_gr_mod_ref


#3 nights
Drumderg3_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Drumderg3_grframe<-data.frame(Drumderg3_gr, samp2)
Drumderg3_grframelong <- melt(Drumderg3_grframe,id.vars="samp2")
Drumderg3_grframelong_sum <- ddply(Drumderg3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg3_gr_max <- sum(Drumderg3_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg3_gr_max
Drumderg3_gr_pres <- sum(Drumderg3_grframelong_sum $max > 0)
Drumderg3_gr_pres

#number of sites which would be classified as low
Drumderg3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg3_grframelong_sum$max)
Drumderg3_gr_lw_ref
#number of sites which would be classified as high
Drumderg3_gr_high_ref <- sum( Drumderg3_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg3_gr_high_ref
#number of sites which would be classified as moderate
Drumderg3_gr_mod_ref <- 1000 - (Drumderg3_gr_high_ref + Drumderg3_gr_lw_ref)
Drumderg3_gr_mod_ref

#4 nights
Drumderg4_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Drumderg4_grframe<-data.frame(Drumderg4_gr, samp2)
Drumderg4_grframelong <- melt(Drumderg4_grframe,id.vars="samp2")
Drumderg4_grframelong_sum <- ddply(Drumderg4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg4_gr_max <- sum(Drumderg4_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg4_gr_max
Drumderg4_gr_pres <- sum(Drumderg4_grframelong_sum $max > 0)
Drumderg4_gr_pres

#number of sites which would be classified as low
Drumderg4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg4_grframelong_sum$max)
Drumderg4_gr_lw_ref
#number of sites which would be classified as high
Drumderg4_gr_high_ref <- sum( Drumderg4_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg4_gr_high_ref
#number of sites which would be classified as moderate
Drumderg4_gr_mod_ref <- 1000 - (Drumderg4_gr_high_ref + Drumderg4_gr_lw_ref)
Drumderg4_gr_mod_ref

#5 nights
Drumderg5_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Drumderg5_grframe<-data.frame(Drumderg5_gr, samp2)
Drumderg5_grframelong <- melt(Drumderg5_grframe,id.vars="samp2")
Drumderg5_grframelong_sum <- ddply(Drumderg5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg5_gr_max <- sum(Drumderg5_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg5_gr_max
Drumderg5_gr_pres <- sum(Drumderg5_grframelong_sum $max > 0)
Drumderg5_gr_pres

#number of sites which would be classified as low
Drumderg5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg5_grframelong_sum$max)
Drumderg5_gr_lw_ref
#number of sites which would be classified as high
Drumderg5_gr_high_ref <- sum( Drumderg5_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg5_gr_high_ref
#number of sites which would be classified as moderate
Drumderg5_gr_mod_ref <- 1000 - (Drumderg5_gr_high_ref + Drumderg5_gr_lw_ref)
Drumderg5_gr_mod_ref

#6 nights
Drumderg6_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Drumderg6_grframe<-data.frame(Drumderg6_gr, samp2)
Drumderg6_grframelong <- melt(Drumderg6_grframe,id.vars="samp2")
Drumderg6_grframelong_sum <- ddply(Drumderg6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg6_gr_max <- sum(Drumderg6_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg6_gr_max
Drumderg6_gr_pres <- sum(Drumderg6_grframelong_sum $max > 0)
Drumderg6_gr_pres

#number of sites which would be classified as low
Drumderg6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg6_grframelong_sum$max)
Drumderg6_gr_lw_ref
#number of sites which would be classified as high
Drumderg6_gr_high_ref <- sum( Drumderg6_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg6_gr_high_ref
#number of sites which would be classified as moderate
Drumderg6_gr_mod_ref <- 1000 - (Drumderg6_gr_high_ref + Drumderg6_gr_lw_ref)
Drumderg6_gr_mod_ref

#7 nights
Drumderg7_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Drumderg7_grframe<-data.frame(Drumderg7_gr, samp2)
Drumderg7_grframelong <- melt(Drumderg7_grframe,id.vars="samp2")
Drumderg7_grframelong_sum <- ddply(Drumderg7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg7_gr_max <- sum(Drumderg7_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg7_gr_max
Drumderg7_gr_pres <- sum(Drumderg7_grframelong_sum $max > 0)
Drumderg7_gr_pres

#number of sites which would be classified as low
Drumderg7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg7_grframelong_sum$max)
Drumderg7_gr_lw_ref
#number of sites which would be classified as high
Drumderg7_gr_high_ref <- sum( Drumderg7_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg7_gr_high_ref
#number of sites which would be classified as moderate
Drumderg7_gr_mod_ref <- 1000 - (Drumderg7_gr_high_ref + Drumderg7_gr_lw_ref)
Drumderg7_gr_mod_ref

#8 nights
Drumderg8_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Drumderg8_grframe<-data.frame(Drumderg8_gr, samp2)
Drumderg8_grframelong <- melt(Drumderg8_grframe,id.vars="samp2")
Drumderg8_grframelong_sum <- ddply(Drumderg8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg8_gr_max <- sum(Drumderg8_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg8_gr_max
Drumderg8_gr_pres <- sum(Drumderg8_grframelong_sum $max > 0)
Drumderg8_gr_pres

#number of sites which would be classified as low
Drumderg8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg8_grframelong_sum$max)
Drumderg8_gr_lw_ref
#number of sites which would be classified as high
Drumderg8_gr_high_ref <- sum( Drumderg8_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg8_gr_high_ref
#number of sites which would be classified as moderate
Drumderg8_gr_mod_ref <- 1000 - (Drumderg8_gr_high_ref + Drumderg8_gr_lw_ref)
Drumderg8_gr_mod_ref

#9 nights
Drumderg9_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Drumderg9_grframe<-data.frame(Drumderg9_gr, samp2)
Drumderg9_grframelong <- melt(Drumderg9_grframe,id.vars="samp2")
Drumderg9_grframelong_sum <- ddply(Drumderg9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Drumderg9_gr_max <- sum(Drumderg9_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg9_gr_max
Drumderg9_gr_pres <- sum(Drumderg9_grframelong_sum $max > 0)
Drumderg9_gr_pres

#number of sites which would be classified as low
Drumderg9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg9_grframelong_sum$max)
Drumderg9_gr_lw_ref
#number of sites which would be classified as high
Drumderg9_gr_high_ref <- sum( Drumderg9_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg9_gr_high_ref
#number of sites which would be classified as moderate
Drumderg9_gr_mod_ref <- 1000 - (Drumderg9_gr_high_ref + Drumderg9_gr_lw_ref)
Drumderg9_gr_mod_ref

#10 detectors
Drumderg10_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Drumderg10_grframe<-data.frame(Drumderg10_gr, samp2)
Drumderg10_grframelong <- melt(Drumderg10_grframe,id.vars="samp2")
Drumderg10_grframelong_sum <- ddply(Drumderg10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg10_gr_max <- sum(Drumderg10_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg10_gr_max
Drumderg10_gr_pres <- sum(Drumderg10_grframelong_sum $max > 0)
Drumderg10_gr_pres

#number of sites which would be classified as low
Drumderg10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg10_grframelong_sum$max)
Drumderg10_gr_lw_ref
#number of sites which would be classified as high
Drumderg10_gr_high_ref <- sum( Drumderg10_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg10_gr_high_ref
#number of sites which would be classified as moderate
Drumderg10_gr_mod_ref <- 1000 - (Drumderg10_gr_high_ref + Drumderg10_gr_lw_ref)
Drumderg10_gr_mod_ref

#11 detectors
Drumderg11_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Drumderg11_grframe<-data.frame(Drumderg11_gr, samp2)
Drumderg11_grframelong <- melt(Drumderg11_grframe,id.vars="samp2")
Drumderg11_grframelong_sum <- ddply(Drumderg11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg11_gr_max <- sum(Drumderg11_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg11_gr_max
Drumderg11_gr_pres <- sum(Drumderg11_grframelong_sum $max > 0)
Drumderg11_gr_pres

#number of sites which would be classified as low
Drumderg11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg11_grframelong_sum$max)
Drumderg11_gr_lw_ref
#number of sites which would be classified as high
Drumderg11_gr_high_ref <- sum( Drumderg11_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg11_gr_high_ref
#number of sites which would be classified as moderate
Drumderg11_gr_mod_ref <- 1000 - (Drumderg11_gr_high_ref + Drumderg11_gr_lw_ref)
Drumderg11_gr_mod_ref

#12 detectors
Drumderg12_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Drumderg12_grframe<-data.frame(Drumderg12_gr, samp2)
Drumderg12_grframelong <- melt(Drumderg12_grframe,id.vars="samp2")
Drumderg12_grframelong_sum <- ddply(Drumderg12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg12_gr_max <- sum(Drumderg12_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg12_gr_max
Drumderg12_gr_pres <- sum(Drumderg12_grframelong_sum $max > 0)
Drumderg12_gr_pres

#number of sites which would be classified as low
Drumderg12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg12_grframelong_sum$max)
Drumderg12_gr_lw_ref
#number of sites which would be classified as high
Drumderg12_gr_high_ref <- sum( Drumderg12_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg12_gr_high_ref
#number of sites which would be classified as moderate
Drumderg12_gr_mod_ref <- 1000 - (Drumderg12_gr_high_ref + Drumderg12_gr_lw_ref)
Drumderg12_gr_mod_ref

#13 detectors
Drumderg13_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Drumderg13_grframe<-data.frame(Drumderg13_gr, samp2)
Drumderg13_grframelong <- melt(Drumderg13_grframe,id.vars="samp2")
Drumderg13_grframelong_sum <- ddply(Drumderg13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg13_gr_max <- sum(Drumderg13_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg13_gr_max
Drumderg13_gr_pres <- sum(Drumderg13_grframelong_sum $max > 0)
Drumderg13_gr_pres

#number of sites which would be classified as low
Drumderg13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg13_grframelong_sum$max)
Drumderg13_gr_lw_ref
#number of sites which would be classified as high
Drumderg13_gr_high_ref <- sum( Drumderg13_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg13_gr_high_ref
#number of sites which would be classified as moderate
Drumderg13_gr_mod_ref <- 1000 - (Drumderg13_gr_high_ref + Drumderg13_gr_lw_ref)
Drumderg13_gr_mod_ref

#14 detectors
Drumderg14_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Drumderg14_grframe<-data.frame(Drumderg14_gr, samp2)
Drumderg14_grframelong <- melt(Drumderg14_grframe,id.vars="samp2")
Drumderg14_grframelong_sum <- ddply(Drumderg14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg14_gr_max <- sum(Drumderg14_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg14_gr_max
Drumderg14_gr_pres <- sum(Drumderg14_grframelong_sum $max > 0)
Drumderg14_gr_pres

#number of sites which would be classified as low
Drumderg14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg14_grframelong_sum$max)
Drumderg14_gr_lw_ref
#number of sites which would be classified as high
Drumderg14_gr_high_ref <- sum( Drumderg14_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg14_gr_high_ref
#number of sites which would be classified as moderate
Drumderg14_gr_mod_ref <- 1000 - (Drumderg14_gr_high_ref + Drumderg14_gr_lw_ref)
Drumderg14_gr_mod_ref

#15 detectors
Drumderg15_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Drumderg15_grframe<-data.frame(Drumderg15_gr, samp2)
Drumderg15_grframelong <- melt(Drumderg15_grframe,id.vars="samp2")
Drumderg15_grframelong_sum <- ddply(Drumderg15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg15_gr_max <- sum(Drumderg15_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg15_gr_max
Drumderg15_gr_pres <- sum(Drumderg15_grframelong_sum $max > 0)
Drumderg15_gr_pres

#number of sites which would be classified as low
Drumderg15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg15_grframelong_sum$max)
Drumderg15_gr_lw_ref
#number of sites which would be classified as high
Drumderg15_gr_high_ref <- sum( Drumderg15_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg15_gr_high_ref
#number of sites which would be classified as moderate
Drumderg15_gr_mod_ref <- 1000 - (Drumderg15_gr_high_ref + Drumderg15_gr_lw_ref)
Drumderg15_gr_mod_ref

#16 detectors
Drumderg16_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Drumderg16_grframe<-data.frame(Drumderg16_gr, samp2)
Drumderg16_grframelong <- melt(Drumderg16_grframe,id.vars="samp2")
Drumderg16_grframelong_sum <- ddply(Drumderg16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg16_gr_max <- sum(Drumderg16_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg16_gr_max
Drumderg16_gr_pres <- sum(Drumderg16_grframelong_sum $max > 0)
Drumderg16_gr_pres

#number of sites which would be classified as low
Drumderg16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg16_grframelong_sum$max)
Drumderg16_gr_lw_ref
#number of sites which would be classified as high
Drumderg16_gr_high_ref <- sum( Drumderg16_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg16_gr_high_ref
#number of sites which would be classified as moderate
Drumderg16_gr_mod_ref <- 1000 - (Drumderg16_gr_high_ref + Drumderg16_gr_lw_ref)
Drumderg16_gr_mod_ref

#17 detectors
Drumderg17_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Drumderg17_grframe<-data.frame(Drumderg17_gr, samp2)
Drumderg17_grframelong <- melt(Drumderg17_grframe,id.vars="samp2")
Drumderg17_grframelong_sum <- ddply(Drumderg17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg17_gr_max <- sum(Drumderg17_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg17_gr_max
Drumderg17_gr_pres <- sum(Drumderg17_grframelong_sum $max > 0)
Drumderg17_gr_pres

#number of sites which would be classified as low
Drumderg17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg17_grframelong_sum$max)
Drumderg17_gr_lw_ref
#number of sites which would be classified as high
Drumderg17_gr_high_ref <- sum( Drumderg17_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg17_gr_high_ref
#number of sites which would be classified as moderate
Drumderg17_gr_mod_ref <- 1000 - (Drumderg17_gr_high_ref + Drumderg17_gr_lw_ref)
Drumderg17_gr_mod_ref

#18 detectors
Drumderg18_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Drumderg18_grframe<-data.frame(Drumderg18_gr, samp2)
Drumderg18_grframelong <- melt(Drumderg18_grframe,id.vars="samp2")
Drumderg18_grframelong_sum <- ddply(Drumderg18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg18_gr_max <- sum(Drumderg18_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg18_gr_max
Drumderg18_gr_pres <- sum(Drumderg18_grframelong_sum $max > 0)
Drumderg18_gr_pres

#number of sites which would be classified as low
Drumderg18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg18_grframelong_sum$max)
Drumderg18_gr_lw_ref
#number of sites which would be classified as high
Drumderg18_gr_high_ref <- sum( Drumderg18_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg18_gr_high_ref
#number of sites which would be classified as moderate
Drumderg18_gr_mod_ref <- 1000 - (Drumderg18_gr_high_ref + Drumderg18_gr_lw_ref)
Drumderg18_gr_mod_ref

#19 detectors
Drumderg19_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Drumderg19_grframe<-data.frame(Drumderg19_gr, samp2)
Drumderg19_grframelong <- melt(Drumderg19_grframe,id.vars="samp2")
Drumderg19_grframelong_sum <- ddply(Drumderg19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg19_gr_max <- sum(Drumderg19_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg19_gr_max
Drumderg19_gr_pres <- sum(Drumderg19_grframelong_sum $max > 0)
Drumderg19_gr_pres

#number of sites which would be classified as low
Drumderg19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg19_grframelong_sum$max)
Drumderg19_gr_lw_ref
#number of sites which would be classified as high
Drumderg19_gr_high_ref <- sum( Drumderg19_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg19_gr_high_ref
#number of sites which would be classified as moderate
Drumderg19_gr_mod_ref <- 1000 - (Drumderg19_gr_high_ref + Drumderg19_gr_lw_ref)
Drumderg19_gr_mod_ref

#20 detectors
Drumderg20_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Drumderg20_grframe<-data.frame(Drumderg20_gr, samp2)
Drumderg20_grframelong <- melt(Drumderg20_grframe,id.vars="samp2")
Drumderg20_grframelong_sum <- ddply(Drumderg20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg20_gr_max <- sum(Drumderg20_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg20_gr_max
Drumderg20_gr_pres <- sum(Drumderg20_grframelong_sum $max > 0)
Drumderg20_gr_pres

#number of sites which would be classified as low
Drumderg20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg20_grframelong_sum$max)
Drumderg20_gr_lw_ref
#number of sites which would be classified as high
Drumderg20_gr_high_ref <- sum( Drumderg20_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg20_gr_high_ref
#number of sites which would be classified as moderate
Drumderg20_gr_mod_ref <- 1000 - (Drumderg20_gr_high_ref + Drumderg20_gr_lw_ref)
Drumderg20_gr_mod_ref

#21 detectors
Drumderg21_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Drumderg21_grframe<-data.frame(Drumderg21_gr, samp2)
Drumderg21_grframelong <- melt(Drumderg21_grframe,id.vars="samp2")
Drumderg21_grframelong_sum <- ddply(Drumderg21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg21_gr_max <- sum(Drumderg21_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg21_gr_max
Drumderg21_gr_pres <- sum(Drumderg21_grframelong_sum $max > 0)
Drumderg21_gr_pres

#number of sites which would be classified as low
Drumderg21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg21_grframelong_sum$max)
Drumderg21_gr_lw_ref
#number of sites which would be classified as high
Drumderg21_gr_high_ref <- sum( Drumderg21_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg21_gr_high_ref
#number of sites which would be classified as moderate
Drumderg21_gr_mod_ref <- 1000 - (Drumderg21_gr_high_ref + Drumderg21_gr_lw_ref)
Drumderg21_gr_mod_ref

#22 detectors
Drumderg22_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Drumderg22_grframe<-data.frame(Drumderg22_gr, samp2)
Drumderg22_grframelong <- melt(Drumderg22_grframe,id.vars="samp2")
Drumderg22_grframelong_sum <- ddply(Drumderg22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg22_gr_max <- sum(Drumderg22_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg22_gr_max
Drumderg22_gr_pres <- sum(Drumderg22_grframelong_sum $max > 0)
Drumderg22_gr_pres

#number of sites which would be classified as low
Drumderg22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg22_grframelong_sum$max)
Drumderg22_gr_lw_ref
#number of sites which would be classified as high
Drumderg22_gr_high_ref <- sum( Drumderg22_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg22_gr_high_ref
#number of sites which would be classified as moderate
Drumderg22_gr_mod_ref <- 1000 - (Drumderg22_gr_high_ref + Drumderg22_gr_lw_ref)
Drumderg22_gr_mod_ref

#23 detectors
Drumderg23_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Drumderg23_grframe<-data.frame(Drumderg23_gr, samp2)
Drumderg23_grframelong <- melt(Drumderg23_grframe,id.vars="samp2")
Drumderg23_grframelong_sum <- ddply(Drumderg23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg23_gr_max <- sum(Drumderg23_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg23_gr_max
Drumderg23_gr_pres <- sum(Drumderg23_grframelong_sum $max > 0)
Drumderg23_gr_pres

#number of sites which would be classified as low
Drumderg23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg23_grframelong_sum$max)
Drumderg23_gr_lw_ref
#number of sites which would be classified as high
Drumderg23_gr_high_ref <- sum( Drumderg23_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg23_gr_high_ref
#number of sites which would be classified as moderate
Drumderg23_gr_mod_ref <- 1000 - (Drumderg23_gr_high_ref + Drumderg23_gr_lw_ref)
Drumderg23_gr_mod_ref

#24 detectors
Drumderg24_gr<-(replicate(1000, (sample(Drumdergpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Drumderg24_grframe<-data.frame(Drumderg24_gr, samp2)
Drumderg24_grframelong <- melt(Drumderg24_grframe,id.vars="samp2")
Drumderg24_grframelong_sum <- ddply(Drumderg24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Drumderg24_gr_max <- sum(Drumderg24_grframelong_sum $max > max20_Drumdergpipgr)
Drumderg24_gr_max
Drumderg24_gr_pres <- sum(Drumderg24_grframelong_sum $max > 0)
Drumderg24_gr_pres

#number of sites which would be classified as low
Drumderg24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Drumderg24_grframelong_sum$max)
Drumderg24_gr_lw_ref
#number of sites which would be classified as high
Drumderg24_gr_high_ref <- sum( Drumderg24_grframelong_sum$max > allsppgr_ppip_ref_high)
Drumderg24_gr_high_ref
#number of sites which would be classified as moderate
Drumderg24_gr_mod_ref <- 1000 - (Drumderg24_gr_high_ref + Drumderg24_gr_lw_ref)
Drumderg24_gr_mod_ref

Present<-c(Drumderg1_gr_pres,Drumderg2_gr_pres,
           Drumderg3_gr_pres,Drumderg4_gr_pres,
           Drumderg5_gr_pres,Drumderg6_gr_pres,
           Drumderg7_gr_pres,Drumderg8_gr_pres,
           Drumderg9_gr_pres,Drumderg10_gr_pres,
           Drumderg11_gr_pres,Drumderg12_gr_pres,
           Drumderg13_gr_pres,Drumderg14_gr_pres,
           Drumderg15_gr_pres,Drumderg16_gr_pres,
           Drumderg17_gr_pres,Drumderg18_gr_pres,
           Drumderg19_gr_pres,Drumderg20_gr_pres,
           Drumderg21_gr_pres,Drumderg22_gr_pres,
           Drumderg23_gr_pres,Drumderg24_gr_pres)


Maximum<-c(Drumderg1_gr_max,Drumderg2_gr_max,
           Drumderg3_gr_max,Drumderg4_gr_max,
           Drumderg5_gr_max,Drumderg6_gr_max,
           Drumderg7_gr_max,Drumderg8_gr_max,
           Drumderg9_gr_max,Drumderg10_gr_max,
           Drumderg11_gr_max,Drumderg12_gr_max,
           Drumderg13_gr_max,Drumderg14_gr_max,
           Drumderg15_gr_max,Drumderg16_gr_max,
           Drumderg17_gr_max,Drumderg18_gr_max,
           Drumderg19_gr_max,Drumderg20_gr_max,
           Drumderg21_gr_max,Drumderg22_gr_max,
           Drumderg23_gr_max,Drumderg24_gr_max)

Low<-c(Drumderg1_gr_lw_ref, Drumderg2_gr_lw_ref, Drumderg3_gr_lw_ref,
       Drumderg4_gr_lw_ref, Drumderg5_gr_lw_ref, Drumderg6_gr_lw_ref,
       Drumderg7_gr_lw_ref, Drumderg8_gr_lw_ref, Drumderg9_gr_lw_ref,
       Drumderg10_gr_lw_ref, Drumderg11_gr_lw_ref, Drumderg12_gr_lw_ref, 
       Drumderg13_gr_lw_ref, Drumderg14_gr_lw_ref, Drumderg15_gr_lw_ref, 
       Drumderg16_gr_lw_ref, Drumderg17_gr_lw_ref, Drumderg18_gr_lw_ref, 
       Drumderg19_gr_lw_ref, Drumderg20_gr_lw_ref, Drumderg21_gr_lw_ref,
       Drumderg22_gr_lw_ref,Drumderg23_gr_lw_ref,Drumderg24_gr_lw_ref)

Moderate<-c(Drumderg1_gr_mod_ref, Drumderg2_gr_mod_ref, Drumderg3_gr_mod_ref,
            Drumderg4_gr_mod_ref, Drumderg5_gr_mod_ref, Drumderg6_gr_mod_ref,
            Drumderg7_gr_mod_ref, Drumderg8_gr_mod_ref, Drumderg9_gr_mod_ref,
            Drumderg10_gr_mod_ref, Drumderg11_gr_mod_ref, Drumderg12_gr_mod_ref, 
            Drumderg13_gr_mod_ref, Drumderg14_gr_mod_ref, Drumderg15_gr_mod_ref, 
            Drumderg16_gr_mod_ref, Drumderg17_gr_mod_ref, Drumderg18_gr_mod_ref, 
            Drumderg19_gr_mod_ref, Drumderg20_gr_mod_ref, Drumderg21_gr_mod_ref,
            Drumderg22_gr_mod_ref,Drumderg23_gr_mod_ref,Drumderg24_gr_mod_ref)

High<-c(Drumderg1_gr_high_ref, Drumderg2_gr_high_ref, Drumderg3_gr_high_ref,
        Drumderg4_gr_high_ref, Drumderg5_gr_high_ref, Drumderg6_gr_high_ref,
        Drumderg7_gr_high_ref, Drumderg8_gr_high_ref, Drumderg9_gr_high_ref,
        Drumderg10_gr_high_ref, Drumderg11_gr_high_ref, Drumderg12_gr_high_ref, 
        Drumderg13_gr_high_ref, Drumderg14_gr_high_ref, Drumderg15_gr_high_ref, 
        Drumderg16_gr_high_ref, Drumderg17_gr_high_ref, Drumderg18_gr_high_ref, 
        Drumderg19_gr_high_ref, Drumderg20_gr_high_ref, Drumderg21_gr_high_ref,
        Drumderg22_gr_high_ref,Drumderg23_gr_high_ref,Drumderg24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Drumderggr",24)
Lowsite <- Drumderglow
Modsite <- Drumdergmod
Highsite <-Drumderghigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Drumderggr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##FairburnEstate

FairburnEstatepipgr<-subset(allspp4gr_ppip, Site=="FairburnEstate")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_FairburnEstatepipgr<-max(FairburnEstatepipgr$Passes)

#calculate 20% from maximum nightly record

max20_FairburnEstatepipgr<- (max_FairburnEstatepipgr/100)*80

##calculate the site classification (reference range)

FairburnEstatehigh<- max_FairburnEstatepipgr > allsppgr_ppip_ref_high

FairburnEstatelow<- allsppgr_ppip_ref_low > max_FairburnEstatepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_FairburnEstatepipgr
FairburnEstatemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
FairburnEstate1_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 1, replace=F))))
FairburnEstate1_gr_max <- sum(FairburnEstate1_gr > max20_FairburnEstatepipgr)
FairburnEstate1_gr_max
FairburnEstate1_gr_pres <- sum(FairburnEstate1_gr > 0)
FairburnEstate1_gr_pres
#number of sites which would be classified as low
FairburnEstate1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate1_gr)
FairburnEstate1_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate1_gr_high_ref <- sum( FairburnEstate1_gr > allsppgr_ppip_ref_high)
FairburnEstate1_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate1_gr_mod_ref <- 1000 - (FairburnEstate1_gr_high_ref + FairburnEstate1_gr_lw_ref)
FairburnEstate1_gr_mod_ref


#2 nights
FairburnEstate2_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
FairburnEstate2_grframe<-data.frame(FairburnEstate2_gr, samp2)
FairburnEstate2_grframelong <- melt(FairburnEstate2_grframe,id.vars="samp2")
FairburnEstate2_grframelong_sum <- ddply(FairburnEstate2_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate2_gr_max <- sum(FairburnEstate2_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate2_gr_max
FairburnEstate2_gr_pres <- sum(FairburnEstate2_grframelong_sum $max > 0)
FairburnEstate2_gr_pres

#number of sites which would be classified as low
FairburnEstate2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate2_grframelong_sum$max)
FairburnEstate2_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate2_gr_high_ref <- sum( FairburnEstate2_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate2_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate2_gr_mod_ref <- 1000 - (FairburnEstate2_gr_high_ref + FairburnEstate2_gr_lw_ref)
FairburnEstate2_gr_mod_ref


#3 nights
FairburnEstate3_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
FairburnEstate3_grframe<-data.frame(FairburnEstate3_gr, samp2)
FairburnEstate3_grframelong <- melt(FairburnEstate3_grframe,id.vars="samp2")
FairburnEstate3_grframelong_sum <- ddply(FairburnEstate3_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate3_gr_max <- sum(FairburnEstate3_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate3_gr_max
FairburnEstate3_gr_pres <- sum(FairburnEstate3_grframelong_sum $max > 0)
FairburnEstate3_gr_pres

#number of sites which would be classified as low
FairburnEstate3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate3_grframelong_sum$max)
FairburnEstate3_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate3_gr_high_ref <- sum( FairburnEstate3_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate3_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate3_gr_mod_ref <- 1000 - (FairburnEstate3_gr_high_ref + FairburnEstate3_gr_lw_ref)
FairburnEstate3_gr_mod_ref

#4 nights
FairburnEstate4_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
FairburnEstate4_grframe<-data.frame(FairburnEstate4_gr, samp2)
FairburnEstate4_grframelong <- melt(FairburnEstate4_grframe,id.vars="samp2")
FairburnEstate4_grframelong_sum <- ddply(FairburnEstate4_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate4_gr_max <- sum(FairburnEstate4_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate4_gr_max
FairburnEstate4_gr_pres <- sum(FairburnEstate4_grframelong_sum $max > 0)
FairburnEstate4_gr_pres

#number of sites which would be classified as low
FairburnEstate4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate4_grframelong_sum$max)
FairburnEstate4_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate4_gr_high_ref <- sum( FairburnEstate4_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate4_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate4_gr_mod_ref <- 1000 - (FairburnEstate4_gr_high_ref + FairburnEstate4_gr_lw_ref)
FairburnEstate4_gr_mod_ref

#5 nights
FairburnEstate5_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
FairburnEstate5_grframe<-data.frame(FairburnEstate5_gr, samp2)
FairburnEstate5_grframelong <- melt(FairburnEstate5_grframe,id.vars="samp2")
FairburnEstate5_grframelong_sum <- ddply(FairburnEstate5_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate5_gr_max <- sum(FairburnEstate5_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate5_gr_max
FairburnEstate5_gr_pres <- sum(FairburnEstate5_grframelong_sum $max > 0)
FairburnEstate5_gr_pres

#number of sites which would be classified as low
FairburnEstate5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate5_grframelong_sum$max)
FairburnEstate5_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate5_gr_high_ref <- sum( FairburnEstate5_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate5_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate5_gr_mod_ref <- 1000 - (FairburnEstate5_gr_high_ref + FairburnEstate5_gr_lw_ref)
FairburnEstate5_gr_mod_ref

#6 nights
FairburnEstate6_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
FairburnEstate6_grframe<-data.frame(FairburnEstate6_gr, samp2)
FairburnEstate6_grframelong <- melt(FairburnEstate6_grframe,id.vars="samp2")
FairburnEstate6_grframelong_sum <- ddply(FairburnEstate6_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate6_gr_max <- sum(FairburnEstate6_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate6_gr_max
FairburnEstate6_gr_pres <- sum(FairburnEstate6_grframelong_sum $max > 0)
FairburnEstate6_gr_pres

#number of sites which would be classified as low
FairburnEstate6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate6_grframelong_sum$max)
FairburnEstate6_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate6_gr_high_ref <- sum( FairburnEstate6_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate6_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate6_gr_mod_ref <- 1000 - (FairburnEstate6_gr_high_ref + FairburnEstate6_gr_lw_ref)
FairburnEstate6_gr_mod_ref

#7 nights
FairburnEstate7_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
FairburnEstate7_grframe<-data.frame(FairburnEstate7_gr, samp2)
FairburnEstate7_grframelong <- melt(FairburnEstate7_grframe,id.vars="samp2")
FairburnEstate7_grframelong_sum <- ddply(FairburnEstate7_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate7_gr_max <- sum(FairburnEstate7_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate7_gr_max
FairburnEstate7_gr_pres <- sum(FairburnEstate7_grframelong_sum $max > 0)
FairburnEstate7_gr_pres

#number of sites which would be classified as low
FairburnEstate7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate7_grframelong_sum$max)
FairburnEstate7_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate7_gr_high_ref <- sum( FairburnEstate7_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate7_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate7_gr_mod_ref <- 1000 - (FairburnEstate7_gr_high_ref + FairburnEstate7_gr_lw_ref)
FairburnEstate7_gr_mod_ref

#8 nights
FairburnEstate8_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
FairburnEstate8_grframe<-data.frame(FairburnEstate8_gr, samp2)
FairburnEstate8_grframelong <- melt(FairburnEstate8_grframe,id.vars="samp2")
FairburnEstate8_grframelong_sum <- ddply(FairburnEstate8_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate8_gr_max <- sum(FairburnEstate8_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate8_gr_max
FairburnEstate8_gr_pres <- sum(FairburnEstate8_grframelong_sum $max > 0)
FairburnEstate8_gr_pres

#number of sites which would be classified as low
FairburnEstate8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate8_grframelong_sum$max)
FairburnEstate8_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate8_gr_high_ref <- sum( FairburnEstate8_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate8_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate8_gr_mod_ref <- 1000 - (FairburnEstate8_gr_high_ref + FairburnEstate8_gr_lw_ref)
FairburnEstate8_gr_mod_ref

#9 nights
FairburnEstate9_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
FairburnEstate9_grframe<-data.frame(FairburnEstate9_gr, samp2)
FairburnEstate9_grframelong <- melt(FairburnEstate9_grframe,id.vars="samp2")
FairburnEstate9_grframelong_sum <- ddply(FairburnEstate9_grframelong, "variable", summarise,
                                         N    = length(value),
                                         max  = max(value))
FairburnEstate9_gr_max <- sum(FairburnEstate9_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate9_gr_max
FairburnEstate9_gr_pres <- sum(FairburnEstate9_grframelong_sum $max > 0)
FairburnEstate9_gr_pres

#number of sites which would be classified as low
FairburnEstate9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate9_grframelong_sum$max)
FairburnEstate9_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate9_gr_high_ref <- sum( FairburnEstate9_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate9_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate9_gr_mod_ref <- 1000 - (FairburnEstate9_gr_high_ref + FairburnEstate9_gr_lw_ref)
FairburnEstate9_gr_mod_ref

#10 detectors
FairburnEstate10_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
FairburnEstate10_grframe<-data.frame(FairburnEstate10_gr, samp2)
FairburnEstate10_grframelong <- melt(FairburnEstate10_grframe,id.vars="samp2")
FairburnEstate10_grframelong_sum <- ddply(FairburnEstate10_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate10_gr_max <- sum(FairburnEstate10_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate10_gr_max
FairburnEstate10_gr_pres <- sum(FairburnEstate10_grframelong_sum $max > 0)
FairburnEstate10_gr_pres

#number of sites which would be classified as low
FairburnEstate10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate10_grframelong_sum$max)
FairburnEstate10_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate10_gr_high_ref <- sum( FairburnEstate10_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate10_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate10_gr_mod_ref <- 1000 - (FairburnEstate10_gr_high_ref + FairburnEstate10_gr_lw_ref)
FairburnEstate10_gr_mod_ref

#11 detectors
FairburnEstate11_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
FairburnEstate11_grframe<-data.frame(FairburnEstate11_gr, samp2)
FairburnEstate11_grframelong <- melt(FairburnEstate11_grframe,id.vars="samp2")
FairburnEstate11_grframelong_sum <- ddply(FairburnEstate11_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate11_gr_max <- sum(FairburnEstate11_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate11_gr_max
FairburnEstate11_gr_pres <- sum(FairburnEstate11_grframelong_sum $max > 0)
FairburnEstate11_gr_pres

#number of sites which would be classified as low
FairburnEstate11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate11_grframelong_sum$max)
FairburnEstate11_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate11_gr_high_ref <- sum( FairburnEstate11_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate11_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate11_gr_mod_ref <- 1000 - (FairburnEstate11_gr_high_ref + FairburnEstate11_gr_lw_ref)
FairburnEstate11_gr_mod_ref

#12 detectors
FairburnEstate12_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
FairburnEstate12_grframe<-data.frame(FairburnEstate12_gr, samp2)
FairburnEstate12_grframelong <- melt(FairburnEstate12_grframe,id.vars="samp2")
FairburnEstate12_grframelong_sum <- ddply(FairburnEstate12_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate12_gr_max <- sum(FairburnEstate12_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate12_gr_max
FairburnEstate12_gr_pres <- sum(FairburnEstate12_grframelong_sum $max > 0)
FairburnEstate12_gr_pres

#number of sites which would be classified as low
FairburnEstate12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate12_grframelong_sum$max)
FairburnEstate12_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate12_gr_high_ref <- sum( FairburnEstate12_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate12_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate12_gr_mod_ref <- 1000 - (FairburnEstate12_gr_high_ref + FairburnEstate12_gr_lw_ref)
FairburnEstate12_gr_mod_ref

#13 detectors
FairburnEstate13_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
FairburnEstate13_grframe<-data.frame(FairburnEstate13_gr, samp2)
FairburnEstate13_grframelong <- melt(FairburnEstate13_grframe,id.vars="samp2")
FairburnEstate13_grframelong_sum <- ddply(FairburnEstate13_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate13_gr_max <- sum(FairburnEstate13_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate13_gr_max
FairburnEstate13_gr_pres <- sum(FairburnEstate13_grframelong_sum $max > 0)
FairburnEstate13_gr_pres

#number of sites which would be classified as low
FairburnEstate13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate13_grframelong_sum$max)
FairburnEstate13_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate13_gr_high_ref <- sum( FairburnEstate13_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate13_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate13_gr_mod_ref <- 1000 - (FairburnEstate13_gr_high_ref + FairburnEstate13_gr_lw_ref)
FairburnEstate13_gr_mod_ref

#14 detectors
FairburnEstate14_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
FairburnEstate14_grframe<-data.frame(FairburnEstate14_gr, samp2)
FairburnEstate14_grframelong <- melt(FairburnEstate14_grframe,id.vars="samp2")
FairburnEstate14_grframelong_sum <- ddply(FairburnEstate14_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate14_gr_max <- sum(FairburnEstate14_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate14_gr_max
FairburnEstate14_gr_pres <- sum(FairburnEstate14_grframelong_sum $max > 0)
FairburnEstate14_gr_pres

#number of sites which would be classified as low
FairburnEstate14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate14_grframelong_sum$max)
FairburnEstate14_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate14_gr_high_ref <- sum( FairburnEstate14_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate14_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate14_gr_mod_ref <- 1000 - (FairburnEstate14_gr_high_ref + FairburnEstate14_gr_lw_ref)
FairburnEstate14_gr_mod_ref

#15 detectors
FairburnEstate15_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
FairburnEstate15_grframe<-data.frame(FairburnEstate15_gr, samp2)
FairburnEstate15_grframelong <- melt(FairburnEstate15_grframe,id.vars="samp2")
FairburnEstate15_grframelong_sum <- ddply(FairburnEstate15_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate15_gr_max <- sum(FairburnEstate15_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate15_gr_max
FairburnEstate15_gr_pres <- sum(FairburnEstate15_grframelong_sum $max > 0)
FairburnEstate15_gr_pres

#number of sites which would be classified as low
FairburnEstate15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate15_grframelong_sum$max)
FairburnEstate15_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate15_gr_high_ref <- sum( FairburnEstate15_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate15_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate15_gr_mod_ref <- 1000 - (FairburnEstate15_gr_high_ref + FairburnEstate15_gr_lw_ref)
FairburnEstate15_gr_mod_ref

#16 detectors
FairburnEstate16_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
FairburnEstate16_grframe<-data.frame(FairburnEstate16_gr, samp2)
FairburnEstate16_grframelong <- melt(FairburnEstate16_grframe,id.vars="samp2")
FairburnEstate16_grframelong_sum <- ddply(FairburnEstate16_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate16_gr_max <- sum(FairburnEstate16_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate16_gr_max
FairburnEstate16_gr_pres <- sum(FairburnEstate16_grframelong_sum $max > 0)
FairburnEstate16_gr_pres

#number of sites which would be classified as low
FairburnEstate16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate16_grframelong_sum$max)
FairburnEstate16_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate16_gr_high_ref <- sum( FairburnEstate16_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate16_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate16_gr_mod_ref <- 1000 - (FairburnEstate16_gr_high_ref + FairburnEstate16_gr_lw_ref)
FairburnEstate16_gr_mod_ref

#17 detectors
FairburnEstate17_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
FairburnEstate17_grframe<-data.frame(FairburnEstate17_gr, samp2)
FairburnEstate17_grframelong <- melt(FairburnEstate17_grframe,id.vars="samp2")
FairburnEstate17_grframelong_sum <- ddply(FairburnEstate17_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate17_gr_max <- sum(FairburnEstate17_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate17_gr_max
FairburnEstate17_gr_pres <- sum(FairburnEstate17_grframelong_sum $max > 0)
FairburnEstate17_gr_pres

#number of sites which would be classified as low
FairburnEstate17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate17_grframelong_sum$max)
FairburnEstate17_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate17_gr_high_ref <- sum( FairburnEstate17_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate17_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate17_gr_mod_ref <- 1000 - (FairburnEstate17_gr_high_ref + FairburnEstate17_gr_lw_ref)
FairburnEstate17_gr_mod_ref

#18 detectors
FairburnEstate18_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
FairburnEstate18_grframe<-data.frame(FairburnEstate18_gr, samp2)
FairburnEstate18_grframelong <- melt(FairburnEstate18_grframe,id.vars="samp2")
FairburnEstate18_grframelong_sum <- ddply(FairburnEstate18_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate18_gr_max <- sum(FairburnEstate18_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate18_gr_max
FairburnEstate18_gr_pres <- sum(FairburnEstate18_grframelong_sum $max > 0)
FairburnEstate18_gr_pres

#number of sites which would be classified as low
FairburnEstate18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate18_grframelong_sum$max)
FairburnEstate18_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate18_gr_high_ref <- sum( FairburnEstate18_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate18_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate18_gr_mod_ref <- 1000 - (FairburnEstate18_gr_high_ref + FairburnEstate18_gr_lw_ref)
FairburnEstate18_gr_mod_ref

#19 detectors
FairburnEstate19_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
FairburnEstate19_grframe<-data.frame(FairburnEstate19_gr, samp2)
FairburnEstate19_grframelong <- melt(FairburnEstate19_grframe,id.vars="samp2")
FairburnEstate19_grframelong_sum <- ddply(FairburnEstate19_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate19_gr_max <- sum(FairburnEstate19_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate19_gr_max
FairburnEstate19_gr_pres <- sum(FairburnEstate19_grframelong_sum $max > 0)
FairburnEstate19_gr_pres

#number of sites which would be classified as low
FairburnEstate19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate19_grframelong_sum$max)
FairburnEstate19_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate19_gr_high_ref <- sum( FairburnEstate19_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate19_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate19_gr_mod_ref <- 1000 - (FairburnEstate19_gr_high_ref + FairburnEstate19_gr_lw_ref)
FairburnEstate19_gr_mod_ref

#20 detectors
FairburnEstate20_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
FairburnEstate20_grframe<-data.frame(FairburnEstate20_gr, samp2)
FairburnEstate20_grframelong <- melt(FairburnEstate20_grframe,id.vars="samp2")
FairburnEstate20_grframelong_sum <- ddply(FairburnEstate20_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate20_gr_max <- sum(FairburnEstate20_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate20_gr_max
FairburnEstate20_gr_pres <- sum(FairburnEstate20_grframelong_sum $max > 0)
FairburnEstate20_gr_pres

#number of sites which would be classified as low
FairburnEstate20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate20_grframelong_sum$max)
FairburnEstate20_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate20_gr_high_ref <- sum( FairburnEstate20_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate20_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate20_gr_mod_ref <- 1000 - (FairburnEstate20_gr_high_ref + FairburnEstate20_gr_lw_ref)
FairburnEstate20_gr_mod_ref

#21 detectors
FairburnEstate21_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
FairburnEstate21_grframe<-data.frame(FairburnEstate21_gr, samp2)
FairburnEstate21_grframelong <- melt(FairburnEstate21_grframe,id.vars="samp2")
FairburnEstate21_grframelong_sum <- ddply(FairburnEstate21_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate21_gr_max <- sum(FairburnEstate21_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate21_gr_max
FairburnEstate21_gr_pres <- sum(FairburnEstate21_grframelong_sum $max > 0)
FairburnEstate21_gr_pres

#number of sites which would be classified as low
FairburnEstate21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate21_grframelong_sum$max)
FairburnEstate21_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate21_gr_high_ref <- sum( FairburnEstate21_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate21_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate21_gr_mod_ref <- 1000 - (FairburnEstate21_gr_high_ref + FairburnEstate21_gr_lw_ref)
FairburnEstate21_gr_mod_ref

#22 detectors
FairburnEstate22_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
FairburnEstate22_grframe<-data.frame(FairburnEstate22_gr, samp2)
FairburnEstate22_grframelong <- melt(FairburnEstate22_grframe,id.vars="samp2")
FairburnEstate22_grframelong_sum <- ddply(FairburnEstate22_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate22_gr_max <- sum(FairburnEstate22_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate22_gr_max
FairburnEstate22_gr_pres <- sum(FairburnEstate22_grframelong_sum $max > 0)
FairburnEstate22_gr_pres

#number of sites which would be classified as low
FairburnEstate22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate22_grframelong_sum$max)
FairburnEstate22_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate22_gr_high_ref <- sum( FairburnEstate22_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate22_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate22_gr_mod_ref <- 1000 - (FairburnEstate22_gr_high_ref + FairburnEstate22_gr_lw_ref)
FairburnEstate22_gr_mod_ref

#23 detectors
FairburnEstate23_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
FairburnEstate23_grframe<-data.frame(FairburnEstate23_gr, samp2)
FairburnEstate23_grframelong <- melt(FairburnEstate23_grframe,id.vars="samp2")
FairburnEstate23_grframelong_sum <- ddply(FairburnEstate23_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate23_gr_max <- sum(FairburnEstate23_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate23_gr_max
FairburnEstate23_gr_pres <- sum(FairburnEstate23_grframelong_sum $max > 0)
FairburnEstate23_gr_pres

#number of sites which would be classified as low
FairburnEstate23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate23_grframelong_sum$max)
FairburnEstate23_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate23_gr_high_ref <- sum( FairburnEstate23_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate23_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate23_gr_mod_ref <- 1000 - (FairburnEstate23_gr_high_ref + FairburnEstate23_gr_lw_ref)
FairburnEstate23_gr_mod_ref

#24 detectors
FairburnEstate24_gr<-(replicate(1000, (sample(FairburnEstatepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
FairburnEstate24_grframe<-data.frame(FairburnEstate24_gr, samp2)
FairburnEstate24_grframelong <- melt(FairburnEstate24_grframe,id.vars="samp2")
FairburnEstate24_grframelong_sum <- ddply(FairburnEstate24_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
FairburnEstate24_gr_max <- sum(FairburnEstate24_grframelong_sum $max > max20_FairburnEstatepipgr)
FairburnEstate24_gr_max
FairburnEstate24_gr_pres <- sum(FairburnEstate24_grframelong_sum $max > 0)
FairburnEstate24_gr_pres

#number of sites which would be classified as low
FairburnEstate24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FairburnEstate24_grframelong_sum$max)
FairburnEstate24_gr_lw_ref
#number of sites which would be classified as high
FairburnEstate24_gr_high_ref <- sum( FairburnEstate24_grframelong_sum$max > allsppgr_ppip_ref_high)
FairburnEstate24_gr_high_ref
#number of sites which would be classified as moderate
FairburnEstate24_gr_mod_ref <- 1000 - (FairburnEstate24_gr_high_ref + FairburnEstate24_gr_lw_ref)
FairburnEstate24_gr_mod_ref

Present<-c(FairburnEstate1_gr_pres,FairburnEstate2_gr_pres,
           FairburnEstate3_gr_pres,FairburnEstate4_gr_pres,
           FairburnEstate5_gr_pres,FairburnEstate6_gr_pres,
           FairburnEstate7_gr_pres,FairburnEstate8_gr_pres,
           FairburnEstate9_gr_pres,FairburnEstate10_gr_pres,
           FairburnEstate11_gr_pres,FairburnEstate12_gr_pres,
           FairburnEstate13_gr_pres,FairburnEstate14_gr_pres,
           FairburnEstate15_gr_pres,FairburnEstate16_gr_pres,
           FairburnEstate17_gr_pres,FairburnEstate18_gr_pres,
           FairburnEstate19_gr_pres,FairburnEstate20_gr_pres,
           FairburnEstate21_gr_pres,FairburnEstate22_gr_pres,
           FairburnEstate23_gr_pres,FairburnEstate24_gr_pres)


Maximum<-c(FairburnEstate1_gr_max,FairburnEstate2_gr_max,
           FairburnEstate3_gr_max,FairburnEstate4_gr_max,
           FairburnEstate5_gr_max,FairburnEstate6_gr_max,
           FairburnEstate7_gr_max,FairburnEstate8_gr_max,
           FairburnEstate9_gr_max,FairburnEstate10_gr_max,
           FairburnEstate11_gr_max,FairburnEstate12_gr_max,
           FairburnEstate13_gr_max,FairburnEstate14_gr_max,
           FairburnEstate15_gr_max,FairburnEstate16_gr_max,
           FairburnEstate17_gr_max,FairburnEstate18_gr_max,
           FairburnEstate19_gr_max,FairburnEstate20_gr_max,
           FairburnEstate21_gr_max,FairburnEstate22_gr_max,
           FairburnEstate23_gr_max,FairburnEstate24_gr_max)

Low<-c(FairburnEstate1_gr_lw_ref, FairburnEstate2_gr_lw_ref, FairburnEstate3_gr_lw_ref,
       FairburnEstate4_gr_lw_ref, FairburnEstate5_gr_lw_ref, FairburnEstate6_gr_lw_ref,
       FairburnEstate7_gr_lw_ref, FairburnEstate8_gr_lw_ref, FairburnEstate9_gr_lw_ref,
       FairburnEstate10_gr_lw_ref, FairburnEstate11_gr_lw_ref, FairburnEstate12_gr_lw_ref, 
       FairburnEstate13_gr_lw_ref, FairburnEstate14_gr_lw_ref, FairburnEstate15_gr_lw_ref, 
       FairburnEstate16_gr_lw_ref, FairburnEstate17_gr_lw_ref, FairburnEstate18_gr_lw_ref, 
       FairburnEstate19_gr_lw_ref, FairburnEstate20_gr_lw_ref, FairburnEstate21_gr_lw_ref,
       FairburnEstate22_gr_lw_ref,FairburnEstate23_gr_lw_ref,FairburnEstate24_gr_lw_ref)

Moderate<-c(FairburnEstate1_gr_mod_ref, FairburnEstate2_gr_mod_ref, FairburnEstate3_gr_mod_ref,
            FairburnEstate4_gr_mod_ref, FairburnEstate5_gr_mod_ref, FairburnEstate6_gr_mod_ref,
            FairburnEstate7_gr_mod_ref, FairburnEstate8_gr_mod_ref, FairburnEstate9_gr_mod_ref,
            FairburnEstate10_gr_mod_ref, FairburnEstate11_gr_mod_ref, FairburnEstate12_gr_mod_ref, 
            FairburnEstate13_gr_mod_ref, FairburnEstate14_gr_mod_ref, FairburnEstate15_gr_mod_ref, 
            FairburnEstate16_gr_mod_ref, FairburnEstate17_gr_mod_ref, FairburnEstate18_gr_mod_ref, 
            FairburnEstate19_gr_mod_ref, FairburnEstate20_gr_mod_ref, FairburnEstate21_gr_mod_ref,
            FairburnEstate22_gr_mod_ref,FairburnEstate23_gr_mod_ref,FairburnEstate24_gr_mod_ref)

High<-c(FairburnEstate1_gr_high_ref, FairburnEstate2_gr_high_ref, FairburnEstate3_gr_high_ref,
        FairburnEstate4_gr_high_ref, FairburnEstate5_gr_high_ref, FairburnEstate6_gr_high_ref,
        FairburnEstate7_gr_high_ref, FairburnEstate8_gr_high_ref, FairburnEstate9_gr_high_ref,
        FairburnEstate10_gr_high_ref, FairburnEstate11_gr_high_ref, FairburnEstate12_gr_high_ref, 
        FairburnEstate13_gr_high_ref, FairburnEstate14_gr_high_ref, FairburnEstate15_gr_high_ref, 
        FairburnEstate16_gr_high_ref, FairburnEstate17_gr_high_ref, FairburnEstate18_gr_high_ref, 
        FairburnEstate19_gr_high_ref, FairburnEstate20_gr_high_ref, FairburnEstate21_gr_high_ref,
        FairburnEstate22_gr_high_ref,FairburnEstate23_gr_high_ref,FairburnEstate24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("FairburnEstategr",24)
Lowsite <- FairburnEstatelow
Modsite <- FairburnEstatemod
Highsite <-FairburnEstatehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



FairburnEstategr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                     Site, Low, Moderate, High,
                                     Lowsite, Modsite, Highsite)

##Ferndale

Ferndalepipgr<-subset(allspp4gr_ppip, Site=="Ferndale")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Ferndalepipgr<-max(Ferndalepipgr$Passes)

#calculate 20% from maximum nightly record

max20_Ferndalepipgr<- (max_Ferndalepipgr/100)*80

##calculate the site classification (reference range)

Ferndalehigh<- max_Ferndalepipgr > allsppgr_ppip_ref_high

Ferndalelow<- allsppgr_ppip_ref_low > max_Ferndalepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Ferndalepipgr
Ferndalemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Ferndale1_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 1, replace=F))))
Ferndale1_gr_max <- sum(Ferndale1_gr > max20_Ferndalepipgr)
Ferndale1_gr_max
Ferndale1_gr_pres <- sum(Ferndale1_gr > 0)
Ferndale1_gr_pres
#number of sites which would be classified as low
Ferndale1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale1_gr)
Ferndale1_gr_lw_ref
#number of sites which would be classified as high
Ferndale1_gr_high_ref <- sum( Ferndale1_gr > allsppgr_ppip_ref_high)
Ferndale1_gr_high_ref
#number of sites which would be classified as moderate
Ferndale1_gr_mod_ref <- 1000 - (Ferndale1_gr_high_ref + Ferndale1_gr_lw_ref)
Ferndale1_gr_mod_ref


#2 nights
Ferndale2_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Ferndale2_grframe<-data.frame(Ferndale2_gr, samp2)
Ferndale2_grframelong <- melt(Ferndale2_grframe,id.vars="samp2")
Ferndale2_grframelong_sum <- ddply(Ferndale2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale2_gr_max <- sum(Ferndale2_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale2_gr_max
Ferndale2_gr_pres <- sum(Ferndale2_grframelong_sum $max > 0)
Ferndale2_gr_pres

#number of sites which would be classified as low
Ferndale2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale2_grframelong_sum$max)
Ferndale2_gr_lw_ref
#number of sites which would be classified as high
Ferndale2_gr_high_ref <- sum( Ferndale2_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale2_gr_high_ref
#number of sites which would be classified as moderate
Ferndale2_gr_mod_ref <- 1000 - (Ferndale2_gr_high_ref + Ferndale2_gr_lw_ref)
Ferndale2_gr_mod_ref


#3 nights
Ferndale3_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Ferndale3_grframe<-data.frame(Ferndale3_gr, samp2)
Ferndale3_grframelong <- melt(Ferndale3_grframe,id.vars="samp2")
Ferndale3_grframelong_sum <- ddply(Ferndale3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale3_gr_max <- sum(Ferndale3_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale3_gr_max
Ferndale3_gr_pres <- sum(Ferndale3_grframelong_sum $max > 0)
Ferndale3_gr_pres

#number of sites which would be classified as low
Ferndale3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale3_grframelong_sum$max)
Ferndale3_gr_lw_ref
#number of sites which would be classified as high
Ferndale3_gr_high_ref <- sum( Ferndale3_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale3_gr_high_ref
#number of sites which would be classified as moderate
Ferndale3_gr_mod_ref <- 1000 - (Ferndale3_gr_high_ref + Ferndale3_gr_lw_ref)
Ferndale3_gr_mod_ref

#4 nights
Ferndale4_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Ferndale4_grframe<-data.frame(Ferndale4_gr, samp2)
Ferndale4_grframelong <- melt(Ferndale4_grframe,id.vars="samp2")
Ferndale4_grframelong_sum <- ddply(Ferndale4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale4_gr_max <- sum(Ferndale4_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale4_gr_max
Ferndale4_gr_pres <- sum(Ferndale4_grframelong_sum $max > 0)
Ferndale4_gr_pres

#number of sites which would be classified as low
Ferndale4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale4_grframelong_sum$max)
Ferndale4_gr_lw_ref
#number of sites which would be classified as high
Ferndale4_gr_high_ref <- sum( Ferndale4_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale4_gr_high_ref
#number of sites which would be classified as moderate
Ferndale4_gr_mod_ref <- 1000 - (Ferndale4_gr_high_ref + Ferndale4_gr_lw_ref)
Ferndale4_gr_mod_ref

#5 nights
Ferndale5_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Ferndale5_grframe<-data.frame(Ferndale5_gr, samp2)
Ferndale5_grframelong <- melt(Ferndale5_grframe,id.vars="samp2")
Ferndale5_grframelong_sum <- ddply(Ferndale5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale5_gr_max <- sum(Ferndale5_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale5_gr_max
Ferndale5_gr_pres <- sum(Ferndale5_grframelong_sum $max > 0)
Ferndale5_gr_pres

#number of sites which would be classified as low
Ferndale5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale5_grframelong_sum$max)
Ferndale5_gr_lw_ref
#number of sites which would be classified as high
Ferndale5_gr_high_ref <- sum( Ferndale5_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale5_gr_high_ref
#number of sites which would be classified as moderate
Ferndale5_gr_mod_ref <- 1000 - (Ferndale5_gr_high_ref + Ferndale5_gr_lw_ref)
Ferndale5_gr_mod_ref

#6 nights
Ferndale6_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Ferndale6_grframe<-data.frame(Ferndale6_gr, samp2)
Ferndale6_grframelong <- melt(Ferndale6_grframe,id.vars="samp2")
Ferndale6_grframelong_sum <- ddply(Ferndale6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale6_gr_max <- sum(Ferndale6_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale6_gr_max
Ferndale6_gr_pres <- sum(Ferndale6_grframelong_sum $max > 0)
Ferndale6_gr_pres

#number of sites which would be classified as low
Ferndale6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale6_grframelong_sum$max)
Ferndale6_gr_lw_ref
#number of sites which would be classified as high
Ferndale6_gr_high_ref <- sum( Ferndale6_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale6_gr_high_ref
#number of sites which would be classified as moderate
Ferndale6_gr_mod_ref <- 1000 - (Ferndale6_gr_high_ref + Ferndale6_gr_lw_ref)
Ferndale6_gr_mod_ref

#7 nights
Ferndale7_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Ferndale7_grframe<-data.frame(Ferndale7_gr, samp2)
Ferndale7_grframelong <- melt(Ferndale7_grframe,id.vars="samp2")
Ferndale7_grframelong_sum <- ddply(Ferndale7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale7_gr_max <- sum(Ferndale7_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale7_gr_max
Ferndale7_gr_pres <- sum(Ferndale7_grframelong_sum $max > 0)
Ferndale7_gr_pres

#number of sites which would be classified as low
Ferndale7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale7_grframelong_sum$max)
Ferndale7_gr_lw_ref
#number of sites which would be classified as high
Ferndale7_gr_high_ref <- sum( Ferndale7_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale7_gr_high_ref
#number of sites which would be classified as moderate
Ferndale7_gr_mod_ref <- 1000 - (Ferndale7_gr_high_ref + Ferndale7_gr_lw_ref)
Ferndale7_gr_mod_ref

#8 nights
Ferndale8_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Ferndale8_grframe<-data.frame(Ferndale8_gr, samp2)
Ferndale8_grframelong <- melt(Ferndale8_grframe,id.vars="samp2")
Ferndale8_grframelong_sum <- ddply(Ferndale8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale8_gr_max <- sum(Ferndale8_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale8_gr_max
Ferndale8_gr_pres <- sum(Ferndale8_grframelong_sum $max > 0)
Ferndale8_gr_pres

#number of sites which would be classified as low
Ferndale8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale8_grframelong_sum$max)
Ferndale8_gr_lw_ref
#number of sites which would be classified as high
Ferndale8_gr_high_ref <- sum( Ferndale8_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale8_gr_high_ref
#number of sites which would be classified as moderate
Ferndale8_gr_mod_ref <- 1000 - (Ferndale8_gr_high_ref + Ferndale8_gr_lw_ref)
Ferndale8_gr_mod_ref

#9 nights
Ferndale9_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Ferndale9_grframe<-data.frame(Ferndale9_gr, samp2)
Ferndale9_grframelong <- melt(Ferndale9_grframe,id.vars="samp2")
Ferndale9_grframelong_sum <- ddply(Ferndale9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Ferndale9_gr_max <- sum(Ferndale9_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale9_gr_max
Ferndale9_gr_pres <- sum(Ferndale9_grframelong_sum $max > 0)
Ferndale9_gr_pres

#number of sites which would be classified as low
Ferndale9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale9_grframelong_sum$max)
Ferndale9_gr_lw_ref
#number of sites which would be classified as high
Ferndale9_gr_high_ref <- sum( Ferndale9_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale9_gr_high_ref
#number of sites which would be classified as moderate
Ferndale9_gr_mod_ref <- 1000 - (Ferndale9_gr_high_ref + Ferndale9_gr_lw_ref)
Ferndale9_gr_mod_ref

#10 detectors
Ferndale10_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Ferndale10_grframe<-data.frame(Ferndale10_gr, samp2)
Ferndale10_grframelong <- melt(Ferndale10_grframe,id.vars="samp2")
Ferndale10_grframelong_sum <- ddply(Ferndale10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale10_gr_max <- sum(Ferndale10_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale10_gr_max
Ferndale10_gr_pres <- sum(Ferndale10_grframelong_sum $max > 0)
Ferndale10_gr_pres

#number of sites which would be classified as low
Ferndale10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale10_grframelong_sum$max)
Ferndale10_gr_lw_ref
#number of sites which would be classified as high
Ferndale10_gr_high_ref <- sum( Ferndale10_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale10_gr_high_ref
#number of sites which would be classified as moderate
Ferndale10_gr_mod_ref <- 1000 - (Ferndale10_gr_high_ref + Ferndale10_gr_lw_ref)
Ferndale10_gr_mod_ref

#11 detectors
Ferndale11_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Ferndale11_grframe<-data.frame(Ferndale11_gr, samp2)
Ferndale11_grframelong <- melt(Ferndale11_grframe,id.vars="samp2")
Ferndale11_grframelong_sum <- ddply(Ferndale11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale11_gr_max <- sum(Ferndale11_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale11_gr_max
Ferndale11_gr_pres <- sum(Ferndale11_grframelong_sum $max > 0)
Ferndale11_gr_pres

#number of sites which would be classified as low
Ferndale11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale11_grframelong_sum$max)
Ferndale11_gr_lw_ref
#number of sites which would be classified as high
Ferndale11_gr_high_ref <- sum( Ferndale11_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale11_gr_high_ref
#number of sites which would be classified as moderate
Ferndale11_gr_mod_ref <- 1000 - (Ferndale11_gr_high_ref + Ferndale11_gr_lw_ref)
Ferndale11_gr_mod_ref

#12 detectors
Ferndale12_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Ferndale12_grframe<-data.frame(Ferndale12_gr, samp2)
Ferndale12_grframelong <- melt(Ferndale12_grframe,id.vars="samp2")
Ferndale12_grframelong_sum <- ddply(Ferndale12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale12_gr_max <- sum(Ferndale12_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale12_gr_max
Ferndale12_gr_pres <- sum(Ferndale12_grframelong_sum $max > 0)
Ferndale12_gr_pres

#number of sites which would be classified as low
Ferndale12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale12_grframelong_sum$max)
Ferndale12_gr_lw_ref
#number of sites which would be classified as high
Ferndale12_gr_high_ref <- sum( Ferndale12_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale12_gr_high_ref
#number of sites which would be classified as moderate
Ferndale12_gr_mod_ref <- 1000 - (Ferndale12_gr_high_ref + Ferndale12_gr_lw_ref)
Ferndale12_gr_mod_ref

#13 detectors
Ferndale13_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Ferndale13_grframe<-data.frame(Ferndale13_gr, samp2)
Ferndale13_grframelong <- melt(Ferndale13_grframe,id.vars="samp2")
Ferndale13_grframelong_sum <- ddply(Ferndale13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale13_gr_max <- sum(Ferndale13_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale13_gr_max
Ferndale13_gr_pres <- sum(Ferndale13_grframelong_sum $max > 0)
Ferndale13_gr_pres

#number of sites which would be classified as low
Ferndale13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale13_grframelong_sum$max)
Ferndale13_gr_lw_ref
#number of sites which would be classified as high
Ferndale13_gr_high_ref <- sum( Ferndale13_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale13_gr_high_ref
#number of sites which would be classified as moderate
Ferndale13_gr_mod_ref <- 1000 - (Ferndale13_gr_high_ref + Ferndale13_gr_lw_ref)
Ferndale13_gr_mod_ref

#14 detectors
Ferndale14_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Ferndale14_grframe<-data.frame(Ferndale14_gr, samp2)
Ferndale14_grframelong <- melt(Ferndale14_grframe,id.vars="samp2")
Ferndale14_grframelong_sum <- ddply(Ferndale14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale14_gr_max <- sum(Ferndale14_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale14_gr_max
Ferndale14_gr_pres <- sum(Ferndale14_grframelong_sum $max > 0)
Ferndale14_gr_pres

#number of sites which would be classified as low
Ferndale14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale14_grframelong_sum$max)
Ferndale14_gr_lw_ref
#number of sites which would be classified as high
Ferndale14_gr_high_ref <- sum( Ferndale14_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale14_gr_high_ref
#number of sites which would be classified as moderate
Ferndale14_gr_mod_ref <- 1000 - (Ferndale14_gr_high_ref + Ferndale14_gr_lw_ref)
Ferndale14_gr_mod_ref

#15 detectors
Ferndale15_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Ferndale15_grframe<-data.frame(Ferndale15_gr, samp2)
Ferndale15_grframelong <- melt(Ferndale15_grframe,id.vars="samp2")
Ferndale15_grframelong_sum <- ddply(Ferndale15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale15_gr_max <- sum(Ferndale15_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale15_gr_max
Ferndale15_gr_pres <- sum(Ferndale15_grframelong_sum $max > 0)
Ferndale15_gr_pres

#number of sites which would be classified as low
Ferndale15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale15_grframelong_sum$max)
Ferndale15_gr_lw_ref
#number of sites which would be classified as high
Ferndale15_gr_high_ref <- sum( Ferndale15_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale15_gr_high_ref
#number of sites which would be classified as moderate
Ferndale15_gr_mod_ref <- 1000 - (Ferndale15_gr_high_ref + Ferndale15_gr_lw_ref)
Ferndale15_gr_mod_ref

#16 detectors
Ferndale16_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Ferndale16_grframe<-data.frame(Ferndale16_gr, samp2)
Ferndale16_grframelong <- melt(Ferndale16_grframe,id.vars="samp2")
Ferndale16_grframelong_sum <- ddply(Ferndale16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale16_gr_max <- sum(Ferndale16_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale16_gr_max
Ferndale16_gr_pres <- sum(Ferndale16_grframelong_sum $max > 0)
Ferndale16_gr_pres

#number of sites which would be classified as low
Ferndale16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale16_grframelong_sum$max)
Ferndale16_gr_lw_ref
#number of sites which would be classified as high
Ferndale16_gr_high_ref <- sum( Ferndale16_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale16_gr_high_ref
#number of sites which would be classified as moderate
Ferndale16_gr_mod_ref <- 1000 - (Ferndale16_gr_high_ref + Ferndale16_gr_lw_ref)
Ferndale16_gr_mod_ref

#17 detectors
Ferndale17_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Ferndale17_grframe<-data.frame(Ferndale17_gr, samp2)
Ferndale17_grframelong <- melt(Ferndale17_grframe,id.vars="samp2")
Ferndale17_grframelong_sum <- ddply(Ferndale17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale17_gr_max <- sum(Ferndale17_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale17_gr_max
Ferndale17_gr_pres <- sum(Ferndale17_grframelong_sum $max > 0)
Ferndale17_gr_pres

#number of sites which would be classified as low
Ferndale17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale17_grframelong_sum$max)
Ferndale17_gr_lw_ref
#number of sites which would be classified as high
Ferndale17_gr_high_ref <- sum( Ferndale17_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale17_gr_high_ref
#number of sites which would be classified as moderate
Ferndale17_gr_mod_ref <- 1000 - (Ferndale17_gr_high_ref + Ferndale17_gr_lw_ref)
Ferndale17_gr_mod_ref

#18 detectors
Ferndale18_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Ferndale18_grframe<-data.frame(Ferndale18_gr, samp2)
Ferndale18_grframelong <- melt(Ferndale18_grframe,id.vars="samp2")
Ferndale18_grframelong_sum <- ddply(Ferndale18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale18_gr_max <- sum(Ferndale18_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale18_gr_max
Ferndale18_gr_pres <- sum(Ferndale18_grframelong_sum $max > 0)
Ferndale18_gr_pres

#number of sites which would be classified as low
Ferndale18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale18_grframelong_sum$max)
Ferndale18_gr_lw_ref
#number of sites which would be classified as high
Ferndale18_gr_high_ref <- sum( Ferndale18_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale18_gr_high_ref
#number of sites which would be classified as moderate
Ferndale18_gr_mod_ref <- 1000 - (Ferndale18_gr_high_ref + Ferndale18_gr_lw_ref)
Ferndale18_gr_mod_ref

#19 detectors
Ferndale19_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Ferndale19_grframe<-data.frame(Ferndale19_gr, samp2)
Ferndale19_grframelong <- melt(Ferndale19_grframe,id.vars="samp2")
Ferndale19_grframelong_sum <- ddply(Ferndale19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale19_gr_max <- sum(Ferndale19_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale19_gr_max
Ferndale19_gr_pres <- sum(Ferndale19_grframelong_sum $max > 0)
Ferndale19_gr_pres

#number of sites which would be classified as low
Ferndale19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale19_grframelong_sum$max)
Ferndale19_gr_lw_ref
#number of sites which would be classified as high
Ferndale19_gr_high_ref <- sum( Ferndale19_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale19_gr_high_ref
#number of sites which would be classified as moderate
Ferndale19_gr_mod_ref <- 1000 - (Ferndale19_gr_high_ref + Ferndale19_gr_lw_ref)
Ferndale19_gr_mod_ref

#20 detectors
Ferndale20_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Ferndale20_grframe<-data.frame(Ferndale20_gr, samp2)
Ferndale20_grframelong <- melt(Ferndale20_grframe,id.vars="samp2")
Ferndale20_grframelong_sum <- ddply(Ferndale20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale20_gr_max <- sum(Ferndale20_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale20_gr_max
Ferndale20_gr_pres <- sum(Ferndale20_grframelong_sum $max > 0)
Ferndale20_gr_pres

#number of sites which would be classified as low
Ferndale20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale20_grframelong_sum$max)
Ferndale20_gr_lw_ref
#number of sites which would be classified as high
Ferndale20_gr_high_ref <- sum( Ferndale20_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale20_gr_high_ref
#number of sites which would be classified as moderate
Ferndale20_gr_mod_ref <- 1000 - (Ferndale20_gr_high_ref + Ferndale20_gr_lw_ref)
Ferndale20_gr_mod_ref

#21 detectors
Ferndale21_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Ferndale21_grframe<-data.frame(Ferndale21_gr, samp2)
Ferndale21_grframelong <- melt(Ferndale21_grframe,id.vars="samp2")
Ferndale21_grframelong_sum <- ddply(Ferndale21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale21_gr_max <- sum(Ferndale21_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale21_gr_max
Ferndale21_gr_pres <- sum(Ferndale21_grframelong_sum $max > 0)
Ferndale21_gr_pres

#number of sites which would be classified as low
Ferndale21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale21_grframelong_sum$max)
Ferndale21_gr_lw_ref
#number of sites which would be classified as high
Ferndale21_gr_high_ref <- sum( Ferndale21_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale21_gr_high_ref
#number of sites which would be classified as moderate
Ferndale21_gr_mod_ref <- 1000 - (Ferndale21_gr_high_ref + Ferndale21_gr_lw_ref)
Ferndale21_gr_mod_ref

#22 detectors
Ferndale22_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Ferndale22_grframe<-data.frame(Ferndale22_gr, samp2)
Ferndale22_grframelong <- melt(Ferndale22_grframe,id.vars="samp2")
Ferndale22_grframelong_sum <- ddply(Ferndale22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale22_gr_max <- sum(Ferndale22_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale22_gr_max
Ferndale22_gr_pres <- sum(Ferndale22_grframelong_sum $max > 0)
Ferndale22_gr_pres

#number of sites which would be classified as low
Ferndale22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale22_grframelong_sum$max)
Ferndale22_gr_lw_ref
#number of sites which would be classified as high
Ferndale22_gr_high_ref <- sum( Ferndale22_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale22_gr_high_ref
#number of sites which would be classified as moderate
Ferndale22_gr_mod_ref <- 1000 - (Ferndale22_gr_high_ref + Ferndale22_gr_lw_ref)
Ferndale22_gr_mod_ref

#23 detectors
Ferndale23_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Ferndale23_grframe<-data.frame(Ferndale23_gr, samp2)
Ferndale23_grframelong <- melt(Ferndale23_grframe,id.vars="samp2")
Ferndale23_grframelong_sum <- ddply(Ferndale23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale23_gr_max <- sum(Ferndale23_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale23_gr_max
Ferndale23_gr_pres <- sum(Ferndale23_grframelong_sum $max > 0)
Ferndale23_gr_pres

#number of sites which would be classified as low
Ferndale23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale23_grframelong_sum$max)
Ferndale23_gr_lw_ref
#number of sites which would be classified as high
Ferndale23_gr_high_ref <- sum( Ferndale23_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale23_gr_high_ref
#number of sites which would be classified as moderate
Ferndale23_gr_mod_ref <- 1000 - (Ferndale23_gr_high_ref + Ferndale23_gr_lw_ref)
Ferndale23_gr_mod_ref

#24 detectors
Ferndale24_gr<-(replicate(1000, (sample(Ferndalepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Ferndale24_grframe<-data.frame(Ferndale24_gr, samp2)
Ferndale24_grframelong <- melt(Ferndale24_grframe,id.vars="samp2")
Ferndale24_grframelong_sum <- ddply(Ferndale24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Ferndale24_gr_max <- sum(Ferndale24_grframelong_sum $max > max20_Ferndalepipgr)
Ferndale24_gr_max
Ferndale24_gr_pres <- sum(Ferndale24_grframelong_sum $max > 0)
Ferndale24_gr_pres

#number of sites which would be classified as low
Ferndale24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Ferndale24_grframelong_sum$max)
Ferndale24_gr_lw_ref
#number of sites which would be classified as high
Ferndale24_gr_high_ref <- sum( Ferndale24_grframelong_sum$max > allsppgr_ppip_ref_high)
Ferndale24_gr_high_ref
#number of sites which would be classified as moderate
Ferndale24_gr_mod_ref <- 1000 - (Ferndale24_gr_high_ref + Ferndale24_gr_lw_ref)
Ferndale24_gr_mod_ref

Present<-c(Ferndale1_gr_pres,Ferndale2_gr_pres,
           Ferndale3_gr_pres,Ferndale4_gr_pres,
           Ferndale5_gr_pres,Ferndale6_gr_pres,
           Ferndale7_gr_pres,Ferndale8_gr_pres,
           Ferndale9_gr_pres,Ferndale10_gr_pres,
           Ferndale11_gr_pres,Ferndale12_gr_pres,
           Ferndale13_gr_pres,Ferndale14_gr_pres,
           Ferndale15_gr_pres,Ferndale16_gr_pres,
           Ferndale17_gr_pres,Ferndale18_gr_pres,
           Ferndale19_gr_pres,Ferndale20_gr_pres,
           Ferndale21_gr_pres,Ferndale22_gr_pres,
           Ferndale23_gr_pres,Ferndale24_gr_pres)


Maximum<-c(Ferndale1_gr_max,Ferndale2_gr_max,
           Ferndale3_gr_max,Ferndale4_gr_max,
           Ferndale5_gr_max,Ferndale6_gr_max,
           Ferndale7_gr_max,Ferndale8_gr_max,
           Ferndale9_gr_max,Ferndale10_gr_max,
           Ferndale11_gr_max,Ferndale12_gr_max,
           Ferndale13_gr_max,Ferndale14_gr_max,
           Ferndale15_gr_max,Ferndale16_gr_max,
           Ferndale17_gr_max,Ferndale18_gr_max,
           Ferndale19_gr_max,Ferndale20_gr_max,
           Ferndale21_gr_max,Ferndale22_gr_max,
           Ferndale23_gr_max,Ferndale24_gr_max)

Low<-c(Ferndale1_gr_lw_ref, Ferndale2_gr_lw_ref, Ferndale3_gr_lw_ref,
       Ferndale4_gr_lw_ref, Ferndale5_gr_lw_ref, Ferndale6_gr_lw_ref,
       Ferndale7_gr_lw_ref, Ferndale8_gr_lw_ref, Ferndale9_gr_lw_ref,
       Ferndale10_gr_lw_ref, Ferndale11_gr_lw_ref, Ferndale12_gr_lw_ref, 
       Ferndale13_gr_lw_ref, Ferndale14_gr_lw_ref, Ferndale15_gr_lw_ref, 
       Ferndale16_gr_lw_ref, Ferndale17_gr_lw_ref, Ferndale18_gr_lw_ref, 
       Ferndale19_gr_lw_ref, Ferndale20_gr_lw_ref, Ferndale21_gr_lw_ref,
       Ferndale22_gr_lw_ref,Ferndale23_gr_lw_ref,Ferndale24_gr_lw_ref)

Moderate<-c(Ferndale1_gr_mod_ref, Ferndale2_gr_mod_ref, Ferndale3_gr_mod_ref,
            Ferndale4_gr_mod_ref, Ferndale5_gr_mod_ref, Ferndale6_gr_mod_ref,
            Ferndale7_gr_mod_ref, Ferndale8_gr_mod_ref, Ferndale9_gr_mod_ref,
            Ferndale10_gr_mod_ref, Ferndale11_gr_mod_ref, Ferndale12_gr_mod_ref, 
            Ferndale13_gr_mod_ref, Ferndale14_gr_mod_ref, Ferndale15_gr_mod_ref, 
            Ferndale16_gr_mod_ref, Ferndale17_gr_mod_ref, Ferndale18_gr_mod_ref, 
            Ferndale19_gr_mod_ref, Ferndale20_gr_mod_ref, Ferndale21_gr_mod_ref,
            Ferndale22_gr_mod_ref,Ferndale23_gr_mod_ref,Ferndale24_gr_mod_ref)

High<-c(Ferndale1_gr_high_ref, Ferndale2_gr_high_ref, Ferndale3_gr_high_ref,
        Ferndale4_gr_high_ref, Ferndale5_gr_high_ref, Ferndale6_gr_high_ref,
        Ferndale7_gr_high_ref, Ferndale8_gr_high_ref, Ferndale9_gr_high_ref,
        Ferndale10_gr_high_ref, Ferndale11_gr_high_ref, Ferndale12_gr_high_ref, 
        Ferndale13_gr_high_ref, Ferndale14_gr_high_ref, Ferndale15_gr_high_ref, 
        Ferndale16_gr_high_ref, Ferndale17_gr_high_ref, Ferndale18_gr_high_ref, 
        Ferndale19_gr_high_ref, Ferndale20_gr_high_ref, Ferndale21_gr_high_ref,
        Ferndale22_gr_high_ref,Ferndale23_gr_high_ref,Ferndale24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Ferndalegr",24)
Lowsite <- Ferndalelow
Modsite <- Ferndalemod
Highsite <-Ferndalehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Ferndalegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##Forss

Forsspipgr<-subset(allspp4gr_ppip, Site=="Forss")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Forsspipgr<-max(Forsspipgr$Passes)

#calculate 20% from maximum nightly record

max20_Forsspipgr<- (max_Forsspipgr/100)*80

##calculate the site classification (reference range)

Forsshigh<- max_Forsspipgr > allsppgr_ppip_ref_high

Forsslow<- allsppgr_ppip_ref_low > max_Forsspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Forsspipgr
Forssmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Forss1_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 1, replace=F))))
Forss1_gr_max <- sum(Forss1_gr > max20_Forsspipgr)
Forss1_gr_max
Forss1_gr_pres <- sum(Forss1_gr > 0)
Forss1_gr_pres
#number of sites which would be classified as low
Forss1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss1_gr)
Forss1_gr_lw_ref
#number of sites which would be classified as high
Forss1_gr_high_ref <- sum( Forss1_gr > allsppgr_ppip_ref_high)
Forss1_gr_high_ref
#number of sites which would be classified as moderate
Forss1_gr_mod_ref <- 1000 - (Forss1_gr_high_ref + Forss1_gr_lw_ref)
Forss1_gr_mod_ref


#2 nights
Forss2_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Forss2_grframe<-data.frame(Forss2_gr, samp2)
Forss2_grframelong <- melt(Forss2_grframe,id.vars="samp2")
Forss2_grframelong_sum <- ddply(Forss2_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss2_gr_max <- sum(Forss2_grframelong_sum $max > max20_Forsspipgr)
Forss2_gr_max
Forss2_gr_pres <- sum(Forss2_grframelong_sum $max > 0)
Forss2_gr_pres

#number of sites which would be classified as low
Forss2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss2_grframelong_sum$max)
Forss2_gr_lw_ref
#number of sites which would be classified as high
Forss2_gr_high_ref <- sum( Forss2_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss2_gr_high_ref
#number of sites which would be classified as moderate
Forss2_gr_mod_ref <- 1000 - (Forss2_gr_high_ref + Forss2_gr_lw_ref)
Forss2_gr_mod_ref


#3 nights
Forss3_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Forss3_grframe<-data.frame(Forss3_gr, samp2)
Forss3_grframelong <- melt(Forss3_grframe,id.vars="samp2")
Forss3_grframelong_sum <- ddply(Forss3_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss3_gr_max <- sum(Forss3_grframelong_sum $max > max20_Forsspipgr)
Forss3_gr_max
Forss3_gr_pres <- sum(Forss3_grframelong_sum $max > 0)
Forss3_gr_pres

#number of sites which would be classified as low
Forss3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss3_grframelong_sum$max)
Forss3_gr_lw_ref
#number of sites which would be classified as high
Forss3_gr_high_ref <- sum( Forss3_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss3_gr_high_ref
#number of sites which would be classified as moderate
Forss3_gr_mod_ref <- 1000 - (Forss3_gr_high_ref + Forss3_gr_lw_ref)
Forss3_gr_mod_ref

#4 nights
Forss4_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Forss4_grframe<-data.frame(Forss4_gr, samp2)
Forss4_grframelong <- melt(Forss4_grframe,id.vars="samp2")
Forss4_grframelong_sum <- ddply(Forss4_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss4_gr_max <- sum(Forss4_grframelong_sum $max > max20_Forsspipgr)
Forss4_gr_max
Forss4_gr_pres <- sum(Forss4_grframelong_sum $max > 0)
Forss4_gr_pres

#number of sites which would be classified as low
Forss4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss4_grframelong_sum$max)
Forss4_gr_lw_ref
#number of sites which would be classified as high
Forss4_gr_high_ref <- sum( Forss4_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss4_gr_high_ref
#number of sites which would be classified as moderate
Forss4_gr_mod_ref <- 1000 - (Forss4_gr_high_ref + Forss4_gr_lw_ref)
Forss4_gr_mod_ref

#5 nights
Forss5_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Forss5_grframe<-data.frame(Forss5_gr, samp2)
Forss5_grframelong <- melt(Forss5_grframe,id.vars="samp2")
Forss5_grframelong_sum <- ddply(Forss5_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss5_gr_max <- sum(Forss5_grframelong_sum $max > max20_Forsspipgr)
Forss5_gr_max
Forss5_gr_pres <- sum(Forss5_grframelong_sum $max > 0)
Forss5_gr_pres

#number of sites which would be classified as low
Forss5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss5_grframelong_sum$max)
Forss5_gr_lw_ref
#number of sites which would be classified as high
Forss5_gr_high_ref <- sum( Forss5_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss5_gr_high_ref
#number of sites which would be classified as moderate
Forss5_gr_mod_ref <- 1000 - (Forss5_gr_high_ref + Forss5_gr_lw_ref)
Forss5_gr_mod_ref

#6 nights
Forss6_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Forss6_grframe<-data.frame(Forss6_gr, samp2)
Forss6_grframelong <- melt(Forss6_grframe,id.vars="samp2")
Forss6_grframelong_sum <- ddply(Forss6_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss6_gr_max <- sum(Forss6_grframelong_sum $max > max20_Forsspipgr)
Forss6_gr_max
Forss6_gr_pres <- sum(Forss6_grframelong_sum $max > 0)
Forss6_gr_pres

#number of sites which would be classified as low
Forss6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss6_grframelong_sum$max)
Forss6_gr_lw_ref
#number of sites which would be classified as high
Forss6_gr_high_ref <- sum( Forss6_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss6_gr_high_ref
#number of sites which would be classified as moderate
Forss6_gr_mod_ref <- 1000 - (Forss6_gr_high_ref + Forss6_gr_lw_ref)
Forss6_gr_mod_ref

#7 nights
Forss7_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Forss7_grframe<-data.frame(Forss7_gr, samp2)
Forss7_grframelong <- melt(Forss7_grframe,id.vars="samp2")
Forss7_grframelong_sum <- ddply(Forss7_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss7_gr_max <- sum(Forss7_grframelong_sum $max > max20_Forsspipgr)
Forss7_gr_max
Forss7_gr_pres <- sum(Forss7_grframelong_sum $max > 0)
Forss7_gr_pres

#number of sites which would be classified as low
Forss7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss7_grframelong_sum$max)
Forss7_gr_lw_ref
#number of sites which would be classified as high
Forss7_gr_high_ref <- sum( Forss7_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss7_gr_high_ref
#number of sites which would be classified as moderate
Forss7_gr_mod_ref <- 1000 - (Forss7_gr_high_ref + Forss7_gr_lw_ref)
Forss7_gr_mod_ref

#8 nights
Forss8_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Forss8_grframe<-data.frame(Forss8_gr, samp2)
Forss8_grframelong <- melt(Forss8_grframe,id.vars="samp2")
Forss8_grframelong_sum <- ddply(Forss8_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss8_gr_max <- sum(Forss8_grframelong_sum $max > max20_Forsspipgr)
Forss8_gr_max
Forss8_gr_pres <- sum(Forss8_grframelong_sum $max > 0)
Forss8_gr_pres

#number of sites which would be classified as low
Forss8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss8_grframelong_sum$max)
Forss8_gr_lw_ref
#number of sites which would be classified as high
Forss8_gr_high_ref <- sum( Forss8_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss8_gr_high_ref
#number of sites which would be classified as moderate
Forss8_gr_mod_ref <- 1000 - (Forss8_gr_high_ref + Forss8_gr_lw_ref)
Forss8_gr_mod_ref

#9 nights
Forss9_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Forss9_grframe<-data.frame(Forss9_gr, samp2)
Forss9_grframelong <- melt(Forss9_grframe,id.vars="samp2")
Forss9_grframelong_sum <- ddply(Forss9_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Forss9_gr_max <- sum(Forss9_grframelong_sum $max > max20_Forsspipgr)
Forss9_gr_max
Forss9_gr_pres <- sum(Forss9_grframelong_sum $max > 0)
Forss9_gr_pres

#number of sites which would be classified as low
Forss9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss9_grframelong_sum$max)
Forss9_gr_lw_ref
#number of sites which would be classified as high
Forss9_gr_high_ref <- sum( Forss9_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss9_gr_high_ref
#number of sites which would be classified as moderate
Forss9_gr_mod_ref <- 1000 - (Forss9_gr_high_ref + Forss9_gr_lw_ref)
Forss9_gr_mod_ref

#10 detectors
Forss10_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Forss10_grframe<-data.frame(Forss10_gr, samp2)
Forss10_grframelong <- melt(Forss10_grframe,id.vars="samp2")
Forss10_grframelong_sum <- ddply(Forss10_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss10_gr_max <- sum(Forss10_grframelong_sum $max > max20_Forsspipgr)
Forss10_gr_max
Forss10_gr_pres <- sum(Forss10_grframelong_sum $max > 0)
Forss10_gr_pres

#number of sites which would be classified as low
Forss10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss10_grframelong_sum$max)
Forss10_gr_lw_ref
#number of sites which would be classified as high
Forss10_gr_high_ref <- sum( Forss10_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss10_gr_high_ref
#number of sites which would be classified as moderate
Forss10_gr_mod_ref <- 1000 - (Forss10_gr_high_ref + Forss10_gr_lw_ref)
Forss10_gr_mod_ref

#11 detectors
Forss11_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Forss11_grframe<-data.frame(Forss11_gr, samp2)
Forss11_grframelong <- melt(Forss11_grframe,id.vars="samp2")
Forss11_grframelong_sum <- ddply(Forss11_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss11_gr_max <- sum(Forss11_grframelong_sum $max > max20_Forsspipgr)
Forss11_gr_max
Forss11_gr_pres <- sum(Forss11_grframelong_sum $max > 0)
Forss11_gr_pres

#number of sites which would be classified as low
Forss11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss11_grframelong_sum$max)
Forss11_gr_lw_ref
#number of sites which would be classified as high
Forss11_gr_high_ref <- sum( Forss11_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss11_gr_high_ref
#number of sites which would be classified as moderate
Forss11_gr_mod_ref <- 1000 - (Forss11_gr_high_ref + Forss11_gr_lw_ref)
Forss11_gr_mod_ref

#12 detectors
Forss12_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Forss12_grframe<-data.frame(Forss12_gr, samp2)
Forss12_grframelong <- melt(Forss12_grframe,id.vars="samp2")
Forss12_grframelong_sum <- ddply(Forss12_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss12_gr_max <- sum(Forss12_grframelong_sum $max > max20_Forsspipgr)
Forss12_gr_max
Forss12_gr_pres <- sum(Forss12_grframelong_sum $max > 0)
Forss12_gr_pres

#number of sites which would be classified as low
Forss12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss12_grframelong_sum$max)
Forss12_gr_lw_ref
#number of sites which would be classified as high
Forss12_gr_high_ref <- sum( Forss12_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss12_gr_high_ref
#number of sites which would be classified as moderate
Forss12_gr_mod_ref <- 1000 - (Forss12_gr_high_ref + Forss12_gr_lw_ref)
Forss12_gr_mod_ref

#13 detectors
Forss13_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Forss13_grframe<-data.frame(Forss13_gr, samp2)
Forss13_grframelong <- melt(Forss13_grframe,id.vars="samp2")
Forss13_grframelong_sum <- ddply(Forss13_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss13_gr_max <- sum(Forss13_grframelong_sum $max > max20_Forsspipgr)
Forss13_gr_max
Forss13_gr_pres <- sum(Forss13_grframelong_sum $max > 0)
Forss13_gr_pres

#number of sites which would be classified as low
Forss13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss13_grframelong_sum$max)
Forss13_gr_lw_ref
#number of sites which would be classified as high
Forss13_gr_high_ref <- sum( Forss13_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss13_gr_high_ref
#number of sites which would be classified as moderate
Forss13_gr_mod_ref <- 1000 - (Forss13_gr_high_ref + Forss13_gr_lw_ref)
Forss13_gr_mod_ref

#14 detectors
Forss14_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Forss14_grframe<-data.frame(Forss14_gr, samp2)
Forss14_grframelong <- melt(Forss14_grframe,id.vars="samp2")
Forss14_grframelong_sum <- ddply(Forss14_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss14_gr_max <- sum(Forss14_grframelong_sum $max > max20_Forsspipgr)
Forss14_gr_max
Forss14_gr_pres <- sum(Forss14_grframelong_sum $max > 0)
Forss14_gr_pres

#number of sites which would be classified as low
Forss14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss14_grframelong_sum$max)
Forss14_gr_lw_ref
#number of sites which would be classified as high
Forss14_gr_high_ref <- sum( Forss14_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss14_gr_high_ref
#number of sites which would be classified as moderate
Forss14_gr_mod_ref <- 1000 - (Forss14_gr_high_ref + Forss14_gr_lw_ref)
Forss14_gr_mod_ref

#15 detectors
Forss15_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Forss15_grframe<-data.frame(Forss15_gr, samp2)
Forss15_grframelong <- melt(Forss15_grframe,id.vars="samp2")
Forss15_grframelong_sum <- ddply(Forss15_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss15_gr_max <- sum(Forss15_grframelong_sum $max > max20_Forsspipgr)
Forss15_gr_max
Forss15_gr_pres <- sum(Forss15_grframelong_sum $max > 0)
Forss15_gr_pres

#number of sites which would be classified as low
Forss15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss15_grframelong_sum$max)
Forss15_gr_lw_ref
#number of sites which would be classified as high
Forss15_gr_high_ref <- sum( Forss15_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss15_gr_high_ref
#number of sites which would be classified as moderate
Forss15_gr_mod_ref <- 1000 - (Forss15_gr_high_ref + Forss15_gr_lw_ref)
Forss15_gr_mod_ref

#16 detectors
Forss16_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Forss16_grframe<-data.frame(Forss16_gr, samp2)
Forss16_grframelong <- melt(Forss16_grframe,id.vars="samp2")
Forss16_grframelong_sum <- ddply(Forss16_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss16_gr_max <- sum(Forss16_grframelong_sum $max > max20_Forsspipgr)
Forss16_gr_max
Forss16_gr_pres <- sum(Forss16_grframelong_sum $max > 0)
Forss16_gr_pres

#number of sites which would be classified as low
Forss16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss16_grframelong_sum$max)
Forss16_gr_lw_ref
#number of sites which would be classified as high
Forss16_gr_high_ref <- sum( Forss16_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss16_gr_high_ref
#number of sites which would be classified as moderate
Forss16_gr_mod_ref <- 1000 - (Forss16_gr_high_ref + Forss16_gr_lw_ref)
Forss16_gr_mod_ref

#17 detectors
Forss17_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Forss17_grframe<-data.frame(Forss17_gr, samp2)
Forss17_grframelong <- melt(Forss17_grframe,id.vars="samp2")
Forss17_grframelong_sum <- ddply(Forss17_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss17_gr_max <- sum(Forss17_grframelong_sum $max > max20_Forsspipgr)
Forss17_gr_max
Forss17_gr_pres <- sum(Forss17_grframelong_sum $max > 0)
Forss17_gr_pres

#number of sites which would be classified as low
Forss17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss17_grframelong_sum$max)
Forss17_gr_lw_ref
#number of sites which would be classified as high
Forss17_gr_high_ref <- sum( Forss17_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss17_gr_high_ref
#number of sites which would be classified as moderate
Forss17_gr_mod_ref <- 1000 - (Forss17_gr_high_ref + Forss17_gr_lw_ref)
Forss17_gr_mod_ref

#18 detectors
Forss18_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Forss18_grframe<-data.frame(Forss18_gr, samp2)
Forss18_grframelong <- melt(Forss18_grframe,id.vars="samp2")
Forss18_grframelong_sum <- ddply(Forss18_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss18_gr_max <- sum(Forss18_grframelong_sum $max > max20_Forsspipgr)
Forss18_gr_max
Forss18_gr_pres <- sum(Forss18_grframelong_sum $max > 0)
Forss18_gr_pres

#number of sites which would be classified as low
Forss18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss18_grframelong_sum$max)
Forss18_gr_lw_ref
#number of sites which would be classified as high
Forss18_gr_high_ref <- sum( Forss18_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss18_gr_high_ref
#number of sites which would be classified as moderate
Forss18_gr_mod_ref <- 1000 - (Forss18_gr_high_ref + Forss18_gr_lw_ref)
Forss18_gr_mod_ref

#19 detectors
Forss19_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Forss19_grframe<-data.frame(Forss19_gr, samp2)
Forss19_grframelong <- melt(Forss19_grframe,id.vars="samp2")
Forss19_grframelong_sum <- ddply(Forss19_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss19_gr_max <- sum(Forss19_grframelong_sum $max > max20_Forsspipgr)
Forss19_gr_max
Forss19_gr_pres <- sum(Forss19_grframelong_sum $max > 0)
Forss19_gr_pres

#number of sites which would be classified as low
Forss19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss19_grframelong_sum$max)
Forss19_gr_lw_ref
#number of sites which would be classified as high
Forss19_gr_high_ref <- sum( Forss19_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss19_gr_high_ref
#number of sites which would be classified as moderate
Forss19_gr_mod_ref <- 1000 - (Forss19_gr_high_ref + Forss19_gr_lw_ref)
Forss19_gr_mod_ref

#20 detectors
Forss20_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Forss20_grframe<-data.frame(Forss20_gr, samp2)
Forss20_grframelong <- melt(Forss20_grframe,id.vars="samp2")
Forss20_grframelong_sum <- ddply(Forss20_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss20_gr_max <- sum(Forss20_grframelong_sum $max > max20_Forsspipgr)
Forss20_gr_max
Forss20_gr_pres <- sum(Forss20_grframelong_sum $max > 0)
Forss20_gr_pres

#number of sites which would be classified as low
Forss20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss20_grframelong_sum$max)
Forss20_gr_lw_ref
#number of sites which would be classified as high
Forss20_gr_high_ref <- sum( Forss20_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss20_gr_high_ref
#number of sites which would be classified as moderate
Forss20_gr_mod_ref <- 1000 - (Forss20_gr_high_ref + Forss20_gr_lw_ref)
Forss20_gr_mod_ref

#21 detectors
Forss21_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Forss21_grframe<-data.frame(Forss21_gr, samp2)
Forss21_grframelong <- melt(Forss21_grframe,id.vars="samp2")
Forss21_grframelong_sum <- ddply(Forss21_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss21_gr_max <- sum(Forss21_grframelong_sum $max > max20_Forsspipgr)
Forss21_gr_max
Forss21_gr_pres <- sum(Forss21_grframelong_sum $max > 0)
Forss21_gr_pres

#number of sites which would be classified as low
Forss21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss21_grframelong_sum$max)
Forss21_gr_lw_ref
#number of sites which would be classified as high
Forss21_gr_high_ref <- sum( Forss21_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss21_gr_high_ref
#number of sites which would be classified as moderate
Forss21_gr_mod_ref <- 1000 - (Forss21_gr_high_ref + Forss21_gr_lw_ref)
Forss21_gr_mod_ref

#22 detectors
Forss22_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Forss22_grframe<-data.frame(Forss22_gr, samp2)
Forss22_grframelong <- melt(Forss22_grframe,id.vars="samp2")
Forss22_grframelong_sum <- ddply(Forss22_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss22_gr_max <- sum(Forss22_grframelong_sum $max > max20_Forsspipgr)
Forss22_gr_max
Forss22_gr_pres <- sum(Forss22_grframelong_sum $max > 0)
Forss22_gr_pres

#number of sites which would be classified as low
Forss22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss22_grframelong_sum$max)
Forss22_gr_lw_ref
#number of sites which would be classified as high
Forss22_gr_high_ref <- sum( Forss22_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss22_gr_high_ref
#number of sites which would be classified as moderate
Forss22_gr_mod_ref <- 1000 - (Forss22_gr_high_ref + Forss22_gr_lw_ref)
Forss22_gr_mod_ref

#23 detectors
Forss23_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Forss23_grframe<-data.frame(Forss23_gr, samp2)
Forss23_grframelong <- melt(Forss23_grframe,id.vars="samp2")
Forss23_grframelong_sum <- ddply(Forss23_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss23_gr_max <- sum(Forss23_grframelong_sum $max > max20_Forsspipgr)
Forss23_gr_max
Forss23_gr_pres <- sum(Forss23_grframelong_sum $max > 0)
Forss23_gr_pres

#number of sites which would be classified as low
Forss23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss23_grframelong_sum$max)
Forss23_gr_lw_ref
#number of sites which would be classified as high
Forss23_gr_high_ref <- sum( Forss23_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss23_gr_high_ref
#number of sites which would be classified as moderate
Forss23_gr_mod_ref <- 1000 - (Forss23_gr_high_ref + Forss23_gr_lw_ref)
Forss23_gr_mod_ref

#24 detectors
Forss24_gr<-(replicate(1000, (sample(Forsspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Forss24_grframe<-data.frame(Forss24_gr, samp2)
Forss24_grframelong <- melt(Forss24_grframe,id.vars="samp2")
Forss24_grframelong_sum <- ddply(Forss24_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Forss24_gr_max <- sum(Forss24_grframelong_sum $max > max20_Forsspipgr)
Forss24_gr_max
Forss24_gr_pres <- sum(Forss24_grframelong_sum $max > 0)
Forss24_gr_pres

#number of sites which would be classified as low
Forss24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Forss24_grframelong_sum$max)
Forss24_gr_lw_ref
#number of sites which would be classified as high
Forss24_gr_high_ref <- sum( Forss24_grframelong_sum$max > allsppgr_ppip_ref_high)
Forss24_gr_high_ref
#number of sites which would be classified as moderate
Forss24_gr_mod_ref <- 1000 - (Forss24_gr_high_ref + Forss24_gr_lw_ref)
Forss24_gr_mod_ref

Present<-c(Forss1_gr_pres,Forss2_gr_pres,
           Forss3_gr_pres,Forss4_gr_pres,
           Forss5_gr_pres,Forss6_gr_pres,
           Forss7_gr_pres,Forss8_gr_pres,
           Forss9_gr_pres,Forss10_gr_pres,
           Forss11_gr_pres,Forss12_gr_pres,
           Forss13_gr_pres,Forss14_gr_pres,
           Forss15_gr_pres,Forss16_gr_pres,
           Forss17_gr_pres,Forss18_gr_pres,
           Forss19_gr_pres,Forss20_gr_pres,
           Forss21_gr_pres,Forss22_gr_pres,
           Forss23_gr_pres,Forss24_gr_pres)


Maximum<-c(Forss1_gr_max,Forss2_gr_max,
           Forss3_gr_max,Forss4_gr_max,
           Forss5_gr_max,Forss6_gr_max,
           Forss7_gr_max,Forss8_gr_max,
           Forss9_gr_max,Forss10_gr_max,
           Forss11_gr_max,Forss12_gr_max,
           Forss13_gr_max,Forss14_gr_max,
           Forss15_gr_max,Forss16_gr_max,
           Forss17_gr_max,Forss18_gr_max,
           Forss19_gr_max,Forss20_gr_max,
           Forss21_gr_max,Forss22_gr_max,
           Forss23_gr_max,Forss24_gr_max)

Low<-c(Forss1_gr_lw_ref, Forss2_gr_lw_ref, Forss3_gr_lw_ref,
       Forss4_gr_lw_ref, Forss5_gr_lw_ref, Forss6_gr_lw_ref,
       Forss7_gr_lw_ref, Forss8_gr_lw_ref, Forss9_gr_lw_ref,
       Forss10_gr_lw_ref, Forss11_gr_lw_ref, Forss12_gr_lw_ref, 
       Forss13_gr_lw_ref, Forss14_gr_lw_ref, Forss15_gr_lw_ref, 
       Forss16_gr_lw_ref, Forss17_gr_lw_ref, Forss18_gr_lw_ref, 
       Forss19_gr_lw_ref, Forss20_gr_lw_ref, Forss21_gr_lw_ref,
       Forss22_gr_lw_ref,Forss23_gr_lw_ref,Forss24_gr_lw_ref)

Moderate<-c(Forss1_gr_mod_ref, Forss2_gr_mod_ref, Forss3_gr_mod_ref,
            Forss4_gr_mod_ref, Forss5_gr_mod_ref, Forss6_gr_mod_ref,
            Forss7_gr_mod_ref, Forss8_gr_mod_ref, Forss9_gr_mod_ref,
            Forss10_gr_mod_ref, Forss11_gr_mod_ref, Forss12_gr_mod_ref, 
            Forss13_gr_mod_ref, Forss14_gr_mod_ref, Forss15_gr_mod_ref, 
            Forss16_gr_mod_ref, Forss17_gr_mod_ref, Forss18_gr_mod_ref, 
            Forss19_gr_mod_ref, Forss20_gr_mod_ref, Forss21_gr_mod_ref,
            Forss22_gr_mod_ref,Forss23_gr_mod_ref,Forss24_gr_mod_ref)

High<-c(Forss1_gr_high_ref, Forss2_gr_high_ref, Forss3_gr_high_ref,
        Forss4_gr_high_ref, Forss5_gr_high_ref, Forss6_gr_high_ref,
        Forss7_gr_high_ref, Forss8_gr_high_ref, Forss9_gr_high_ref,
        Forss10_gr_high_ref, Forss11_gr_high_ref, Forss12_gr_high_ref, 
        Forss13_gr_high_ref, Forss14_gr_high_ref, Forss15_gr_high_ref, 
        Forss16_gr_high_ref, Forss17_gr_high_ref, Forss18_gr_high_ref, 
        Forss19_gr_high_ref, Forss20_gr_high_ref, Forss21_gr_high_ref,
        Forss22_gr_high_ref,Forss23_gr_high_ref,Forss24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Forssgr",24)
Lowsite <- Forsslow
Modsite <- Forssmod
Highsite <-Forsshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Forssgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                            Site, Low, Moderate, High,
                            Lowsite, Modsite, Highsite)

##FourBurrows

FourBurrowspipgr<-subset(allspp4gr_ppip, Site=="FourBurrows")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_FourBurrowspipgr<-max(FourBurrowspipgr$Passes)

#calculate 20% from maximum nightly record

max20_FourBurrowspipgr<- (max_FourBurrowspipgr/100)*80

##calculate the site classification (reference range)

FourBurrowshigh<- max_FourBurrowspipgr > allsppgr_ppip_ref_high

FourBurrowslow<- allsppgr_ppip_ref_low > max_FourBurrowspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_FourBurrowspipgr
FourBurrowsmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
FourBurrows1_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 1, replace=F))))
FourBurrows1_gr_max <- sum(FourBurrows1_gr > max20_FourBurrowspipgr)
FourBurrows1_gr_max
FourBurrows1_gr_pres <- sum(FourBurrows1_gr > 0)
FourBurrows1_gr_pres
#number of sites which would be classified as low
FourBurrows1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows1_gr)
FourBurrows1_gr_lw_ref
#number of sites which would be classified as high
FourBurrows1_gr_high_ref <- sum( FourBurrows1_gr > allsppgr_ppip_ref_high)
FourBurrows1_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows1_gr_mod_ref <- 1000 - (FourBurrows1_gr_high_ref + FourBurrows1_gr_lw_ref)
FourBurrows1_gr_mod_ref


#2 nights
FourBurrows2_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
FourBurrows2_grframe<-data.frame(FourBurrows2_gr, samp2)
FourBurrows2_grframelong <- melt(FourBurrows2_grframe,id.vars="samp2")
FourBurrows2_grframelong_sum <- ddply(FourBurrows2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows2_gr_max <- sum(FourBurrows2_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows2_gr_max
FourBurrows2_gr_pres <- sum(FourBurrows2_grframelong_sum $max > 0)
FourBurrows2_gr_pres

#number of sites which would be classified as low
FourBurrows2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows2_grframelong_sum$max)
FourBurrows2_gr_lw_ref
#number of sites which would be classified as high
FourBurrows2_gr_high_ref <- sum( FourBurrows2_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows2_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows2_gr_mod_ref <- 1000 - (FourBurrows2_gr_high_ref + FourBurrows2_gr_lw_ref)
FourBurrows2_gr_mod_ref


#3 nights
FourBurrows3_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
FourBurrows3_grframe<-data.frame(FourBurrows3_gr, samp2)
FourBurrows3_grframelong <- melt(FourBurrows3_grframe,id.vars="samp2")
FourBurrows3_grframelong_sum <- ddply(FourBurrows3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows3_gr_max <- sum(FourBurrows3_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows3_gr_max
FourBurrows3_gr_pres <- sum(FourBurrows3_grframelong_sum $max > 0)
FourBurrows3_gr_pres

#number of sites which would be classified as low
FourBurrows3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows3_grframelong_sum$max)
FourBurrows3_gr_lw_ref
#number of sites which would be classified as high
FourBurrows3_gr_high_ref <- sum( FourBurrows3_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows3_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows3_gr_mod_ref <- 1000 - (FourBurrows3_gr_high_ref + FourBurrows3_gr_lw_ref)
FourBurrows3_gr_mod_ref

#4 nights
FourBurrows4_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
FourBurrows4_grframe<-data.frame(FourBurrows4_gr, samp2)
FourBurrows4_grframelong <- melt(FourBurrows4_grframe,id.vars="samp2")
FourBurrows4_grframelong_sum <- ddply(FourBurrows4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows4_gr_max <- sum(FourBurrows4_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows4_gr_max
FourBurrows4_gr_pres <- sum(FourBurrows4_grframelong_sum $max > 0)
FourBurrows4_gr_pres

#number of sites which would be classified as low
FourBurrows4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows4_grframelong_sum$max)
FourBurrows4_gr_lw_ref
#number of sites which would be classified as high
FourBurrows4_gr_high_ref <- sum( FourBurrows4_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows4_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows4_gr_mod_ref <- 1000 - (FourBurrows4_gr_high_ref + FourBurrows4_gr_lw_ref)
FourBurrows4_gr_mod_ref

#5 nights
FourBurrows5_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
FourBurrows5_grframe<-data.frame(FourBurrows5_gr, samp2)
FourBurrows5_grframelong <- melt(FourBurrows5_grframe,id.vars="samp2")
FourBurrows5_grframelong_sum <- ddply(FourBurrows5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows5_gr_max <- sum(FourBurrows5_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows5_gr_max
FourBurrows5_gr_pres <- sum(FourBurrows5_grframelong_sum $max > 0)
FourBurrows5_gr_pres

#number of sites which would be classified as low
FourBurrows5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows5_grframelong_sum$max)
FourBurrows5_gr_lw_ref
#number of sites which would be classified as high
FourBurrows5_gr_high_ref <- sum( FourBurrows5_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows5_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows5_gr_mod_ref <- 1000 - (FourBurrows5_gr_high_ref + FourBurrows5_gr_lw_ref)
FourBurrows5_gr_mod_ref

#6 nights
FourBurrows6_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
FourBurrows6_grframe<-data.frame(FourBurrows6_gr, samp2)
FourBurrows6_grframelong <- melt(FourBurrows6_grframe,id.vars="samp2")
FourBurrows6_grframelong_sum <- ddply(FourBurrows6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows6_gr_max <- sum(FourBurrows6_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows6_gr_max
FourBurrows6_gr_pres <- sum(FourBurrows6_grframelong_sum $max > 0)
FourBurrows6_gr_pres

#number of sites which would be classified as low
FourBurrows6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows6_grframelong_sum$max)
FourBurrows6_gr_lw_ref
#number of sites which would be classified as high
FourBurrows6_gr_high_ref <- sum( FourBurrows6_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows6_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows6_gr_mod_ref <- 1000 - (FourBurrows6_gr_high_ref + FourBurrows6_gr_lw_ref)
FourBurrows6_gr_mod_ref

#7 nights
FourBurrows7_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
FourBurrows7_grframe<-data.frame(FourBurrows7_gr, samp2)
FourBurrows7_grframelong <- melt(FourBurrows7_grframe,id.vars="samp2")
FourBurrows7_grframelong_sum <- ddply(FourBurrows7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows7_gr_max <- sum(FourBurrows7_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows7_gr_max
FourBurrows7_gr_pres <- sum(FourBurrows7_grframelong_sum $max > 0)
FourBurrows7_gr_pres

#number of sites which would be classified as low
FourBurrows7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows7_grframelong_sum$max)
FourBurrows7_gr_lw_ref
#number of sites which would be classified as high
FourBurrows7_gr_high_ref <- sum( FourBurrows7_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows7_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows7_gr_mod_ref <- 1000 - (FourBurrows7_gr_high_ref + FourBurrows7_gr_lw_ref)
FourBurrows7_gr_mod_ref

#8 nights
FourBurrows8_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
FourBurrows8_grframe<-data.frame(FourBurrows8_gr, samp2)
FourBurrows8_grframelong <- melt(FourBurrows8_grframe,id.vars="samp2")
FourBurrows8_grframelong_sum <- ddply(FourBurrows8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows8_gr_max <- sum(FourBurrows8_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows8_gr_max
FourBurrows8_gr_pres <- sum(FourBurrows8_grframelong_sum $max > 0)
FourBurrows8_gr_pres

#number of sites which would be classified as low
FourBurrows8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows8_grframelong_sum$max)
FourBurrows8_gr_lw_ref
#number of sites which would be classified as high
FourBurrows8_gr_high_ref <- sum( FourBurrows8_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows8_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows8_gr_mod_ref <- 1000 - (FourBurrows8_gr_high_ref + FourBurrows8_gr_lw_ref)
FourBurrows8_gr_mod_ref

#9 nights
FourBurrows9_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
FourBurrows9_grframe<-data.frame(FourBurrows9_gr, samp2)
FourBurrows9_grframelong <- melt(FourBurrows9_grframe,id.vars="samp2")
FourBurrows9_grframelong_sum <- ddply(FourBurrows9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
FourBurrows9_gr_max <- sum(FourBurrows9_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows9_gr_max
FourBurrows9_gr_pres <- sum(FourBurrows9_grframelong_sum $max > 0)
FourBurrows9_gr_pres

#number of sites which would be classified as low
FourBurrows9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows9_grframelong_sum$max)
FourBurrows9_gr_lw_ref
#number of sites which would be classified as high
FourBurrows9_gr_high_ref <- sum( FourBurrows9_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows9_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows9_gr_mod_ref <- 1000 - (FourBurrows9_gr_high_ref + FourBurrows9_gr_lw_ref)
FourBurrows9_gr_mod_ref

#10 detectors
FourBurrows10_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
FourBurrows10_grframe<-data.frame(FourBurrows10_gr, samp2)
FourBurrows10_grframelong <- melt(FourBurrows10_grframe,id.vars="samp2")
FourBurrows10_grframelong_sum <- ddply(FourBurrows10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows10_gr_max <- sum(FourBurrows10_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows10_gr_max
FourBurrows10_gr_pres <- sum(FourBurrows10_grframelong_sum $max > 0)
FourBurrows10_gr_pres

#number of sites which would be classified as low
FourBurrows10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows10_grframelong_sum$max)
FourBurrows10_gr_lw_ref
#number of sites which would be classified as high
FourBurrows10_gr_high_ref <- sum( FourBurrows10_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows10_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows10_gr_mod_ref <- 1000 - (FourBurrows10_gr_high_ref + FourBurrows10_gr_lw_ref)
FourBurrows10_gr_mod_ref

#11 detectors
FourBurrows11_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
FourBurrows11_grframe<-data.frame(FourBurrows11_gr, samp2)
FourBurrows11_grframelong <- melt(FourBurrows11_grframe,id.vars="samp2")
FourBurrows11_grframelong_sum <- ddply(FourBurrows11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows11_gr_max <- sum(FourBurrows11_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows11_gr_max
FourBurrows11_gr_pres <- sum(FourBurrows11_grframelong_sum $max > 0)
FourBurrows11_gr_pres

#number of sites which would be classified as low
FourBurrows11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows11_grframelong_sum$max)
FourBurrows11_gr_lw_ref
#number of sites which would be classified as high
FourBurrows11_gr_high_ref <- sum( FourBurrows11_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows11_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows11_gr_mod_ref <- 1000 - (FourBurrows11_gr_high_ref + FourBurrows11_gr_lw_ref)
FourBurrows11_gr_mod_ref

#12 detectors
FourBurrows12_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
FourBurrows12_grframe<-data.frame(FourBurrows12_gr, samp2)
FourBurrows12_grframelong <- melt(FourBurrows12_grframe,id.vars="samp2")
FourBurrows12_grframelong_sum <- ddply(FourBurrows12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows12_gr_max <- sum(FourBurrows12_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows12_gr_max
FourBurrows12_gr_pres <- sum(FourBurrows12_grframelong_sum $max > 0)
FourBurrows12_gr_pres

#number of sites which would be classified as low
FourBurrows12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows12_grframelong_sum$max)
FourBurrows12_gr_lw_ref
#number of sites which would be classified as high
FourBurrows12_gr_high_ref <- sum( FourBurrows12_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows12_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows12_gr_mod_ref <- 1000 - (FourBurrows12_gr_high_ref + FourBurrows12_gr_lw_ref)
FourBurrows12_gr_mod_ref

#13 detectors
FourBurrows13_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
FourBurrows13_grframe<-data.frame(FourBurrows13_gr, samp2)
FourBurrows13_grframelong <- melt(FourBurrows13_grframe,id.vars="samp2")
FourBurrows13_grframelong_sum <- ddply(FourBurrows13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows13_gr_max <- sum(FourBurrows13_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows13_gr_max
FourBurrows13_gr_pres <- sum(FourBurrows13_grframelong_sum $max > 0)
FourBurrows13_gr_pres

#number of sites which would be classified as low
FourBurrows13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows13_grframelong_sum$max)
FourBurrows13_gr_lw_ref
#number of sites which would be classified as high
FourBurrows13_gr_high_ref <- sum( FourBurrows13_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows13_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows13_gr_mod_ref <- 1000 - (FourBurrows13_gr_high_ref + FourBurrows13_gr_lw_ref)
FourBurrows13_gr_mod_ref

#14 detectors
FourBurrows14_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
FourBurrows14_grframe<-data.frame(FourBurrows14_gr, samp2)
FourBurrows14_grframelong <- melt(FourBurrows14_grframe,id.vars="samp2")
FourBurrows14_grframelong_sum <- ddply(FourBurrows14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows14_gr_max <- sum(FourBurrows14_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows14_gr_max
FourBurrows14_gr_pres <- sum(FourBurrows14_grframelong_sum $max > 0)
FourBurrows14_gr_pres

#number of sites which would be classified as low
FourBurrows14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows14_grframelong_sum$max)
FourBurrows14_gr_lw_ref
#number of sites which would be classified as high
FourBurrows14_gr_high_ref <- sum( FourBurrows14_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows14_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows14_gr_mod_ref <- 1000 - (FourBurrows14_gr_high_ref + FourBurrows14_gr_lw_ref)
FourBurrows14_gr_mod_ref

#15 detectors
FourBurrows15_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
FourBurrows15_grframe<-data.frame(FourBurrows15_gr, samp2)
FourBurrows15_grframelong <- melt(FourBurrows15_grframe,id.vars="samp2")
FourBurrows15_grframelong_sum <- ddply(FourBurrows15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows15_gr_max <- sum(FourBurrows15_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows15_gr_max
FourBurrows15_gr_pres <- sum(FourBurrows15_grframelong_sum $max > 0)
FourBurrows15_gr_pres

#number of sites which would be classified as low
FourBurrows15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows15_grframelong_sum$max)
FourBurrows15_gr_lw_ref
#number of sites which would be classified as high
FourBurrows15_gr_high_ref <- sum( FourBurrows15_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows15_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows15_gr_mod_ref <- 1000 - (FourBurrows15_gr_high_ref + FourBurrows15_gr_lw_ref)
FourBurrows15_gr_mod_ref

#16 detectors
FourBurrows16_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
FourBurrows16_grframe<-data.frame(FourBurrows16_gr, samp2)
FourBurrows16_grframelong <- melt(FourBurrows16_grframe,id.vars="samp2")
FourBurrows16_grframelong_sum <- ddply(FourBurrows16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows16_gr_max <- sum(FourBurrows16_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows16_gr_max
FourBurrows16_gr_pres <- sum(FourBurrows16_grframelong_sum $max > 0)
FourBurrows16_gr_pres

#number of sites which would be classified as low
FourBurrows16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows16_grframelong_sum$max)
FourBurrows16_gr_lw_ref
#number of sites which would be classified as high
FourBurrows16_gr_high_ref <- sum( FourBurrows16_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows16_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows16_gr_mod_ref <- 1000 - (FourBurrows16_gr_high_ref + FourBurrows16_gr_lw_ref)
FourBurrows16_gr_mod_ref

#17 detectors
FourBurrows17_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
FourBurrows17_grframe<-data.frame(FourBurrows17_gr, samp2)
FourBurrows17_grframelong <- melt(FourBurrows17_grframe,id.vars="samp2")
FourBurrows17_grframelong_sum <- ddply(FourBurrows17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows17_gr_max <- sum(FourBurrows17_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows17_gr_max
FourBurrows17_gr_pres <- sum(FourBurrows17_grframelong_sum $max > 0)
FourBurrows17_gr_pres

#number of sites which would be classified as low
FourBurrows17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows17_grframelong_sum$max)
FourBurrows17_gr_lw_ref
#number of sites which would be classified as high
FourBurrows17_gr_high_ref <- sum( FourBurrows17_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows17_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows17_gr_mod_ref <- 1000 - (FourBurrows17_gr_high_ref + FourBurrows17_gr_lw_ref)
FourBurrows17_gr_mod_ref

#18 detectors
FourBurrows18_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
FourBurrows18_grframe<-data.frame(FourBurrows18_gr, samp2)
FourBurrows18_grframelong <- melt(FourBurrows18_grframe,id.vars="samp2")
FourBurrows18_grframelong_sum <- ddply(FourBurrows18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows18_gr_max <- sum(FourBurrows18_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows18_gr_max
FourBurrows18_gr_pres <- sum(FourBurrows18_grframelong_sum $max > 0)
FourBurrows18_gr_pres

#number of sites which would be classified as low
FourBurrows18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows18_grframelong_sum$max)
FourBurrows18_gr_lw_ref
#number of sites which would be classified as high
FourBurrows18_gr_high_ref <- sum( FourBurrows18_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows18_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows18_gr_mod_ref <- 1000 - (FourBurrows18_gr_high_ref + FourBurrows18_gr_lw_ref)
FourBurrows18_gr_mod_ref

#19 detectors
FourBurrows19_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
FourBurrows19_grframe<-data.frame(FourBurrows19_gr, samp2)
FourBurrows19_grframelong <- melt(FourBurrows19_grframe,id.vars="samp2")
FourBurrows19_grframelong_sum <- ddply(FourBurrows19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows19_gr_max <- sum(FourBurrows19_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows19_gr_max
FourBurrows19_gr_pres <- sum(FourBurrows19_grframelong_sum $max > 0)
FourBurrows19_gr_pres

#number of sites which would be classified as low
FourBurrows19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows19_grframelong_sum$max)
FourBurrows19_gr_lw_ref
#number of sites which would be classified as high
FourBurrows19_gr_high_ref <- sum( FourBurrows19_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows19_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows19_gr_mod_ref <- 1000 - (FourBurrows19_gr_high_ref + FourBurrows19_gr_lw_ref)
FourBurrows19_gr_mod_ref

#20 detectors
FourBurrows20_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
FourBurrows20_grframe<-data.frame(FourBurrows20_gr, samp2)
FourBurrows20_grframelong <- melt(FourBurrows20_grframe,id.vars="samp2")
FourBurrows20_grframelong_sum <- ddply(FourBurrows20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows20_gr_max <- sum(FourBurrows20_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows20_gr_max
FourBurrows20_gr_pres <- sum(FourBurrows20_grframelong_sum $max > 0)
FourBurrows20_gr_pres

#number of sites which would be classified as low
FourBurrows20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows20_grframelong_sum$max)
FourBurrows20_gr_lw_ref
#number of sites which would be classified as high
FourBurrows20_gr_high_ref <- sum( FourBurrows20_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows20_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows20_gr_mod_ref <- 1000 - (FourBurrows20_gr_high_ref + FourBurrows20_gr_lw_ref)
FourBurrows20_gr_mod_ref

#21 detectors
FourBurrows21_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
FourBurrows21_grframe<-data.frame(FourBurrows21_gr, samp2)
FourBurrows21_grframelong <- melt(FourBurrows21_grframe,id.vars="samp2")
FourBurrows21_grframelong_sum <- ddply(FourBurrows21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows21_gr_max <- sum(FourBurrows21_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows21_gr_max
FourBurrows21_gr_pres <- sum(FourBurrows21_grframelong_sum $max > 0)
FourBurrows21_gr_pres

#number of sites which would be classified as low
FourBurrows21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows21_grframelong_sum$max)
FourBurrows21_gr_lw_ref
#number of sites which would be classified as high
FourBurrows21_gr_high_ref <- sum( FourBurrows21_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows21_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows21_gr_mod_ref <- 1000 - (FourBurrows21_gr_high_ref + FourBurrows21_gr_lw_ref)
FourBurrows21_gr_mod_ref

#22 detectors
FourBurrows22_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
FourBurrows22_grframe<-data.frame(FourBurrows22_gr, samp2)
FourBurrows22_grframelong <- melt(FourBurrows22_grframe,id.vars="samp2")
FourBurrows22_grframelong_sum <- ddply(FourBurrows22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows22_gr_max <- sum(FourBurrows22_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows22_gr_max
FourBurrows22_gr_pres <- sum(FourBurrows22_grframelong_sum $max > 0)
FourBurrows22_gr_pres

#number of sites which would be classified as low
FourBurrows22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows22_grframelong_sum$max)
FourBurrows22_gr_lw_ref
#number of sites which would be classified as high
FourBurrows22_gr_high_ref <- sum( FourBurrows22_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows22_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows22_gr_mod_ref <- 1000 - (FourBurrows22_gr_high_ref + FourBurrows22_gr_lw_ref)
FourBurrows22_gr_mod_ref

#23 detectors
FourBurrows23_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
FourBurrows23_grframe<-data.frame(FourBurrows23_gr, samp2)
FourBurrows23_grframelong <- melt(FourBurrows23_grframe,id.vars="samp2")
FourBurrows23_grframelong_sum <- ddply(FourBurrows23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows23_gr_max <- sum(FourBurrows23_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows23_gr_max
FourBurrows23_gr_pres <- sum(FourBurrows23_grframelong_sum $max > 0)
FourBurrows23_gr_pres

#number of sites which would be classified as low
FourBurrows23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows23_grframelong_sum$max)
FourBurrows23_gr_lw_ref
#number of sites which would be classified as high
FourBurrows23_gr_high_ref <- sum( FourBurrows23_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows23_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows23_gr_mod_ref <- 1000 - (FourBurrows23_gr_high_ref + FourBurrows23_gr_lw_ref)
FourBurrows23_gr_mod_ref

#24 detectors
FourBurrows24_gr<-(replicate(1000, (sample(FourBurrowspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
FourBurrows24_grframe<-data.frame(FourBurrows24_gr, samp2)
FourBurrows24_grframelong <- melt(FourBurrows24_grframe,id.vars="samp2")
FourBurrows24_grframelong_sum <- ddply(FourBurrows24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
FourBurrows24_gr_max <- sum(FourBurrows24_grframelong_sum $max > max20_FourBurrowspipgr)
FourBurrows24_gr_max
FourBurrows24_gr_pres <- sum(FourBurrows24_grframelong_sum $max > 0)
FourBurrows24_gr_pres

#number of sites which would be classified as low
FourBurrows24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= FourBurrows24_grframelong_sum$max)
FourBurrows24_gr_lw_ref
#number of sites which would be classified as high
FourBurrows24_gr_high_ref <- sum( FourBurrows24_grframelong_sum$max > allsppgr_ppip_ref_high)
FourBurrows24_gr_high_ref
#number of sites which would be classified as moderate
FourBurrows24_gr_mod_ref <- 1000 - (FourBurrows24_gr_high_ref + FourBurrows24_gr_lw_ref)
FourBurrows24_gr_mod_ref

Present<-c(FourBurrows1_gr_pres,FourBurrows2_gr_pres,
           FourBurrows3_gr_pres,FourBurrows4_gr_pres,
           FourBurrows5_gr_pres,FourBurrows6_gr_pres,
           FourBurrows7_gr_pres,FourBurrows8_gr_pres,
           FourBurrows9_gr_pres,FourBurrows10_gr_pres,
           FourBurrows11_gr_pres,FourBurrows12_gr_pres,
           FourBurrows13_gr_pres,FourBurrows14_gr_pres,
           FourBurrows15_gr_pres,FourBurrows16_gr_pres,
           FourBurrows17_gr_pres,FourBurrows18_gr_pres,
           FourBurrows19_gr_pres,FourBurrows20_gr_pres,
           FourBurrows21_gr_pres,FourBurrows22_gr_pres,
           FourBurrows23_gr_pres,FourBurrows24_gr_pres)


Maximum<-c(FourBurrows1_gr_max,FourBurrows2_gr_max,
           FourBurrows3_gr_max,FourBurrows4_gr_max,
           FourBurrows5_gr_max,FourBurrows6_gr_max,
           FourBurrows7_gr_max,FourBurrows8_gr_max,
           FourBurrows9_gr_max,FourBurrows10_gr_max,
           FourBurrows11_gr_max,FourBurrows12_gr_max,
           FourBurrows13_gr_max,FourBurrows14_gr_max,
           FourBurrows15_gr_max,FourBurrows16_gr_max,
           FourBurrows17_gr_max,FourBurrows18_gr_max,
           FourBurrows19_gr_max,FourBurrows20_gr_max,
           FourBurrows21_gr_max,FourBurrows22_gr_max,
           FourBurrows23_gr_max,FourBurrows24_gr_max)

Low<-c(FourBurrows1_gr_lw_ref, FourBurrows2_gr_lw_ref, FourBurrows3_gr_lw_ref,
       FourBurrows4_gr_lw_ref, FourBurrows5_gr_lw_ref, FourBurrows6_gr_lw_ref,
       FourBurrows7_gr_lw_ref, FourBurrows8_gr_lw_ref, FourBurrows9_gr_lw_ref,
       FourBurrows10_gr_lw_ref, FourBurrows11_gr_lw_ref, FourBurrows12_gr_lw_ref, 
       FourBurrows13_gr_lw_ref, FourBurrows14_gr_lw_ref, FourBurrows15_gr_lw_ref, 
       FourBurrows16_gr_lw_ref, FourBurrows17_gr_lw_ref, FourBurrows18_gr_lw_ref, 
       FourBurrows19_gr_lw_ref, FourBurrows20_gr_lw_ref, FourBurrows21_gr_lw_ref,
       FourBurrows22_gr_lw_ref,FourBurrows23_gr_lw_ref,FourBurrows24_gr_lw_ref)

Moderate<-c(FourBurrows1_gr_mod_ref, FourBurrows2_gr_mod_ref, FourBurrows3_gr_mod_ref,
            FourBurrows4_gr_mod_ref, FourBurrows5_gr_mod_ref, FourBurrows6_gr_mod_ref,
            FourBurrows7_gr_mod_ref, FourBurrows8_gr_mod_ref, FourBurrows9_gr_mod_ref,
            FourBurrows10_gr_mod_ref, FourBurrows11_gr_mod_ref, FourBurrows12_gr_mod_ref, 
            FourBurrows13_gr_mod_ref, FourBurrows14_gr_mod_ref, FourBurrows15_gr_mod_ref, 
            FourBurrows16_gr_mod_ref, FourBurrows17_gr_mod_ref, FourBurrows18_gr_mod_ref, 
            FourBurrows19_gr_mod_ref, FourBurrows20_gr_mod_ref, FourBurrows21_gr_mod_ref,
            FourBurrows22_gr_mod_ref,FourBurrows23_gr_mod_ref,FourBurrows24_gr_mod_ref)

High<-c(FourBurrows1_gr_high_ref, FourBurrows2_gr_high_ref, FourBurrows3_gr_high_ref,
        FourBurrows4_gr_high_ref, FourBurrows5_gr_high_ref, FourBurrows6_gr_high_ref,
        FourBurrows7_gr_high_ref, FourBurrows8_gr_high_ref, FourBurrows9_gr_high_ref,
        FourBurrows10_gr_high_ref, FourBurrows11_gr_high_ref, FourBurrows12_gr_high_ref, 
        FourBurrows13_gr_high_ref, FourBurrows14_gr_high_ref, FourBurrows15_gr_high_ref, 
        FourBurrows16_gr_high_ref, FourBurrows17_gr_high_ref, FourBurrows18_gr_high_ref, 
        FourBurrows19_gr_high_ref, FourBurrows20_gr_high_ref, FourBurrows21_gr_high_ref,
        FourBurrows22_gr_high_ref,FourBurrows23_gr_high_ref,FourBurrows24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("FourBurrowsgr",24)
Lowsite <- FourBurrowslow
Modsite <- FourBurrowsmod
Highsite <-FourBurrowshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



FourBurrowsgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##Fullabrook

Fullabrookpipgr<-subset(allspp4gr_ppip, Site=="Fullabrook")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Fullabrookpipgr<-max(Fullabrookpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Fullabrookpipgr<- (max_Fullabrookpipgr/100)*80

##calculate the site classification (reference range)

Fullabrookhigh<- max_Fullabrookpipgr > allsppgr_ppip_ref_high

Fullabrooklow<- allsppgr_ppip_ref_low > max_Fullabrookpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Fullabrookpipgr
Fullabrookmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Fullabrook1_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 1, replace=F))))
Fullabrook1_gr_max <- sum(Fullabrook1_gr > max20_Fullabrookpipgr)
Fullabrook1_gr_max
Fullabrook1_gr_pres <- sum(Fullabrook1_gr > 0)
Fullabrook1_gr_pres
#number of sites which would be classified as low
Fullabrook1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook1_gr)
Fullabrook1_gr_lw_ref
#number of sites which would be classified as high
Fullabrook1_gr_high_ref <- sum( Fullabrook1_gr > allsppgr_ppip_ref_high)
Fullabrook1_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook1_gr_mod_ref <- 1000 - (Fullabrook1_gr_high_ref + Fullabrook1_gr_lw_ref)
Fullabrook1_gr_mod_ref


#2 nights
Fullabrook2_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Fullabrook2_grframe<-data.frame(Fullabrook2_gr, samp2)
Fullabrook2_grframelong <- melt(Fullabrook2_grframe,id.vars="samp2")
Fullabrook2_grframelong_sum <- ddply(Fullabrook2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook2_gr_max <- sum(Fullabrook2_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook2_gr_max
Fullabrook2_gr_pres <- sum(Fullabrook2_grframelong_sum $max > 0)
Fullabrook2_gr_pres

#number of sites which would be classified as low
Fullabrook2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook2_grframelong_sum$max)
Fullabrook2_gr_lw_ref
#number of sites which would be classified as high
Fullabrook2_gr_high_ref <- sum( Fullabrook2_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook2_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook2_gr_mod_ref <- 1000 - (Fullabrook2_gr_high_ref + Fullabrook2_gr_lw_ref)
Fullabrook2_gr_mod_ref


#3 nights
Fullabrook3_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Fullabrook3_grframe<-data.frame(Fullabrook3_gr, samp2)
Fullabrook3_grframelong <- melt(Fullabrook3_grframe,id.vars="samp2")
Fullabrook3_grframelong_sum <- ddply(Fullabrook3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook3_gr_max <- sum(Fullabrook3_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook3_gr_max
Fullabrook3_gr_pres <- sum(Fullabrook3_grframelong_sum $max > 0)
Fullabrook3_gr_pres

#number of sites which would be classified as low
Fullabrook3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook3_grframelong_sum$max)
Fullabrook3_gr_lw_ref
#number of sites which would be classified as high
Fullabrook3_gr_high_ref <- sum( Fullabrook3_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook3_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook3_gr_mod_ref <- 1000 - (Fullabrook3_gr_high_ref + Fullabrook3_gr_lw_ref)
Fullabrook3_gr_mod_ref

#4 nights
Fullabrook4_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Fullabrook4_grframe<-data.frame(Fullabrook4_gr, samp2)
Fullabrook4_grframelong <- melt(Fullabrook4_grframe,id.vars="samp2")
Fullabrook4_grframelong_sum <- ddply(Fullabrook4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook4_gr_max <- sum(Fullabrook4_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook4_gr_max
Fullabrook4_gr_pres <- sum(Fullabrook4_grframelong_sum $max > 0)
Fullabrook4_gr_pres

#number of sites which would be classified as low
Fullabrook4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook4_grframelong_sum$max)
Fullabrook4_gr_lw_ref
#number of sites which would be classified as high
Fullabrook4_gr_high_ref <- sum( Fullabrook4_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook4_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook4_gr_mod_ref <- 1000 - (Fullabrook4_gr_high_ref + Fullabrook4_gr_lw_ref)
Fullabrook4_gr_mod_ref

#5 nights
Fullabrook5_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Fullabrook5_grframe<-data.frame(Fullabrook5_gr, samp2)
Fullabrook5_grframelong <- melt(Fullabrook5_grframe,id.vars="samp2")
Fullabrook5_grframelong_sum <- ddply(Fullabrook5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook5_gr_max <- sum(Fullabrook5_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook5_gr_max
Fullabrook5_gr_pres <- sum(Fullabrook5_grframelong_sum $max > 0)
Fullabrook5_gr_pres

#number of sites which would be classified as low
Fullabrook5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook5_grframelong_sum$max)
Fullabrook5_gr_lw_ref
#number of sites which would be classified as high
Fullabrook5_gr_high_ref <- sum( Fullabrook5_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook5_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook5_gr_mod_ref <- 1000 - (Fullabrook5_gr_high_ref + Fullabrook5_gr_lw_ref)
Fullabrook5_gr_mod_ref

#6 nights
Fullabrook6_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Fullabrook6_grframe<-data.frame(Fullabrook6_gr, samp2)
Fullabrook6_grframelong <- melt(Fullabrook6_grframe,id.vars="samp2")
Fullabrook6_grframelong_sum <- ddply(Fullabrook6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook6_gr_max <- sum(Fullabrook6_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook6_gr_max
Fullabrook6_gr_pres <- sum(Fullabrook6_grframelong_sum $max > 0)
Fullabrook6_gr_pres

#number of sites which would be classified as low
Fullabrook6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook6_grframelong_sum$max)
Fullabrook6_gr_lw_ref
#number of sites which would be classified as high
Fullabrook6_gr_high_ref <- sum( Fullabrook6_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook6_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook6_gr_mod_ref <- 1000 - (Fullabrook6_gr_high_ref + Fullabrook6_gr_lw_ref)
Fullabrook6_gr_mod_ref

#7 nights
Fullabrook7_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Fullabrook7_grframe<-data.frame(Fullabrook7_gr, samp2)
Fullabrook7_grframelong <- melt(Fullabrook7_grframe,id.vars="samp2")
Fullabrook7_grframelong_sum <- ddply(Fullabrook7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook7_gr_max <- sum(Fullabrook7_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook7_gr_max
Fullabrook7_gr_pres <- sum(Fullabrook7_grframelong_sum $max > 0)
Fullabrook7_gr_pres

#number of sites which would be classified as low
Fullabrook7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook7_grframelong_sum$max)
Fullabrook7_gr_lw_ref
#number of sites which would be classified as high
Fullabrook7_gr_high_ref <- sum( Fullabrook7_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook7_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook7_gr_mod_ref <- 1000 - (Fullabrook7_gr_high_ref + Fullabrook7_gr_lw_ref)
Fullabrook7_gr_mod_ref

#8 nights
Fullabrook8_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Fullabrook8_grframe<-data.frame(Fullabrook8_gr, samp2)
Fullabrook8_grframelong <- melt(Fullabrook8_grframe,id.vars="samp2")
Fullabrook8_grframelong_sum <- ddply(Fullabrook8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook8_gr_max <- sum(Fullabrook8_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook8_gr_max
Fullabrook8_gr_pres <- sum(Fullabrook8_grframelong_sum $max > 0)
Fullabrook8_gr_pres

#number of sites which would be classified as low
Fullabrook8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook8_grframelong_sum$max)
Fullabrook8_gr_lw_ref
#number of sites which would be classified as high
Fullabrook8_gr_high_ref <- sum( Fullabrook8_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook8_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook8_gr_mod_ref <- 1000 - (Fullabrook8_gr_high_ref + Fullabrook8_gr_lw_ref)
Fullabrook8_gr_mod_ref

#9 nights
Fullabrook9_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Fullabrook9_grframe<-data.frame(Fullabrook9_gr, samp2)
Fullabrook9_grframelong <- melt(Fullabrook9_grframe,id.vars="samp2")
Fullabrook9_grframelong_sum <- ddply(Fullabrook9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Fullabrook9_gr_max <- sum(Fullabrook9_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook9_gr_max
Fullabrook9_gr_pres <- sum(Fullabrook9_grframelong_sum $max > 0)
Fullabrook9_gr_pres

#number of sites which would be classified as low
Fullabrook9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook9_grframelong_sum$max)
Fullabrook9_gr_lw_ref
#number of sites which would be classified as high
Fullabrook9_gr_high_ref <- sum( Fullabrook9_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook9_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook9_gr_mod_ref <- 1000 - (Fullabrook9_gr_high_ref + Fullabrook9_gr_lw_ref)
Fullabrook9_gr_mod_ref

#10 detectors
Fullabrook10_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Fullabrook10_grframe<-data.frame(Fullabrook10_gr, samp2)
Fullabrook10_grframelong <- melt(Fullabrook10_grframe,id.vars="samp2")
Fullabrook10_grframelong_sum <- ddply(Fullabrook10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook10_gr_max <- sum(Fullabrook10_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook10_gr_max
Fullabrook10_gr_pres <- sum(Fullabrook10_grframelong_sum $max > 0)
Fullabrook10_gr_pres

#number of sites which would be classified as low
Fullabrook10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook10_grframelong_sum$max)
Fullabrook10_gr_lw_ref
#number of sites which would be classified as high
Fullabrook10_gr_high_ref <- sum( Fullabrook10_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook10_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook10_gr_mod_ref <- 1000 - (Fullabrook10_gr_high_ref + Fullabrook10_gr_lw_ref)
Fullabrook10_gr_mod_ref

#11 detectors
Fullabrook11_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Fullabrook11_grframe<-data.frame(Fullabrook11_gr, samp2)
Fullabrook11_grframelong <- melt(Fullabrook11_grframe,id.vars="samp2")
Fullabrook11_grframelong_sum <- ddply(Fullabrook11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook11_gr_max <- sum(Fullabrook11_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook11_gr_max
Fullabrook11_gr_pres <- sum(Fullabrook11_grframelong_sum $max > 0)
Fullabrook11_gr_pres

#number of sites which would be classified as low
Fullabrook11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook11_grframelong_sum$max)
Fullabrook11_gr_lw_ref
#number of sites which would be classified as high
Fullabrook11_gr_high_ref <- sum( Fullabrook11_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook11_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook11_gr_mod_ref <- 1000 - (Fullabrook11_gr_high_ref + Fullabrook11_gr_lw_ref)
Fullabrook11_gr_mod_ref

#12 detectors
Fullabrook12_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Fullabrook12_grframe<-data.frame(Fullabrook12_gr, samp2)
Fullabrook12_grframelong <- melt(Fullabrook12_grframe,id.vars="samp2")
Fullabrook12_grframelong_sum <- ddply(Fullabrook12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook12_gr_max <- sum(Fullabrook12_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook12_gr_max
Fullabrook12_gr_pres <- sum(Fullabrook12_grframelong_sum $max > 0)
Fullabrook12_gr_pres

#number of sites which would be classified as low
Fullabrook12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook12_grframelong_sum$max)
Fullabrook12_gr_lw_ref
#number of sites which would be classified as high
Fullabrook12_gr_high_ref <- sum( Fullabrook12_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook12_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook12_gr_mod_ref <- 1000 - (Fullabrook12_gr_high_ref + Fullabrook12_gr_lw_ref)
Fullabrook12_gr_mod_ref

#13 detectors
Fullabrook13_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Fullabrook13_grframe<-data.frame(Fullabrook13_gr, samp2)
Fullabrook13_grframelong <- melt(Fullabrook13_grframe,id.vars="samp2")
Fullabrook13_grframelong_sum <- ddply(Fullabrook13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook13_gr_max <- sum(Fullabrook13_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook13_gr_max
Fullabrook13_gr_pres <- sum(Fullabrook13_grframelong_sum $max > 0)
Fullabrook13_gr_pres

#number of sites which would be classified as low
Fullabrook13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook13_grframelong_sum$max)
Fullabrook13_gr_lw_ref
#number of sites which would be classified as high
Fullabrook13_gr_high_ref <- sum( Fullabrook13_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook13_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook13_gr_mod_ref <- 1000 - (Fullabrook13_gr_high_ref + Fullabrook13_gr_lw_ref)
Fullabrook13_gr_mod_ref

#14 detectors
Fullabrook14_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Fullabrook14_grframe<-data.frame(Fullabrook14_gr, samp2)
Fullabrook14_grframelong <- melt(Fullabrook14_grframe,id.vars="samp2")
Fullabrook14_grframelong_sum <- ddply(Fullabrook14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook14_gr_max <- sum(Fullabrook14_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook14_gr_max
Fullabrook14_gr_pres <- sum(Fullabrook14_grframelong_sum $max > 0)
Fullabrook14_gr_pres

#number of sites which would be classified as low
Fullabrook14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook14_grframelong_sum$max)
Fullabrook14_gr_lw_ref
#number of sites which would be classified as high
Fullabrook14_gr_high_ref <- sum( Fullabrook14_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook14_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook14_gr_mod_ref <- 1000 - (Fullabrook14_gr_high_ref + Fullabrook14_gr_lw_ref)
Fullabrook14_gr_mod_ref

#15 detectors
Fullabrook15_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Fullabrook15_grframe<-data.frame(Fullabrook15_gr, samp2)
Fullabrook15_grframelong <- melt(Fullabrook15_grframe,id.vars="samp2")
Fullabrook15_grframelong_sum <- ddply(Fullabrook15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook15_gr_max <- sum(Fullabrook15_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook15_gr_max
Fullabrook15_gr_pres <- sum(Fullabrook15_grframelong_sum $max > 0)
Fullabrook15_gr_pres

#number of sites which would be classified as low
Fullabrook15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook15_grframelong_sum$max)
Fullabrook15_gr_lw_ref
#number of sites which would be classified as high
Fullabrook15_gr_high_ref <- sum( Fullabrook15_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook15_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook15_gr_mod_ref <- 1000 - (Fullabrook15_gr_high_ref + Fullabrook15_gr_lw_ref)
Fullabrook15_gr_mod_ref

#16 detectors
Fullabrook16_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Fullabrook16_grframe<-data.frame(Fullabrook16_gr, samp2)
Fullabrook16_grframelong <- melt(Fullabrook16_grframe,id.vars="samp2")
Fullabrook16_grframelong_sum <- ddply(Fullabrook16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook16_gr_max <- sum(Fullabrook16_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook16_gr_max
Fullabrook16_gr_pres <- sum(Fullabrook16_grframelong_sum $max > 0)
Fullabrook16_gr_pres

#number of sites which would be classified as low
Fullabrook16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook16_grframelong_sum$max)
Fullabrook16_gr_lw_ref
#number of sites which would be classified as high
Fullabrook16_gr_high_ref <- sum( Fullabrook16_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook16_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook16_gr_mod_ref <- 1000 - (Fullabrook16_gr_high_ref + Fullabrook16_gr_lw_ref)
Fullabrook16_gr_mod_ref

#17 detectors
Fullabrook17_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Fullabrook17_grframe<-data.frame(Fullabrook17_gr, samp2)
Fullabrook17_grframelong <- melt(Fullabrook17_grframe,id.vars="samp2")
Fullabrook17_grframelong_sum <- ddply(Fullabrook17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook17_gr_max <- sum(Fullabrook17_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook17_gr_max
Fullabrook17_gr_pres <- sum(Fullabrook17_grframelong_sum $max > 0)
Fullabrook17_gr_pres

#number of sites which would be classified as low
Fullabrook17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook17_grframelong_sum$max)
Fullabrook17_gr_lw_ref
#number of sites which would be classified as high
Fullabrook17_gr_high_ref <- sum( Fullabrook17_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook17_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook17_gr_mod_ref <- 1000 - (Fullabrook17_gr_high_ref + Fullabrook17_gr_lw_ref)
Fullabrook17_gr_mod_ref

#18 detectors
Fullabrook18_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Fullabrook18_grframe<-data.frame(Fullabrook18_gr, samp2)
Fullabrook18_grframelong <- melt(Fullabrook18_grframe,id.vars="samp2")
Fullabrook18_grframelong_sum <- ddply(Fullabrook18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook18_gr_max <- sum(Fullabrook18_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook18_gr_max
Fullabrook18_gr_pres <- sum(Fullabrook18_grframelong_sum $max > 0)
Fullabrook18_gr_pres

#number of sites which would be classified as low
Fullabrook18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook18_grframelong_sum$max)
Fullabrook18_gr_lw_ref
#number of sites which would be classified as high
Fullabrook18_gr_high_ref <- sum( Fullabrook18_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook18_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook18_gr_mod_ref <- 1000 - (Fullabrook18_gr_high_ref + Fullabrook18_gr_lw_ref)
Fullabrook18_gr_mod_ref

#19 detectors
Fullabrook19_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Fullabrook19_grframe<-data.frame(Fullabrook19_gr, samp2)
Fullabrook19_grframelong <- melt(Fullabrook19_grframe,id.vars="samp2")
Fullabrook19_grframelong_sum <- ddply(Fullabrook19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook19_gr_max <- sum(Fullabrook19_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook19_gr_max
Fullabrook19_gr_pres <- sum(Fullabrook19_grframelong_sum $max > 0)
Fullabrook19_gr_pres

#number of sites which would be classified as low
Fullabrook19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook19_grframelong_sum$max)
Fullabrook19_gr_lw_ref
#number of sites which would be classified as high
Fullabrook19_gr_high_ref <- sum( Fullabrook19_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook19_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook19_gr_mod_ref <- 1000 - (Fullabrook19_gr_high_ref + Fullabrook19_gr_lw_ref)
Fullabrook19_gr_mod_ref

#20 detectors
Fullabrook20_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Fullabrook20_grframe<-data.frame(Fullabrook20_gr, samp2)
Fullabrook20_grframelong <- melt(Fullabrook20_grframe,id.vars="samp2")
Fullabrook20_grframelong_sum <- ddply(Fullabrook20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook20_gr_max <- sum(Fullabrook20_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook20_gr_max
Fullabrook20_gr_pres <- sum(Fullabrook20_grframelong_sum $max > 0)
Fullabrook20_gr_pres

#number of sites which would be classified as low
Fullabrook20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook20_grframelong_sum$max)
Fullabrook20_gr_lw_ref
#number of sites which would be classified as high
Fullabrook20_gr_high_ref <- sum( Fullabrook20_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook20_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook20_gr_mod_ref <- 1000 - (Fullabrook20_gr_high_ref + Fullabrook20_gr_lw_ref)
Fullabrook20_gr_mod_ref

#21 detectors
Fullabrook21_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Fullabrook21_grframe<-data.frame(Fullabrook21_gr, samp2)
Fullabrook21_grframelong <- melt(Fullabrook21_grframe,id.vars="samp2")
Fullabrook21_grframelong_sum <- ddply(Fullabrook21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook21_gr_max <- sum(Fullabrook21_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook21_gr_max
Fullabrook21_gr_pres <- sum(Fullabrook21_grframelong_sum $max > 0)
Fullabrook21_gr_pres

#number of sites which would be classified as low
Fullabrook21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook21_grframelong_sum$max)
Fullabrook21_gr_lw_ref
#number of sites which would be classified as high
Fullabrook21_gr_high_ref <- sum( Fullabrook21_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook21_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook21_gr_mod_ref <- 1000 - (Fullabrook21_gr_high_ref + Fullabrook21_gr_lw_ref)
Fullabrook21_gr_mod_ref

#22 detectors
Fullabrook22_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Fullabrook22_grframe<-data.frame(Fullabrook22_gr, samp2)
Fullabrook22_grframelong <- melt(Fullabrook22_grframe,id.vars="samp2")
Fullabrook22_grframelong_sum <- ddply(Fullabrook22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook22_gr_max <- sum(Fullabrook22_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook22_gr_max
Fullabrook22_gr_pres <- sum(Fullabrook22_grframelong_sum $max > 0)
Fullabrook22_gr_pres

#number of sites which would be classified as low
Fullabrook22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook22_grframelong_sum$max)
Fullabrook22_gr_lw_ref
#number of sites which would be classified as high
Fullabrook22_gr_high_ref <- sum( Fullabrook22_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook22_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook22_gr_mod_ref <- 1000 - (Fullabrook22_gr_high_ref + Fullabrook22_gr_lw_ref)
Fullabrook22_gr_mod_ref

#23 detectors
Fullabrook23_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Fullabrook23_grframe<-data.frame(Fullabrook23_gr, samp2)
Fullabrook23_grframelong <- melt(Fullabrook23_grframe,id.vars="samp2")
Fullabrook23_grframelong_sum <- ddply(Fullabrook23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook23_gr_max <- sum(Fullabrook23_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook23_gr_max
Fullabrook23_gr_pres <- sum(Fullabrook23_grframelong_sum $max > 0)
Fullabrook23_gr_pres

#number of sites which would be classified as low
Fullabrook23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook23_grframelong_sum$max)
Fullabrook23_gr_lw_ref
#number of sites which would be classified as high
Fullabrook23_gr_high_ref <- sum( Fullabrook23_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook23_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook23_gr_mod_ref <- 1000 - (Fullabrook23_gr_high_ref + Fullabrook23_gr_lw_ref)
Fullabrook23_gr_mod_ref

#24 detectors
Fullabrook24_gr<-(replicate(1000, (sample(Fullabrookpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Fullabrook24_grframe<-data.frame(Fullabrook24_gr, samp2)
Fullabrook24_grframelong <- melt(Fullabrook24_grframe,id.vars="samp2")
Fullabrook24_grframelong_sum <- ddply(Fullabrook24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Fullabrook24_gr_max <- sum(Fullabrook24_grframelong_sum $max > max20_Fullabrookpipgr)
Fullabrook24_gr_max
Fullabrook24_gr_pres <- sum(Fullabrook24_grframelong_sum $max > 0)
Fullabrook24_gr_pres

#number of sites which would be classified as low
Fullabrook24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Fullabrook24_grframelong_sum$max)
Fullabrook24_gr_lw_ref
#number of sites which would be classified as high
Fullabrook24_gr_high_ref <- sum( Fullabrook24_grframelong_sum$max > allsppgr_ppip_ref_high)
Fullabrook24_gr_high_ref
#number of sites which would be classified as moderate
Fullabrook24_gr_mod_ref <- 1000 - (Fullabrook24_gr_high_ref + Fullabrook24_gr_lw_ref)
Fullabrook24_gr_mod_ref

Present<-c(Fullabrook1_gr_pres,Fullabrook2_gr_pres,
           Fullabrook3_gr_pres,Fullabrook4_gr_pres,
           Fullabrook5_gr_pres,Fullabrook6_gr_pres,
           Fullabrook7_gr_pres,Fullabrook8_gr_pres,
           Fullabrook9_gr_pres,Fullabrook10_gr_pres,
           Fullabrook11_gr_pres,Fullabrook12_gr_pres,
           Fullabrook13_gr_pres,Fullabrook14_gr_pres,
           Fullabrook15_gr_pres,Fullabrook16_gr_pres,
           Fullabrook17_gr_pres,Fullabrook18_gr_pres,
           Fullabrook19_gr_pres,Fullabrook20_gr_pres,
           Fullabrook21_gr_pres,Fullabrook22_gr_pres,
           Fullabrook23_gr_pres,Fullabrook24_gr_pres)


Maximum<-c(Fullabrook1_gr_max,Fullabrook2_gr_max,
           Fullabrook3_gr_max,Fullabrook4_gr_max,
           Fullabrook5_gr_max,Fullabrook6_gr_max,
           Fullabrook7_gr_max,Fullabrook8_gr_max,
           Fullabrook9_gr_max,Fullabrook10_gr_max,
           Fullabrook11_gr_max,Fullabrook12_gr_max,
           Fullabrook13_gr_max,Fullabrook14_gr_max,
           Fullabrook15_gr_max,Fullabrook16_gr_max,
           Fullabrook17_gr_max,Fullabrook18_gr_max,
           Fullabrook19_gr_max,Fullabrook20_gr_max,
           Fullabrook21_gr_max,Fullabrook22_gr_max,
           Fullabrook23_gr_max,Fullabrook24_gr_max)

Low<-c(Fullabrook1_gr_lw_ref, Fullabrook2_gr_lw_ref, Fullabrook3_gr_lw_ref,
       Fullabrook4_gr_lw_ref, Fullabrook5_gr_lw_ref, Fullabrook6_gr_lw_ref,
       Fullabrook7_gr_lw_ref, Fullabrook8_gr_lw_ref, Fullabrook9_gr_lw_ref,
       Fullabrook10_gr_lw_ref, Fullabrook11_gr_lw_ref, Fullabrook12_gr_lw_ref, 
       Fullabrook13_gr_lw_ref, Fullabrook14_gr_lw_ref, Fullabrook15_gr_lw_ref, 
       Fullabrook16_gr_lw_ref, Fullabrook17_gr_lw_ref, Fullabrook18_gr_lw_ref, 
       Fullabrook19_gr_lw_ref, Fullabrook20_gr_lw_ref, Fullabrook21_gr_lw_ref,
       Fullabrook22_gr_lw_ref,Fullabrook23_gr_lw_ref,Fullabrook24_gr_lw_ref)

Moderate<-c(Fullabrook1_gr_mod_ref, Fullabrook2_gr_mod_ref, Fullabrook3_gr_mod_ref,
            Fullabrook4_gr_mod_ref, Fullabrook5_gr_mod_ref, Fullabrook6_gr_mod_ref,
            Fullabrook7_gr_mod_ref, Fullabrook8_gr_mod_ref, Fullabrook9_gr_mod_ref,
            Fullabrook10_gr_mod_ref, Fullabrook11_gr_mod_ref, Fullabrook12_gr_mod_ref, 
            Fullabrook13_gr_mod_ref, Fullabrook14_gr_mod_ref, Fullabrook15_gr_mod_ref, 
            Fullabrook16_gr_mod_ref, Fullabrook17_gr_mod_ref, Fullabrook18_gr_mod_ref, 
            Fullabrook19_gr_mod_ref, Fullabrook20_gr_mod_ref, Fullabrook21_gr_mod_ref,
            Fullabrook22_gr_mod_ref,Fullabrook23_gr_mod_ref,Fullabrook24_gr_mod_ref)

High<-c(Fullabrook1_gr_high_ref, Fullabrook2_gr_high_ref, Fullabrook3_gr_high_ref,
        Fullabrook4_gr_high_ref, Fullabrook5_gr_high_ref, Fullabrook6_gr_high_ref,
        Fullabrook7_gr_high_ref, Fullabrook8_gr_high_ref, Fullabrook9_gr_high_ref,
        Fullabrook10_gr_high_ref, Fullabrook11_gr_high_ref, Fullabrook12_gr_high_ref, 
        Fullabrook13_gr_high_ref, Fullabrook14_gr_high_ref, Fullabrook15_gr_high_ref, 
        Fullabrook16_gr_high_ref, Fullabrook17_gr_high_ref, Fullabrook18_gr_high_ref, 
        Fullabrook19_gr_high_ref, Fullabrook20_gr_high_ref, Fullabrook21_gr_high_ref,
        Fullabrook22_gr_high_ref,Fullabrook23_gr_high_ref,Fullabrook24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Fullabrookgr",24)
Lowsite <- Fullabrooklow
Modsite <- Fullabrookmod
Highsite <-Fullabrookhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Fullabrookgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##GlassMoor

GlassMoorpipgr<-subset(allspp4gr_ppip, Site=="GlassMoor")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_GlassMoorpipgr<-max(GlassMoorpipgr$Passes)

#calculate 20% from maximum nightly record

max20_GlassMoorpipgr<- (max_GlassMoorpipgr/100)*80

##calculate the site classification (reference range)

GlassMoorhigh<- max_GlassMoorpipgr > allsppgr_ppip_ref_high

GlassMoorlow<- allsppgr_ppip_ref_low > max_GlassMoorpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_GlassMoorpipgr
GlassMoormod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
GlassMoor1_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 1, replace=F))))
GlassMoor1_gr_max <- sum(GlassMoor1_gr > max20_GlassMoorpipgr)
GlassMoor1_gr_max
GlassMoor1_gr_pres <- sum(GlassMoor1_gr > 0)
GlassMoor1_gr_pres
#number of sites which would be classified as low
GlassMoor1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor1_gr)
GlassMoor1_gr_lw_ref
#number of sites which would be classified as high
GlassMoor1_gr_high_ref <- sum( GlassMoor1_gr > allsppgr_ppip_ref_high)
GlassMoor1_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor1_gr_mod_ref <- 1000 - (GlassMoor1_gr_high_ref + GlassMoor1_gr_lw_ref)
GlassMoor1_gr_mod_ref


#2 nights
GlassMoor2_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
GlassMoor2_grframe<-data.frame(GlassMoor2_gr, samp2)
GlassMoor2_grframelong <- melt(GlassMoor2_grframe,id.vars="samp2")
GlassMoor2_grframelong_sum <- ddply(GlassMoor2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor2_gr_max <- sum(GlassMoor2_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor2_gr_max
GlassMoor2_gr_pres <- sum(GlassMoor2_grframelong_sum $max > 0)
GlassMoor2_gr_pres

#number of sites which would be classified as low
GlassMoor2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor2_grframelong_sum$max)
GlassMoor2_gr_lw_ref
#number of sites which would be classified as high
GlassMoor2_gr_high_ref <- sum( GlassMoor2_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor2_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor2_gr_mod_ref <- 1000 - (GlassMoor2_gr_high_ref + GlassMoor2_gr_lw_ref)
GlassMoor2_gr_mod_ref


#3 nights
GlassMoor3_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
GlassMoor3_grframe<-data.frame(GlassMoor3_gr, samp2)
GlassMoor3_grframelong <- melt(GlassMoor3_grframe,id.vars="samp2")
GlassMoor3_grframelong_sum <- ddply(GlassMoor3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor3_gr_max <- sum(GlassMoor3_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor3_gr_max
GlassMoor3_gr_pres <- sum(GlassMoor3_grframelong_sum $max > 0)
GlassMoor3_gr_pres

#number of sites which would be classified as low
GlassMoor3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor3_grframelong_sum$max)
GlassMoor3_gr_lw_ref
#number of sites which would be classified as high
GlassMoor3_gr_high_ref <- sum( GlassMoor3_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor3_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor3_gr_mod_ref <- 1000 - (GlassMoor3_gr_high_ref + GlassMoor3_gr_lw_ref)
GlassMoor3_gr_mod_ref

#4 nights
GlassMoor4_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
GlassMoor4_grframe<-data.frame(GlassMoor4_gr, samp2)
GlassMoor4_grframelong <- melt(GlassMoor4_grframe,id.vars="samp2")
GlassMoor4_grframelong_sum <- ddply(GlassMoor4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor4_gr_max <- sum(GlassMoor4_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor4_gr_max
GlassMoor4_gr_pres <- sum(GlassMoor4_grframelong_sum $max > 0)
GlassMoor4_gr_pres

#number of sites which would be classified as low
GlassMoor4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor4_grframelong_sum$max)
GlassMoor4_gr_lw_ref
#number of sites which would be classified as high
GlassMoor4_gr_high_ref <- sum( GlassMoor4_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor4_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor4_gr_mod_ref <- 1000 - (GlassMoor4_gr_high_ref + GlassMoor4_gr_lw_ref)
GlassMoor4_gr_mod_ref

#5 nights
GlassMoor5_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
GlassMoor5_grframe<-data.frame(GlassMoor5_gr, samp2)
GlassMoor5_grframelong <- melt(GlassMoor5_grframe,id.vars="samp2")
GlassMoor5_grframelong_sum <- ddply(GlassMoor5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor5_gr_max <- sum(GlassMoor5_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor5_gr_max
GlassMoor5_gr_pres <- sum(GlassMoor5_grframelong_sum $max > 0)
GlassMoor5_gr_pres

#number of sites which would be classified as low
GlassMoor5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor5_grframelong_sum$max)
GlassMoor5_gr_lw_ref
#number of sites which would be classified as high
GlassMoor5_gr_high_ref <- sum( GlassMoor5_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor5_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor5_gr_mod_ref <- 1000 - (GlassMoor5_gr_high_ref + GlassMoor5_gr_lw_ref)
GlassMoor5_gr_mod_ref

#6 nights
GlassMoor6_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
GlassMoor6_grframe<-data.frame(GlassMoor6_gr, samp2)
GlassMoor6_grframelong <- melt(GlassMoor6_grframe,id.vars="samp2")
GlassMoor6_grframelong_sum <- ddply(GlassMoor6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor6_gr_max <- sum(GlassMoor6_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor6_gr_max
GlassMoor6_gr_pres <- sum(GlassMoor6_grframelong_sum $max > 0)
GlassMoor6_gr_pres

#number of sites which would be classified as low
GlassMoor6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor6_grframelong_sum$max)
GlassMoor6_gr_lw_ref
#number of sites which would be classified as high
GlassMoor6_gr_high_ref <- sum( GlassMoor6_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor6_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor6_gr_mod_ref <- 1000 - (GlassMoor6_gr_high_ref + GlassMoor6_gr_lw_ref)
GlassMoor6_gr_mod_ref

#7 nights
GlassMoor7_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
GlassMoor7_grframe<-data.frame(GlassMoor7_gr, samp2)
GlassMoor7_grframelong <- melt(GlassMoor7_grframe,id.vars="samp2")
GlassMoor7_grframelong_sum <- ddply(GlassMoor7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor7_gr_max <- sum(GlassMoor7_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor7_gr_max
GlassMoor7_gr_pres <- sum(GlassMoor7_grframelong_sum $max > 0)
GlassMoor7_gr_pres

#number of sites which would be classified as low
GlassMoor7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor7_grframelong_sum$max)
GlassMoor7_gr_lw_ref
#number of sites which would be classified as high
GlassMoor7_gr_high_ref <- sum( GlassMoor7_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor7_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor7_gr_mod_ref <- 1000 - (GlassMoor7_gr_high_ref + GlassMoor7_gr_lw_ref)
GlassMoor7_gr_mod_ref

#8 nights
GlassMoor8_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
GlassMoor8_grframe<-data.frame(GlassMoor8_gr, samp2)
GlassMoor8_grframelong <- melt(GlassMoor8_grframe,id.vars="samp2")
GlassMoor8_grframelong_sum <- ddply(GlassMoor8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor8_gr_max <- sum(GlassMoor8_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor8_gr_max
GlassMoor8_gr_pres <- sum(GlassMoor8_grframelong_sum $max > 0)
GlassMoor8_gr_pres

#number of sites which would be classified as low
GlassMoor8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor8_grframelong_sum$max)
GlassMoor8_gr_lw_ref
#number of sites which would be classified as high
GlassMoor8_gr_high_ref <- sum( GlassMoor8_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor8_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor8_gr_mod_ref <- 1000 - (GlassMoor8_gr_high_ref + GlassMoor8_gr_lw_ref)
GlassMoor8_gr_mod_ref

#9 nights
GlassMoor9_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
GlassMoor9_grframe<-data.frame(GlassMoor9_gr, samp2)
GlassMoor9_grframelong <- melt(GlassMoor9_grframe,id.vars="samp2")
GlassMoor9_grframelong_sum <- ddply(GlassMoor9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
GlassMoor9_gr_max <- sum(GlassMoor9_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor9_gr_max
GlassMoor9_gr_pres <- sum(GlassMoor9_grframelong_sum $max > 0)
GlassMoor9_gr_pres

#number of sites which would be classified as low
GlassMoor9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor9_grframelong_sum$max)
GlassMoor9_gr_lw_ref
#number of sites which would be classified as high
GlassMoor9_gr_high_ref <- sum( GlassMoor9_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor9_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor9_gr_mod_ref <- 1000 - (GlassMoor9_gr_high_ref + GlassMoor9_gr_lw_ref)
GlassMoor9_gr_mod_ref

#10 detectors
GlassMoor10_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
GlassMoor10_grframe<-data.frame(GlassMoor10_gr, samp2)
GlassMoor10_grframelong <- melt(GlassMoor10_grframe,id.vars="samp2")
GlassMoor10_grframelong_sum <- ddply(GlassMoor10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor10_gr_max <- sum(GlassMoor10_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor10_gr_max
GlassMoor10_gr_pres <- sum(GlassMoor10_grframelong_sum $max > 0)
GlassMoor10_gr_pres

#number of sites which would be classified as low
GlassMoor10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor10_grframelong_sum$max)
GlassMoor10_gr_lw_ref
#number of sites which would be classified as high
GlassMoor10_gr_high_ref <- sum( GlassMoor10_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor10_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor10_gr_mod_ref <- 1000 - (GlassMoor10_gr_high_ref + GlassMoor10_gr_lw_ref)
GlassMoor10_gr_mod_ref

#11 detectors
GlassMoor11_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
GlassMoor11_grframe<-data.frame(GlassMoor11_gr, samp2)
GlassMoor11_grframelong <- melt(GlassMoor11_grframe,id.vars="samp2")
GlassMoor11_grframelong_sum <- ddply(GlassMoor11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor11_gr_max <- sum(GlassMoor11_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor11_gr_max
GlassMoor11_gr_pres <- sum(GlassMoor11_grframelong_sum $max > 0)
GlassMoor11_gr_pres

#number of sites which would be classified as low
GlassMoor11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor11_grframelong_sum$max)
GlassMoor11_gr_lw_ref
#number of sites which would be classified as high
GlassMoor11_gr_high_ref <- sum( GlassMoor11_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor11_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor11_gr_mod_ref <- 1000 - (GlassMoor11_gr_high_ref + GlassMoor11_gr_lw_ref)
GlassMoor11_gr_mod_ref

#12 detectors
GlassMoor12_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
GlassMoor12_grframe<-data.frame(GlassMoor12_gr, samp2)
GlassMoor12_grframelong <- melt(GlassMoor12_grframe,id.vars="samp2")
GlassMoor12_grframelong_sum <- ddply(GlassMoor12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor12_gr_max <- sum(GlassMoor12_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor12_gr_max
GlassMoor12_gr_pres <- sum(GlassMoor12_grframelong_sum $max > 0)
GlassMoor12_gr_pres

#number of sites which would be classified as low
GlassMoor12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor12_grframelong_sum$max)
GlassMoor12_gr_lw_ref
#number of sites which would be classified as high
GlassMoor12_gr_high_ref <- sum( GlassMoor12_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor12_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor12_gr_mod_ref <- 1000 - (GlassMoor12_gr_high_ref + GlassMoor12_gr_lw_ref)
GlassMoor12_gr_mod_ref

#13 detectors
GlassMoor13_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
GlassMoor13_grframe<-data.frame(GlassMoor13_gr, samp2)
GlassMoor13_grframelong <- melt(GlassMoor13_grframe,id.vars="samp2")
GlassMoor13_grframelong_sum <- ddply(GlassMoor13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor13_gr_max <- sum(GlassMoor13_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor13_gr_max
GlassMoor13_gr_pres <- sum(GlassMoor13_grframelong_sum $max > 0)
GlassMoor13_gr_pres

#number of sites which would be classified as low
GlassMoor13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor13_grframelong_sum$max)
GlassMoor13_gr_lw_ref
#number of sites which would be classified as high
GlassMoor13_gr_high_ref <- sum( GlassMoor13_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor13_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor13_gr_mod_ref <- 1000 - (GlassMoor13_gr_high_ref + GlassMoor13_gr_lw_ref)
GlassMoor13_gr_mod_ref

#14 detectors
GlassMoor14_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
GlassMoor14_grframe<-data.frame(GlassMoor14_gr, samp2)
GlassMoor14_grframelong <- melt(GlassMoor14_grframe,id.vars="samp2")
GlassMoor14_grframelong_sum <- ddply(GlassMoor14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor14_gr_max <- sum(GlassMoor14_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor14_gr_max
GlassMoor14_gr_pres <- sum(GlassMoor14_grframelong_sum $max > 0)
GlassMoor14_gr_pres

#number of sites which would be classified as low
GlassMoor14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor14_grframelong_sum$max)
GlassMoor14_gr_lw_ref
#number of sites which would be classified as high
GlassMoor14_gr_high_ref <- sum( GlassMoor14_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor14_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor14_gr_mod_ref <- 1000 - (GlassMoor14_gr_high_ref + GlassMoor14_gr_lw_ref)
GlassMoor14_gr_mod_ref

#15 detectors
GlassMoor15_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
GlassMoor15_grframe<-data.frame(GlassMoor15_gr, samp2)
GlassMoor15_grframelong <- melt(GlassMoor15_grframe,id.vars="samp2")
GlassMoor15_grframelong_sum <- ddply(GlassMoor15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor15_gr_max <- sum(GlassMoor15_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor15_gr_max
GlassMoor15_gr_pres <- sum(GlassMoor15_grframelong_sum $max > 0)
GlassMoor15_gr_pres

#number of sites which would be classified as low
GlassMoor15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor15_grframelong_sum$max)
GlassMoor15_gr_lw_ref
#number of sites which would be classified as high
GlassMoor15_gr_high_ref <- sum( GlassMoor15_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor15_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor15_gr_mod_ref <- 1000 - (GlassMoor15_gr_high_ref + GlassMoor15_gr_lw_ref)
GlassMoor15_gr_mod_ref

#16 detectors
GlassMoor16_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
GlassMoor16_grframe<-data.frame(GlassMoor16_gr, samp2)
GlassMoor16_grframelong <- melt(GlassMoor16_grframe,id.vars="samp2")
GlassMoor16_grframelong_sum <- ddply(GlassMoor16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor16_gr_max <- sum(GlassMoor16_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor16_gr_max
GlassMoor16_gr_pres <- sum(GlassMoor16_grframelong_sum $max > 0)
GlassMoor16_gr_pres

#number of sites which would be classified as low
GlassMoor16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor16_grframelong_sum$max)
GlassMoor16_gr_lw_ref
#number of sites which would be classified as high
GlassMoor16_gr_high_ref <- sum( GlassMoor16_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor16_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor16_gr_mod_ref <- 1000 - (GlassMoor16_gr_high_ref + GlassMoor16_gr_lw_ref)
GlassMoor16_gr_mod_ref

#17 detectors
GlassMoor17_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
GlassMoor17_grframe<-data.frame(GlassMoor17_gr, samp2)
GlassMoor17_grframelong <- melt(GlassMoor17_grframe,id.vars="samp2")
GlassMoor17_grframelong_sum <- ddply(GlassMoor17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor17_gr_max <- sum(GlassMoor17_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor17_gr_max
GlassMoor17_gr_pres <- sum(GlassMoor17_grframelong_sum $max > 0)
GlassMoor17_gr_pres

#number of sites which would be classified as low
GlassMoor17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor17_grframelong_sum$max)
GlassMoor17_gr_lw_ref
#number of sites which would be classified as high
GlassMoor17_gr_high_ref <- sum( GlassMoor17_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor17_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor17_gr_mod_ref <- 1000 - (GlassMoor17_gr_high_ref + GlassMoor17_gr_lw_ref)
GlassMoor17_gr_mod_ref

#18 detectors
GlassMoor18_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
GlassMoor18_grframe<-data.frame(GlassMoor18_gr, samp2)
GlassMoor18_grframelong <- melt(GlassMoor18_grframe,id.vars="samp2")
GlassMoor18_grframelong_sum <- ddply(GlassMoor18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor18_gr_max <- sum(GlassMoor18_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor18_gr_max
GlassMoor18_gr_pres <- sum(GlassMoor18_grframelong_sum $max > 0)
GlassMoor18_gr_pres

#number of sites which would be classified as low
GlassMoor18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor18_grframelong_sum$max)
GlassMoor18_gr_lw_ref
#number of sites which would be classified as high
GlassMoor18_gr_high_ref <- sum( GlassMoor18_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor18_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor18_gr_mod_ref <- 1000 - (GlassMoor18_gr_high_ref + GlassMoor18_gr_lw_ref)
GlassMoor18_gr_mod_ref

#19 detectors
GlassMoor19_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
GlassMoor19_grframe<-data.frame(GlassMoor19_gr, samp2)
GlassMoor19_grframelong <- melt(GlassMoor19_grframe,id.vars="samp2")
GlassMoor19_grframelong_sum <- ddply(GlassMoor19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor19_gr_max <- sum(GlassMoor19_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor19_gr_max
GlassMoor19_gr_pres <- sum(GlassMoor19_grframelong_sum $max > 0)
GlassMoor19_gr_pres

#number of sites which would be classified as low
GlassMoor19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor19_grframelong_sum$max)
GlassMoor19_gr_lw_ref
#number of sites which would be classified as high
GlassMoor19_gr_high_ref <- sum( GlassMoor19_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor19_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor19_gr_mod_ref <- 1000 - (GlassMoor19_gr_high_ref + GlassMoor19_gr_lw_ref)
GlassMoor19_gr_mod_ref

#20 detectors
GlassMoor20_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
GlassMoor20_grframe<-data.frame(GlassMoor20_gr, samp2)
GlassMoor20_grframelong <- melt(GlassMoor20_grframe,id.vars="samp2")
GlassMoor20_grframelong_sum <- ddply(GlassMoor20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor20_gr_max <- sum(GlassMoor20_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor20_gr_max
GlassMoor20_gr_pres <- sum(GlassMoor20_grframelong_sum $max > 0)
GlassMoor20_gr_pres

#number of sites which would be classified as low
GlassMoor20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor20_grframelong_sum$max)
GlassMoor20_gr_lw_ref
#number of sites which would be classified as high
GlassMoor20_gr_high_ref <- sum( GlassMoor20_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor20_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor20_gr_mod_ref <- 1000 - (GlassMoor20_gr_high_ref + GlassMoor20_gr_lw_ref)
GlassMoor20_gr_mod_ref

#21 detectors
GlassMoor21_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
GlassMoor21_grframe<-data.frame(GlassMoor21_gr, samp2)
GlassMoor21_grframelong <- melt(GlassMoor21_grframe,id.vars="samp2")
GlassMoor21_grframelong_sum <- ddply(GlassMoor21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor21_gr_max <- sum(GlassMoor21_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor21_gr_max
GlassMoor21_gr_pres <- sum(GlassMoor21_grframelong_sum $max > 0)
GlassMoor21_gr_pres

#number of sites which would be classified as low
GlassMoor21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor21_grframelong_sum$max)
GlassMoor21_gr_lw_ref
#number of sites which would be classified as high
GlassMoor21_gr_high_ref <- sum( GlassMoor21_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor21_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor21_gr_mod_ref <- 1000 - (GlassMoor21_gr_high_ref + GlassMoor21_gr_lw_ref)
GlassMoor21_gr_mod_ref

#22 detectors
GlassMoor22_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
GlassMoor22_grframe<-data.frame(GlassMoor22_gr, samp2)
GlassMoor22_grframelong <- melt(GlassMoor22_grframe,id.vars="samp2")
GlassMoor22_grframelong_sum <- ddply(GlassMoor22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor22_gr_max <- sum(GlassMoor22_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor22_gr_max
GlassMoor22_gr_pres <- sum(GlassMoor22_grframelong_sum $max > 0)
GlassMoor22_gr_pres

#number of sites which would be classified as low
GlassMoor22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor22_grframelong_sum$max)
GlassMoor22_gr_lw_ref
#number of sites which would be classified as high
GlassMoor22_gr_high_ref <- sum( GlassMoor22_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor22_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor22_gr_mod_ref <- 1000 - (GlassMoor22_gr_high_ref + GlassMoor22_gr_lw_ref)
GlassMoor22_gr_mod_ref

#23 detectors
GlassMoor23_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
GlassMoor23_grframe<-data.frame(GlassMoor23_gr, samp2)
GlassMoor23_grframelong <- melt(GlassMoor23_grframe,id.vars="samp2")
GlassMoor23_grframelong_sum <- ddply(GlassMoor23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor23_gr_max <- sum(GlassMoor23_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor23_gr_max
GlassMoor23_gr_pres <- sum(GlassMoor23_grframelong_sum $max > 0)
GlassMoor23_gr_pres

#number of sites which would be classified as low
GlassMoor23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor23_grframelong_sum$max)
GlassMoor23_gr_lw_ref
#number of sites which would be classified as high
GlassMoor23_gr_high_ref <- sum( GlassMoor23_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor23_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor23_gr_mod_ref <- 1000 - (GlassMoor23_gr_high_ref + GlassMoor23_gr_lw_ref)
GlassMoor23_gr_mod_ref

#24 detectors
GlassMoor24_gr<-(replicate(1000, (sample(GlassMoorpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
GlassMoor24_grframe<-data.frame(GlassMoor24_gr, samp2)
GlassMoor24_grframelong <- melt(GlassMoor24_grframe,id.vars="samp2")
GlassMoor24_grframelong_sum <- ddply(GlassMoor24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
GlassMoor24_gr_max <- sum(GlassMoor24_grframelong_sum $max > max20_GlassMoorpipgr)
GlassMoor24_gr_max
GlassMoor24_gr_pres <- sum(GlassMoor24_grframelong_sum $max > 0)
GlassMoor24_gr_pres

#number of sites which would be classified as low
GlassMoor24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= GlassMoor24_grframelong_sum$max)
GlassMoor24_gr_lw_ref
#number of sites which would be classified as high
GlassMoor24_gr_high_ref <- sum( GlassMoor24_grframelong_sum$max > allsppgr_ppip_ref_high)
GlassMoor24_gr_high_ref
#number of sites which would be classified as moderate
GlassMoor24_gr_mod_ref <- 1000 - (GlassMoor24_gr_high_ref + GlassMoor24_gr_lw_ref)
GlassMoor24_gr_mod_ref

Present<-c(GlassMoor1_gr_pres,GlassMoor2_gr_pres,
           GlassMoor3_gr_pres,GlassMoor4_gr_pres,
           GlassMoor5_gr_pres,GlassMoor6_gr_pres,
           GlassMoor7_gr_pres,GlassMoor8_gr_pres,
           GlassMoor9_gr_pres,GlassMoor10_gr_pres,
           GlassMoor11_gr_pres,GlassMoor12_gr_pres,
           GlassMoor13_gr_pres,GlassMoor14_gr_pres,
           GlassMoor15_gr_pres,GlassMoor16_gr_pres,
           GlassMoor17_gr_pres,GlassMoor18_gr_pres,
           GlassMoor19_gr_pres,GlassMoor20_gr_pres,
           GlassMoor21_gr_pres,GlassMoor22_gr_pres,
           GlassMoor23_gr_pres,GlassMoor24_gr_pres)


Maximum<-c(GlassMoor1_gr_max,GlassMoor2_gr_max,
           GlassMoor3_gr_max,GlassMoor4_gr_max,
           GlassMoor5_gr_max,GlassMoor6_gr_max,
           GlassMoor7_gr_max,GlassMoor8_gr_max,
           GlassMoor9_gr_max,GlassMoor10_gr_max,
           GlassMoor11_gr_max,GlassMoor12_gr_max,
           GlassMoor13_gr_max,GlassMoor14_gr_max,
           GlassMoor15_gr_max,GlassMoor16_gr_max,
           GlassMoor17_gr_max,GlassMoor18_gr_max,
           GlassMoor19_gr_max,GlassMoor20_gr_max,
           GlassMoor21_gr_max,GlassMoor22_gr_max,
           GlassMoor23_gr_max,GlassMoor24_gr_max)

Low<-c(GlassMoor1_gr_lw_ref, GlassMoor2_gr_lw_ref, GlassMoor3_gr_lw_ref,
       GlassMoor4_gr_lw_ref, GlassMoor5_gr_lw_ref, GlassMoor6_gr_lw_ref,
       GlassMoor7_gr_lw_ref, GlassMoor8_gr_lw_ref, GlassMoor9_gr_lw_ref,
       GlassMoor10_gr_lw_ref, GlassMoor11_gr_lw_ref, GlassMoor12_gr_lw_ref, 
       GlassMoor13_gr_lw_ref, GlassMoor14_gr_lw_ref, GlassMoor15_gr_lw_ref, 
       GlassMoor16_gr_lw_ref, GlassMoor17_gr_lw_ref, GlassMoor18_gr_lw_ref, 
       GlassMoor19_gr_lw_ref, GlassMoor20_gr_lw_ref, GlassMoor21_gr_lw_ref,
       GlassMoor22_gr_lw_ref,GlassMoor23_gr_lw_ref,GlassMoor24_gr_lw_ref)

Moderate<-c(GlassMoor1_gr_mod_ref, GlassMoor2_gr_mod_ref, GlassMoor3_gr_mod_ref,
            GlassMoor4_gr_mod_ref, GlassMoor5_gr_mod_ref, GlassMoor6_gr_mod_ref,
            GlassMoor7_gr_mod_ref, GlassMoor8_gr_mod_ref, GlassMoor9_gr_mod_ref,
            GlassMoor10_gr_mod_ref, GlassMoor11_gr_mod_ref, GlassMoor12_gr_mod_ref, 
            GlassMoor13_gr_mod_ref, GlassMoor14_gr_mod_ref, GlassMoor15_gr_mod_ref, 
            GlassMoor16_gr_mod_ref, GlassMoor17_gr_mod_ref, GlassMoor18_gr_mod_ref, 
            GlassMoor19_gr_mod_ref, GlassMoor20_gr_mod_ref, GlassMoor21_gr_mod_ref,
            GlassMoor22_gr_mod_ref,GlassMoor23_gr_mod_ref,GlassMoor24_gr_mod_ref)

High<-c(GlassMoor1_gr_high_ref, GlassMoor2_gr_high_ref, GlassMoor3_gr_high_ref,
        GlassMoor4_gr_high_ref, GlassMoor5_gr_high_ref, GlassMoor6_gr_high_ref,
        GlassMoor7_gr_high_ref, GlassMoor8_gr_high_ref, GlassMoor9_gr_high_ref,
        GlassMoor10_gr_high_ref, GlassMoor11_gr_high_ref, GlassMoor12_gr_high_ref, 
        GlassMoor13_gr_high_ref, GlassMoor14_gr_high_ref, GlassMoor15_gr_high_ref, 
        GlassMoor16_gr_high_ref, GlassMoor17_gr_high_ref, GlassMoor18_gr_high_ref, 
        GlassMoor19_gr_high_ref, GlassMoor20_gr_high_ref, GlassMoor21_gr_high_ref,
        GlassMoor22_gr_high_ref,GlassMoor23_gr_high_ref,GlassMoor24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("GlassMoorgr",24)
Lowsite <- GlassMoorlow
Modsite <- GlassMoormod
Highsite <-GlassMoorhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



GlassMoorgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##Goonhilly

Goonhillypipgr<-subset(allspp4gr_ppip, Site=="Goonhilly")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Goonhillypipgr<-max(Goonhillypipgr$Passes)

#calculate 20% from maximum nightly record

max20_Goonhillypipgr<- (max_Goonhillypipgr/100)*80

##calculate the site classification (reference range)

Goonhillyhigh<- max_Goonhillypipgr > allsppgr_ppip_ref_high

Goonhillylow<- allsppgr_ppip_ref_low > max_Goonhillypipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Goonhillypipgr
Goonhillymod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Goonhilly1_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 1, replace=F))))
Goonhilly1_gr_max <- sum(Goonhilly1_gr > max20_Goonhillypipgr)
Goonhilly1_gr_max
Goonhilly1_gr_pres <- sum(Goonhilly1_gr > 0)
Goonhilly1_gr_pres
#number of sites which would be classified as low
Goonhilly1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly1_gr)
Goonhilly1_gr_lw_ref
#number of sites which would be classified as high
Goonhilly1_gr_high_ref <- sum( Goonhilly1_gr > allsppgr_ppip_ref_high)
Goonhilly1_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly1_gr_mod_ref <- 1000 - (Goonhilly1_gr_high_ref + Goonhilly1_gr_lw_ref)
Goonhilly1_gr_mod_ref


#2 nights
Goonhilly2_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Goonhilly2_grframe<-data.frame(Goonhilly2_gr, samp2)
Goonhilly2_grframelong <- melt(Goonhilly2_grframe,id.vars="samp2")
Goonhilly2_grframelong_sum <- ddply(Goonhilly2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly2_gr_max <- sum(Goonhilly2_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly2_gr_max
Goonhilly2_gr_pres <- sum(Goonhilly2_grframelong_sum $max > 0)
Goonhilly2_gr_pres

#number of sites which would be classified as low
Goonhilly2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly2_grframelong_sum$max)
Goonhilly2_gr_lw_ref
#number of sites which would be classified as high
Goonhilly2_gr_high_ref <- sum( Goonhilly2_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly2_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly2_gr_mod_ref <- 1000 - (Goonhilly2_gr_high_ref + Goonhilly2_gr_lw_ref)
Goonhilly2_gr_mod_ref


#3 nights
Goonhilly3_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Goonhilly3_grframe<-data.frame(Goonhilly3_gr, samp2)
Goonhilly3_grframelong <- melt(Goonhilly3_grframe,id.vars="samp2")
Goonhilly3_grframelong_sum <- ddply(Goonhilly3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly3_gr_max <- sum(Goonhilly3_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly3_gr_max
Goonhilly3_gr_pres <- sum(Goonhilly3_grframelong_sum $max > 0)
Goonhilly3_gr_pres

#number of sites which would be classified as low
Goonhilly3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly3_grframelong_sum$max)
Goonhilly3_gr_lw_ref
#number of sites which would be classified as high
Goonhilly3_gr_high_ref <- sum( Goonhilly3_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly3_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly3_gr_mod_ref <- 1000 - (Goonhilly3_gr_high_ref + Goonhilly3_gr_lw_ref)
Goonhilly3_gr_mod_ref

#4 nights
Goonhilly4_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Goonhilly4_grframe<-data.frame(Goonhilly4_gr, samp2)
Goonhilly4_grframelong <- melt(Goonhilly4_grframe,id.vars="samp2")
Goonhilly4_grframelong_sum <- ddply(Goonhilly4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly4_gr_max <- sum(Goonhilly4_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly4_gr_max
Goonhilly4_gr_pres <- sum(Goonhilly4_grframelong_sum $max > 0)
Goonhilly4_gr_pres

#number of sites which would be classified as low
Goonhilly4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly4_grframelong_sum$max)
Goonhilly4_gr_lw_ref
#number of sites which would be classified as high
Goonhilly4_gr_high_ref <- sum( Goonhilly4_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly4_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly4_gr_mod_ref <- 1000 - (Goonhilly4_gr_high_ref + Goonhilly4_gr_lw_ref)
Goonhilly4_gr_mod_ref

#5 nights
Goonhilly5_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Goonhilly5_grframe<-data.frame(Goonhilly5_gr, samp2)
Goonhilly5_grframelong <- melt(Goonhilly5_grframe,id.vars="samp2")
Goonhilly5_grframelong_sum <- ddply(Goonhilly5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly5_gr_max <- sum(Goonhilly5_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly5_gr_max
Goonhilly5_gr_pres <- sum(Goonhilly5_grframelong_sum $max > 0)
Goonhilly5_gr_pres

#number of sites which would be classified as low
Goonhilly5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly5_grframelong_sum$max)
Goonhilly5_gr_lw_ref
#number of sites which would be classified as high
Goonhilly5_gr_high_ref <- sum( Goonhilly5_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly5_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly5_gr_mod_ref <- 1000 - (Goonhilly5_gr_high_ref + Goonhilly5_gr_lw_ref)
Goonhilly5_gr_mod_ref

#6 nights
Goonhilly6_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Goonhilly6_grframe<-data.frame(Goonhilly6_gr, samp2)
Goonhilly6_grframelong <- melt(Goonhilly6_grframe,id.vars="samp2")
Goonhilly6_grframelong_sum <- ddply(Goonhilly6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly6_gr_max <- sum(Goonhilly6_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly6_gr_max
Goonhilly6_gr_pres <- sum(Goonhilly6_grframelong_sum $max > 0)
Goonhilly6_gr_pres

#number of sites which would be classified as low
Goonhilly6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly6_grframelong_sum$max)
Goonhilly6_gr_lw_ref
#number of sites which would be classified as high
Goonhilly6_gr_high_ref <- sum( Goonhilly6_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly6_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly6_gr_mod_ref <- 1000 - (Goonhilly6_gr_high_ref + Goonhilly6_gr_lw_ref)
Goonhilly6_gr_mod_ref

#7 nights
Goonhilly7_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Goonhilly7_grframe<-data.frame(Goonhilly7_gr, samp2)
Goonhilly7_grframelong <- melt(Goonhilly7_grframe,id.vars="samp2")
Goonhilly7_grframelong_sum <- ddply(Goonhilly7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly7_gr_max <- sum(Goonhilly7_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly7_gr_max
Goonhilly7_gr_pres <- sum(Goonhilly7_grframelong_sum $max > 0)
Goonhilly7_gr_pres

#number of sites which would be classified as low
Goonhilly7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly7_grframelong_sum$max)
Goonhilly7_gr_lw_ref
#number of sites which would be classified as high
Goonhilly7_gr_high_ref <- sum( Goonhilly7_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly7_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly7_gr_mod_ref <- 1000 - (Goonhilly7_gr_high_ref + Goonhilly7_gr_lw_ref)
Goonhilly7_gr_mod_ref

#8 nights
Goonhilly8_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Goonhilly8_grframe<-data.frame(Goonhilly8_gr, samp2)
Goonhilly8_grframelong <- melt(Goonhilly8_grframe,id.vars="samp2")
Goonhilly8_grframelong_sum <- ddply(Goonhilly8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly8_gr_max <- sum(Goonhilly8_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly8_gr_max
Goonhilly8_gr_pres <- sum(Goonhilly8_grframelong_sum $max > 0)
Goonhilly8_gr_pres

#number of sites which would be classified as low
Goonhilly8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly8_grframelong_sum$max)
Goonhilly8_gr_lw_ref
#number of sites which would be classified as high
Goonhilly8_gr_high_ref <- sum( Goonhilly8_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly8_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly8_gr_mod_ref <- 1000 - (Goonhilly8_gr_high_ref + Goonhilly8_gr_lw_ref)
Goonhilly8_gr_mod_ref

#9 nights
Goonhilly9_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Goonhilly9_grframe<-data.frame(Goonhilly9_gr, samp2)
Goonhilly9_grframelong <- melt(Goonhilly9_grframe,id.vars="samp2")
Goonhilly9_grframelong_sum <- ddply(Goonhilly9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Goonhilly9_gr_max <- sum(Goonhilly9_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly9_gr_max
Goonhilly9_gr_pres <- sum(Goonhilly9_grframelong_sum $max > 0)
Goonhilly9_gr_pres

#number of sites which would be classified as low
Goonhilly9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly9_grframelong_sum$max)
Goonhilly9_gr_lw_ref
#number of sites which would be classified as high
Goonhilly9_gr_high_ref <- sum( Goonhilly9_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly9_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly9_gr_mod_ref <- 1000 - (Goonhilly9_gr_high_ref + Goonhilly9_gr_lw_ref)
Goonhilly9_gr_mod_ref

#10 detectors
Goonhilly10_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Goonhilly10_grframe<-data.frame(Goonhilly10_gr, samp2)
Goonhilly10_grframelong <- melt(Goonhilly10_grframe,id.vars="samp2")
Goonhilly10_grframelong_sum <- ddply(Goonhilly10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly10_gr_max <- sum(Goonhilly10_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly10_gr_max
Goonhilly10_gr_pres <- sum(Goonhilly10_grframelong_sum $max > 0)
Goonhilly10_gr_pres

#number of sites which would be classified as low
Goonhilly10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly10_grframelong_sum$max)
Goonhilly10_gr_lw_ref
#number of sites which would be classified as high
Goonhilly10_gr_high_ref <- sum( Goonhilly10_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly10_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly10_gr_mod_ref <- 1000 - (Goonhilly10_gr_high_ref + Goonhilly10_gr_lw_ref)
Goonhilly10_gr_mod_ref

#11 detectors
Goonhilly11_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Goonhilly11_grframe<-data.frame(Goonhilly11_gr, samp2)
Goonhilly11_grframelong <- melt(Goonhilly11_grframe,id.vars="samp2")
Goonhilly11_grframelong_sum <- ddply(Goonhilly11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly11_gr_max <- sum(Goonhilly11_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly11_gr_max
Goonhilly11_gr_pres <- sum(Goonhilly11_grframelong_sum $max > 0)
Goonhilly11_gr_pres

#number of sites which would be classified as low
Goonhilly11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly11_grframelong_sum$max)
Goonhilly11_gr_lw_ref
#number of sites which would be classified as high
Goonhilly11_gr_high_ref <- sum( Goonhilly11_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly11_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly11_gr_mod_ref <- 1000 - (Goonhilly11_gr_high_ref + Goonhilly11_gr_lw_ref)
Goonhilly11_gr_mod_ref

#12 detectors
Goonhilly12_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Goonhilly12_grframe<-data.frame(Goonhilly12_gr, samp2)
Goonhilly12_grframelong <- melt(Goonhilly12_grframe,id.vars="samp2")
Goonhilly12_grframelong_sum <- ddply(Goonhilly12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly12_gr_max <- sum(Goonhilly12_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly12_gr_max
Goonhilly12_gr_pres <- sum(Goonhilly12_grframelong_sum $max > 0)
Goonhilly12_gr_pres

#number of sites which would be classified as low
Goonhilly12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly12_grframelong_sum$max)
Goonhilly12_gr_lw_ref
#number of sites which would be classified as high
Goonhilly12_gr_high_ref <- sum( Goonhilly12_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly12_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly12_gr_mod_ref <- 1000 - (Goonhilly12_gr_high_ref + Goonhilly12_gr_lw_ref)
Goonhilly12_gr_mod_ref

#13 detectors
Goonhilly13_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Goonhilly13_grframe<-data.frame(Goonhilly13_gr, samp2)
Goonhilly13_grframelong <- melt(Goonhilly13_grframe,id.vars="samp2")
Goonhilly13_grframelong_sum <- ddply(Goonhilly13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly13_gr_max <- sum(Goonhilly13_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly13_gr_max
Goonhilly13_gr_pres <- sum(Goonhilly13_grframelong_sum $max > 0)
Goonhilly13_gr_pres

#number of sites which would be classified as low
Goonhilly13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly13_grframelong_sum$max)
Goonhilly13_gr_lw_ref
#number of sites which would be classified as high
Goonhilly13_gr_high_ref <- sum( Goonhilly13_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly13_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly13_gr_mod_ref <- 1000 - (Goonhilly13_gr_high_ref + Goonhilly13_gr_lw_ref)
Goonhilly13_gr_mod_ref

#14 detectors
Goonhilly14_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Goonhilly14_grframe<-data.frame(Goonhilly14_gr, samp2)
Goonhilly14_grframelong <- melt(Goonhilly14_grframe,id.vars="samp2")
Goonhilly14_grframelong_sum <- ddply(Goonhilly14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly14_gr_max <- sum(Goonhilly14_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly14_gr_max
Goonhilly14_gr_pres <- sum(Goonhilly14_grframelong_sum $max > 0)
Goonhilly14_gr_pres

#number of sites which would be classified as low
Goonhilly14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly14_grframelong_sum$max)
Goonhilly14_gr_lw_ref
#number of sites which would be classified as high
Goonhilly14_gr_high_ref <- sum( Goonhilly14_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly14_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly14_gr_mod_ref <- 1000 - (Goonhilly14_gr_high_ref + Goonhilly14_gr_lw_ref)
Goonhilly14_gr_mod_ref

#15 detectors
Goonhilly15_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Goonhilly15_grframe<-data.frame(Goonhilly15_gr, samp2)
Goonhilly15_grframelong <- melt(Goonhilly15_grframe,id.vars="samp2")
Goonhilly15_grframelong_sum <- ddply(Goonhilly15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly15_gr_max <- sum(Goonhilly15_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly15_gr_max
Goonhilly15_gr_pres <- sum(Goonhilly15_grframelong_sum $max > 0)
Goonhilly15_gr_pres

#number of sites which would be classified as low
Goonhilly15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly15_grframelong_sum$max)
Goonhilly15_gr_lw_ref
#number of sites which would be classified as high
Goonhilly15_gr_high_ref <- sum( Goonhilly15_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly15_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly15_gr_mod_ref <- 1000 - (Goonhilly15_gr_high_ref + Goonhilly15_gr_lw_ref)
Goonhilly15_gr_mod_ref

#16 detectors
Goonhilly16_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Goonhilly16_grframe<-data.frame(Goonhilly16_gr, samp2)
Goonhilly16_grframelong <- melt(Goonhilly16_grframe,id.vars="samp2")
Goonhilly16_grframelong_sum <- ddply(Goonhilly16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly16_gr_max <- sum(Goonhilly16_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly16_gr_max
Goonhilly16_gr_pres <- sum(Goonhilly16_grframelong_sum $max > 0)
Goonhilly16_gr_pres

#number of sites which would be classified as low
Goonhilly16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly16_grframelong_sum$max)
Goonhilly16_gr_lw_ref
#number of sites which would be classified as high
Goonhilly16_gr_high_ref <- sum( Goonhilly16_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly16_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly16_gr_mod_ref <- 1000 - (Goonhilly16_gr_high_ref + Goonhilly16_gr_lw_ref)
Goonhilly16_gr_mod_ref

#17 detectors
Goonhilly17_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Goonhilly17_grframe<-data.frame(Goonhilly17_gr, samp2)
Goonhilly17_grframelong <- melt(Goonhilly17_grframe,id.vars="samp2")
Goonhilly17_grframelong_sum <- ddply(Goonhilly17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly17_gr_max <- sum(Goonhilly17_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly17_gr_max
Goonhilly17_gr_pres <- sum(Goonhilly17_grframelong_sum $max > 0)
Goonhilly17_gr_pres

#number of sites which would be classified as low
Goonhilly17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly17_grframelong_sum$max)
Goonhilly17_gr_lw_ref
#number of sites which would be classified as high
Goonhilly17_gr_high_ref <- sum( Goonhilly17_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly17_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly17_gr_mod_ref <- 1000 - (Goonhilly17_gr_high_ref + Goonhilly17_gr_lw_ref)
Goonhilly17_gr_mod_ref

#18 detectors
Goonhilly18_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Goonhilly18_grframe<-data.frame(Goonhilly18_gr, samp2)
Goonhilly18_grframelong <- melt(Goonhilly18_grframe,id.vars="samp2")
Goonhilly18_grframelong_sum <- ddply(Goonhilly18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly18_gr_max <- sum(Goonhilly18_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly18_gr_max
Goonhilly18_gr_pres <- sum(Goonhilly18_grframelong_sum $max > 0)
Goonhilly18_gr_pres

#number of sites which would be classified as low
Goonhilly18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly18_grframelong_sum$max)
Goonhilly18_gr_lw_ref
#number of sites which would be classified as high
Goonhilly18_gr_high_ref <- sum( Goonhilly18_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly18_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly18_gr_mod_ref <- 1000 - (Goonhilly18_gr_high_ref + Goonhilly18_gr_lw_ref)
Goonhilly18_gr_mod_ref

#19 detectors
Goonhilly19_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Goonhilly19_grframe<-data.frame(Goonhilly19_gr, samp2)
Goonhilly19_grframelong <- melt(Goonhilly19_grframe,id.vars="samp2")
Goonhilly19_grframelong_sum <- ddply(Goonhilly19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly19_gr_max <- sum(Goonhilly19_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly19_gr_max
Goonhilly19_gr_pres <- sum(Goonhilly19_grframelong_sum $max > 0)
Goonhilly19_gr_pres

#number of sites which would be classified as low
Goonhilly19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly19_grframelong_sum$max)
Goonhilly19_gr_lw_ref
#number of sites which would be classified as high
Goonhilly19_gr_high_ref <- sum( Goonhilly19_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly19_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly19_gr_mod_ref <- 1000 - (Goonhilly19_gr_high_ref + Goonhilly19_gr_lw_ref)
Goonhilly19_gr_mod_ref

#20 detectors
Goonhilly20_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Goonhilly20_grframe<-data.frame(Goonhilly20_gr, samp2)
Goonhilly20_grframelong <- melt(Goonhilly20_grframe,id.vars="samp2")
Goonhilly20_grframelong_sum <- ddply(Goonhilly20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly20_gr_max <- sum(Goonhilly20_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly20_gr_max
Goonhilly20_gr_pres <- sum(Goonhilly20_grframelong_sum $max > 0)
Goonhilly20_gr_pres

#number of sites which would be classified as low
Goonhilly20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly20_grframelong_sum$max)
Goonhilly20_gr_lw_ref
#number of sites which would be classified as high
Goonhilly20_gr_high_ref <- sum( Goonhilly20_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly20_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly20_gr_mod_ref <- 1000 - (Goonhilly20_gr_high_ref + Goonhilly20_gr_lw_ref)
Goonhilly20_gr_mod_ref

#21 detectors
Goonhilly21_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Goonhilly21_grframe<-data.frame(Goonhilly21_gr, samp2)
Goonhilly21_grframelong <- melt(Goonhilly21_grframe,id.vars="samp2")
Goonhilly21_grframelong_sum <- ddply(Goonhilly21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly21_gr_max <- sum(Goonhilly21_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly21_gr_max
Goonhilly21_gr_pres <- sum(Goonhilly21_grframelong_sum $max > 0)
Goonhilly21_gr_pres

#number of sites which would be classified as low
Goonhilly21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly21_grframelong_sum$max)
Goonhilly21_gr_lw_ref
#number of sites which would be classified as high
Goonhilly21_gr_high_ref <- sum( Goonhilly21_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly21_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly21_gr_mod_ref <- 1000 - (Goonhilly21_gr_high_ref + Goonhilly21_gr_lw_ref)
Goonhilly21_gr_mod_ref

#22 detectors
Goonhilly22_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Goonhilly22_grframe<-data.frame(Goonhilly22_gr, samp2)
Goonhilly22_grframelong <- melt(Goonhilly22_grframe,id.vars="samp2")
Goonhilly22_grframelong_sum <- ddply(Goonhilly22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly22_gr_max <- sum(Goonhilly22_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly22_gr_max
Goonhilly22_gr_pres <- sum(Goonhilly22_grframelong_sum $max > 0)
Goonhilly22_gr_pres

#number of sites which would be classified as low
Goonhilly22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly22_grframelong_sum$max)
Goonhilly22_gr_lw_ref
#number of sites which would be classified as high
Goonhilly22_gr_high_ref <- sum( Goonhilly22_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly22_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly22_gr_mod_ref <- 1000 - (Goonhilly22_gr_high_ref + Goonhilly22_gr_lw_ref)
Goonhilly22_gr_mod_ref

#23 detectors
Goonhilly23_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Goonhilly23_grframe<-data.frame(Goonhilly23_gr, samp2)
Goonhilly23_grframelong <- melt(Goonhilly23_grframe,id.vars="samp2")
Goonhilly23_grframelong_sum <- ddply(Goonhilly23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly23_gr_max <- sum(Goonhilly23_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly23_gr_max
Goonhilly23_gr_pres <- sum(Goonhilly23_grframelong_sum $max > 0)
Goonhilly23_gr_pres

#number of sites which would be classified as low
Goonhilly23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly23_grframelong_sum$max)
Goonhilly23_gr_lw_ref
#number of sites which would be classified as high
Goonhilly23_gr_high_ref <- sum( Goonhilly23_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly23_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly23_gr_mod_ref <- 1000 - (Goonhilly23_gr_high_ref + Goonhilly23_gr_lw_ref)
Goonhilly23_gr_mod_ref

#24 detectors
Goonhilly24_gr<-(replicate(1000, (sample(Goonhillypipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Goonhilly24_grframe<-data.frame(Goonhilly24_gr, samp2)
Goonhilly24_grframelong <- melt(Goonhilly24_grframe,id.vars="samp2")
Goonhilly24_grframelong_sum <- ddply(Goonhilly24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Goonhilly24_gr_max <- sum(Goonhilly24_grframelong_sum $max > max20_Goonhillypipgr)
Goonhilly24_gr_max
Goonhilly24_gr_pres <- sum(Goonhilly24_grframelong_sum $max > 0)
Goonhilly24_gr_pres

#number of sites which would be classified as low
Goonhilly24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Goonhilly24_grframelong_sum$max)
Goonhilly24_gr_lw_ref
#number of sites which would be classified as high
Goonhilly24_gr_high_ref <- sum( Goonhilly24_grframelong_sum$max > allsppgr_ppip_ref_high)
Goonhilly24_gr_high_ref
#number of sites which would be classified as moderate
Goonhilly24_gr_mod_ref <- 1000 - (Goonhilly24_gr_high_ref + Goonhilly24_gr_lw_ref)
Goonhilly24_gr_mod_ref

Present<-c(Goonhilly1_gr_pres,Goonhilly2_gr_pres,
           Goonhilly3_gr_pres,Goonhilly4_gr_pres,
           Goonhilly5_gr_pres,Goonhilly6_gr_pres,
           Goonhilly7_gr_pres,Goonhilly8_gr_pres,
           Goonhilly9_gr_pres,Goonhilly10_gr_pres,
           Goonhilly11_gr_pres,Goonhilly12_gr_pres,
           Goonhilly13_gr_pres,Goonhilly14_gr_pres,
           Goonhilly15_gr_pres,Goonhilly16_gr_pres,
           Goonhilly17_gr_pres,Goonhilly18_gr_pres,
           Goonhilly19_gr_pres,Goonhilly20_gr_pres,
           Goonhilly21_gr_pres,Goonhilly22_gr_pres,
           Goonhilly23_gr_pres,Goonhilly24_gr_pres)


Maximum<-c(Goonhilly1_gr_max,Goonhilly2_gr_max,
           Goonhilly3_gr_max,Goonhilly4_gr_max,
           Goonhilly5_gr_max,Goonhilly6_gr_max,
           Goonhilly7_gr_max,Goonhilly8_gr_max,
           Goonhilly9_gr_max,Goonhilly10_gr_max,
           Goonhilly11_gr_max,Goonhilly12_gr_max,
           Goonhilly13_gr_max,Goonhilly14_gr_max,
           Goonhilly15_gr_max,Goonhilly16_gr_max,
           Goonhilly17_gr_max,Goonhilly18_gr_max,
           Goonhilly19_gr_max,Goonhilly20_gr_max,
           Goonhilly21_gr_max,Goonhilly22_gr_max,
           Goonhilly23_gr_max,Goonhilly24_gr_max)

Low<-c(Goonhilly1_gr_lw_ref, Goonhilly2_gr_lw_ref, Goonhilly3_gr_lw_ref,
       Goonhilly4_gr_lw_ref, Goonhilly5_gr_lw_ref, Goonhilly6_gr_lw_ref,
       Goonhilly7_gr_lw_ref, Goonhilly8_gr_lw_ref, Goonhilly9_gr_lw_ref,
       Goonhilly10_gr_lw_ref, Goonhilly11_gr_lw_ref, Goonhilly12_gr_lw_ref, 
       Goonhilly13_gr_lw_ref, Goonhilly14_gr_lw_ref, Goonhilly15_gr_lw_ref, 
       Goonhilly16_gr_lw_ref, Goonhilly17_gr_lw_ref, Goonhilly18_gr_lw_ref, 
       Goonhilly19_gr_lw_ref, Goonhilly20_gr_lw_ref, Goonhilly21_gr_lw_ref,
       Goonhilly22_gr_lw_ref,Goonhilly23_gr_lw_ref,Goonhilly24_gr_lw_ref)

Moderate<-c(Goonhilly1_gr_mod_ref, Goonhilly2_gr_mod_ref, Goonhilly3_gr_mod_ref,
            Goonhilly4_gr_mod_ref, Goonhilly5_gr_mod_ref, Goonhilly6_gr_mod_ref,
            Goonhilly7_gr_mod_ref, Goonhilly8_gr_mod_ref, Goonhilly9_gr_mod_ref,
            Goonhilly10_gr_mod_ref, Goonhilly11_gr_mod_ref, Goonhilly12_gr_mod_ref, 
            Goonhilly13_gr_mod_ref, Goonhilly14_gr_mod_ref, Goonhilly15_gr_mod_ref, 
            Goonhilly16_gr_mod_ref, Goonhilly17_gr_mod_ref, Goonhilly18_gr_mod_ref, 
            Goonhilly19_gr_mod_ref, Goonhilly20_gr_mod_ref, Goonhilly21_gr_mod_ref,
            Goonhilly22_gr_mod_ref,Goonhilly23_gr_mod_ref,Goonhilly24_gr_mod_ref)

High<-c(Goonhilly1_gr_high_ref, Goonhilly2_gr_high_ref, Goonhilly3_gr_high_ref,
        Goonhilly4_gr_high_ref, Goonhilly5_gr_high_ref, Goonhilly6_gr_high_ref,
        Goonhilly7_gr_high_ref, Goonhilly8_gr_high_ref, Goonhilly9_gr_high_ref,
        Goonhilly10_gr_high_ref, Goonhilly11_gr_high_ref, Goonhilly12_gr_high_ref, 
        Goonhilly13_gr_high_ref, Goonhilly14_gr_high_ref, Goonhilly15_gr_high_ref, 
        Goonhilly16_gr_high_ref, Goonhilly17_gr_high_ref, Goonhilly18_gr_high_ref, 
        Goonhilly19_gr_high_ref, Goonhilly20_gr_high_ref, Goonhilly21_gr_high_ref,
        Goonhilly22_gr_high_ref,Goonhilly23_gr_high_ref,Goonhilly24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Goonhillygr",24)
Lowsite <- Goonhillylow
Modsite <- Goonhillymod
Highsite <-Goonhillyhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Goonhillygr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##HillofTowie

HillofTowiepipgr<-subset(allspp4gr_ppip, Site=="HillofTowie")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_HillofTowiepipgr<-max(HillofTowiepipgr$Passes)

#calculate 20% from maximum nightly record

max20_HillofTowiepipgr<- (max_HillofTowiepipgr/100)*80

##calculate the site classification (reference range)

HillofTowiehigh<- max_HillofTowiepipgr > allsppgr_ppip_ref_high

HillofTowielow<- allsppgr_ppip_ref_low > max_HillofTowiepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_HillofTowiepipgr
HillofTowiemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
HillofTowie1_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 1, replace=F))))
HillofTowie1_gr_max <- sum(HillofTowie1_gr > max20_HillofTowiepipgr)
HillofTowie1_gr_max
HillofTowie1_gr_pres <- sum(HillofTowie1_gr > 0)
HillofTowie1_gr_pres
#number of sites which would be classified as low
HillofTowie1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie1_gr)
HillofTowie1_gr_lw_ref
#number of sites which would be classified as high
HillofTowie1_gr_high_ref <- sum( HillofTowie1_gr > allsppgr_ppip_ref_high)
HillofTowie1_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie1_gr_mod_ref <- 1000 - (HillofTowie1_gr_high_ref + HillofTowie1_gr_lw_ref)
HillofTowie1_gr_mod_ref


#2 nights
HillofTowie2_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
HillofTowie2_grframe<-data.frame(HillofTowie2_gr, samp2)
HillofTowie2_grframelong <- melt(HillofTowie2_grframe,id.vars="samp2")
HillofTowie2_grframelong_sum <- ddply(HillofTowie2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie2_gr_max <- sum(HillofTowie2_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie2_gr_max
HillofTowie2_gr_pres <- sum(HillofTowie2_grframelong_sum $max > 0)
HillofTowie2_gr_pres

#number of sites which would be classified as low
HillofTowie2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie2_grframelong_sum$max)
HillofTowie2_gr_lw_ref
#number of sites which would be classified as high
HillofTowie2_gr_high_ref <- sum( HillofTowie2_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie2_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie2_gr_mod_ref <- 1000 - (HillofTowie2_gr_high_ref + HillofTowie2_gr_lw_ref)
HillofTowie2_gr_mod_ref


#3 nights
HillofTowie3_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
HillofTowie3_grframe<-data.frame(HillofTowie3_gr, samp2)
HillofTowie3_grframelong <- melt(HillofTowie3_grframe,id.vars="samp2")
HillofTowie3_grframelong_sum <- ddply(HillofTowie3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie3_gr_max <- sum(HillofTowie3_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie3_gr_max
HillofTowie3_gr_pres <- sum(HillofTowie3_grframelong_sum $max > 0)
HillofTowie3_gr_pres

#number of sites which would be classified as low
HillofTowie3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie3_grframelong_sum$max)
HillofTowie3_gr_lw_ref
#number of sites which would be classified as high
HillofTowie3_gr_high_ref <- sum( HillofTowie3_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie3_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie3_gr_mod_ref <- 1000 - (HillofTowie3_gr_high_ref + HillofTowie3_gr_lw_ref)
HillofTowie3_gr_mod_ref

#4 nights
HillofTowie4_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
HillofTowie4_grframe<-data.frame(HillofTowie4_gr, samp2)
HillofTowie4_grframelong <- melt(HillofTowie4_grframe,id.vars="samp2")
HillofTowie4_grframelong_sum <- ddply(HillofTowie4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie4_gr_max <- sum(HillofTowie4_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie4_gr_max
HillofTowie4_gr_pres <- sum(HillofTowie4_grframelong_sum $max > 0)
HillofTowie4_gr_pres

#number of sites which would be classified as low
HillofTowie4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie4_grframelong_sum$max)
HillofTowie4_gr_lw_ref
#number of sites which would be classified as high
HillofTowie4_gr_high_ref <- sum( HillofTowie4_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie4_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie4_gr_mod_ref <- 1000 - (HillofTowie4_gr_high_ref + HillofTowie4_gr_lw_ref)
HillofTowie4_gr_mod_ref

#5 nights
HillofTowie5_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
HillofTowie5_grframe<-data.frame(HillofTowie5_gr, samp2)
HillofTowie5_grframelong <- melt(HillofTowie5_grframe,id.vars="samp2")
HillofTowie5_grframelong_sum <- ddply(HillofTowie5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie5_gr_max <- sum(HillofTowie5_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie5_gr_max
HillofTowie5_gr_pres <- sum(HillofTowie5_grframelong_sum $max > 0)
HillofTowie5_gr_pres

#number of sites which would be classified as low
HillofTowie5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie5_grframelong_sum$max)
HillofTowie5_gr_lw_ref
#number of sites which would be classified as high
HillofTowie5_gr_high_ref <- sum( HillofTowie5_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie5_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie5_gr_mod_ref <- 1000 - (HillofTowie5_gr_high_ref + HillofTowie5_gr_lw_ref)
HillofTowie5_gr_mod_ref

#6 nights
HillofTowie6_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
HillofTowie6_grframe<-data.frame(HillofTowie6_gr, samp2)
HillofTowie6_grframelong <- melt(HillofTowie6_grframe,id.vars="samp2")
HillofTowie6_grframelong_sum <- ddply(HillofTowie6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie6_gr_max <- sum(HillofTowie6_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie6_gr_max
HillofTowie6_gr_pres <- sum(HillofTowie6_grframelong_sum $max > 0)
HillofTowie6_gr_pres

#number of sites which would be classified as low
HillofTowie6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie6_grframelong_sum$max)
HillofTowie6_gr_lw_ref
#number of sites which would be classified as high
HillofTowie6_gr_high_ref <- sum( HillofTowie6_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie6_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie6_gr_mod_ref <- 1000 - (HillofTowie6_gr_high_ref + HillofTowie6_gr_lw_ref)
HillofTowie6_gr_mod_ref

#7 nights
HillofTowie7_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
HillofTowie7_grframe<-data.frame(HillofTowie7_gr, samp2)
HillofTowie7_grframelong <- melt(HillofTowie7_grframe,id.vars="samp2")
HillofTowie7_grframelong_sum <- ddply(HillofTowie7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie7_gr_max <- sum(HillofTowie7_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie7_gr_max
HillofTowie7_gr_pres <- sum(HillofTowie7_grframelong_sum $max > 0)
HillofTowie7_gr_pres

#number of sites which would be classified as low
HillofTowie7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie7_grframelong_sum$max)
HillofTowie7_gr_lw_ref
#number of sites which would be classified as high
HillofTowie7_gr_high_ref <- sum( HillofTowie7_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie7_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie7_gr_mod_ref <- 1000 - (HillofTowie7_gr_high_ref + HillofTowie7_gr_lw_ref)
HillofTowie7_gr_mod_ref

#8 nights
HillofTowie8_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
HillofTowie8_grframe<-data.frame(HillofTowie8_gr, samp2)
HillofTowie8_grframelong <- melt(HillofTowie8_grframe,id.vars="samp2")
HillofTowie8_grframelong_sum <- ddply(HillofTowie8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie8_gr_max <- sum(HillofTowie8_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie8_gr_max
HillofTowie8_gr_pres <- sum(HillofTowie8_grframelong_sum $max > 0)
HillofTowie8_gr_pres

#number of sites which would be classified as low
HillofTowie8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie8_grframelong_sum$max)
HillofTowie8_gr_lw_ref
#number of sites which would be classified as high
HillofTowie8_gr_high_ref <- sum( HillofTowie8_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie8_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie8_gr_mod_ref <- 1000 - (HillofTowie8_gr_high_ref + HillofTowie8_gr_lw_ref)
HillofTowie8_gr_mod_ref

#9 nights
HillofTowie9_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
HillofTowie9_grframe<-data.frame(HillofTowie9_gr, samp2)
HillofTowie9_grframelong <- melt(HillofTowie9_grframe,id.vars="samp2")
HillofTowie9_grframelong_sum <- ddply(HillofTowie9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
HillofTowie9_gr_max <- sum(HillofTowie9_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie9_gr_max
HillofTowie9_gr_pres <- sum(HillofTowie9_grframelong_sum $max > 0)
HillofTowie9_gr_pres

#number of sites which would be classified as low
HillofTowie9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie9_grframelong_sum$max)
HillofTowie9_gr_lw_ref
#number of sites which would be classified as high
HillofTowie9_gr_high_ref <- sum( HillofTowie9_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie9_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie9_gr_mod_ref <- 1000 - (HillofTowie9_gr_high_ref + HillofTowie9_gr_lw_ref)
HillofTowie9_gr_mod_ref

#10 detectors
HillofTowie10_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
HillofTowie10_grframe<-data.frame(HillofTowie10_gr, samp2)
HillofTowie10_grframelong <- melt(HillofTowie10_grframe,id.vars="samp2")
HillofTowie10_grframelong_sum <- ddply(HillofTowie10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie10_gr_max <- sum(HillofTowie10_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie10_gr_max
HillofTowie10_gr_pres <- sum(HillofTowie10_grframelong_sum $max > 0)
HillofTowie10_gr_pres

#number of sites which would be classified as low
HillofTowie10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie10_grframelong_sum$max)
HillofTowie10_gr_lw_ref
#number of sites which would be classified as high
HillofTowie10_gr_high_ref <- sum( HillofTowie10_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie10_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie10_gr_mod_ref <- 1000 - (HillofTowie10_gr_high_ref + HillofTowie10_gr_lw_ref)
HillofTowie10_gr_mod_ref

#11 detectors
HillofTowie11_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
HillofTowie11_grframe<-data.frame(HillofTowie11_gr, samp2)
HillofTowie11_grframelong <- melt(HillofTowie11_grframe,id.vars="samp2")
HillofTowie11_grframelong_sum <- ddply(HillofTowie11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie11_gr_max <- sum(HillofTowie11_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie11_gr_max
HillofTowie11_gr_pres <- sum(HillofTowie11_grframelong_sum $max > 0)
HillofTowie11_gr_pres

#number of sites which would be classified as low
HillofTowie11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie11_grframelong_sum$max)
HillofTowie11_gr_lw_ref
#number of sites which would be classified as high
HillofTowie11_gr_high_ref <- sum( HillofTowie11_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie11_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie11_gr_mod_ref <- 1000 - (HillofTowie11_gr_high_ref + HillofTowie11_gr_lw_ref)
HillofTowie11_gr_mod_ref

#12 detectors
HillofTowie12_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
HillofTowie12_grframe<-data.frame(HillofTowie12_gr, samp2)
HillofTowie12_grframelong <- melt(HillofTowie12_grframe,id.vars="samp2")
HillofTowie12_grframelong_sum <- ddply(HillofTowie12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie12_gr_max <- sum(HillofTowie12_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie12_gr_max
HillofTowie12_gr_pres <- sum(HillofTowie12_grframelong_sum $max > 0)
HillofTowie12_gr_pres

#number of sites which would be classified as low
HillofTowie12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie12_grframelong_sum$max)
HillofTowie12_gr_lw_ref
#number of sites which would be classified as high
HillofTowie12_gr_high_ref <- sum( HillofTowie12_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie12_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie12_gr_mod_ref <- 1000 - (HillofTowie12_gr_high_ref + HillofTowie12_gr_lw_ref)
HillofTowie12_gr_mod_ref

#13 detectors
HillofTowie13_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
HillofTowie13_grframe<-data.frame(HillofTowie13_gr, samp2)
HillofTowie13_grframelong <- melt(HillofTowie13_grframe,id.vars="samp2")
HillofTowie13_grframelong_sum <- ddply(HillofTowie13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie13_gr_max <- sum(HillofTowie13_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie13_gr_max
HillofTowie13_gr_pres <- sum(HillofTowie13_grframelong_sum $max > 0)
HillofTowie13_gr_pres

#number of sites which would be classified as low
HillofTowie13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie13_grframelong_sum$max)
HillofTowie13_gr_lw_ref
#number of sites which would be classified as high
HillofTowie13_gr_high_ref <- sum( HillofTowie13_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie13_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie13_gr_mod_ref <- 1000 - (HillofTowie13_gr_high_ref + HillofTowie13_gr_lw_ref)
HillofTowie13_gr_mod_ref

#14 detectors
HillofTowie14_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
HillofTowie14_grframe<-data.frame(HillofTowie14_gr, samp2)
HillofTowie14_grframelong <- melt(HillofTowie14_grframe,id.vars="samp2")
HillofTowie14_grframelong_sum <- ddply(HillofTowie14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie14_gr_max <- sum(HillofTowie14_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie14_gr_max
HillofTowie14_gr_pres <- sum(HillofTowie14_grframelong_sum $max > 0)
HillofTowie14_gr_pres

#number of sites which would be classified as low
HillofTowie14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie14_grframelong_sum$max)
HillofTowie14_gr_lw_ref
#number of sites which would be classified as high
HillofTowie14_gr_high_ref <- sum( HillofTowie14_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie14_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie14_gr_mod_ref <- 1000 - (HillofTowie14_gr_high_ref + HillofTowie14_gr_lw_ref)
HillofTowie14_gr_mod_ref

#15 detectors
HillofTowie15_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
HillofTowie15_grframe<-data.frame(HillofTowie15_gr, samp2)
HillofTowie15_grframelong <- melt(HillofTowie15_grframe,id.vars="samp2")
HillofTowie15_grframelong_sum <- ddply(HillofTowie15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie15_gr_max <- sum(HillofTowie15_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie15_gr_max
HillofTowie15_gr_pres <- sum(HillofTowie15_grframelong_sum $max > 0)
HillofTowie15_gr_pres

#number of sites which would be classified as low
HillofTowie15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie15_grframelong_sum$max)
HillofTowie15_gr_lw_ref
#number of sites which would be classified as high
HillofTowie15_gr_high_ref <- sum( HillofTowie15_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie15_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie15_gr_mod_ref <- 1000 - (HillofTowie15_gr_high_ref + HillofTowie15_gr_lw_ref)
HillofTowie15_gr_mod_ref

#16 detectors
HillofTowie16_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
HillofTowie16_grframe<-data.frame(HillofTowie16_gr, samp2)
HillofTowie16_grframelong <- melt(HillofTowie16_grframe,id.vars="samp2")
HillofTowie16_grframelong_sum <- ddply(HillofTowie16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie16_gr_max <- sum(HillofTowie16_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie16_gr_max
HillofTowie16_gr_pres <- sum(HillofTowie16_grframelong_sum $max > 0)
HillofTowie16_gr_pres

#number of sites which would be classified as low
HillofTowie16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie16_grframelong_sum$max)
HillofTowie16_gr_lw_ref
#number of sites which would be classified as high
HillofTowie16_gr_high_ref <- sum( HillofTowie16_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie16_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie16_gr_mod_ref <- 1000 - (HillofTowie16_gr_high_ref + HillofTowie16_gr_lw_ref)
HillofTowie16_gr_mod_ref

#17 detectors
HillofTowie17_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
HillofTowie17_grframe<-data.frame(HillofTowie17_gr, samp2)
HillofTowie17_grframelong <- melt(HillofTowie17_grframe,id.vars="samp2")
HillofTowie17_grframelong_sum <- ddply(HillofTowie17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie17_gr_max <- sum(HillofTowie17_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie17_gr_max
HillofTowie17_gr_pres <- sum(HillofTowie17_grframelong_sum $max > 0)
HillofTowie17_gr_pres

#number of sites which would be classified as low
HillofTowie17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie17_grframelong_sum$max)
HillofTowie17_gr_lw_ref
#number of sites which would be classified as high
HillofTowie17_gr_high_ref <- sum( HillofTowie17_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie17_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie17_gr_mod_ref <- 1000 - (HillofTowie17_gr_high_ref + HillofTowie17_gr_lw_ref)
HillofTowie17_gr_mod_ref

#18 detectors
HillofTowie18_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
HillofTowie18_grframe<-data.frame(HillofTowie18_gr, samp2)
HillofTowie18_grframelong <- melt(HillofTowie18_grframe,id.vars="samp2")
HillofTowie18_grframelong_sum <- ddply(HillofTowie18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie18_gr_max <- sum(HillofTowie18_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie18_gr_max
HillofTowie18_gr_pres <- sum(HillofTowie18_grframelong_sum $max > 0)
HillofTowie18_gr_pres

#number of sites which would be classified as low
HillofTowie18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie18_grframelong_sum$max)
HillofTowie18_gr_lw_ref
#number of sites which would be classified as high
HillofTowie18_gr_high_ref <- sum( HillofTowie18_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie18_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie18_gr_mod_ref <- 1000 - (HillofTowie18_gr_high_ref + HillofTowie18_gr_lw_ref)
HillofTowie18_gr_mod_ref

#19 detectors
HillofTowie19_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
HillofTowie19_grframe<-data.frame(HillofTowie19_gr, samp2)
HillofTowie19_grframelong <- melt(HillofTowie19_grframe,id.vars="samp2")
HillofTowie19_grframelong_sum <- ddply(HillofTowie19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie19_gr_max <- sum(HillofTowie19_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie19_gr_max
HillofTowie19_gr_pres <- sum(HillofTowie19_grframelong_sum $max > 0)
HillofTowie19_gr_pres

#number of sites which would be classified as low
HillofTowie19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie19_grframelong_sum$max)
HillofTowie19_gr_lw_ref
#number of sites which would be classified as high
HillofTowie19_gr_high_ref <- sum( HillofTowie19_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie19_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie19_gr_mod_ref <- 1000 - (HillofTowie19_gr_high_ref + HillofTowie19_gr_lw_ref)
HillofTowie19_gr_mod_ref

#20 detectors
HillofTowie20_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
HillofTowie20_grframe<-data.frame(HillofTowie20_gr, samp2)
HillofTowie20_grframelong <- melt(HillofTowie20_grframe,id.vars="samp2")
HillofTowie20_grframelong_sum <- ddply(HillofTowie20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie20_gr_max <- sum(HillofTowie20_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie20_gr_max
HillofTowie20_gr_pres <- sum(HillofTowie20_grframelong_sum $max > 0)
HillofTowie20_gr_pres

#number of sites which would be classified as low
HillofTowie20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie20_grframelong_sum$max)
HillofTowie20_gr_lw_ref
#number of sites which would be classified as high
HillofTowie20_gr_high_ref <- sum( HillofTowie20_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie20_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie20_gr_mod_ref <- 1000 - (HillofTowie20_gr_high_ref + HillofTowie20_gr_lw_ref)
HillofTowie20_gr_mod_ref

#21 detectors
HillofTowie21_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
HillofTowie21_grframe<-data.frame(HillofTowie21_gr, samp2)
HillofTowie21_grframelong <- melt(HillofTowie21_grframe,id.vars="samp2")
HillofTowie21_grframelong_sum <- ddply(HillofTowie21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie21_gr_max <- sum(HillofTowie21_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie21_gr_max
HillofTowie21_gr_pres <- sum(HillofTowie21_grframelong_sum $max > 0)
HillofTowie21_gr_pres

#number of sites which would be classified as low
HillofTowie21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie21_grframelong_sum$max)
HillofTowie21_gr_lw_ref
#number of sites which would be classified as high
HillofTowie21_gr_high_ref <- sum( HillofTowie21_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie21_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie21_gr_mod_ref <- 1000 - (HillofTowie21_gr_high_ref + HillofTowie21_gr_lw_ref)
HillofTowie21_gr_mod_ref

#22 detectors
HillofTowie22_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
HillofTowie22_grframe<-data.frame(HillofTowie22_gr, samp2)
HillofTowie22_grframelong <- melt(HillofTowie22_grframe,id.vars="samp2")
HillofTowie22_grframelong_sum <- ddply(HillofTowie22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie22_gr_max <- sum(HillofTowie22_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie22_gr_max
HillofTowie22_gr_pres <- sum(HillofTowie22_grframelong_sum $max > 0)
HillofTowie22_gr_pres

#number of sites which would be classified as low
HillofTowie22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie22_grframelong_sum$max)
HillofTowie22_gr_lw_ref
#number of sites which would be classified as high
HillofTowie22_gr_high_ref <- sum( HillofTowie22_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie22_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie22_gr_mod_ref <- 1000 - (HillofTowie22_gr_high_ref + HillofTowie22_gr_lw_ref)
HillofTowie22_gr_mod_ref

#23 detectors
HillofTowie23_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
HillofTowie23_grframe<-data.frame(HillofTowie23_gr, samp2)
HillofTowie23_grframelong <- melt(HillofTowie23_grframe,id.vars="samp2")
HillofTowie23_grframelong_sum <- ddply(HillofTowie23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie23_gr_max <- sum(HillofTowie23_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie23_gr_max
HillofTowie23_gr_pres <- sum(HillofTowie23_grframelong_sum $max > 0)
HillofTowie23_gr_pres

#number of sites which would be classified as low
HillofTowie23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie23_grframelong_sum$max)
HillofTowie23_gr_lw_ref
#number of sites which would be classified as high
HillofTowie23_gr_high_ref <- sum( HillofTowie23_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie23_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie23_gr_mod_ref <- 1000 - (HillofTowie23_gr_high_ref + HillofTowie23_gr_lw_ref)
HillofTowie23_gr_mod_ref

#24 detectors
HillofTowie24_gr<-(replicate(1000, (sample(HillofTowiepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
HillofTowie24_grframe<-data.frame(HillofTowie24_gr, samp2)
HillofTowie24_grframelong <- melt(HillofTowie24_grframe,id.vars="samp2")
HillofTowie24_grframelong_sum <- ddply(HillofTowie24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
HillofTowie24_gr_max <- sum(HillofTowie24_grframelong_sum $max > max20_HillofTowiepipgr)
HillofTowie24_gr_max
HillofTowie24_gr_pres <- sum(HillofTowie24_grframelong_sum $max > 0)
HillofTowie24_gr_pres

#number of sites which would be classified as low
HillofTowie24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= HillofTowie24_grframelong_sum$max)
HillofTowie24_gr_lw_ref
#number of sites which would be classified as high
HillofTowie24_gr_high_ref <- sum( HillofTowie24_grframelong_sum$max > allsppgr_ppip_ref_high)
HillofTowie24_gr_high_ref
#number of sites which would be classified as moderate
HillofTowie24_gr_mod_ref <- 1000 - (HillofTowie24_gr_high_ref + HillofTowie24_gr_lw_ref)
HillofTowie24_gr_mod_ref

Present<-c(HillofTowie1_gr_pres,HillofTowie2_gr_pres,
           HillofTowie3_gr_pres,HillofTowie4_gr_pres,
           HillofTowie5_gr_pres,HillofTowie6_gr_pres,
           HillofTowie7_gr_pres,HillofTowie8_gr_pres,
           HillofTowie9_gr_pres,HillofTowie10_gr_pres,
           HillofTowie11_gr_pres,HillofTowie12_gr_pres,
           HillofTowie13_gr_pres,HillofTowie14_gr_pres,
           HillofTowie15_gr_pres,HillofTowie16_gr_pres,
           HillofTowie17_gr_pres,HillofTowie18_gr_pres,
           HillofTowie19_gr_pres,HillofTowie20_gr_pres,
           HillofTowie21_gr_pres,HillofTowie22_gr_pres,
           HillofTowie23_gr_pres,HillofTowie24_gr_pres)


Maximum<-c(HillofTowie1_gr_max,HillofTowie2_gr_max,
           HillofTowie3_gr_max,HillofTowie4_gr_max,
           HillofTowie5_gr_max,HillofTowie6_gr_max,
           HillofTowie7_gr_max,HillofTowie8_gr_max,
           HillofTowie9_gr_max,HillofTowie10_gr_max,
           HillofTowie11_gr_max,HillofTowie12_gr_max,
           HillofTowie13_gr_max,HillofTowie14_gr_max,
           HillofTowie15_gr_max,HillofTowie16_gr_max,
           HillofTowie17_gr_max,HillofTowie18_gr_max,
           HillofTowie19_gr_max,HillofTowie20_gr_max,
           HillofTowie21_gr_max,HillofTowie22_gr_max,
           HillofTowie23_gr_max,HillofTowie24_gr_max)

Low<-c(HillofTowie1_gr_lw_ref, HillofTowie2_gr_lw_ref, HillofTowie3_gr_lw_ref,
       HillofTowie4_gr_lw_ref, HillofTowie5_gr_lw_ref, HillofTowie6_gr_lw_ref,
       HillofTowie7_gr_lw_ref, HillofTowie8_gr_lw_ref, HillofTowie9_gr_lw_ref,
       HillofTowie10_gr_lw_ref, HillofTowie11_gr_lw_ref, HillofTowie12_gr_lw_ref, 
       HillofTowie13_gr_lw_ref, HillofTowie14_gr_lw_ref, HillofTowie15_gr_lw_ref, 
       HillofTowie16_gr_lw_ref, HillofTowie17_gr_lw_ref, HillofTowie18_gr_lw_ref, 
       HillofTowie19_gr_lw_ref, HillofTowie20_gr_lw_ref, HillofTowie21_gr_lw_ref,
       HillofTowie22_gr_lw_ref,HillofTowie23_gr_lw_ref,HillofTowie24_gr_lw_ref)

Moderate<-c(HillofTowie1_gr_mod_ref, HillofTowie2_gr_mod_ref, HillofTowie3_gr_mod_ref,
            HillofTowie4_gr_mod_ref, HillofTowie5_gr_mod_ref, HillofTowie6_gr_mod_ref,
            HillofTowie7_gr_mod_ref, HillofTowie8_gr_mod_ref, HillofTowie9_gr_mod_ref,
            HillofTowie10_gr_mod_ref, HillofTowie11_gr_mod_ref, HillofTowie12_gr_mod_ref, 
            HillofTowie13_gr_mod_ref, HillofTowie14_gr_mod_ref, HillofTowie15_gr_mod_ref, 
            HillofTowie16_gr_mod_ref, HillofTowie17_gr_mod_ref, HillofTowie18_gr_mod_ref, 
            HillofTowie19_gr_mod_ref, HillofTowie20_gr_mod_ref, HillofTowie21_gr_mod_ref,
            HillofTowie22_gr_mod_ref,HillofTowie23_gr_mod_ref,HillofTowie24_gr_mod_ref)

High<-c(HillofTowie1_gr_high_ref, HillofTowie2_gr_high_ref, HillofTowie3_gr_high_ref,
        HillofTowie4_gr_high_ref, HillofTowie5_gr_high_ref, HillofTowie6_gr_high_ref,
        HillofTowie7_gr_high_ref, HillofTowie8_gr_high_ref, HillofTowie9_gr_high_ref,
        HillofTowie10_gr_high_ref, HillofTowie11_gr_high_ref, HillofTowie12_gr_high_ref, 
        HillofTowie13_gr_high_ref, HillofTowie14_gr_high_ref, HillofTowie15_gr_high_ref, 
        HillofTowie16_gr_high_ref, HillofTowie17_gr_high_ref, HillofTowie18_gr_high_ref, 
        HillofTowie19_gr_high_ref, HillofTowie20_gr_high_ref, HillofTowie21_gr_high_ref,
        HillofTowie22_gr_high_ref,HillofTowie23_gr_high_ref,HillofTowie24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("HillofTowiegr",24)
Lowsite <- HillofTowielow
Modsite <- HillofTowiemod
Highsite <-HillofTowiehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



HillofTowiegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##Lissett

Lissettpipgr<-subset(allspp4gr_ppip, Site=="Lissett")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Lissettpipgr<-max(Lissettpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Lissettpipgr<- (max_Lissettpipgr/100)*80

##calculate the site classification (reference range)

Lissetthigh<- max_Lissettpipgr > allsppgr_ppip_ref_high

Lissettlow<- allsppgr_ppip_ref_low > max_Lissettpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Lissettpipgr
Lissettmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Lissett1_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 1, replace=F))))
Lissett1_gr_max <- sum(Lissett1_gr > max20_Lissettpipgr)
Lissett1_gr_max
Lissett1_gr_pres <- sum(Lissett1_gr > 0)
Lissett1_gr_pres
#number of sites which would be classified as low
Lissett1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett1_gr)
Lissett1_gr_lw_ref
#number of sites which would be classified as high
Lissett1_gr_high_ref <- sum( Lissett1_gr > allsppgr_ppip_ref_high)
Lissett1_gr_high_ref
#number of sites which would be classified as moderate
Lissett1_gr_mod_ref <- 1000 - (Lissett1_gr_high_ref + Lissett1_gr_lw_ref)
Lissett1_gr_mod_ref


#2 nights
Lissett2_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Lissett2_grframe<-data.frame(Lissett2_gr, samp2)
Lissett2_grframelong <- melt(Lissett2_grframe,id.vars="samp2")
Lissett2_grframelong_sum <- ddply(Lissett2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett2_gr_max <- sum(Lissett2_grframelong_sum $max > max20_Lissettpipgr)
Lissett2_gr_max
Lissett2_gr_pres <- sum(Lissett2_grframelong_sum $max > 0)
Lissett2_gr_pres

#number of sites which would be classified as low
Lissett2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett2_grframelong_sum$max)
Lissett2_gr_lw_ref
#number of sites which would be classified as high
Lissett2_gr_high_ref <- sum( Lissett2_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett2_gr_high_ref
#number of sites which would be classified as moderate
Lissett2_gr_mod_ref <- 1000 - (Lissett2_gr_high_ref + Lissett2_gr_lw_ref)
Lissett2_gr_mod_ref


#3 nights
Lissett3_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Lissett3_grframe<-data.frame(Lissett3_gr, samp2)
Lissett3_grframelong <- melt(Lissett3_grframe,id.vars="samp2")
Lissett3_grframelong_sum <- ddply(Lissett3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett3_gr_max <- sum(Lissett3_grframelong_sum $max > max20_Lissettpipgr)
Lissett3_gr_max
Lissett3_gr_pres <- sum(Lissett3_grframelong_sum $max > 0)
Lissett3_gr_pres

#number of sites which would be classified as low
Lissett3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett3_grframelong_sum$max)
Lissett3_gr_lw_ref
#number of sites which would be classified as high
Lissett3_gr_high_ref <- sum( Lissett3_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett3_gr_high_ref
#number of sites which would be classified as moderate
Lissett3_gr_mod_ref <- 1000 - (Lissett3_gr_high_ref + Lissett3_gr_lw_ref)
Lissett3_gr_mod_ref

#4 nights
Lissett4_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Lissett4_grframe<-data.frame(Lissett4_gr, samp2)
Lissett4_grframelong <- melt(Lissett4_grframe,id.vars="samp2")
Lissett4_grframelong_sum <- ddply(Lissett4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett4_gr_max <- sum(Lissett4_grframelong_sum $max > max20_Lissettpipgr)
Lissett4_gr_max
Lissett4_gr_pres <- sum(Lissett4_grframelong_sum $max > 0)
Lissett4_gr_pres

#number of sites which would be classified as low
Lissett4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett4_grframelong_sum$max)
Lissett4_gr_lw_ref
#number of sites which would be classified as high
Lissett4_gr_high_ref <- sum( Lissett4_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett4_gr_high_ref
#number of sites which would be classified as moderate
Lissett4_gr_mod_ref <- 1000 - (Lissett4_gr_high_ref + Lissett4_gr_lw_ref)
Lissett4_gr_mod_ref

#5 nights
Lissett5_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Lissett5_grframe<-data.frame(Lissett5_gr, samp2)
Lissett5_grframelong <- melt(Lissett5_grframe,id.vars="samp2")
Lissett5_grframelong_sum <- ddply(Lissett5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett5_gr_max <- sum(Lissett5_grframelong_sum $max > max20_Lissettpipgr)
Lissett5_gr_max
Lissett5_gr_pres <- sum(Lissett5_grframelong_sum $max > 0)
Lissett5_gr_pres

#number of sites which would be classified as low
Lissett5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett5_grframelong_sum$max)
Lissett5_gr_lw_ref
#number of sites which would be classified as high
Lissett5_gr_high_ref <- sum( Lissett5_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett5_gr_high_ref
#number of sites which would be classified as moderate
Lissett5_gr_mod_ref <- 1000 - (Lissett5_gr_high_ref + Lissett5_gr_lw_ref)
Lissett5_gr_mod_ref

#6 nights
Lissett6_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Lissett6_grframe<-data.frame(Lissett6_gr, samp2)
Lissett6_grframelong <- melt(Lissett6_grframe,id.vars="samp2")
Lissett6_grframelong_sum <- ddply(Lissett6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett6_gr_max <- sum(Lissett6_grframelong_sum $max > max20_Lissettpipgr)
Lissett6_gr_max
Lissett6_gr_pres <- sum(Lissett6_grframelong_sum $max > 0)
Lissett6_gr_pres

#number of sites which would be classified as low
Lissett6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett6_grframelong_sum$max)
Lissett6_gr_lw_ref
#number of sites which would be classified as high
Lissett6_gr_high_ref <- sum( Lissett6_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett6_gr_high_ref
#number of sites which would be classified as moderate
Lissett6_gr_mod_ref <- 1000 - (Lissett6_gr_high_ref + Lissett6_gr_lw_ref)
Lissett6_gr_mod_ref

#7 nights
Lissett7_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Lissett7_grframe<-data.frame(Lissett7_gr, samp2)
Lissett7_grframelong <- melt(Lissett7_grframe,id.vars="samp2")
Lissett7_grframelong_sum <- ddply(Lissett7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett7_gr_max <- sum(Lissett7_grframelong_sum $max > max20_Lissettpipgr)
Lissett7_gr_max
Lissett7_gr_pres <- sum(Lissett7_grframelong_sum $max > 0)
Lissett7_gr_pres

#number of sites which would be classified as low
Lissett7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett7_grframelong_sum$max)
Lissett7_gr_lw_ref
#number of sites which would be classified as high
Lissett7_gr_high_ref <- sum( Lissett7_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett7_gr_high_ref
#number of sites which would be classified as moderate
Lissett7_gr_mod_ref <- 1000 - (Lissett7_gr_high_ref + Lissett7_gr_lw_ref)
Lissett7_gr_mod_ref

#8 nights
Lissett8_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Lissett8_grframe<-data.frame(Lissett8_gr, samp2)
Lissett8_grframelong <- melt(Lissett8_grframe,id.vars="samp2")
Lissett8_grframelong_sum <- ddply(Lissett8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett8_gr_max <- sum(Lissett8_grframelong_sum $max > max20_Lissettpipgr)
Lissett8_gr_max
Lissett8_gr_pres <- sum(Lissett8_grframelong_sum $max > 0)
Lissett8_gr_pres

#number of sites which would be classified as low
Lissett8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett8_grframelong_sum$max)
Lissett8_gr_lw_ref
#number of sites which would be classified as high
Lissett8_gr_high_ref <- sum( Lissett8_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett8_gr_high_ref
#number of sites which would be classified as moderate
Lissett8_gr_mod_ref <- 1000 - (Lissett8_gr_high_ref + Lissett8_gr_lw_ref)
Lissett8_gr_mod_ref

#9 nights
Lissett9_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Lissett9_grframe<-data.frame(Lissett9_gr, samp2)
Lissett9_grframelong <- melt(Lissett9_grframe,id.vars="samp2")
Lissett9_grframelong_sum <- ddply(Lissett9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Lissett9_gr_max <- sum(Lissett9_grframelong_sum $max > max20_Lissettpipgr)
Lissett9_gr_max
Lissett9_gr_pres <- sum(Lissett9_grframelong_sum $max > 0)
Lissett9_gr_pres

#number of sites which would be classified as low
Lissett9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett9_grframelong_sum$max)
Lissett9_gr_lw_ref
#number of sites which would be classified as high
Lissett9_gr_high_ref <- sum( Lissett9_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett9_gr_high_ref
#number of sites which would be classified as moderate
Lissett9_gr_mod_ref <- 1000 - (Lissett9_gr_high_ref + Lissett9_gr_lw_ref)
Lissett9_gr_mod_ref

#10 detectors
Lissett10_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Lissett10_grframe<-data.frame(Lissett10_gr, samp2)
Lissett10_grframelong <- melt(Lissett10_grframe,id.vars="samp2")
Lissett10_grframelong_sum <- ddply(Lissett10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett10_gr_max <- sum(Lissett10_grframelong_sum $max > max20_Lissettpipgr)
Lissett10_gr_max
Lissett10_gr_pres <- sum(Lissett10_grframelong_sum $max > 0)
Lissett10_gr_pres

#number of sites which would be classified as low
Lissett10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett10_grframelong_sum$max)
Lissett10_gr_lw_ref
#number of sites which would be classified as high
Lissett10_gr_high_ref <- sum( Lissett10_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett10_gr_high_ref
#number of sites which would be classified as moderate
Lissett10_gr_mod_ref <- 1000 - (Lissett10_gr_high_ref + Lissett10_gr_lw_ref)
Lissett10_gr_mod_ref

#11 detectors
Lissett11_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Lissett11_grframe<-data.frame(Lissett11_gr, samp2)
Lissett11_grframelong <- melt(Lissett11_grframe,id.vars="samp2")
Lissett11_grframelong_sum <- ddply(Lissett11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett11_gr_max <- sum(Lissett11_grframelong_sum $max > max20_Lissettpipgr)
Lissett11_gr_max
Lissett11_gr_pres <- sum(Lissett11_grframelong_sum $max > 0)
Lissett11_gr_pres

#number of sites which would be classified as low
Lissett11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett11_grframelong_sum$max)
Lissett11_gr_lw_ref
#number of sites which would be classified as high
Lissett11_gr_high_ref <- sum( Lissett11_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett11_gr_high_ref
#number of sites which would be classified as moderate
Lissett11_gr_mod_ref <- 1000 - (Lissett11_gr_high_ref + Lissett11_gr_lw_ref)
Lissett11_gr_mod_ref

#12 detectors
Lissett12_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Lissett12_grframe<-data.frame(Lissett12_gr, samp2)
Lissett12_grframelong <- melt(Lissett12_grframe,id.vars="samp2")
Lissett12_grframelong_sum <- ddply(Lissett12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett12_gr_max <- sum(Lissett12_grframelong_sum $max > max20_Lissettpipgr)
Lissett12_gr_max
Lissett12_gr_pres <- sum(Lissett12_grframelong_sum $max > 0)
Lissett12_gr_pres

#number of sites which would be classified as low
Lissett12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett12_grframelong_sum$max)
Lissett12_gr_lw_ref
#number of sites which would be classified as high
Lissett12_gr_high_ref <- sum( Lissett12_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett12_gr_high_ref
#number of sites which would be classified as moderate
Lissett12_gr_mod_ref <- 1000 - (Lissett12_gr_high_ref + Lissett12_gr_lw_ref)
Lissett12_gr_mod_ref

#13 detectors
Lissett13_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Lissett13_grframe<-data.frame(Lissett13_gr, samp2)
Lissett13_grframelong <- melt(Lissett13_grframe,id.vars="samp2")
Lissett13_grframelong_sum <- ddply(Lissett13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett13_gr_max <- sum(Lissett13_grframelong_sum $max > max20_Lissettpipgr)
Lissett13_gr_max
Lissett13_gr_pres <- sum(Lissett13_grframelong_sum $max > 0)
Lissett13_gr_pres

#number of sites which would be classified as low
Lissett13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett13_grframelong_sum$max)
Lissett13_gr_lw_ref
#number of sites which would be classified as high
Lissett13_gr_high_ref <- sum( Lissett13_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett13_gr_high_ref
#number of sites which would be classified as moderate
Lissett13_gr_mod_ref <- 1000 - (Lissett13_gr_high_ref + Lissett13_gr_lw_ref)
Lissett13_gr_mod_ref

#14 detectors
Lissett14_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Lissett14_grframe<-data.frame(Lissett14_gr, samp2)
Lissett14_grframelong <- melt(Lissett14_grframe,id.vars="samp2")
Lissett14_grframelong_sum <- ddply(Lissett14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett14_gr_max <- sum(Lissett14_grframelong_sum $max > max20_Lissettpipgr)
Lissett14_gr_max
Lissett14_gr_pres <- sum(Lissett14_grframelong_sum $max > 0)
Lissett14_gr_pres

#number of sites which would be classified as low
Lissett14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett14_grframelong_sum$max)
Lissett14_gr_lw_ref
#number of sites which would be classified as high
Lissett14_gr_high_ref <- sum( Lissett14_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett14_gr_high_ref
#number of sites which would be classified as moderate
Lissett14_gr_mod_ref <- 1000 - (Lissett14_gr_high_ref + Lissett14_gr_lw_ref)
Lissett14_gr_mod_ref

#15 detectors
Lissett15_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Lissett15_grframe<-data.frame(Lissett15_gr, samp2)
Lissett15_grframelong <- melt(Lissett15_grframe,id.vars="samp2")
Lissett15_grframelong_sum <- ddply(Lissett15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett15_gr_max <- sum(Lissett15_grframelong_sum $max > max20_Lissettpipgr)
Lissett15_gr_max
Lissett15_gr_pres <- sum(Lissett15_grframelong_sum $max > 0)
Lissett15_gr_pres

#number of sites which would be classified as low
Lissett15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett15_grframelong_sum$max)
Lissett15_gr_lw_ref
#number of sites which would be classified as high
Lissett15_gr_high_ref <- sum( Lissett15_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett15_gr_high_ref
#number of sites which would be classified as moderate
Lissett15_gr_mod_ref <- 1000 - (Lissett15_gr_high_ref + Lissett15_gr_lw_ref)
Lissett15_gr_mod_ref

#16 detectors
Lissett16_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Lissett16_grframe<-data.frame(Lissett16_gr, samp2)
Lissett16_grframelong <- melt(Lissett16_grframe,id.vars="samp2")
Lissett16_grframelong_sum <- ddply(Lissett16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett16_gr_max <- sum(Lissett16_grframelong_sum $max > max20_Lissettpipgr)
Lissett16_gr_max
Lissett16_gr_pres <- sum(Lissett16_grframelong_sum $max > 0)
Lissett16_gr_pres

#number of sites which would be classified as low
Lissett16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett16_grframelong_sum$max)
Lissett16_gr_lw_ref
#number of sites which would be classified as high
Lissett16_gr_high_ref <- sum( Lissett16_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett16_gr_high_ref
#number of sites which would be classified as moderate
Lissett16_gr_mod_ref <- 1000 - (Lissett16_gr_high_ref + Lissett16_gr_lw_ref)
Lissett16_gr_mod_ref

#17 detectors
Lissett17_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Lissett17_grframe<-data.frame(Lissett17_gr, samp2)
Lissett17_grframelong <- melt(Lissett17_grframe,id.vars="samp2")
Lissett17_grframelong_sum <- ddply(Lissett17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett17_gr_max <- sum(Lissett17_grframelong_sum $max > max20_Lissettpipgr)
Lissett17_gr_max
Lissett17_gr_pres <- sum(Lissett17_grframelong_sum $max > 0)
Lissett17_gr_pres

#number of sites which would be classified as low
Lissett17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett17_grframelong_sum$max)
Lissett17_gr_lw_ref
#number of sites which would be classified as high
Lissett17_gr_high_ref <- sum( Lissett17_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett17_gr_high_ref
#number of sites which would be classified as moderate
Lissett17_gr_mod_ref <- 1000 - (Lissett17_gr_high_ref + Lissett17_gr_lw_ref)
Lissett17_gr_mod_ref

#18 detectors
Lissett18_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Lissett18_grframe<-data.frame(Lissett18_gr, samp2)
Lissett18_grframelong <- melt(Lissett18_grframe,id.vars="samp2")
Lissett18_grframelong_sum <- ddply(Lissett18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett18_gr_max <- sum(Lissett18_grframelong_sum $max > max20_Lissettpipgr)
Lissett18_gr_max
Lissett18_gr_pres <- sum(Lissett18_grframelong_sum $max > 0)
Lissett18_gr_pres

#number of sites which would be classified as low
Lissett18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett18_grframelong_sum$max)
Lissett18_gr_lw_ref
#number of sites which would be classified as high
Lissett18_gr_high_ref <- sum( Lissett18_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett18_gr_high_ref
#number of sites which would be classified as moderate
Lissett18_gr_mod_ref <- 1000 - (Lissett18_gr_high_ref + Lissett18_gr_lw_ref)
Lissett18_gr_mod_ref

#19 detectors
Lissett19_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Lissett19_grframe<-data.frame(Lissett19_gr, samp2)
Lissett19_grframelong <- melt(Lissett19_grframe,id.vars="samp2")
Lissett19_grframelong_sum <- ddply(Lissett19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett19_gr_max <- sum(Lissett19_grframelong_sum $max > max20_Lissettpipgr)
Lissett19_gr_max
Lissett19_gr_pres <- sum(Lissett19_grframelong_sum $max > 0)
Lissett19_gr_pres

#number of sites which would be classified as low
Lissett19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett19_grframelong_sum$max)
Lissett19_gr_lw_ref
#number of sites which would be classified as high
Lissett19_gr_high_ref <- sum( Lissett19_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett19_gr_high_ref
#number of sites which would be classified as moderate
Lissett19_gr_mod_ref <- 1000 - (Lissett19_gr_high_ref + Lissett19_gr_lw_ref)
Lissett19_gr_mod_ref

#20 detectors
Lissett20_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Lissett20_grframe<-data.frame(Lissett20_gr, samp2)
Lissett20_grframelong <- melt(Lissett20_grframe,id.vars="samp2")
Lissett20_grframelong_sum <- ddply(Lissett20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett20_gr_max <- sum(Lissett20_grframelong_sum $max > max20_Lissettpipgr)
Lissett20_gr_max
Lissett20_gr_pres <- sum(Lissett20_grframelong_sum $max > 0)
Lissett20_gr_pres

#number of sites which would be classified as low
Lissett20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett20_grframelong_sum$max)
Lissett20_gr_lw_ref
#number of sites which would be classified as high
Lissett20_gr_high_ref <- sum( Lissett20_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett20_gr_high_ref
#number of sites which would be classified as moderate
Lissett20_gr_mod_ref <- 1000 - (Lissett20_gr_high_ref + Lissett20_gr_lw_ref)
Lissett20_gr_mod_ref

#21 detectors
Lissett21_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Lissett21_grframe<-data.frame(Lissett21_gr, samp2)
Lissett21_grframelong <- melt(Lissett21_grframe,id.vars="samp2")
Lissett21_grframelong_sum <- ddply(Lissett21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett21_gr_max <- sum(Lissett21_grframelong_sum $max > max20_Lissettpipgr)
Lissett21_gr_max
Lissett21_gr_pres <- sum(Lissett21_grframelong_sum $max > 0)
Lissett21_gr_pres

#number of sites which would be classified as low
Lissett21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett21_grframelong_sum$max)
Lissett21_gr_lw_ref
#number of sites which would be classified as high
Lissett21_gr_high_ref <- sum( Lissett21_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett21_gr_high_ref
#number of sites which would be classified as moderate
Lissett21_gr_mod_ref <- 1000 - (Lissett21_gr_high_ref + Lissett21_gr_lw_ref)
Lissett21_gr_mod_ref

#22 detectors
Lissett22_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Lissett22_grframe<-data.frame(Lissett22_gr, samp2)
Lissett22_grframelong <- melt(Lissett22_grframe,id.vars="samp2")
Lissett22_grframelong_sum <- ddply(Lissett22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett22_gr_max <- sum(Lissett22_grframelong_sum $max > max20_Lissettpipgr)
Lissett22_gr_max
Lissett22_gr_pres <- sum(Lissett22_grframelong_sum $max > 0)
Lissett22_gr_pres

#number of sites which would be classified as low
Lissett22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett22_grframelong_sum$max)
Lissett22_gr_lw_ref
#number of sites which would be classified as high
Lissett22_gr_high_ref <- sum( Lissett22_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett22_gr_high_ref
#number of sites which would be classified as moderate
Lissett22_gr_mod_ref <- 1000 - (Lissett22_gr_high_ref + Lissett22_gr_lw_ref)
Lissett22_gr_mod_ref

#23 detectors
Lissett23_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Lissett23_grframe<-data.frame(Lissett23_gr, samp2)
Lissett23_grframelong <- melt(Lissett23_grframe,id.vars="samp2")
Lissett23_grframelong_sum <- ddply(Lissett23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett23_gr_max <- sum(Lissett23_grframelong_sum $max > max20_Lissettpipgr)
Lissett23_gr_max
Lissett23_gr_pres <- sum(Lissett23_grframelong_sum $max > 0)
Lissett23_gr_pres

#number of sites which would be classified as low
Lissett23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett23_grframelong_sum$max)
Lissett23_gr_lw_ref
#number of sites which would be classified as high
Lissett23_gr_high_ref <- sum( Lissett23_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett23_gr_high_ref
#number of sites which would be classified as moderate
Lissett23_gr_mod_ref <- 1000 - (Lissett23_gr_high_ref + Lissett23_gr_lw_ref)
Lissett23_gr_mod_ref

#24 detectors
Lissett24_gr<-(replicate(1000, (sample(Lissettpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Lissett24_grframe<-data.frame(Lissett24_gr, samp2)
Lissett24_grframelong <- melt(Lissett24_grframe,id.vars="samp2")
Lissett24_grframelong_sum <- ddply(Lissett24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Lissett24_gr_max <- sum(Lissett24_grframelong_sum $max > max20_Lissettpipgr)
Lissett24_gr_max
Lissett24_gr_pres <- sum(Lissett24_grframelong_sum $max > 0)
Lissett24_gr_pres

#number of sites which would be classified as low
Lissett24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lissett24_grframelong_sum$max)
Lissett24_gr_lw_ref
#number of sites which would be classified as high
Lissett24_gr_high_ref <- sum( Lissett24_grframelong_sum$max > allsppgr_ppip_ref_high)
Lissett24_gr_high_ref
#number of sites which would be classified as moderate
Lissett24_gr_mod_ref <- 1000 - (Lissett24_gr_high_ref + Lissett24_gr_lw_ref)
Lissett24_gr_mod_ref

Present<-c(Lissett1_gr_pres,Lissett2_gr_pres,
           Lissett3_gr_pres,Lissett4_gr_pres,
           Lissett5_gr_pres,Lissett6_gr_pres,
           Lissett7_gr_pres,Lissett8_gr_pres,
           Lissett9_gr_pres,Lissett10_gr_pres,
           Lissett11_gr_pres,Lissett12_gr_pres,
           Lissett13_gr_pres,Lissett14_gr_pres,
           Lissett15_gr_pres,Lissett16_gr_pres,
           Lissett17_gr_pres,Lissett18_gr_pres,
           Lissett19_gr_pres,Lissett20_gr_pres,
           Lissett21_gr_pres,Lissett22_gr_pres,
           Lissett23_gr_pres,Lissett24_gr_pres)


Maximum<-c(Lissett1_gr_max,Lissett2_gr_max,
           Lissett3_gr_max,Lissett4_gr_max,
           Lissett5_gr_max,Lissett6_gr_max,
           Lissett7_gr_max,Lissett8_gr_max,
           Lissett9_gr_max,Lissett10_gr_max,
           Lissett11_gr_max,Lissett12_gr_max,
           Lissett13_gr_max,Lissett14_gr_max,
           Lissett15_gr_max,Lissett16_gr_max,
           Lissett17_gr_max,Lissett18_gr_max,
           Lissett19_gr_max,Lissett20_gr_max,
           Lissett21_gr_max,Lissett22_gr_max,
           Lissett23_gr_max,Lissett24_gr_max)

Low<-c(Lissett1_gr_lw_ref, Lissett2_gr_lw_ref, Lissett3_gr_lw_ref,
       Lissett4_gr_lw_ref, Lissett5_gr_lw_ref, Lissett6_gr_lw_ref,
       Lissett7_gr_lw_ref, Lissett8_gr_lw_ref, Lissett9_gr_lw_ref,
       Lissett10_gr_lw_ref, Lissett11_gr_lw_ref, Lissett12_gr_lw_ref, 
       Lissett13_gr_lw_ref, Lissett14_gr_lw_ref, Lissett15_gr_lw_ref, 
       Lissett16_gr_lw_ref, Lissett17_gr_lw_ref, Lissett18_gr_lw_ref, 
       Lissett19_gr_lw_ref, Lissett20_gr_lw_ref, Lissett21_gr_lw_ref,
       Lissett22_gr_lw_ref,Lissett23_gr_lw_ref,Lissett24_gr_lw_ref)

Moderate<-c(Lissett1_gr_mod_ref, Lissett2_gr_mod_ref, Lissett3_gr_mod_ref,
            Lissett4_gr_mod_ref, Lissett5_gr_mod_ref, Lissett6_gr_mod_ref,
            Lissett7_gr_mod_ref, Lissett8_gr_mod_ref, Lissett9_gr_mod_ref,
            Lissett10_gr_mod_ref, Lissett11_gr_mod_ref, Lissett12_gr_mod_ref, 
            Lissett13_gr_mod_ref, Lissett14_gr_mod_ref, Lissett15_gr_mod_ref, 
            Lissett16_gr_mod_ref, Lissett17_gr_mod_ref, Lissett18_gr_mod_ref, 
            Lissett19_gr_mod_ref, Lissett20_gr_mod_ref, Lissett21_gr_mod_ref,
            Lissett22_gr_mod_ref,Lissett23_gr_mod_ref,Lissett24_gr_mod_ref)

High<-c(Lissett1_gr_high_ref, Lissett2_gr_high_ref, Lissett3_gr_high_ref,
        Lissett4_gr_high_ref, Lissett5_gr_high_ref, Lissett6_gr_high_ref,
        Lissett7_gr_high_ref, Lissett8_gr_high_ref, Lissett9_gr_high_ref,
        Lissett10_gr_high_ref, Lissett11_gr_high_ref, Lissett12_gr_high_ref, 
        Lissett13_gr_high_ref, Lissett14_gr_high_ref, Lissett15_gr_high_ref, 
        Lissett16_gr_high_ref, Lissett17_gr_high_ref, Lissett18_gr_high_ref, 
        Lissett19_gr_high_ref, Lissett20_gr_high_ref, Lissett21_gr_high_ref,
        Lissett22_gr_high_ref,Lissett23_gr_high_ref,Lissett24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Lissettgr",24)
Lowsite <- Lissettlow
Modsite <- Lissettmod
Highsite <-Lissetthigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Lissettgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##Lochelbank

Lochelbankpipgr<-subset(allspp4gr_ppip, Site=="Lochelbank")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Lochelbankpipgr<-max(Lochelbankpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Lochelbankpipgr<- (max_Lochelbankpipgr/100)*80

##calculate the site classification (reference range)

Lochelbankhigh<- max_Lochelbankpipgr > allsppgr_ppip_ref_high

Lochelbanklow<- allsppgr_ppip_ref_low > max_Lochelbankpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Lochelbankpipgr
Lochelbankmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Lochelbank1_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 1, replace=F))))
Lochelbank1_gr_max <- sum(Lochelbank1_gr > max20_Lochelbankpipgr)
Lochelbank1_gr_max
Lochelbank1_gr_pres <- sum(Lochelbank1_gr > 0)
Lochelbank1_gr_pres
#number of sites which would be classified as low
Lochelbank1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank1_gr)
Lochelbank1_gr_lw_ref
#number of sites which would be classified as high
Lochelbank1_gr_high_ref <- sum( Lochelbank1_gr > allsppgr_ppip_ref_high)
Lochelbank1_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank1_gr_mod_ref <- 1000 - (Lochelbank1_gr_high_ref + Lochelbank1_gr_lw_ref)
Lochelbank1_gr_mod_ref


#2 nights
Lochelbank2_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Lochelbank2_grframe<-data.frame(Lochelbank2_gr, samp2)
Lochelbank2_grframelong <- melt(Lochelbank2_grframe,id.vars="samp2")
Lochelbank2_grframelong_sum <- ddply(Lochelbank2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank2_gr_max <- sum(Lochelbank2_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank2_gr_max
Lochelbank2_gr_pres <- sum(Lochelbank2_grframelong_sum $max > 0)
Lochelbank2_gr_pres

#number of sites which would be classified as low
Lochelbank2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank2_grframelong_sum$max)
Lochelbank2_gr_lw_ref
#number of sites which would be classified as high
Lochelbank2_gr_high_ref <- sum( Lochelbank2_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank2_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank2_gr_mod_ref <- 1000 - (Lochelbank2_gr_high_ref + Lochelbank2_gr_lw_ref)
Lochelbank2_gr_mod_ref


#3 nights
Lochelbank3_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Lochelbank3_grframe<-data.frame(Lochelbank3_gr, samp2)
Lochelbank3_grframelong <- melt(Lochelbank3_grframe,id.vars="samp2")
Lochelbank3_grframelong_sum <- ddply(Lochelbank3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank3_gr_max <- sum(Lochelbank3_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank3_gr_max
Lochelbank3_gr_pres <- sum(Lochelbank3_grframelong_sum $max > 0)
Lochelbank3_gr_pres

#number of sites which would be classified as low
Lochelbank3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank3_grframelong_sum$max)
Lochelbank3_gr_lw_ref
#number of sites which would be classified as high
Lochelbank3_gr_high_ref <- sum( Lochelbank3_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank3_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank3_gr_mod_ref <- 1000 - (Lochelbank3_gr_high_ref + Lochelbank3_gr_lw_ref)
Lochelbank3_gr_mod_ref

#4 nights
Lochelbank4_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Lochelbank4_grframe<-data.frame(Lochelbank4_gr, samp2)
Lochelbank4_grframelong <- melt(Lochelbank4_grframe,id.vars="samp2")
Lochelbank4_grframelong_sum <- ddply(Lochelbank4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank4_gr_max <- sum(Lochelbank4_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank4_gr_max
Lochelbank4_gr_pres <- sum(Lochelbank4_grframelong_sum $max > 0)
Lochelbank4_gr_pres

#number of sites which would be classified as low
Lochelbank4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank4_grframelong_sum$max)
Lochelbank4_gr_lw_ref
#number of sites which would be classified as high
Lochelbank4_gr_high_ref <- sum( Lochelbank4_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank4_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank4_gr_mod_ref <- 1000 - (Lochelbank4_gr_high_ref + Lochelbank4_gr_lw_ref)
Lochelbank4_gr_mod_ref

#5 nights
Lochelbank5_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Lochelbank5_grframe<-data.frame(Lochelbank5_gr, samp2)
Lochelbank5_grframelong <- melt(Lochelbank5_grframe,id.vars="samp2")
Lochelbank5_grframelong_sum <- ddply(Lochelbank5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank5_gr_max <- sum(Lochelbank5_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank5_gr_max
Lochelbank5_gr_pres <- sum(Lochelbank5_grframelong_sum $max > 0)
Lochelbank5_gr_pres

#number of sites which would be classified as low
Lochelbank5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank5_grframelong_sum$max)
Lochelbank5_gr_lw_ref
#number of sites which would be classified as high
Lochelbank5_gr_high_ref <- sum( Lochelbank5_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank5_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank5_gr_mod_ref <- 1000 - (Lochelbank5_gr_high_ref + Lochelbank5_gr_lw_ref)
Lochelbank5_gr_mod_ref

#6 nights
Lochelbank6_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Lochelbank6_grframe<-data.frame(Lochelbank6_gr, samp2)
Lochelbank6_grframelong <- melt(Lochelbank6_grframe,id.vars="samp2")
Lochelbank6_grframelong_sum <- ddply(Lochelbank6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank6_gr_max <- sum(Lochelbank6_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank6_gr_max
Lochelbank6_gr_pres <- sum(Lochelbank6_grframelong_sum $max > 0)
Lochelbank6_gr_pres

#number of sites which would be classified as low
Lochelbank6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank6_grframelong_sum$max)
Lochelbank6_gr_lw_ref
#number of sites which would be classified as high
Lochelbank6_gr_high_ref <- sum( Lochelbank6_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank6_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank6_gr_mod_ref <- 1000 - (Lochelbank6_gr_high_ref + Lochelbank6_gr_lw_ref)
Lochelbank6_gr_mod_ref

#7 nights
Lochelbank7_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Lochelbank7_grframe<-data.frame(Lochelbank7_gr, samp2)
Lochelbank7_grframelong <- melt(Lochelbank7_grframe,id.vars="samp2")
Lochelbank7_grframelong_sum <- ddply(Lochelbank7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank7_gr_max <- sum(Lochelbank7_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank7_gr_max
Lochelbank7_gr_pres <- sum(Lochelbank7_grframelong_sum $max > 0)
Lochelbank7_gr_pres

#number of sites which would be classified as low
Lochelbank7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank7_grframelong_sum$max)
Lochelbank7_gr_lw_ref
#number of sites which would be classified as high
Lochelbank7_gr_high_ref <- sum( Lochelbank7_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank7_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank7_gr_mod_ref <- 1000 - (Lochelbank7_gr_high_ref + Lochelbank7_gr_lw_ref)
Lochelbank7_gr_mod_ref

#8 nights
Lochelbank8_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Lochelbank8_grframe<-data.frame(Lochelbank8_gr, samp2)
Lochelbank8_grframelong <- melt(Lochelbank8_grframe,id.vars="samp2")
Lochelbank8_grframelong_sum <- ddply(Lochelbank8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank8_gr_max <- sum(Lochelbank8_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank8_gr_max
Lochelbank8_gr_pres <- sum(Lochelbank8_grframelong_sum $max > 0)
Lochelbank8_gr_pres

#number of sites which would be classified as low
Lochelbank8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank8_grframelong_sum$max)
Lochelbank8_gr_lw_ref
#number of sites which would be classified as high
Lochelbank8_gr_high_ref <- sum( Lochelbank8_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank8_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank8_gr_mod_ref <- 1000 - (Lochelbank8_gr_high_ref + Lochelbank8_gr_lw_ref)
Lochelbank8_gr_mod_ref

#9 nights
Lochelbank9_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Lochelbank9_grframe<-data.frame(Lochelbank9_gr, samp2)
Lochelbank9_grframelong <- melt(Lochelbank9_grframe,id.vars="samp2")
Lochelbank9_grframelong_sum <- ddply(Lochelbank9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lochelbank9_gr_max <- sum(Lochelbank9_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank9_gr_max
Lochelbank9_gr_pres <- sum(Lochelbank9_grframelong_sum $max > 0)
Lochelbank9_gr_pres

#number of sites which would be classified as low
Lochelbank9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank9_grframelong_sum$max)
Lochelbank9_gr_lw_ref
#number of sites which would be classified as high
Lochelbank9_gr_high_ref <- sum( Lochelbank9_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank9_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank9_gr_mod_ref <- 1000 - (Lochelbank9_gr_high_ref + Lochelbank9_gr_lw_ref)
Lochelbank9_gr_mod_ref

#10 detectors
Lochelbank10_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Lochelbank10_grframe<-data.frame(Lochelbank10_gr, samp2)
Lochelbank10_grframelong <- melt(Lochelbank10_grframe,id.vars="samp2")
Lochelbank10_grframelong_sum <- ddply(Lochelbank10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank10_gr_max <- sum(Lochelbank10_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank10_gr_max
Lochelbank10_gr_pres <- sum(Lochelbank10_grframelong_sum $max > 0)
Lochelbank10_gr_pres

#number of sites which would be classified as low
Lochelbank10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank10_grframelong_sum$max)
Lochelbank10_gr_lw_ref
#number of sites which would be classified as high
Lochelbank10_gr_high_ref <- sum( Lochelbank10_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank10_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank10_gr_mod_ref <- 1000 - (Lochelbank10_gr_high_ref + Lochelbank10_gr_lw_ref)
Lochelbank10_gr_mod_ref

#11 detectors
Lochelbank11_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Lochelbank11_grframe<-data.frame(Lochelbank11_gr, samp2)
Lochelbank11_grframelong <- melt(Lochelbank11_grframe,id.vars="samp2")
Lochelbank11_grframelong_sum <- ddply(Lochelbank11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank11_gr_max <- sum(Lochelbank11_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank11_gr_max
Lochelbank11_gr_pres <- sum(Lochelbank11_grframelong_sum $max > 0)
Lochelbank11_gr_pres

#number of sites which would be classified as low
Lochelbank11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank11_grframelong_sum$max)
Lochelbank11_gr_lw_ref
#number of sites which would be classified as high
Lochelbank11_gr_high_ref <- sum( Lochelbank11_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank11_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank11_gr_mod_ref <- 1000 - (Lochelbank11_gr_high_ref + Lochelbank11_gr_lw_ref)
Lochelbank11_gr_mod_ref

#12 detectors
Lochelbank12_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Lochelbank12_grframe<-data.frame(Lochelbank12_gr, samp2)
Lochelbank12_grframelong <- melt(Lochelbank12_grframe,id.vars="samp2")
Lochelbank12_grframelong_sum <- ddply(Lochelbank12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank12_gr_max <- sum(Lochelbank12_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank12_gr_max
Lochelbank12_gr_pres <- sum(Lochelbank12_grframelong_sum $max > 0)
Lochelbank12_gr_pres

#number of sites which would be classified as low
Lochelbank12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank12_grframelong_sum$max)
Lochelbank12_gr_lw_ref
#number of sites which would be classified as high
Lochelbank12_gr_high_ref <- sum( Lochelbank12_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank12_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank12_gr_mod_ref <- 1000 - (Lochelbank12_gr_high_ref + Lochelbank12_gr_lw_ref)
Lochelbank12_gr_mod_ref

#13 detectors
Lochelbank13_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Lochelbank13_grframe<-data.frame(Lochelbank13_gr, samp2)
Lochelbank13_grframelong <- melt(Lochelbank13_grframe,id.vars="samp2")
Lochelbank13_grframelong_sum <- ddply(Lochelbank13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank13_gr_max <- sum(Lochelbank13_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank13_gr_max
Lochelbank13_gr_pres <- sum(Lochelbank13_grframelong_sum $max > 0)
Lochelbank13_gr_pres

#number of sites which would be classified as low
Lochelbank13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank13_grframelong_sum$max)
Lochelbank13_gr_lw_ref
#number of sites which would be classified as high
Lochelbank13_gr_high_ref <- sum( Lochelbank13_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank13_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank13_gr_mod_ref <- 1000 - (Lochelbank13_gr_high_ref + Lochelbank13_gr_lw_ref)
Lochelbank13_gr_mod_ref

#14 detectors
Lochelbank14_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Lochelbank14_grframe<-data.frame(Lochelbank14_gr, samp2)
Lochelbank14_grframelong <- melt(Lochelbank14_grframe,id.vars="samp2")
Lochelbank14_grframelong_sum <- ddply(Lochelbank14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank14_gr_max <- sum(Lochelbank14_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank14_gr_max
Lochelbank14_gr_pres <- sum(Lochelbank14_grframelong_sum $max > 0)
Lochelbank14_gr_pres

#number of sites which would be classified as low
Lochelbank14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank14_grframelong_sum$max)
Lochelbank14_gr_lw_ref
#number of sites which would be classified as high
Lochelbank14_gr_high_ref <- sum( Lochelbank14_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank14_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank14_gr_mod_ref <- 1000 - (Lochelbank14_gr_high_ref + Lochelbank14_gr_lw_ref)
Lochelbank14_gr_mod_ref

#15 detectors
Lochelbank15_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Lochelbank15_grframe<-data.frame(Lochelbank15_gr, samp2)
Lochelbank15_grframelong <- melt(Lochelbank15_grframe,id.vars="samp2")
Lochelbank15_grframelong_sum <- ddply(Lochelbank15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank15_gr_max <- sum(Lochelbank15_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank15_gr_max
Lochelbank15_gr_pres <- sum(Lochelbank15_grframelong_sum $max > 0)
Lochelbank15_gr_pres

#number of sites which would be classified as low
Lochelbank15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank15_grframelong_sum$max)
Lochelbank15_gr_lw_ref
#number of sites which would be classified as high
Lochelbank15_gr_high_ref <- sum( Lochelbank15_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank15_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank15_gr_mod_ref <- 1000 - (Lochelbank15_gr_high_ref + Lochelbank15_gr_lw_ref)
Lochelbank15_gr_mod_ref

#16 detectors
Lochelbank16_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Lochelbank16_grframe<-data.frame(Lochelbank16_gr, samp2)
Lochelbank16_grframelong <- melt(Lochelbank16_grframe,id.vars="samp2")
Lochelbank16_grframelong_sum <- ddply(Lochelbank16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank16_gr_max <- sum(Lochelbank16_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank16_gr_max
Lochelbank16_gr_pres <- sum(Lochelbank16_grframelong_sum $max > 0)
Lochelbank16_gr_pres

#number of sites which would be classified as low
Lochelbank16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank16_grframelong_sum$max)
Lochelbank16_gr_lw_ref
#number of sites which would be classified as high
Lochelbank16_gr_high_ref <- sum( Lochelbank16_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank16_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank16_gr_mod_ref <- 1000 - (Lochelbank16_gr_high_ref + Lochelbank16_gr_lw_ref)
Lochelbank16_gr_mod_ref

#17 detectors
Lochelbank17_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Lochelbank17_grframe<-data.frame(Lochelbank17_gr, samp2)
Lochelbank17_grframelong <- melt(Lochelbank17_grframe,id.vars="samp2")
Lochelbank17_grframelong_sum <- ddply(Lochelbank17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank17_gr_max <- sum(Lochelbank17_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank17_gr_max
Lochelbank17_gr_pres <- sum(Lochelbank17_grframelong_sum $max > 0)
Lochelbank17_gr_pres

#number of sites which would be classified as low
Lochelbank17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank17_grframelong_sum$max)
Lochelbank17_gr_lw_ref
#number of sites which would be classified as high
Lochelbank17_gr_high_ref <- sum( Lochelbank17_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank17_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank17_gr_mod_ref <- 1000 - (Lochelbank17_gr_high_ref + Lochelbank17_gr_lw_ref)
Lochelbank17_gr_mod_ref

#18 detectors
Lochelbank18_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Lochelbank18_grframe<-data.frame(Lochelbank18_gr, samp2)
Lochelbank18_grframelong <- melt(Lochelbank18_grframe,id.vars="samp2")
Lochelbank18_grframelong_sum <- ddply(Lochelbank18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank18_gr_max <- sum(Lochelbank18_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank18_gr_max
Lochelbank18_gr_pres <- sum(Lochelbank18_grframelong_sum $max > 0)
Lochelbank18_gr_pres

#number of sites which would be classified as low
Lochelbank18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank18_grframelong_sum$max)
Lochelbank18_gr_lw_ref
#number of sites which would be classified as high
Lochelbank18_gr_high_ref <- sum( Lochelbank18_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank18_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank18_gr_mod_ref <- 1000 - (Lochelbank18_gr_high_ref + Lochelbank18_gr_lw_ref)
Lochelbank18_gr_mod_ref

#19 detectors
Lochelbank19_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Lochelbank19_grframe<-data.frame(Lochelbank19_gr, samp2)
Lochelbank19_grframelong <- melt(Lochelbank19_grframe,id.vars="samp2")
Lochelbank19_grframelong_sum <- ddply(Lochelbank19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank19_gr_max <- sum(Lochelbank19_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank19_gr_max
Lochelbank19_gr_pres <- sum(Lochelbank19_grframelong_sum $max > 0)
Lochelbank19_gr_pres

#number of sites which would be classified as low
Lochelbank19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank19_grframelong_sum$max)
Lochelbank19_gr_lw_ref
#number of sites which would be classified as high
Lochelbank19_gr_high_ref <- sum( Lochelbank19_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank19_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank19_gr_mod_ref <- 1000 - (Lochelbank19_gr_high_ref + Lochelbank19_gr_lw_ref)
Lochelbank19_gr_mod_ref

#20 detectors
Lochelbank20_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Lochelbank20_grframe<-data.frame(Lochelbank20_gr, samp2)
Lochelbank20_grframelong <- melt(Lochelbank20_grframe,id.vars="samp2")
Lochelbank20_grframelong_sum <- ddply(Lochelbank20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank20_gr_max <- sum(Lochelbank20_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank20_gr_max
Lochelbank20_gr_pres <- sum(Lochelbank20_grframelong_sum $max > 0)
Lochelbank20_gr_pres

#number of sites which would be classified as low
Lochelbank20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank20_grframelong_sum$max)
Lochelbank20_gr_lw_ref
#number of sites which would be classified as high
Lochelbank20_gr_high_ref <- sum( Lochelbank20_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank20_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank20_gr_mod_ref <- 1000 - (Lochelbank20_gr_high_ref + Lochelbank20_gr_lw_ref)
Lochelbank20_gr_mod_ref

#21 detectors
Lochelbank21_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Lochelbank21_grframe<-data.frame(Lochelbank21_gr, samp2)
Lochelbank21_grframelong <- melt(Lochelbank21_grframe,id.vars="samp2")
Lochelbank21_grframelong_sum <- ddply(Lochelbank21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank21_gr_max <- sum(Lochelbank21_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank21_gr_max
Lochelbank21_gr_pres <- sum(Lochelbank21_grframelong_sum $max > 0)
Lochelbank21_gr_pres

#number of sites which would be classified as low
Lochelbank21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank21_grframelong_sum$max)
Lochelbank21_gr_lw_ref
#number of sites which would be classified as high
Lochelbank21_gr_high_ref <- sum( Lochelbank21_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank21_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank21_gr_mod_ref <- 1000 - (Lochelbank21_gr_high_ref + Lochelbank21_gr_lw_ref)
Lochelbank21_gr_mod_ref

#22 detectors
Lochelbank22_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Lochelbank22_grframe<-data.frame(Lochelbank22_gr, samp2)
Lochelbank22_grframelong <- melt(Lochelbank22_grframe,id.vars="samp2")
Lochelbank22_grframelong_sum <- ddply(Lochelbank22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank22_gr_max <- sum(Lochelbank22_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank22_gr_max
Lochelbank22_gr_pres <- sum(Lochelbank22_grframelong_sum $max > 0)
Lochelbank22_gr_pres

#number of sites which would be classified as low
Lochelbank22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank22_grframelong_sum$max)
Lochelbank22_gr_lw_ref
#number of sites which would be classified as high
Lochelbank22_gr_high_ref <- sum( Lochelbank22_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank22_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank22_gr_mod_ref <- 1000 - (Lochelbank22_gr_high_ref + Lochelbank22_gr_lw_ref)
Lochelbank22_gr_mod_ref

#23 detectors
Lochelbank23_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Lochelbank23_grframe<-data.frame(Lochelbank23_gr, samp2)
Lochelbank23_grframelong <- melt(Lochelbank23_grframe,id.vars="samp2")
Lochelbank23_grframelong_sum <- ddply(Lochelbank23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank23_gr_max <- sum(Lochelbank23_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank23_gr_max
Lochelbank23_gr_pres <- sum(Lochelbank23_grframelong_sum $max > 0)
Lochelbank23_gr_pres

#number of sites which would be classified as low
Lochelbank23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank23_grframelong_sum$max)
Lochelbank23_gr_lw_ref
#number of sites which would be classified as high
Lochelbank23_gr_high_ref <- sum( Lochelbank23_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank23_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank23_gr_mod_ref <- 1000 - (Lochelbank23_gr_high_ref + Lochelbank23_gr_lw_ref)
Lochelbank23_gr_mod_ref

#24 detectors
Lochelbank24_gr<-(replicate(1000, (sample(Lochelbankpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Lochelbank24_grframe<-data.frame(Lochelbank24_gr, samp2)
Lochelbank24_grframelong <- melt(Lochelbank24_grframe,id.vars="samp2")
Lochelbank24_grframelong_sum <- ddply(Lochelbank24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Lochelbank24_gr_max <- sum(Lochelbank24_grframelong_sum $max > max20_Lochelbankpipgr)
Lochelbank24_gr_max
Lochelbank24_gr_pres <- sum(Lochelbank24_grframelong_sum $max > 0)
Lochelbank24_gr_pres

#number of sites which would be classified as low
Lochelbank24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lochelbank24_grframelong_sum$max)
Lochelbank24_gr_lw_ref
#number of sites which would be classified as high
Lochelbank24_gr_high_ref <- sum( Lochelbank24_grframelong_sum$max > allsppgr_ppip_ref_high)
Lochelbank24_gr_high_ref
#number of sites which would be classified as moderate
Lochelbank24_gr_mod_ref <- 1000 - (Lochelbank24_gr_high_ref + Lochelbank24_gr_lw_ref)
Lochelbank24_gr_mod_ref

Present<-c(Lochelbank1_gr_pres,Lochelbank2_gr_pres,
           Lochelbank3_gr_pres,Lochelbank4_gr_pres,
           Lochelbank5_gr_pres,Lochelbank6_gr_pres,
           Lochelbank7_gr_pres,Lochelbank8_gr_pres,
           Lochelbank9_gr_pres,Lochelbank10_gr_pres,
           Lochelbank11_gr_pres,Lochelbank12_gr_pres,
           Lochelbank13_gr_pres,Lochelbank14_gr_pres,
           Lochelbank15_gr_pres,Lochelbank16_gr_pres,
           Lochelbank17_gr_pres,Lochelbank18_gr_pres,
           Lochelbank19_gr_pres,Lochelbank20_gr_pres,
           Lochelbank21_gr_pres,Lochelbank22_gr_pres,
           Lochelbank23_gr_pres,Lochelbank24_gr_pres)


Maximum<-c(Lochelbank1_gr_max,Lochelbank2_gr_max,
           Lochelbank3_gr_max,Lochelbank4_gr_max,
           Lochelbank5_gr_max,Lochelbank6_gr_max,
           Lochelbank7_gr_max,Lochelbank8_gr_max,
           Lochelbank9_gr_max,Lochelbank10_gr_max,
           Lochelbank11_gr_max,Lochelbank12_gr_max,
           Lochelbank13_gr_max,Lochelbank14_gr_max,
           Lochelbank15_gr_max,Lochelbank16_gr_max,
           Lochelbank17_gr_max,Lochelbank18_gr_max,
           Lochelbank19_gr_max,Lochelbank20_gr_max,
           Lochelbank21_gr_max,Lochelbank22_gr_max,
           Lochelbank23_gr_max,Lochelbank24_gr_max)

Low<-c(Lochelbank1_gr_lw_ref, Lochelbank2_gr_lw_ref, Lochelbank3_gr_lw_ref,
       Lochelbank4_gr_lw_ref, Lochelbank5_gr_lw_ref, Lochelbank6_gr_lw_ref,
       Lochelbank7_gr_lw_ref, Lochelbank8_gr_lw_ref, Lochelbank9_gr_lw_ref,
       Lochelbank10_gr_lw_ref, Lochelbank11_gr_lw_ref, Lochelbank12_gr_lw_ref, 
       Lochelbank13_gr_lw_ref, Lochelbank14_gr_lw_ref, Lochelbank15_gr_lw_ref, 
       Lochelbank16_gr_lw_ref, Lochelbank17_gr_lw_ref, Lochelbank18_gr_lw_ref, 
       Lochelbank19_gr_lw_ref, Lochelbank20_gr_lw_ref, Lochelbank21_gr_lw_ref,
       Lochelbank22_gr_lw_ref,Lochelbank23_gr_lw_ref,Lochelbank24_gr_lw_ref)

Moderate<-c(Lochelbank1_gr_mod_ref, Lochelbank2_gr_mod_ref, Lochelbank3_gr_mod_ref,
            Lochelbank4_gr_mod_ref, Lochelbank5_gr_mod_ref, Lochelbank6_gr_mod_ref,
            Lochelbank7_gr_mod_ref, Lochelbank8_gr_mod_ref, Lochelbank9_gr_mod_ref,
            Lochelbank10_gr_mod_ref, Lochelbank11_gr_mod_ref, Lochelbank12_gr_mod_ref, 
            Lochelbank13_gr_mod_ref, Lochelbank14_gr_mod_ref, Lochelbank15_gr_mod_ref, 
            Lochelbank16_gr_mod_ref, Lochelbank17_gr_mod_ref, Lochelbank18_gr_mod_ref, 
            Lochelbank19_gr_mod_ref, Lochelbank20_gr_mod_ref, Lochelbank21_gr_mod_ref,
            Lochelbank22_gr_mod_ref,Lochelbank23_gr_mod_ref,Lochelbank24_gr_mod_ref)

High<-c(Lochelbank1_gr_high_ref, Lochelbank2_gr_high_ref, Lochelbank3_gr_high_ref,
        Lochelbank4_gr_high_ref, Lochelbank5_gr_high_ref, Lochelbank6_gr_high_ref,
        Lochelbank7_gr_high_ref, Lochelbank8_gr_high_ref, Lochelbank9_gr_high_ref,
        Lochelbank10_gr_high_ref, Lochelbank11_gr_high_ref, Lochelbank12_gr_high_ref, 
        Lochelbank13_gr_high_ref, Lochelbank14_gr_high_ref, Lochelbank15_gr_high_ref, 
        Lochelbank16_gr_high_ref, Lochelbank17_gr_high_ref, Lochelbank18_gr_high_ref, 
        Lochelbank19_gr_high_ref, Lochelbank20_gr_high_ref, Lochelbank21_gr_high_ref,
        Lochelbank22_gr_high_ref,Lochelbank23_gr_high_ref,Lochelbank24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Lochelbankgr",24)
Lowsite <- Lochelbanklow
Modsite <- Lochelbankmod
Highsite <-Lochelbankhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Lochelbankgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Lowca

Lowcapipgr<-subset(allspp4gr_ppip, Site=="Lowca")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Lowcapipgr<-max(Lowcapipgr$Passes)

#calculate 20% from maximum nightly record

max20_Lowcapipgr<- (max_Lowcapipgr/100)*80

##calculate the site classification (reference range)

Lowcahigh<- max_Lowcapipgr > allsppgr_ppip_ref_high

Lowcalow<- allsppgr_ppip_ref_low > max_Lowcapipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Lowcapipgr
Lowcamod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Lowca1_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 1, replace=F))))
Lowca1_gr_max <- sum(Lowca1_gr > max20_Lowcapipgr)
Lowca1_gr_max
Lowca1_gr_pres <- sum(Lowca1_gr > 0)
Lowca1_gr_pres
#number of sites which would be classified as low
Lowca1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca1_gr)
Lowca1_gr_lw_ref
#number of sites which would be classified as high
Lowca1_gr_high_ref <- sum( Lowca1_gr > allsppgr_ppip_ref_high)
Lowca1_gr_high_ref
#number of sites which would be classified as moderate
Lowca1_gr_mod_ref <- 1000 - (Lowca1_gr_high_ref + Lowca1_gr_lw_ref)
Lowca1_gr_mod_ref


#2 nights
Lowca2_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Lowca2_grframe<-data.frame(Lowca2_gr, samp2)
Lowca2_grframelong <- melt(Lowca2_grframe,id.vars="samp2")
Lowca2_grframelong_sum <- ddply(Lowca2_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca2_gr_max <- sum(Lowca2_grframelong_sum $max > max20_Lowcapipgr)
Lowca2_gr_max
Lowca2_gr_pres <- sum(Lowca2_grframelong_sum $max > 0)
Lowca2_gr_pres

#number of sites which would be classified as low
Lowca2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca2_grframelong_sum$max)
Lowca2_gr_lw_ref
#number of sites which would be classified as high
Lowca2_gr_high_ref <- sum( Lowca2_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca2_gr_high_ref
#number of sites which would be classified as moderate
Lowca2_gr_mod_ref <- 1000 - (Lowca2_gr_high_ref + Lowca2_gr_lw_ref)
Lowca2_gr_mod_ref


#3 nights
Lowca3_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Lowca3_grframe<-data.frame(Lowca3_gr, samp2)
Lowca3_grframelong <- melt(Lowca3_grframe,id.vars="samp2")
Lowca3_grframelong_sum <- ddply(Lowca3_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca3_gr_max <- sum(Lowca3_grframelong_sum $max > max20_Lowcapipgr)
Lowca3_gr_max
Lowca3_gr_pres <- sum(Lowca3_grframelong_sum $max > 0)
Lowca3_gr_pres

#number of sites which would be classified as low
Lowca3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca3_grframelong_sum$max)
Lowca3_gr_lw_ref
#number of sites which would be classified as high
Lowca3_gr_high_ref <- sum( Lowca3_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca3_gr_high_ref
#number of sites which would be classified as moderate
Lowca3_gr_mod_ref <- 1000 - (Lowca3_gr_high_ref + Lowca3_gr_lw_ref)
Lowca3_gr_mod_ref

#4 nights
Lowca4_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Lowca4_grframe<-data.frame(Lowca4_gr, samp2)
Lowca4_grframelong <- melt(Lowca4_grframe,id.vars="samp2")
Lowca4_grframelong_sum <- ddply(Lowca4_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca4_gr_max <- sum(Lowca4_grframelong_sum $max > max20_Lowcapipgr)
Lowca4_gr_max
Lowca4_gr_pres <- sum(Lowca4_grframelong_sum $max > 0)
Lowca4_gr_pres

#number of sites which would be classified as low
Lowca4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca4_grframelong_sum$max)
Lowca4_gr_lw_ref
#number of sites which would be classified as high
Lowca4_gr_high_ref <- sum( Lowca4_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca4_gr_high_ref
#number of sites which would be classified as moderate
Lowca4_gr_mod_ref <- 1000 - (Lowca4_gr_high_ref + Lowca4_gr_lw_ref)
Lowca4_gr_mod_ref

#5 nights
Lowca5_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Lowca5_grframe<-data.frame(Lowca5_gr, samp2)
Lowca5_grframelong <- melt(Lowca5_grframe,id.vars="samp2")
Lowca5_grframelong_sum <- ddply(Lowca5_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca5_gr_max <- sum(Lowca5_grframelong_sum $max > max20_Lowcapipgr)
Lowca5_gr_max
Lowca5_gr_pres <- sum(Lowca5_grframelong_sum $max > 0)
Lowca5_gr_pres

#number of sites which would be classified as low
Lowca5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca5_grframelong_sum$max)
Lowca5_gr_lw_ref
#number of sites which would be classified as high
Lowca5_gr_high_ref <- sum( Lowca5_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca5_gr_high_ref
#number of sites which would be classified as moderate
Lowca5_gr_mod_ref <- 1000 - (Lowca5_gr_high_ref + Lowca5_gr_lw_ref)
Lowca5_gr_mod_ref

#6 nights
Lowca6_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Lowca6_grframe<-data.frame(Lowca6_gr, samp2)
Lowca6_grframelong <- melt(Lowca6_grframe,id.vars="samp2")
Lowca6_grframelong_sum <- ddply(Lowca6_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca6_gr_max <- sum(Lowca6_grframelong_sum $max > max20_Lowcapipgr)
Lowca6_gr_max
Lowca6_gr_pres <- sum(Lowca6_grframelong_sum $max > 0)
Lowca6_gr_pres

#number of sites which would be classified as low
Lowca6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca6_grframelong_sum$max)
Lowca6_gr_lw_ref
#number of sites which would be classified as high
Lowca6_gr_high_ref <- sum( Lowca6_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca6_gr_high_ref
#number of sites which would be classified as moderate
Lowca6_gr_mod_ref <- 1000 - (Lowca6_gr_high_ref + Lowca6_gr_lw_ref)
Lowca6_gr_mod_ref

#7 nights
Lowca7_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Lowca7_grframe<-data.frame(Lowca7_gr, samp2)
Lowca7_grframelong <- melt(Lowca7_grframe,id.vars="samp2")
Lowca7_grframelong_sum <- ddply(Lowca7_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca7_gr_max <- sum(Lowca7_grframelong_sum $max > max20_Lowcapipgr)
Lowca7_gr_max
Lowca7_gr_pres <- sum(Lowca7_grframelong_sum $max > 0)
Lowca7_gr_pres

#number of sites which would be classified as low
Lowca7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca7_grframelong_sum$max)
Lowca7_gr_lw_ref
#number of sites which would be classified as high
Lowca7_gr_high_ref <- sum( Lowca7_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca7_gr_high_ref
#number of sites which would be classified as moderate
Lowca7_gr_mod_ref <- 1000 - (Lowca7_gr_high_ref + Lowca7_gr_lw_ref)
Lowca7_gr_mod_ref

#8 nights
Lowca8_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Lowca8_grframe<-data.frame(Lowca8_gr, samp2)
Lowca8_grframelong <- melt(Lowca8_grframe,id.vars="samp2")
Lowca8_grframelong_sum <- ddply(Lowca8_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca8_gr_max <- sum(Lowca8_grframelong_sum $max > max20_Lowcapipgr)
Lowca8_gr_max
Lowca8_gr_pres <- sum(Lowca8_grframelong_sum $max > 0)
Lowca8_gr_pres

#number of sites which would be classified as low
Lowca8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca8_grframelong_sum$max)
Lowca8_gr_lw_ref
#number of sites which would be classified as high
Lowca8_gr_high_ref <- sum( Lowca8_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca8_gr_high_ref
#number of sites which would be classified as moderate
Lowca8_gr_mod_ref <- 1000 - (Lowca8_gr_high_ref + Lowca8_gr_lw_ref)
Lowca8_gr_mod_ref

#9 nights
Lowca9_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Lowca9_grframe<-data.frame(Lowca9_gr, samp2)
Lowca9_grframelong <- melt(Lowca9_grframe,id.vars="samp2")
Lowca9_grframelong_sum <- ddply(Lowca9_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Lowca9_gr_max <- sum(Lowca9_grframelong_sum $max > max20_Lowcapipgr)
Lowca9_gr_max
Lowca9_gr_pres <- sum(Lowca9_grframelong_sum $max > 0)
Lowca9_gr_pres

#number of sites which would be classified as low
Lowca9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca9_grframelong_sum$max)
Lowca9_gr_lw_ref
#number of sites which would be classified as high
Lowca9_gr_high_ref <- sum( Lowca9_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca9_gr_high_ref
#number of sites which would be classified as moderate
Lowca9_gr_mod_ref <- 1000 - (Lowca9_gr_high_ref + Lowca9_gr_lw_ref)
Lowca9_gr_mod_ref

#10 detectors
Lowca10_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Lowca10_grframe<-data.frame(Lowca10_gr, samp2)
Lowca10_grframelong <- melt(Lowca10_grframe,id.vars="samp2")
Lowca10_grframelong_sum <- ddply(Lowca10_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca10_gr_max <- sum(Lowca10_grframelong_sum $max > max20_Lowcapipgr)
Lowca10_gr_max
Lowca10_gr_pres <- sum(Lowca10_grframelong_sum $max > 0)
Lowca10_gr_pres

#number of sites which would be classified as low
Lowca10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca10_grframelong_sum$max)
Lowca10_gr_lw_ref
#number of sites which would be classified as high
Lowca10_gr_high_ref <- sum( Lowca10_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca10_gr_high_ref
#number of sites which would be classified as moderate
Lowca10_gr_mod_ref <- 1000 - (Lowca10_gr_high_ref + Lowca10_gr_lw_ref)
Lowca10_gr_mod_ref

#11 detectors
Lowca11_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Lowca11_grframe<-data.frame(Lowca11_gr, samp2)
Lowca11_grframelong <- melt(Lowca11_grframe,id.vars="samp2")
Lowca11_grframelong_sum <- ddply(Lowca11_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca11_gr_max <- sum(Lowca11_grframelong_sum $max > max20_Lowcapipgr)
Lowca11_gr_max
Lowca11_gr_pres <- sum(Lowca11_grframelong_sum $max > 0)
Lowca11_gr_pres

#number of sites which would be classified as low
Lowca11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca11_grframelong_sum$max)
Lowca11_gr_lw_ref
#number of sites which would be classified as high
Lowca11_gr_high_ref <- sum( Lowca11_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca11_gr_high_ref
#number of sites which would be classified as moderate
Lowca11_gr_mod_ref <- 1000 - (Lowca11_gr_high_ref + Lowca11_gr_lw_ref)
Lowca11_gr_mod_ref

#12 detectors
Lowca12_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Lowca12_grframe<-data.frame(Lowca12_gr, samp2)
Lowca12_grframelong <- melt(Lowca12_grframe,id.vars="samp2")
Lowca12_grframelong_sum <- ddply(Lowca12_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca12_gr_max <- sum(Lowca12_grframelong_sum $max > max20_Lowcapipgr)
Lowca12_gr_max
Lowca12_gr_pres <- sum(Lowca12_grframelong_sum $max > 0)
Lowca12_gr_pres

#number of sites which would be classified as low
Lowca12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca12_grframelong_sum$max)
Lowca12_gr_lw_ref
#number of sites which would be classified as high
Lowca12_gr_high_ref <- sum( Lowca12_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca12_gr_high_ref
#number of sites which would be classified as moderate
Lowca12_gr_mod_ref <- 1000 - (Lowca12_gr_high_ref + Lowca12_gr_lw_ref)
Lowca12_gr_mod_ref

#13 detectors
Lowca13_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Lowca13_grframe<-data.frame(Lowca13_gr, samp2)
Lowca13_grframelong <- melt(Lowca13_grframe,id.vars="samp2")
Lowca13_grframelong_sum <- ddply(Lowca13_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca13_gr_max <- sum(Lowca13_grframelong_sum $max > max20_Lowcapipgr)
Lowca13_gr_max
Lowca13_gr_pres <- sum(Lowca13_grframelong_sum $max > 0)
Lowca13_gr_pres

#number of sites which would be classified as low
Lowca13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca13_grframelong_sum$max)
Lowca13_gr_lw_ref
#number of sites which would be classified as high
Lowca13_gr_high_ref <- sum( Lowca13_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca13_gr_high_ref
#number of sites which would be classified as moderate
Lowca13_gr_mod_ref <- 1000 - (Lowca13_gr_high_ref + Lowca13_gr_lw_ref)
Lowca13_gr_mod_ref

#14 detectors
Lowca14_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Lowca14_grframe<-data.frame(Lowca14_gr, samp2)
Lowca14_grframelong <- melt(Lowca14_grframe,id.vars="samp2")
Lowca14_grframelong_sum <- ddply(Lowca14_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca14_gr_max <- sum(Lowca14_grframelong_sum $max > max20_Lowcapipgr)
Lowca14_gr_max
Lowca14_gr_pres <- sum(Lowca14_grframelong_sum $max > 0)
Lowca14_gr_pres

#number of sites which would be classified as low
Lowca14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca14_grframelong_sum$max)
Lowca14_gr_lw_ref
#number of sites which would be classified as high
Lowca14_gr_high_ref <- sum( Lowca14_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca14_gr_high_ref
#number of sites which would be classified as moderate
Lowca14_gr_mod_ref <- 1000 - (Lowca14_gr_high_ref + Lowca14_gr_lw_ref)
Lowca14_gr_mod_ref

#15 detectors
Lowca15_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Lowca15_grframe<-data.frame(Lowca15_gr, samp2)
Lowca15_grframelong <- melt(Lowca15_grframe,id.vars="samp2")
Lowca15_grframelong_sum <- ddply(Lowca15_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca15_gr_max <- sum(Lowca15_grframelong_sum $max > max20_Lowcapipgr)
Lowca15_gr_max
Lowca15_gr_pres <- sum(Lowca15_grframelong_sum $max > 0)
Lowca15_gr_pres

#number of sites which would be classified as low
Lowca15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca15_grframelong_sum$max)
Lowca15_gr_lw_ref
#number of sites which would be classified as high
Lowca15_gr_high_ref <- sum( Lowca15_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca15_gr_high_ref
#number of sites which would be classified as moderate
Lowca15_gr_mod_ref <- 1000 - (Lowca15_gr_high_ref + Lowca15_gr_lw_ref)
Lowca15_gr_mod_ref

#16 detectors
Lowca16_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Lowca16_grframe<-data.frame(Lowca16_gr, samp2)
Lowca16_grframelong <- melt(Lowca16_grframe,id.vars="samp2")
Lowca16_grframelong_sum <- ddply(Lowca16_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca16_gr_max <- sum(Lowca16_grframelong_sum $max > max20_Lowcapipgr)
Lowca16_gr_max
Lowca16_gr_pres <- sum(Lowca16_grframelong_sum $max > 0)
Lowca16_gr_pres

#number of sites which would be classified as low
Lowca16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca16_grframelong_sum$max)
Lowca16_gr_lw_ref
#number of sites which would be classified as high
Lowca16_gr_high_ref <- sum( Lowca16_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca16_gr_high_ref
#number of sites which would be classified as moderate
Lowca16_gr_mod_ref <- 1000 - (Lowca16_gr_high_ref + Lowca16_gr_lw_ref)
Lowca16_gr_mod_ref

#17 detectors
Lowca17_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Lowca17_grframe<-data.frame(Lowca17_gr, samp2)
Lowca17_grframelong <- melt(Lowca17_grframe,id.vars="samp2")
Lowca17_grframelong_sum <- ddply(Lowca17_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca17_gr_max <- sum(Lowca17_grframelong_sum $max > max20_Lowcapipgr)
Lowca17_gr_max
Lowca17_gr_pres <- sum(Lowca17_grframelong_sum $max > 0)
Lowca17_gr_pres

#number of sites which would be classified as low
Lowca17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca17_grframelong_sum$max)
Lowca17_gr_lw_ref
#number of sites which would be classified as high
Lowca17_gr_high_ref <- sum( Lowca17_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca17_gr_high_ref
#number of sites which would be classified as moderate
Lowca17_gr_mod_ref <- 1000 - (Lowca17_gr_high_ref + Lowca17_gr_lw_ref)
Lowca17_gr_mod_ref

#18 detectors
Lowca18_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Lowca18_grframe<-data.frame(Lowca18_gr, samp2)
Lowca18_grframelong <- melt(Lowca18_grframe,id.vars="samp2")
Lowca18_grframelong_sum <- ddply(Lowca18_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca18_gr_max <- sum(Lowca18_grframelong_sum $max > max20_Lowcapipgr)
Lowca18_gr_max
Lowca18_gr_pres <- sum(Lowca18_grframelong_sum $max > 0)
Lowca18_gr_pres

#number of sites which would be classified as low
Lowca18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca18_grframelong_sum$max)
Lowca18_gr_lw_ref
#number of sites which would be classified as high
Lowca18_gr_high_ref <- sum( Lowca18_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca18_gr_high_ref
#number of sites which would be classified as moderate
Lowca18_gr_mod_ref <- 1000 - (Lowca18_gr_high_ref + Lowca18_gr_lw_ref)
Lowca18_gr_mod_ref

#19 detectors
Lowca19_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Lowca19_grframe<-data.frame(Lowca19_gr, samp2)
Lowca19_grframelong <- melt(Lowca19_grframe,id.vars="samp2")
Lowca19_grframelong_sum <- ddply(Lowca19_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca19_gr_max <- sum(Lowca19_grframelong_sum $max > max20_Lowcapipgr)
Lowca19_gr_max
Lowca19_gr_pres <- sum(Lowca19_grframelong_sum $max > 0)
Lowca19_gr_pres

#number of sites which would be classified as low
Lowca19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca19_grframelong_sum$max)
Lowca19_gr_lw_ref
#number of sites which would be classified as high
Lowca19_gr_high_ref <- sum( Lowca19_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca19_gr_high_ref
#number of sites which would be classified as moderate
Lowca19_gr_mod_ref <- 1000 - (Lowca19_gr_high_ref + Lowca19_gr_lw_ref)
Lowca19_gr_mod_ref

#20 detectors
Lowca20_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Lowca20_grframe<-data.frame(Lowca20_gr, samp2)
Lowca20_grframelong <- melt(Lowca20_grframe,id.vars="samp2")
Lowca20_grframelong_sum <- ddply(Lowca20_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca20_gr_max <- sum(Lowca20_grframelong_sum $max > max20_Lowcapipgr)
Lowca20_gr_max
Lowca20_gr_pres <- sum(Lowca20_grframelong_sum $max > 0)
Lowca20_gr_pres

#number of sites which would be classified as low
Lowca20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca20_grframelong_sum$max)
Lowca20_gr_lw_ref
#number of sites which would be classified as high
Lowca20_gr_high_ref <- sum( Lowca20_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca20_gr_high_ref
#number of sites which would be classified as moderate
Lowca20_gr_mod_ref <- 1000 - (Lowca20_gr_high_ref + Lowca20_gr_lw_ref)
Lowca20_gr_mod_ref

#21 detectors
Lowca21_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Lowca21_grframe<-data.frame(Lowca21_gr, samp2)
Lowca21_grframelong <- melt(Lowca21_grframe,id.vars="samp2")
Lowca21_grframelong_sum <- ddply(Lowca21_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca21_gr_max <- sum(Lowca21_grframelong_sum $max > max20_Lowcapipgr)
Lowca21_gr_max
Lowca21_gr_pres <- sum(Lowca21_grframelong_sum $max > 0)
Lowca21_gr_pres

#number of sites which would be classified as low
Lowca21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca21_grframelong_sum$max)
Lowca21_gr_lw_ref
#number of sites which would be classified as high
Lowca21_gr_high_ref <- sum( Lowca21_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca21_gr_high_ref
#number of sites which would be classified as moderate
Lowca21_gr_mod_ref <- 1000 - (Lowca21_gr_high_ref + Lowca21_gr_lw_ref)
Lowca21_gr_mod_ref

#22 detectors
Lowca22_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Lowca22_grframe<-data.frame(Lowca22_gr, samp2)
Lowca22_grframelong <- melt(Lowca22_grframe,id.vars="samp2")
Lowca22_grframelong_sum <- ddply(Lowca22_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca22_gr_max <- sum(Lowca22_grframelong_sum $max > max20_Lowcapipgr)
Lowca22_gr_max
Lowca22_gr_pres <- sum(Lowca22_grframelong_sum $max > 0)
Lowca22_gr_pres

#number of sites which would be classified as low
Lowca22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca22_grframelong_sum$max)
Lowca22_gr_lw_ref
#number of sites which would be classified as high
Lowca22_gr_high_ref <- sum( Lowca22_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca22_gr_high_ref
#number of sites which would be classified as moderate
Lowca22_gr_mod_ref <- 1000 - (Lowca22_gr_high_ref + Lowca22_gr_lw_ref)
Lowca22_gr_mod_ref

#23 detectors
Lowca23_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Lowca23_grframe<-data.frame(Lowca23_gr, samp2)
Lowca23_grframelong <- melt(Lowca23_grframe,id.vars="samp2")
Lowca23_grframelong_sum <- ddply(Lowca23_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca23_gr_max <- sum(Lowca23_grframelong_sum $max > max20_Lowcapipgr)
Lowca23_gr_max
Lowca23_gr_pres <- sum(Lowca23_grframelong_sum $max > 0)
Lowca23_gr_pres

#number of sites which would be classified as low
Lowca23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca23_grframelong_sum$max)
Lowca23_gr_lw_ref
#number of sites which would be classified as high
Lowca23_gr_high_ref <- sum( Lowca23_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca23_gr_high_ref
#number of sites which would be classified as moderate
Lowca23_gr_mod_ref <- 1000 - (Lowca23_gr_high_ref + Lowca23_gr_lw_ref)
Lowca23_gr_mod_ref

#24 detectors
Lowca24_gr<-(replicate(1000, (sample(Lowcapipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Lowca24_grframe<-data.frame(Lowca24_gr, samp2)
Lowca24_grframelong <- melt(Lowca24_grframe,id.vars="samp2")
Lowca24_grframelong_sum <- ddply(Lowca24_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Lowca24_gr_max <- sum(Lowca24_grframelong_sum $max > max20_Lowcapipgr)
Lowca24_gr_max
Lowca24_gr_pres <- sum(Lowca24_grframelong_sum $max > 0)
Lowca24_gr_pres

#number of sites which would be classified as low
Lowca24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lowca24_grframelong_sum$max)
Lowca24_gr_lw_ref
#number of sites which would be classified as high
Lowca24_gr_high_ref <- sum( Lowca24_grframelong_sum$max > allsppgr_ppip_ref_high)
Lowca24_gr_high_ref
#number of sites which would be classified as moderate
Lowca24_gr_mod_ref <- 1000 - (Lowca24_gr_high_ref + Lowca24_gr_lw_ref)
Lowca24_gr_mod_ref

Present<-c(Lowca1_gr_pres,Lowca2_gr_pres,
           Lowca3_gr_pres,Lowca4_gr_pres,
           Lowca5_gr_pres,Lowca6_gr_pres,
           Lowca7_gr_pres,Lowca8_gr_pres,
           Lowca9_gr_pres,Lowca10_gr_pres,
           Lowca11_gr_pres,Lowca12_gr_pres,
           Lowca13_gr_pres,Lowca14_gr_pres,
           Lowca15_gr_pres,Lowca16_gr_pres,
           Lowca17_gr_pres,Lowca18_gr_pres,
           Lowca19_gr_pres,Lowca20_gr_pres,
           Lowca21_gr_pres,Lowca22_gr_pres,
           Lowca23_gr_pres,Lowca24_gr_pres)


Maximum<-c(Lowca1_gr_max,Lowca2_gr_max,
           Lowca3_gr_max,Lowca4_gr_max,
           Lowca5_gr_max,Lowca6_gr_max,
           Lowca7_gr_max,Lowca8_gr_max,
           Lowca9_gr_max,Lowca10_gr_max,
           Lowca11_gr_max,Lowca12_gr_max,
           Lowca13_gr_max,Lowca14_gr_max,
           Lowca15_gr_max,Lowca16_gr_max,
           Lowca17_gr_max,Lowca18_gr_max,
           Lowca19_gr_max,Lowca20_gr_max,
           Lowca21_gr_max,Lowca22_gr_max,
           Lowca23_gr_max,Lowca24_gr_max)

Low<-c(Lowca1_gr_lw_ref, Lowca2_gr_lw_ref, Lowca3_gr_lw_ref,
       Lowca4_gr_lw_ref, Lowca5_gr_lw_ref, Lowca6_gr_lw_ref,
       Lowca7_gr_lw_ref, Lowca8_gr_lw_ref, Lowca9_gr_lw_ref,
       Lowca10_gr_lw_ref, Lowca11_gr_lw_ref, Lowca12_gr_lw_ref, 
       Lowca13_gr_lw_ref, Lowca14_gr_lw_ref, Lowca15_gr_lw_ref, 
       Lowca16_gr_lw_ref, Lowca17_gr_lw_ref, Lowca18_gr_lw_ref, 
       Lowca19_gr_lw_ref, Lowca20_gr_lw_ref, Lowca21_gr_lw_ref,
       Lowca22_gr_lw_ref,Lowca23_gr_lw_ref,Lowca24_gr_lw_ref)

Moderate<-c(Lowca1_gr_mod_ref, Lowca2_gr_mod_ref, Lowca3_gr_mod_ref,
            Lowca4_gr_mod_ref, Lowca5_gr_mod_ref, Lowca6_gr_mod_ref,
            Lowca7_gr_mod_ref, Lowca8_gr_mod_ref, Lowca9_gr_mod_ref,
            Lowca10_gr_mod_ref, Lowca11_gr_mod_ref, Lowca12_gr_mod_ref, 
            Lowca13_gr_mod_ref, Lowca14_gr_mod_ref, Lowca15_gr_mod_ref, 
            Lowca16_gr_mod_ref, Lowca17_gr_mod_ref, Lowca18_gr_mod_ref, 
            Lowca19_gr_mod_ref, Lowca20_gr_mod_ref, Lowca21_gr_mod_ref,
            Lowca22_gr_mod_ref,Lowca23_gr_mod_ref,Lowca24_gr_mod_ref)

High<-c(Lowca1_gr_high_ref, Lowca2_gr_high_ref, Lowca3_gr_high_ref,
        Lowca4_gr_high_ref, Lowca5_gr_high_ref, Lowca6_gr_high_ref,
        Lowca7_gr_high_ref, Lowca8_gr_high_ref, Lowca9_gr_high_ref,
        Lowca10_gr_high_ref, Lowca11_gr_high_ref, Lowca12_gr_high_ref, 
        Lowca13_gr_high_ref, Lowca14_gr_high_ref, Lowca15_gr_high_ref, 
        Lowca16_gr_high_ref, Lowca17_gr_high_ref, Lowca18_gr_high_ref, 
        Lowca19_gr_high_ref, Lowca20_gr_high_ref, Lowca21_gr_high_ref,
        Lowca22_gr_high_ref,Lowca23_gr_high_ref,Lowca24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Lowcagr",24)
Lowsite <- Lowcalow
Modsite <- Lowcamod
Highsite <-Lowcahigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Lowcagr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                            Site, Low, Moderate, High,
                            Lowsite, Modsite, Highsite)

##Lynemouth

Lynemouthpipgr<-subset(allspp4gr_ppip, Site=="Lynemouth")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Lynemouthpipgr<-max(Lynemouthpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Lynemouthpipgr<- (max_Lynemouthpipgr/100)*80

##calculate the site classification (reference range)

Lynemouthhigh<- max_Lynemouthpipgr > allsppgr_ppip_ref_high

Lynemouthlow<- allsppgr_ppip_ref_low > max_Lynemouthpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Lynemouthpipgr
Lynemouthmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Lynemouth1_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 1, replace=F))))
Lynemouth1_gr_max <- sum(Lynemouth1_gr > max20_Lynemouthpipgr)
Lynemouth1_gr_max
Lynemouth1_gr_pres <- sum(Lynemouth1_gr > 0)
Lynemouth1_gr_pres
#number of sites which would be classified as low
Lynemouth1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth1_gr)
Lynemouth1_gr_lw_ref
#number of sites which would be classified as high
Lynemouth1_gr_high_ref <- sum( Lynemouth1_gr > allsppgr_ppip_ref_high)
Lynemouth1_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth1_gr_mod_ref <- 1000 - (Lynemouth1_gr_high_ref + Lynemouth1_gr_lw_ref)
Lynemouth1_gr_mod_ref


#2 nights
Lynemouth2_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Lynemouth2_grframe<-data.frame(Lynemouth2_gr, samp2)
Lynemouth2_grframelong <- melt(Lynemouth2_grframe,id.vars="samp2")
Lynemouth2_grframelong_sum <- ddply(Lynemouth2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth2_gr_max <- sum(Lynemouth2_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth2_gr_max
Lynemouth2_gr_pres <- sum(Lynemouth2_grframelong_sum $max > 0)
Lynemouth2_gr_pres

#number of sites which would be classified as low
Lynemouth2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth2_grframelong_sum$max)
Lynemouth2_gr_lw_ref
#number of sites which would be classified as high
Lynemouth2_gr_high_ref <- sum( Lynemouth2_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth2_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth2_gr_mod_ref <- 1000 - (Lynemouth2_gr_high_ref + Lynemouth2_gr_lw_ref)
Lynemouth2_gr_mod_ref


#3 nights
Lynemouth3_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Lynemouth3_grframe<-data.frame(Lynemouth3_gr, samp2)
Lynemouth3_grframelong <- melt(Lynemouth3_grframe,id.vars="samp2")
Lynemouth3_grframelong_sum <- ddply(Lynemouth3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth3_gr_max <- sum(Lynemouth3_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth3_gr_max
Lynemouth3_gr_pres <- sum(Lynemouth3_grframelong_sum $max > 0)
Lynemouth3_gr_pres

#number of sites which would be classified as low
Lynemouth3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth3_grframelong_sum$max)
Lynemouth3_gr_lw_ref
#number of sites which would be classified as high
Lynemouth3_gr_high_ref <- sum( Lynemouth3_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth3_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth3_gr_mod_ref <- 1000 - (Lynemouth3_gr_high_ref + Lynemouth3_gr_lw_ref)
Lynemouth3_gr_mod_ref

#4 nights
Lynemouth4_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Lynemouth4_grframe<-data.frame(Lynemouth4_gr, samp2)
Lynemouth4_grframelong <- melt(Lynemouth4_grframe,id.vars="samp2")
Lynemouth4_grframelong_sum <- ddply(Lynemouth4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth4_gr_max <- sum(Lynemouth4_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth4_gr_max
Lynemouth4_gr_pres <- sum(Lynemouth4_grframelong_sum $max > 0)
Lynemouth4_gr_pres

#number of sites which would be classified as low
Lynemouth4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth4_grframelong_sum$max)
Lynemouth4_gr_lw_ref
#number of sites which would be classified as high
Lynemouth4_gr_high_ref <- sum( Lynemouth4_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth4_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth4_gr_mod_ref <- 1000 - (Lynemouth4_gr_high_ref + Lynemouth4_gr_lw_ref)
Lynemouth4_gr_mod_ref

#5 nights
Lynemouth5_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Lynemouth5_grframe<-data.frame(Lynemouth5_gr, samp2)
Lynemouth5_grframelong <- melt(Lynemouth5_grframe,id.vars="samp2")
Lynemouth5_grframelong_sum <- ddply(Lynemouth5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth5_gr_max <- sum(Lynemouth5_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth5_gr_max
Lynemouth5_gr_pres <- sum(Lynemouth5_grframelong_sum $max > 0)
Lynemouth5_gr_pres

#number of sites which would be classified as low
Lynemouth5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth5_grframelong_sum$max)
Lynemouth5_gr_lw_ref
#number of sites which would be classified as high
Lynemouth5_gr_high_ref <- sum( Lynemouth5_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth5_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth5_gr_mod_ref <- 1000 - (Lynemouth5_gr_high_ref + Lynemouth5_gr_lw_ref)
Lynemouth5_gr_mod_ref

#6 nights
Lynemouth6_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Lynemouth6_grframe<-data.frame(Lynemouth6_gr, samp2)
Lynemouth6_grframelong <- melt(Lynemouth6_grframe,id.vars="samp2")
Lynemouth6_grframelong_sum <- ddply(Lynemouth6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth6_gr_max <- sum(Lynemouth6_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth6_gr_max
Lynemouth6_gr_pres <- sum(Lynemouth6_grframelong_sum $max > 0)
Lynemouth6_gr_pres

#number of sites which would be classified as low
Lynemouth6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth6_grframelong_sum$max)
Lynemouth6_gr_lw_ref
#number of sites which would be classified as high
Lynemouth6_gr_high_ref <- sum( Lynemouth6_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth6_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth6_gr_mod_ref <- 1000 - (Lynemouth6_gr_high_ref + Lynemouth6_gr_lw_ref)
Lynemouth6_gr_mod_ref

#7 nights
Lynemouth7_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Lynemouth7_grframe<-data.frame(Lynemouth7_gr, samp2)
Lynemouth7_grframelong <- melt(Lynemouth7_grframe,id.vars="samp2")
Lynemouth7_grframelong_sum <- ddply(Lynemouth7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth7_gr_max <- sum(Lynemouth7_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth7_gr_max
Lynemouth7_gr_pres <- sum(Lynemouth7_grframelong_sum $max > 0)
Lynemouth7_gr_pres

#number of sites which would be classified as low
Lynemouth7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth7_grframelong_sum$max)
Lynemouth7_gr_lw_ref
#number of sites which would be classified as high
Lynemouth7_gr_high_ref <- sum( Lynemouth7_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth7_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth7_gr_mod_ref <- 1000 - (Lynemouth7_gr_high_ref + Lynemouth7_gr_lw_ref)
Lynemouth7_gr_mod_ref

#8 nights
Lynemouth8_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Lynemouth8_grframe<-data.frame(Lynemouth8_gr, samp2)
Lynemouth8_grframelong <- melt(Lynemouth8_grframe,id.vars="samp2")
Lynemouth8_grframelong_sum <- ddply(Lynemouth8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth8_gr_max <- sum(Lynemouth8_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth8_gr_max
Lynemouth8_gr_pres <- sum(Lynemouth8_grframelong_sum $max > 0)
Lynemouth8_gr_pres

#number of sites which would be classified as low
Lynemouth8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth8_grframelong_sum$max)
Lynemouth8_gr_lw_ref
#number of sites which would be classified as high
Lynemouth8_gr_high_ref <- sum( Lynemouth8_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth8_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth8_gr_mod_ref <- 1000 - (Lynemouth8_gr_high_ref + Lynemouth8_gr_lw_ref)
Lynemouth8_gr_mod_ref

#9 nights
Lynemouth9_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Lynemouth9_grframe<-data.frame(Lynemouth9_gr, samp2)
Lynemouth9_grframelong <- melt(Lynemouth9_grframe,id.vars="samp2")
Lynemouth9_grframelong_sum <- ddply(Lynemouth9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Lynemouth9_gr_max <- sum(Lynemouth9_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth9_gr_max
Lynemouth9_gr_pres <- sum(Lynemouth9_grframelong_sum $max > 0)
Lynemouth9_gr_pres

#number of sites which would be classified as low
Lynemouth9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth9_grframelong_sum$max)
Lynemouth9_gr_lw_ref
#number of sites which would be classified as high
Lynemouth9_gr_high_ref <- sum( Lynemouth9_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth9_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth9_gr_mod_ref <- 1000 - (Lynemouth9_gr_high_ref + Lynemouth9_gr_lw_ref)
Lynemouth9_gr_mod_ref

#10 detectors
Lynemouth10_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Lynemouth10_grframe<-data.frame(Lynemouth10_gr, samp2)
Lynemouth10_grframelong <- melt(Lynemouth10_grframe,id.vars="samp2")
Lynemouth10_grframelong_sum <- ddply(Lynemouth10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth10_gr_max <- sum(Lynemouth10_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth10_gr_max
Lynemouth10_gr_pres <- sum(Lynemouth10_grframelong_sum $max > 0)
Lynemouth10_gr_pres

#number of sites which would be classified as low
Lynemouth10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth10_grframelong_sum$max)
Lynemouth10_gr_lw_ref
#number of sites which would be classified as high
Lynemouth10_gr_high_ref <- sum( Lynemouth10_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth10_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth10_gr_mod_ref <- 1000 - (Lynemouth10_gr_high_ref + Lynemouth10_gr_lw_ref)
Lynemouth10_gr_mod_ref

#11 detectors
Lynemouth11_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Lynemouth11_grframe<-data.frame(Lynemouth11_gr, samp2)
Lynemouth11_grframelong <- melt(Lynemouth11_grframe,id.vars="samp2")
Lynemouth11_grframelong_sum <- ddply(Lynemouth11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth11_gr_max <- sum(Lynemouth11_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth11_gr_max
Lynemouth11_gr_pres <- sum(Lynemouth11_grframelong_sum $max > 0)
Lynemouth11_gr_pres

#number of sites which would be classified as low
Lynemouth11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth11_grframelong_sum$max)
Lynemouth11_gr_lw_ref
#number of sites which would be classified as high
Lynemouth11_gr_high_ref <- sum( Lynemouth11_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth11_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth11_gr_mod_ref <- 1000 - (Lynemouth11_gr_high_ref + Lynemouth11_gr_lw_ref)
Lynemouth11_gr_mod_ref

#12 detectors
Lynemouth12_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Lynemouth12_grframe<-data.frame(Lynemouth12_gr, samp2)
Lynemouth12_grframelong <- melt(Lynemouth12_grframe,id.vars="samp2")
Lynemouth12_grframelong_sum <- ddply(Lynemouth12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth12_gr_max <- sum(Lynemouth12_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth12_gr_max
Lynemouth12_gr_pres <- sum(Lynemouth12_grframelong_sum $max > 0)
Lynemouth12_gr_pres

#number of sites which would be classified as low
Lynemouth12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth12_grframelong_sum$max)
Lynemouth12_gr_lw_ref
#number of sites which would be classified as high
Lynemouth12_gr_high_ref <- sum( Lynemouth12_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth12_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth12_gr_mod_ref <- 1000 - (Lynemouth12_gr_high_ref + Lynemouth12_gr_lw_ref)
Lynemouth12_gr_mod_ref

#13 detectors
Lynemouth13_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Lynemouth13_grframe<-data.frame(Lynemouth13_gr, samp2)
Lynemouth13_grframelong <- melt(Lynemouth13_grframe,id.vars="samp2")
Lynemouth13_grframelong_sum <- ddply(Lynemouth13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth13_gr_max <- sum(Lynemouth13_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth13_gr_max
Lynemouth13_gr_pres <- sum(Lynemouth13_grframelong_sum $max > 0)
Lynemouth13_gr_pres

#number of sites which would be classified as low
Lynemouth13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth13_grframelong_sum$max)
Lynemouth13_gr_lw_ref
#number of sites which would be classified as high
Lynemouth13_gr_high_ref <- sum( Lynemouth13_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth13_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth13_gr_mod_ref <- 1000 - (Lynemouth13_gr_high_ref + Lynemouth13_gr_lw_ref)
Lynemouth13_gr_mod_ref

#14 detectors
Lynemouth14_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Lynemouth14_grframe<-data.frame(Lynemouth14_gr, samp2)
Lynemouth14_grframelong <- melt(Lynemouth14_grframe,id.vars="samp2")
Lynemouth14_grframelong_sum <- ddply(Lynemouth14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth14_gr_max <- sum(Lynemouth14_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth14_gr_max
Lynemouth14_gr_pres <- sum(Lynemouth14_grframelong_sum $max > 0)
Lynemouth14_gr_pres

#number of sites which would be classified as low
Lynemouth14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth14_grframelong_sum$max)
Lynemouth14_gr_lw_ref
#number of sites which would be classified as high
Lynemouth14_gr_high_ref <- sum( Lynemouth14_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth14_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth14_gr_mod_ref <- 1000 - (Lynemouth14_gr_high_ref + Lynemouth14_gr_lw_ref)
Lynemouth14_gr_mod_ref

#15 detectors
Lynemouth15_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Lynemouth15_grframe<-data.frame(Lynemouth15_gr, samp2)
Lynemouth15_grframelong <- melt(Lynemouth15_grframe,id.vars="samp2")
Lynemouth15_grframelong_sum <- ddply(Lynemouth15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth15_gr_max <- sum(Lynemouth15_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth15_gr_max
Lynemouth15_gr_pres <- sum(Lynemouth15_grframelong_sum $max > 0)
Lynemouth15_gr_pres

#number of sites which would be classified as low
Lynemouth15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth15_grframelong_sum$max)
Lynemouth15_gr_lw_ref
#number of sites which would be classified as high
Lynemouth15_gr_high_ref <- sum( Lynemouth15_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth15_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth15_gr_mod_ref <- 1000 - (Lynemouth15_gr_high_ref + Lynemouth15_gr_lw_ref)
Lynemouth15_gr_mod_ref

#16 detectors
Lynemouth16_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Lynemouth16_grframe<-data.frame(Lynemouth16_gr, samp2)
Lynemouth16_grframelong <- melt(Lynemouth16_grframe,id.vars="samp2")
Lynemouth16_grframelong_sum <- ddply(Lynemouth16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth16_gr_max <- sum(Lynemouth16_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth16_gr_max
Lynemouth16_gr_pres <- sum(Lynemouth16_grframelong_sum $max > 0)
Lynemouth16_gr_pres

#number of sites which would be classified as low
Lynemouth16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth16_grframelong_sum$max)
Lynemouth16_gr_lw_ref
#number of sites which would be classified as high
Lynemouth16_gr_high_ref <- sum( Lynemouth16_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth16_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth16_gr_mod_ref <- 1000 - (Lynemouth16_gr_high_ref + Lynemouth16_gr_lw_ref)
Lynemouth16_gr_mod_ref

#17 detectors
Lynemouth17_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Lynemouth17_grframe<-data.frame(Lynemouth17_gr, samp2)
Lynemouth17_grframelong <- melt(Lynemouth17_grframe,id.vars="samp2")
Lynemouth17_grframelong_sum <- ddply(Lynemouth17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth17_gr_max <- sum(Lynemouth17_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth17_gr_max
Lynemouth17_gr_pres <- sum(Lynemouth17_grframelong_sum $max > 0)
Lynemouth17_gr_pres

#number of sites which would be classified as low
Lynemouth17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth17_grframelong_sum$max)
Lynemouth17_gr_lw_ref
#number of sites which would be classified as high
Lynemouth17_gr_high_ref <- sum( Lynemouth17_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth17_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth17_gr_mod_ref <- 1000 - (Lynemouth17_gr_high_ref + Lynemouth17_gr_lw_ref)
Lynemouth17_gr_mod_ref

#18 detectors
Lynemouth18_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Lynemouth18_grframe<-data.frame(Lynemouth18_gr, samp2)
Lynemouth18_grframelong <- melt(Lynemouth18_grframe,id.vars="samp2")
Lynemouth18_grframelong_sum <- ddply(Lynemouth18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth18_gr_max <- sum(Lynemouth18_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth18_gr_max
Lynemouth18_gr_pres <- sum(Lynemouth18_grframelong_sum $max > 0)
Lynemouth18_gr_pres

#number of sites which would be classified as low
Lynemouth18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth18_grframelong_sum$max)
Lynemouth18_gr_lw_ref
#number of sites which would be classified as high
Lynemouth18_gr_high_ref <- sum( Lynemouth18_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth18_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth18_gr_mod_ref <- 1000 - (Lynemouth18_gr_high_ref + Lynemouth18_gr_lw_ref)
Lynemouth18_gr_mod_ref

#19 detectors
Lynemouth19_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Lynemouth19_grframe<-data.frame(Lynemouth19_gr, samp2)
Lynemouth19_grframelong <- melt(Lynemouth19_grframe,id.vars="samp2")
Lynemouth19_grframelong_sum <- ddply(Lynemouth19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth19_gr_max <- sum(Lynemouth19_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth19_gr_max
Lynemouth19_gr_pres <- sum(Lynemouth19_grframelong_sum $max > 0)
Lynemouth19_gr_pres

#number of sites which would be classified as low
Lynemouth19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth19_grframelong_sum$max)
Lynemouth19_gr_lw_ref
#number of sites which would be classified as high
Lynemouth19_gr_high_ref <- sum( Lynemouth19_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth19_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth19_gr_mod_ref <- 1000 - (Lynemouth19_gr_high_ref + Lynemouth19_gr_lw_ref)
Lynemouth19_gr_mod_ref

#20 detectors
Lynemouth20_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Lynemouth20_grframe<-data.frame(Lynemouth20_gr, samp2)
Lynemouth20_grframelong <- melt(Lynemouth20_grframe,id.vars="samp2")
Lynemouth20_grframelong_sum <- ddply(Lynemouth20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth20_gr_max <- sum(Lynemouth20_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth20_gr_max
Lynemouth20_gr_pres <- sum(Lynemouth20_grframelong_sum $max > 0)
Lynemouth20_gr_pres

#number of sites which would be classified as low
Lynemouth20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth20_grframelong_sum$max)
Lynemouth20_gr_lw_ref
#number of sites which would be classified as high
Lynemouth20_gr_high_ref <- sum( Lynemouth20_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth20_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth20_gr_mod_ref <- 1000 - (Lynemouth20_gr_high_ref + Lynemouth20_gr_lw_ref)
Lynemouth20_gr_mod_ref

#21 detectors
Lynemouth21_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Lynemouth21_grframe<-data.frame(Lynemouth21_gr, samp2)
Lynemouth21_grframelong <- melt(Lynemouth21_grframe,id.vars="samp2")
Lynemouth21_grframelong_sum <- ddply(Lynemouth21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth21_gr_max <- sum(Lynemouth21_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth21_gr_max
Lynemouth21_gr_pres <- sum(Lynemouth21_grframelong_sum $max > 0)
Lynemouth21_gr_pres

#number of sites which would be classified as low
Lynemouth21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth21_grframelong_sum$max)
Lynemouth21_gr_lw_ref
#number of sites which would be classified as high
Lynemouth21_gr_high_ref <- sum( Lynemouth21_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth21_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth21_gr_mod_ref <- 1000 - (Lynemouth21_gr_high_ref + Lynemouth21_gr_lw_ref)
Lynemouth21_gr_mod_ref

#22 detectors
Lynemouth22_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Lynemouth22_grframe<-data.frame(Lynemouth22_gr, samp2)
Lynemouth22_grframelong <- melt(Lynemouth22_grframe,id.vars="samp2")
Lynemouth22_grframelong_sum <- ddply(Lynemouth22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth22_gr_max <- sum(Lynemouth22_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth22_gr_max
Lynemouth22_gr_pres <- sum(Lynemouth22_grframelong_sum $max > 0)
Lynemouth22_gr_pres

#number of sites which would be classified as low
Lynemouth22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth22_grframelong_sum$max)
Lynemouth22_gr_lw_ref
#number of sites which would be classified as high
Lynemouth22_gr_high_ref <- sum( Lynemouth22_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth22_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth22_gr_mod_ref <- 1000 - (Lynemouth22_gr_high_ref + Lynemouth22_gr_lw_ref)
Lynemouth22_gr_mod_ref

#23 detectors
Lynemouth23_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Lynemouth23_grframe<-data.frame(Lynemouth23_gr, samp2)
Lynemouth23_grframelong <- melt(Lynemouth23_grframe,id.vars="samp2")
Lynemouth23_grframelong_sum <- ddply(Lynemouth23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth23_gr_max <- sum(Lynemouth23_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth23_gr_max
Lynemouth23_gr_pres <- sum(Lynemouth23_grframelong_sum $max > 0)
Lynemouth23_gr_pres

#number of sites which would be classified as low
Lynemouth23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth23_grframelong_sum$max)
Lynemouth23_gr_lw_ref
#number of sites which would be classified as high
Lynemouth23_gr_high_ref <- sum( Lynemouth23_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth23_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth23_gr_mod_ref <- 1000 - (Lynemouth23_gr_high_ref + Lynemouth23_gr_lw_ref)
Lynemouth23_gr_mod_ref

#24 detectors
Lynemouth24_gr<-(replicate(1000, (sample(Lynemouthpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Lynemouth24_grframe<-data.frame(Lynemouth24_gr, samp2)
Lynemouth24_grframelong <- melt(Lynemouth24_grframe,id.vars="samp2")
Lynemouth24_grframelong_sum <- ddply(Lynemouth24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Lynemouth24_gr_max <- sum(Lynemouth24_grframelong_sum $max > max20_Lynemouthpipgr)
Lynemouth24_gr_max
Lynemouth24_gr_pres <- sum(Lynemouth24_grframelong_sum $max > 0)
Lynemouth24_gr_pres

#number of sites which would be classified as low
Lynemouth24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Lynemouth24_grframelong_sum$max)
Lynemouth24_gr_lw_ref
#number of sites which would be classified as high
Lynemouth24_gr_high_ref <- sum( Lynemouth24_grframelong_sum$max > allsppgr_ppip_ref_high)
Lynemouth24_gr_high_ref
#number of sites which would be classified as moderate
Lynemouth24_gr_mod_ref <- 1000 - (Lynemouth24_gr_high_ref + Lynemouth24_gr_lw_ref)
Lynemouth24_gr_mod_ref

Present<-c(Lynemouth1_gr_pres,Lynemouth2_gr_pres,
           Lynemouth3_gr_pres,Lynemouth4_gr_pres,
           Lynemouth5_gr_pres,Lynemouth6_gr_pres,
           Lynemouth7_gr_pres,Lynemouth8_gr_pres,
           Lynemouth9_gr_pres,Lynemouth10_gr_pres,
           Lynemouth11_gr_pres,Lynemouth12_gr_pres,
           Lynemouth13_gr_pres,Lynemouth14_gr_pres,
           Lynemouth15_gr_pres,Lynemouth16_gr_pres,
           Lynemouth17_gr_pres,Lynemouth18_gr_pres,
           Lynemouth19_gr_pres,Lynemouth20_gr_pres,
           Lynemouth21_gr_pres,Lynemouth22_gr_pres,
           Lynemouth23_gr_pres,Lynemouth24_gr_pres)


Maximum<-c(Lynemouth1_gr_max,Lynemouth2_gr_max,
           Lynemouth3_gr_max,Lynemouth4_gr_max,
           Lynemouth5_gr_max,Lynemouth6_gr_max,
           Lynemouth7_gr_max,Lynemouth8_gr_max,
           Lynemouth9_gr_max,Lynemouth10_gr_max,
           Lynemouth11_gr_max,Lynemouth12_gr_max,
           Lynemouth13_gr_max,Lynemouth14_gr_max,
           Lynemouth15_gr_max,Lynemouth16_gr_max,
           Lynemouth17_gr_max,Lynemouth18_gr_max,
           Lynemouth19_gr_max,Lynemouth20_gr_max,
           Lynemouth21_gr_max,Lynemouth22_gr_max,
           Lynemouth23_gr_max,Lynemouth24_gr_max)

Low<-c(Lynemouth1_gr_lw_ref, Lynemouth2_gr_lw_ref, Lynemouth3_gr_lw_ref,
       Lynemouth4_gr_lw_ref, Lynemouth5_gr_lw_ref, Lynemouth6_gr_lw_ref,
       Lynemouth7_gr_lw_ref, Lynemouth8_gr_lw_ref, Lynemouth9_gr_lw_ref,
       Lynemouth10_gr_lw_ref, Lynemouth11_gr_lw_ref, Lynemouth12_gr_lw_ref, 
       Lynemouth13_gr_lw_ref, Lynemouth14_gr_lw_ref, Lynemouth15_gr_lw_ref, 
       Lynemouth16_gr_lw_ref, Lynemouth17_gr_lw_ref, Lynemouth18_gr_lw_ref, 
       Lynemouth19_gr_lw_ref, Lynemouth20_gr_lw_ref, Lynemouth21_gr_lw_ref,
       Lynemouth22_gr_lw_ref,Lynemouth23_gr_lw_ref,Lynemouth24_gr_lw_ref)

Moderate<-c(Lynemouth1_gr_mod_ref, Lynemouth2_gr_mod_ref, Lynemouth3_gr_mod_ref,
            Lynemouth4_gr_mod_ref, Lynemouth5_gr_mod_ref, Lynemouth6_gr_mod_ref,
            Lynemouth7_gr_mod_ref, Lynemouth8_gr_mod_ref, Lynemouth9_gr_mod_ref,
            Lynemouth10_gr_mod_ref, Lynemouth11_gr_mod_ref, Lynemouth12_gr_mod_ref, 
            Lynemouth13_gr_mod_ref, Lynemouth14_gr_mod_ref, Lynemouth15_gr_mod_ref, 
            Lynemouth16_gr_mod_ref, Lynemouth17_gr_mod_ref, Lynemouth18_gr_mod_ref, 
            Lynemouth19_gr_mod_ref, Lynemouth20_gr_mod_ref, Lynemouth21_gr_mod_ref,
            Lynemouth22_gr_mod_ref,Lynemouth23_gr_mod_ref,Lynemouth24_gr_mod_ref)

High<-c(Lynemouth1_gr_high_ref, Lynemouth2_gr_high_ref, Lynemouth3_gr_high_ref,
        Lynemouth4_gr_high_ref, Lynemouth5_gr_high_ref, Lynemouth6_gr_high_ref,
        Lynemouth7_gr_high_ref, Lynemouth8_gr_high_ref, Lynemouth9_gr_high_ref,
        Lynemouth10_gr_high_ref, Lynemouth11_gr_high_ref, Lynemouth12_gr_high_ref, 
        Lynemouth13_gr_high_ref, Lynemouth14_gr_high_ref, Lynemouth15_gr_high_ref, 
        Lynemouth16_gr_high_ref, Lynemouth17_gr_high_ref, Lynemouth18_gr_high_ref, 
        Lynemouth19_gr_high_ref, Lynemouth20_gr_high_ref, Lynemouth21_gr_high_ref,
        Lynemouth22_gr_high_ref,Lynemouth23_gr_high_ref,Lynemouth24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Lynemouthgr",24)
Lowsite <- Lynemouthlow
Modsite <- Lynemouthmod
Highsite <-Lynemouthhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Lynemouthgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##Maesgwyn

Maesgwynpipgr<-subset(allspp4gr_ppip, Site=="Maesgwyn")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Maesgwynpipgr<-max(Maesgwynpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Maesgwynpipgr<- (max_Maesgwynpipgr/100)*80

##calculate the site classification (reference range)

Maesgwynhigh<- max_Maesgwynpipgr > allsppgr_ppip_ref_high

Maesgwynlow<- allsppgr_ppip_ref_low > max_Maesgwynpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Maesgwynpipgr
Maesgwynmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Maesgwyn1_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 1, replace=F))))
Maesgwyn1_gr_max <- sum(Maesgwyn1_gr > max20_Maesgwynpipgr)
Maesgwyn1_gr_max
Maesgwyn1_gr_pres <- sum(Maesgwyn1_gr > 0)
Maesgwyn1_gr_pres
#number of sites which would be classified as low
Maesgwyn1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn1_gr)
Maesgwyn1_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn1_gr_high_ref <- sum( Maesgwyn1_gr > allsppgr_ppip_ref_high)
Maesgwyn1_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn1_gr_mod_ref <- 1000 - (Maesgwyn1_gr_high_ref + Maesgwyn1_gr_lw_ref)
Maesgwyn1_gr_mod_ref


#2 nights
Maesgwyn2_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Maesgwyn2_grframe<-data.frame(Maesgwyn2_gr, samp2)
Maesgwyn2_grframelong <- melt(Maesgwyn2_grframe,id.vars="samp2")
Maesgwyn2_grframelong_sum <- ddply(Maesgwyn2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn2_gr_max <- sum(Maesgwyn2_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn2_gr_max
Maesgwyn2_gr_pres <- sum(Maesgwyn2_grframelong_sum $max > 0)
Maesgwyn2_gr_pres

#number of sites which would be classified as low
Maesgwyn2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn2_grframelong_sum$max)
Maesgwyn2_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn2_gr_high_ref <- sum( Maesgwyn2_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn2_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn2_gr_mod_ref <- 1000 - (Maesgwyn2_gr_high_ref + Maesgwyn2_gr_lw_ref)
Maesgwyn2_gr_mod_ref


#3 nights
Maesgwyn3_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Maesgwyn3_grframe<-data.frame(Maesgwyn3_gr, samp2)
Maesgwyn3_grframelong <- melt(Maesgwyn3_grframe,id.vars="samp2")
Maesgwyn3_grframelong_sum <- ddply(Maesgwyn3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn3_gr_max <- sum(Maesgwyn3_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn3_gr_max
Maesgwyn3_gr_pres <- sum(Maesgwyn3_grframelong_sum $max > 0)
Maesgwyn3_gr_pres

#number of sites which would be classified as low
Maesgwyn3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn3_grframelong_sum$max)
Maesgwyn3_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn3_gr_high_ref <- sum( Maesgwyn3_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn3_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn3_gr_mod_ref <- 1000 - (Maesgwyn3_gr_high_ref + Maesgwyn3_gr_lw_ref)
Maesgwyn3_gr_mod_ref

#4 nights
Maesgwyn4_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Maesgwyn4_grframe<-data.frame(Maesgwyn4_gr, samp2)
Maesgwyn4_grframelong <- melt(Maesgwyn4_grframe,id.vars="samp2")
Maesgwyn4_grframelong_sum <- ddply(Maesgwyn4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn4_gr_max <- sum(Maesgwyn4_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn4_gr_max
Maesgwyn4_gr_pres <- sum(Maesgwyn4_grframelong_sum $max > 0)
Maesgwyn4_gr_pres

#number of sites which would be classified as low
Maesgwyn4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn4_grframelong_sum$max)
Maesgwyn4_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn4_gr_high_ref <- sum( Maesgwyn4_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn4_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn4_gr_mod_ref <- 1000 - (Maesgwyn4_gr_high_ref + Maesgwyn4_gr_lw_ref)
Maesgwyn4_gr_mod_ref

#5 nights
Maesgwyn5_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Maesgwyn5_grframe<-data.frame(Maesgwyn5_gr, samp2)
Maesgwyn5_grframelong <- melt(Maesgwyn5_grframe,id.vars="samp2")
Maesgwyn5_grframelong_sum <- ddply(Maesgwyn5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn5_gr_max <- sum(Maesgwyn5_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn5_gr_max
Maesgwyn5_gr_pres <- sum(Maesgwyn5_grframelong_sum $max > 0)
Maesgwyn5_gr_pres

#number of sites which would be classified as low
Maesgwyn5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn5_grframelong_sum$max)
Maesgwyn5_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn5_gr_high_ref <- sum( Maesgwyn5_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn5_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn5_gr_mod_ref <- 1000 - (Maesgwyn5_gr_high_ref + Maesgwyn5_gr_lw_ref)
Maesgwyn5_gr_mod_ref

#6 nights
Maesgwyn6_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Maesgwyn6_grframe<-data.frame(Maesgwyn6_gr, samp2)
Maesgwyn6_grframelong <- melt(Maesgwyn6_grframe,id.vars="samp2")
Maesgwyn6_grframelong_sum <- ddply(Maesgwyn6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn6_gr_max <- sum(Maesgwyn6_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn6_gr_max
Maesgwyn6_gr_pres <- sum(Maesgwyn6_grframelong_sum $max > 0)
Maesgwyn6_gr_pres

#number of sites which would be classified as low
Maesgwyn6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn6_grframelong_sum$max)
Maesgwyn6_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn6_gr_high_ref <- sum( Maesgwyn6_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn6_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn6_gr_mod_ref <- 1000 - (Maesgwyn6_gr_high_ref + Maesgwyn6_gr_lw_ref)
Maesgwyn6_gr_mod_ref

#7 nights
Maesgwyn7_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Maesgwyn7_grframe<-data.frame(Maesgwyn7_gr, samp2)
Maesgwyn7_grframelong <- melt(Maesgwyn7_grframe,id.vars="samp2")
Maesgwyn7_grframelong_sum <- ddply(Maesgwyn7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn7_gr_max <- sum(Maesgwyn7_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn7_gr_max
Maesgwyn7_gr_pres <- sum(Maesgwyn7_grframelong_sum $max > 0)
Maesgwyn7_gr_pres

#number of sites which would be classified as low
Maesgwyn7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn7_grframelong_sum$max)
Maesgwyn7_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn7_gr_high_ref <- sum( Maesgwyn7_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn7_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn7_gr_mod_ref <- 1000 - (Maesgwyn7_gr_high_ref + Maesgwyn7_gr_lw_ref)
Maesgwyn7_gr_mod_ref

#8 nights
Maesgwyn8_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Maesgwyn8_grframe<-data.frame(Maesgwyn8_gr, samp2)
Maesgwyn8_grframelong <- melt(Maesgwyn8_grframe,id.vars="samp2")
Maesgwyn8_grframelong_sum <- ddply(Maesgwyn8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn8_gr_max <- sum(Maesgwyn8_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn8_gr_max
Maesgwyn8_gr_pres <- sum(Maesgwyn8_grframelong_sum $max > 0)
Maesgwyn8_gr_pres

#number of sites which would be classified as low
Maesgwyn8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn8_grframelong_sum$max)
Maesgwyn8_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn8_gr_high_ref <- sum( Maesgwyn8_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn8_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn8_gr_mod_ref <- 1000 - (Maesgwyn8_gr_high_ref + Maesgwyn8_gr_lw_ref)
Maesgwyn8_gr_mod_ref

#9 nights
Maesgwyn9_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Maesgwyn9_grframe<-data.frame(Maesgwyn9_gr, samp2)
Maesgwyn9_grframelong <- melt(Maesgwyn9_grframe,id.vars="samp2")
Maesgwyn9_grframelong_sum <- ddply(Maesgwyn9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Maesgwyn9_gr_max <- sum(Maesgwyn9_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn9_gr_max
Maesgwyn9_gr_pres <- sum(Maesgwyn9_grframelong_sum $max > 0)
Maesgwyn9_gr_pres

#number of sites which would be classified as low
Maesgwyn9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn9_grframelong_sum$max)
Maesgwyn9_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn9_gr_high_ref <- sum( Maesgwyn9_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn9_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn9_gr_mod_ref <- 1000 - (Maesgwyn9_gr_high_ref + Maesgwyn9_gr_lw_ref)
Maesgwyn9_gr_mod_ref

#10 detectors
Maesgwyn10_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Maesgwyn10_grframe<-data.frame(Maesgwyn10_gr, samp2)
Maesgwyn10_grframelong <- melt(Maesgwyn10_grframe,id.vars="samp2")
Maesgwyn10_grframelong_sum <- ddply(Maesgwyn10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn10_gr_max <- sum(Maesgwyn10_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn10_gr_max
Maesgwyn10_gr_pres <- sum(Maesgwyn10_grframelong_sum $max > 0)
Maesgwyn10_gr_pres

#number of sites which would be classified as low
Maesgwyn10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn10_grframelong_sum$max)
Maesgwyn10_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn10_gr_high_ref <- sum( Maesgwyn10_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn10_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn10_gr_mod_ref <- 1000 - (Maesgwyn10_gr_high_ref + Maesgwyn10_gr_lw_ref)
Maesgwyn10_gr_mod_ref

#11 detectors
Maesgwyn11_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Maesgwyn11_grframe<-data.frame(Maesgwyn11_gr, samp2)
Maesgwyn11_grframelong <- melt(Maesgwyn11_grframe,id.vars="samp2")
Maesgwyn11_grframelong_sum <- ddply(Maesgwyn11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn11_gr_max <- sum(Maesgwyn11_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn11_gr_max
Maesgwyn11_gr_pres <- sum(Maesgwyn11_grframelong_sum $max > 0)
Maesgwyn11_gr_pres

#number of sites which would be classified as low
Maesgwyn11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn11_grframelong_sum$max)
Maesgwyn11_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn11_gr_high_ref <- sum( Maesgwyn11_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn11_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn11_gr_mod_ref <- 1000 - (Maesgwyn11_gr_high_ref + Maesgwyn11_gr_lw_ref)
Maesgwyn11_gr_mod_ref

#12 detectors
Maesgwyn12_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Maesgwyn12_grframe<-data.frame(Maesgwyn12_gr, samp2)
Maesgwyn12_grframelong <- melt(Maesgwyn12_grframe,id.vars="samp2")
Maesgwyn12_grframelong_sum <- ddply(Maesgwyn12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn12_gr_max <- sum(Maesgwyn12_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn12_gr_max
Maesgwyn12_gr_pres <- sum(Maesgwyn12_grframelong_sum $max > 0)
Maesgwyn12_gr_pres

#number of sites which would be classified as low
Maesgwyn12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn12_grframelong_sum$max)
Maesgwyn12_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn12_gr_high_ref <- sum( Maesgwyn12_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn12_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn12_gr_mod_ref <- 1000 - (Maesgwyn12_gr_high_ref + Maesgwyn12_gr_lw_ref)
Maesgwyn12_gr_mod_ref

#13 detectors
Maesgwyn13_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Maesgwyn13_grframe<-data.frame(Maesgwyn13_gr, samp2)
Maesgwyn13_grframelong <- melt(Maesgwyn13_grframe,id.vars="samp2")
Maesgwyn13_grframelong_sum <- ddply(Maesgwyn13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn13_gr_max <- sum(Maesgwyn13_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn13_gr_max
Maesgwyn13_gr_pres <- sum(Maesgwyn13_grframelong_sum $max > 0)
Maesgwyn13_gr_pres

#number of sites which would be classified as low
Maesgwyn13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn13_grframelong_sum$max)
Maesgwyn13_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn13_gr_high_ref <- sum( Maesgwyn13_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn13_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn13_gr_mod_ref <- 1000 - (Maesgwyn13_gr_high_ref + Maesgwyn13_gr_lw_ref)
Maesgwyn13_gr_mod_ref

#14 detectors
Maesgwyn14_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Maesgwyn14_grframe<-data.frame(Maesgwyn14_gr, samp2)
Maesgwyn14_grframelong <- melt(Maesgwyn14_grframe,id.vars="samp2")
Maesgwyn14_grframelong_sum <- ddply(Maesgwyn14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn14_gr_max <- sum(Maesgwyn14_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn14_gr_max
Maesgwyn14_gr_pres <- sum(Maesgwyn14_grframelong_sum $max > 0)
Maesgwyn14_gr_pres

#number of sites which would be classified as low
Maesgwyn14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn14_grframelong_sum$max)
Maesgwyn14_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn14_gr_high_ref <- sum( Maesgwyn14_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn14_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn14_gr_mod_ref <- 1000 - (Maesgwyn14_gr_high_ref + Maesgwyn14_gr_lw_ref)
Maesgwyn14_gr_mod_ref

#15 detectors
Maesgwyn15_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Maesgwyn15_grframe<-data.frame(Maesgwyn15_gr, samp2)
Maesgwyn15_grframelong <- melt(Maesgwyn15_grframe,id.vars="samp2")
Maesgwyn15_grframelong_sum <- ddply(Maesgwyn15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn15_gr_max <- sum(Maesgwyn15_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn15_gr_max
Maesgwyn15_gr_pres <- sum(Maesgwyn15_grframelong_sum $max > 0)
Maesgwyn15_gr_pres

#number of sites which would be classified as low
Maesgwyn15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn15_grframelong_sum$max)
Maesgwyn15_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn15_gr_high_ref <- sum( Maesgwyn15_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn15_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn15_gr_mod_ref <- 1000 - (Maesgwyn15_gr_high_ref + Maesgwyn15_gr_lw_ref)
Maesgwyn15_gr_mod_ref

#16 detectors
Maesgwyn16_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Maesgwyn16_grframe<-data.frame(Maesgwyn16_gr, samp2)
Maesgwyn16_grframelong <- melt(Maesgwyn16_grframe,id.vars="samp2")
Maesgwyn16_grframelong_sum <- ddply(Maesgwyn16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn16_gr_max <- sum(Maesgwyn16_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn16_gr_max
Maesgwyn16_gr_pres <- sum(Maesgwyn16_grframelong_sum $max > 0)
Maesgwyn16_gr_pres

#number of sites which would be classified as low
Maesgwyn16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn16_grframelong_sum$max)
Maesgwyn16_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn16_gr_high_ref <- sum( Maesgwyn16_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn16_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn16_gr_mod_ref <- 1000 - (Maesgwyn16_gr_high_ref + Maesgwyn16_gr_lw_ref)
Maesgwyn16_gr_mod_ref

#17 detectors
Maesgwyn17_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Maesgwyn17_grframe<-data.frame(Maesgwyn17_gr, samp2)
Maesgwyn17_grframelong <- melt(Maesgwyn17_grframe,id.vars="samp2")
Maesgwyn17_grframelong_sum <- ddply(Maesgwyn17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn17_gr_max <- sum(Maesgwyn17_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn17_gr_max
Maesgwyn17_gr_pres <- sum(Maesgwyn17_grframelong_sum $max > 0)
Maesgwyn17_gr_pres

#number of sites which would be classified as low
Maesgwyn17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn17_grframelong_sum$max)
Maesgwyn17_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn17_gr_high_ref <- sum( Maesgwyn17_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn17_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn17_gr_mod_ref <- 1000 - (Maesgwyn17_gr_high_ref + Maesgwyn17_gr_lw_ref)
Maesgwyn17_gr_mod_ref

#18 detectors
Maesgwyn18_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Maesgwyn18_grframe<-data.frame(Maesgwyn18_gr, samp2)
Maesgwyn18_grframelong <- melt(Maesgwyn18_grframe,id.vars="samp2")
Maesgwyn18_grframelong_sum <- ddply(Maesgwyn18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn18_gr_max <- sum(Maesgwyn18_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn18_gr_max
Maesgwyn18_gr_pres <- sum(Maesgwyn18_grframelong_sum $max > 0)
Maesgwyn18_gr_pres

#number of sites which would be classified as low
Maesgwyn18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn18_grframelong_sum$max)
Maesgwyn18_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn18_gr_high_ref <- sum( Maesgwyn18_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn18_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn18_gr_mod_ref <- 1000 - (Maesgwyn18_gr_high_ref + Maesgwyn18_gr_lw_ref)
Maesgwyn18_gr_mod_ref

#19 detectors
Maesgwyn19_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Maesgwyn19_grframe<-data.frame(Maesgwyn19_gr, samp2)
Maesgwyn19_grframelong <- melt(Maesgwyn19_grframe,id.vars="samp2")
Maesgwyn19_grframelong_sum <- ddply(Maesgwyn19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn19_gr_max <- sum(Maesgwyn19_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn19_gr_max
Maesgwyn19_gr_pres <- sum(Maesgwyn19_grframelong_sum $max > 0)
Maesgwyn19_gr_pres

#number of sites which would be classified as low
Maesgwyn19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn19_grframelong_sum$max)
Maesgwyn19_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn19_gr_high_ref <- sum( Maesgwyn19_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn19_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn19_gr_mod_ref <- 1000 - (Maesgwyn19_gr_high_ref + Maesgwyn19_gr_lw_ref)
Maesgwyn19_gr_mod_ref

#20 detectors
Maesgwyn20_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Maesgwyn20_grframe<-data.frame(Maesgwyn20_gr, samp2)
Maesgwyn20_grframelong <- melt(Maesgwyn20_grframe,id.vars="samp2")
Maesgwyn20_grframelong_sum <- ddply(Maesgwyn20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn20_gr_max <- sum(Maesgwyn20_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn20_gr_max
Maesgwyn20_gr_pres <- sum(Maesgwyn20_grframelong_sum $max > 0)
Maesgwyn20_gr_pres

#number of sites which would be classified as low
Maesgwyn20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn20_grframelong_sum$max)
Maesgwyn20_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn20_gr_high_ref <- sum( Maesgwyn20_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn20_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn20_gr_mod_ref <- 1000 - (Maesgwyn20_gr_high_ref + Maesgwyn20_gr_lw_ref)
Maesgwyn20_gr_mod_ref

#21 detectors
Maesgwyn21_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Maesgwyn21_grframe<-data.frame(Maesgwyn21_gr, samp2)
Maesgwyn21_grframelong <- melt(Maesgwyn21_grframe,id.vars="samp2")
Maesgwyn21_grframelong_sum <- ddply(Maesgwyn21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn21_gr_max <- sum(Maesgwyn21_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn21_gr_max
Maesgwyn21_gr_pres <- sum(Maesgwyn21_grframelong_sum $max > 0)
Maesgwyn21_gr_pres

#number of sites which would be classified as low
Maesgwyn21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn21_grframelong_sum$max)
Maesgwyn21_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn21_gr_high_ref <- sum( Maesgwyn21_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn21_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn21_gr_mod_ref <- 1000 - (Maesgwyn21_gr_high_ref + Maesgwyn21_gr_lw_ref)
Maesgwyn21_gr_mod_ref

#22 detectors
Maesgwyn22_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Maesgwyn22_grframe<-data.frame(Maesgwyn22_gr, samp2)
Maesgwyn22_grframelong <- melt(Maesgwyn22_grframe,id.vars="samp2")
Maesgwyn22_grframelong_sum <- ddply(Maesgwyn22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn22_gr_max <- sum(Maesgwyn22_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn22_gr_max
Maesgwyn22_gr_pres <- sum(Maesgwyn22_grframelong_sum $max > 0)
Maesgwyn22_gr_pres

#number of sites which would be classified as low
Maesgwyn22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn22_grframelong_sum$max)
Maesgwyn22_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn22_gr_high_ref <- sum( Maesgwyn22_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn22_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn22_gr_mod_ref <- 1000 - (Maesgwyn22_gr_high_ref + Maesgwyn22_gr_lw_ref)
Maesgwyn22_gr_mod_ref

#23 detectors
Maesgwyn23_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Maesgwyn23_grframe<-data.frame(Maesgwyn23_gr, samp2)
Maesgwyn23_grframelong <- melt(Maesgwyn23_grframe,id.vars="samp2")
Maesgwyn23_grframelong_sum <- ddply(Maesgwyn23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn23_gr_max <- sum(Maesgwyn23_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn23_gr_max
Maesgwyn23_gr_pres <- sum(Maesgwyn23_grframelong_sum $max > 0)
Maesgwyn23_gr_pres

#number of sites which would be classified as low
Maesgwyn23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn23_grframelong_sum$max)
Maesgwyn23_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn23_gr_high_ref <- sum( Maesgwyn23_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn23_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn23_gr_mod_ref <- 1000 - (Maesgwyn23_gr_high_ref + Maesgwyn23_gr_lw_ref)
Maesgwyn23_gr_mod_ref

#24 detectors
Maesgwyn24_gr<-(replicate(1000, (sample(Maesgwynpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Maesgwyn24_grframe<-data.frame(Maesgwyn24_gr, samp2)
Maesgwyn24_grframelong <- melt(Maesgwyn24_grframe,id.vars="samp2")
Maesgwyn24_grframelong_sum <- ddply(Maesgwyn24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Maesgwyn24_gr_max <- sum(Maesgwyn24_grframelong_sum $max > max20_Maesgwynpipgr)
Maesgwyn24_gr_max
Maesgwyn24_gr_pres <- sum(Maesgwyn24_grframelong_sum $max > 0)
Maesgwyn24_gr_pres

#number of sites which would be classified as low
Maesgwyn24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Maesgwyn24_grframelong_sum$max)
Maesgwyn24_gr_lw_ref
#number of sites which would be classified as high
Maesgwyn24_gr_high_ref <- sum( Maesgwyn24_grframelong_sum$max > allsppgr_ppip_ref_high)
Maesgwyn24_gr_high_ref
#number of sites which would be classified as moderate
Maesgwyn24_gr_mod_ref <- 1000 - (Maesgwyn24_gr_high_ref + Maesgwyn24_gr_lw_ref)
Maesgwyn24_gr_mod_ref

Present<-c(Maesgwyn1_gr_pres,Maesgwyn2_gr_pres,
           Maesgwyn3_gr_pres,Maesgwyn4_gr_pres,
           Maesgwyn5_gr_pres,Maesgwyn6_gr_pres,
           Maesgwyn7_gr_pres,Maesgwyn8_gr_pres,
           Maesgwyn9_gr_pres,Maesgwyn10_gr_pres,
           Maesgwyn11_gr_pres,Maesgwyn12_gr_pres,
           Maesgwyn13_gr_pres,Maesgwyn14_gr_pres,
           Maesgwyn15_gr_pres,Maesgwyn16_gr_pres,
           Maesgwyn17_gr_pres,Maesgwyn18_gr_pres,
           Maesgwyn19_gr_pres,Maesgwyn20_gr_pres,
           Maesgwyn21_gr_pres,Maesgwyn22_gr_pres,
           Maesgwyn23_gr_pres,Maesgwyn24_gr_pres)


Maximum<-c(Maesgwyn1_gr_max,Maesgwyn2_gr_max,
           Maesgwyn3_gr_max,Maesgwyn4_gr_max,
           Maesgwyn5_gr_max,Maesgwyn6_gr_max,
           Maesgwyn7_gr_max,Maesgwyn8_gr_max,
           Maesgwyn9_gr_max,Maesgwyn10_gr_max,
           Maesgwyn11_gr_max,Maesgwyn12_gr_max,
           Maesgwyn13_gr_max,Maesgwyn14_gr_max,
           Maesgwyn15_gr_max,Maesgwyn16_gr_max,
           Maesgwyn17_gr_max,Maesgwyn18_gr_max,
           Maesgwyn19_gr_max,Maesgwyn20_gr_max,
           Maesgwyn21_gr_max,Maesgwyn22_gr_max,
           Maesgwyn23_gr_max,Maesgwyn24_gr_max)

Low<-c(Maesgwyn1_gr_lw_ref, Maesgwyn2_gr_lw_ref, Maesgwyn3_gr_lw_ref,
       Maesgwyn4_gr_lw_ref, Maesgwyn5_gr_lw_ref, Maesgwyn6_gr_lw_ref,
       Maesgwyn7_gr_lw_ref, Maesgwyn8_gr_lw_ref, Maesgwyn9_gr_lw_ref,
       Maesgwyn10_gr_lw_ref, Maesgwyn11_gr_lw_ref, Maesgwyn12_gr_lw_ref, 
       Maesgwyn13_gr_lw_ref, Maesgwyn14_gr_lw_ref, Maesgwyn15_gr_lw_ref, 
       Maesgwyn16_gr_lw_ref, Maesgwyn17_gr_lw_ref, Maesgwyn18_gr_lw_ref, 
       Maesgwyn19_gr_lw_ref, Maesgwyn20_gr_lw_ref, Maesgwyn21_gr_lw_ref,
       Maesgwyn22_gr_lw_ref,Maesgwyn23_gr_lw_ref,Maesgwyn24_gr_lw_ref)

Moderate<-c(Maesgwyn1_gr_mod_ref, Maesgwyn2_gr_mod_ref, Maesgwyn3_gr_mod_ref,
            Maesgwyn4_gr_mod_ref, Maesgwyn5_gr_mod_ref, Maesgwyn6_gr_mod_ref,
            Maesgwyn7_gr_mod_ref, Maesgwyn8_gr_mod_ref, Maesgwyn9_gr_mod_ref,
            Maesgwyn10_gr_mod_ref, Maesgwyn11_gr_mod_ref, Maesgwyn12_gr_mod_ref, 
            Maesgwyn13_gr_mod_ref, Maesgwyn14_gr_mod_ref, Maesgwyn15_gr_mod_ref, 
            Maesgwyn16_gr_mod_ref, Maesgwyn17_gr_mod_ref, Maesgwyn18_gr_mod_ref, 
            Maesgwyn19_gr_mod_ref, Maesgwyn20_gr_mod_ref, Maesgwyn21_gr_mod_ref,
            Maesgwyn22_gr_mod_ref,Maesgwyn23_gr_mod_ref,Maesgwyn24_gr_mod_ref)

High<-c(Maesgwyn1_gr_high_ref, Maesgwyn2_gr_high_ref, Maesgwyn3_gr_high_ref,
        Maesgwyn4_gr_high_ref, Maesgwyn5_gr_high_ref, Maesgwyn6_gr_high_ref,
        Maesgwyn7_gr_high_ref, Maesgwyn8_gr_high_ref, Maesgwyn9_gr_high_ref,
        Maesgwyn10_gr_high_ref, Maesgwyn11_gr_high_ref, Maesgwyn12_gr_high_ref, 
        Maesgwyn13_gr_high_ref, Maesgwyn14_gr_high_ref, Maesgwyn15_gr_high_ref, 
        Maesgwyn16_gr_high_ref, Maesgwyn17_gr_high_ref, Maesgwyn18_gr_high_ref, 
        Maesgwyn19_gr_high_ref, Maesgwyn20_gr_high_ref, Maesgwyn21_gr_high_ref,
        Maesgwyn22_gr_high_ref,Maesgwyn23_gr_high_ref,Maesgwyn24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Maesgwyngr",24)
Lowsite <- Maesgwynlow
Modsite <- Maesgwynmod
Highsite <-Maesgwynhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Maesgwyngr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##MilourHill

MilourHillpipgr<-subset(allspp4gr_ppip, Site=="MilourHill")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_MilourHillpipgr<-max(MilourHillpipgr$Passes)

#calculate 20% from maximum nightly record

max20_MilourHillpipgr<- (max_MilourHillpipgr/100)*80

##calculate the site classification (reference range)

MilourHillhigh<- max_MilourHillpipgr > allsppgr_ppip_ref_high

MilourHilllow<- allsppgr_ppip_ref_low > max_MilourHillpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_MilourHillpipgr
MilourHillmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
MilourHill1_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 1, replace=F))))
MilourHill1_gr_max <- sum(MilourHill1_gr > max20_MilourHillpipgr)
MilourHill1_gr_max
MilourHill1_gr_pres <- sum(MilourHill1_gr > 0)
MilourHill1_gr_pres
#number of sites which would be classified as low
MilourHill1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill1_gr)
MilourHill1_gr_lw_ref
#number of sites which would be classified as high
MilourHill1_gr_high_ref <- sum( MilourHill1_gr > allsppgr_ppip_ref_high)
MilourHill1_gr_high_ref
#number of sites which would be classified as moderate
MilourHill1_gr_mod_ref <- 1000 - (MilourHill1_gr_high_ref + MilourHill1_gr_lw_ref)
MilourHill1_gr_mod_ref


#2 nights
MilourHill2_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
MilourHill2_grframe<-data.frame(MilourHill2_gr, samp2)
MilourHill2_grframelong <- melt(MilourHill2_grframe,id.vars="samp2")
MilourHill2_grframelong_sum <- ddply(MilourHill2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill2_gr_max <- sum(MilourHill2_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill2_gr_max
MilourHill2_gr_pres <- sum(MilourHill2_grframelong_sum $max > 0)
MilourHill2_gr_pres

#number of sites which would be classified as low
MilourHill2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill2_grframelong_sum$max)
MilourHill2_gr_lw_ref
#number of sites which would be classified as high
MilourHill2_gr_high_ref <- sum( MilourHill2_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill2_gr_high_ref
#number of sites which would be classified as moderate
MilourHill2_gr_mod_ref <- 1000 - (MilourHill2_gr_high_ref + MilourHill2_gr_lw_ref)
MilourHill2_gr_mod_ref


#3 nights
MilourHill3_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
MilourHill3_grframe<-data.frame(MilourHill3_gr, samp2)
MilourHill3_grframelong <- melt(MilourHill3_grframe,id.vars="samp2")
MilourHill3_grframelong_sum <- ddply(MilourHill3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill3_gr_max <- sum(MilourHill3_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill3_gr_max
MilourHill3_gr_pres <- sum(MilourHill3_grframelong_sum $max > 0)
MilourHill3_gr_pres

#number of sites which would be classified as low
MilourHill3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill3_grframelong_sum$max)
MilourHill3_gr_lw_ref
#number of sites which would be classified as high
MilourHill3_gr_high_ref <- sum( MilourHill3_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill3_gr_high_ref
#number of sites which would be classified as moderate
MilourHill3_gr_mod_ref <- 1000 - (MilourHill3_gr_high_ref + MilourHill3_gr_lw_ref)
MilourHill3_gr_mod_ref

#4 nights
MilourHill4_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
MilourHill4_grframe<-data.frame(MilourHill4_gr, samp2)
MilourHill4_grframelong <- melt(MilourHill4_grframe,id.vars="samp2")
MilourHill4_grframelong_sum <- ddply(MilourHill4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill4_gr_max <- sum(MilourHill4_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill4_gr_max
MilourHill4_gr_pres <- sum(MilourHill4_grframelong_sum $max > 0)
MilourHill4_gr_pres

#number of sites which would be classified as low
MilourHill4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill4_grframelong_sum$max)
MilourHill4_gr_lw_ref
#number of sites which would be classified as high
MilourHill4_gr_high_ref <- sum( MilourHill4_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill4_gr_high_ref
#number of sites which would be classified as moderate
MilourHill4_gr_mod_ref <- 1000 - (MilourHill4_gr_high_ref + MilourHill4_gr_lw_ref)
MilourHill4_gr_mod_ref

#5 nights
MilourHill5_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
MilourHill5_grframe<-data.frame(MilourHill5_gr, samp2)
MilourHill5_grframelong <- melt(MilourHill5_grframe,id.vars="samp2")
MilourHill5_grframelong_sum <- ddply(MilourHill5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill5_gr_max <- sum(MilourHill5_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill5_gr_max
MilourHill5_gr_pres <- sum(MilourHill5_grframelong_sum $max > 0)
MilourHill5_gr_pres

#number of sites which would be classified as low
MilourHill5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill5_grframelong_sum$max)
MilourHill5_gr_lw_ref
#number of sites which would be classified as high
MilourHill5_gr_high_ref <- sum( MilourHill5_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill5_gr_high_ref
#number of sites which would be classified as moderate
MilourHill5_gr_mod_ref <- 1000 - (MilourHill5_gr_high_ref + MilourHill5_gr_lw_ref)
MilourHill5_gr_mod_ref

#6 nights
MilourHill6_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
MilourHill6_grframe<-data.frame(MilourHill6_gr, samp2)
MilourHill6_grframelong <- melt(MilourHill6_grframe,id.vars="samp2")
MilourHill6_grframelong_sum <- ddply(MilourHill6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill6_gr_max <- sum(MilourHill6_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill6_gr_max
MilourHill6_gr_pres <- sum(MilourHill6_grframelong_sum $max > 0)
MilourHill6_gr_pres

#number of sites which would be classified as low
MilourHill6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill6_grframelong_sum$max)
MilourHill6_gr_lw_ref
#number of sites which would be classified as high
MilourHill6_gr_high_ref <- sum( MilourHill6_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill6_gr_high_ref
#number of sites which would be classified as moderate
MilourHill6_gr_mod_ref <- 1000 - (MilourHill6_gr_high_ref + MilourHill6_gr_lw_ref)
MilourHill6_gr_mod_ref

#7 nights
MilourHill7_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
MilourHill7_grframe<-data.frame(MilourHill7_gr, samp2)
MilourHill7_grframelong <- melt(MilourHill7_grframe,id.vars="samp2")
MilourHill7_grframelong_sum <- ddply(MilourHill7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill7_gr_max <- sum(MilourHill7_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill7_gr_max
MilourHill7_gr_pres <- sum(MilourHill7_grframelong_sum $max > 0)
MilourHill7_gr_pres

#number of sites which would be classified as low
MilourHill7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill7_grframelong_sum$max)
MilourHill7_gr_lw_ref
#number of sites which would be classified as high
MilourHill7_gr_high_ref <- sum( MilourHill7_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill7_gr_high_ref
#number of sites which would be classified as moderate
MilourHill7_gr_mod_ref <- 1000 - (MilourHill7_gr_high_ref + MilourHill7_gr_lw_ref)
MilourHill7_gr_mod_ref

#8 nights
MilourHill8_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
MilourHill8_grframe<-data.frame(MilourHill8_gr, samp2)
MilourHill8_grframelong <- melt(MilourHill8_grframe,id.vars="samp2")
MilourHill8_grframelong_sum <- ddply(MilourHill8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill8_gr_max <- sum(MilourHill8_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill8_gr_max
MilourHill8_gr_pres <- sum(MilourHill8_grframelong_sum $max > 0)
MilourHill8_gr_pres

#number of sites which would be classified as low
MilourHill8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill8_grframelong_sum$max)
MilourHill8_gr_lw_ref
#number of sites which would be classified as high
MilourHill8_gr_high_ref <- sum( MilourHill8_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill8_gr_high_ref
#number of sites which would be classified as moderate
MilourHill8_gr_mod_ref <- 1000 - (MilourHill8_gr_high_ref + MilourHill8_gr_lw_ref)
MilourHill8_gr_mod_ref

#9 nights
MilourHill9_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
MilourHill9_grframe<-data.frame(MilourHill9_gr, samp2)
MilourHill9_grframelong <- melt(MilourHill9_grframe,id.vars="samp2")
MilourHill9_grframelong_sum <- ddply(MilourHill9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
MilourHill9_gr_max <- sum(MilourHill9_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill9_gr_max
MilourHill9_gr_pres <- sum(MilourHill9_grframelong_sum $max > 0)
MilourHill9_gr_pres

#number of sites which would be classified as low
MilourHill9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill9_grframelong_sum$max)
MilourHill9_gr_lw_ref
#number of sites which would be classified as high
MilourHill9_gr_high_ref <- sum( MilourHill9_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill9_gr_high_ref
#number of sites which would be classified as moderate
MilourHill9_gr_mod_ref <- 1000 - (MilourHill9_gr_high_ref + MilourHill9_gr_lw_ref)
MilourHill9_gr_mod_ref

#10 detectors
MilourHill10_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
MilourHill10_grframe<-data.frame(MilourHill10_gr, samp2)
MilourHill10_grframelong <- melt(MilourHill10_grframe,id.vars="samp2")
MilourHill10_grframelong_sum <- ddply(MilourHill10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill10_gr_max <- sum(MilourHill10_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill10_gr_max
MilourHill10_gr_pres <- sum(MilourHill10_grframelong_sum $max > 0)
MilourHill10_gr_pres

#number of sites which would be classified as low
MilourHill10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill10_grframelong_sum$max)
MilourHill10_gr_lw_ref
#number of sites which would be classified as high
MilourHill10_gr_high_ref <- sum( MilourHill10_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill10_gr_high_ref
#number of sites which would be classified as moderate
MilourHill10_gr_mod_ref <- 1000 - (MilourHill10_gr_high_ref + MilourHill10_gr_lw_ref)
MilourHill10_gr_mod_ref

#11 detectors
MilourHill11_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
MilourHill11_grframe<-data.frame(MilourHill11_gr, samp2)
MilourHill11_grframelong <- melt(MilourHill11_grframe,id.vars="samp2")
MilourHill11_grframelong_sum <- ddply(MilourHill11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill11_gr_max <- sum(MilourHill11_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill11_gr_max
MilourHill11_gr_pres <- sum(MilourHill11_grframelong_sum $max > 0)
MilourHill11_gr_pres

#number of sites which would be classified as low
MilourHill11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill11_grframelong_sum$max)
MilourHill11_gr_lw_ref
#number of sites which would be classified as high
MilourHill11_gr_high_ref <- sum( MilourHill11_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill11_gr_high_ref
#number of sites which would be classified as moderate
MilourHill11_gr_mod_ref <- 1000 - (MilourHill11_gr_high_ref + MilourHill11_gr_lw_ref)
MilourHill11_gr_mod_ref

#12 detectors
MilourHill12_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
MilourHill12_grframe<-data.frame(MilourHill12_gr, samp2)
MilourHill12_grframelong <- melt(MilourHill12_grframe,id.vars="samp2")
MilourHill12_grframelong_sum <- ddply(MilourHill12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill12_gr_max <- sum(MilourHill12_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill12_gr_max
MilourHill12_gr_pres <- sum(MilourHill12_grframelong_sum $max > 0)
MilourHill12_gr_pres

#number of sites which would be classified as low
MilourHill12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill12_grframelong_sum$max)
MilourHill12_gr_lw_ref
#number of sites which would be classified as high
MilourHill12_gr_high_ref <- sum( MilourHill12_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill12_gr_high_ref
#number of sites which would be classified as moderate
MilourHill12_gr_mod_ref <- 1000 - (MilourHill12_gr_high_ref + MilourHill12_gr_lw_ref)
MilourHill12_gr_mod_ref

#13 detectors
MilourHill13_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
MilourHill13_grframe<-data.frame(MilourHill13_gr, samp2)
MilourHill13_grframelong <- melt(MilourHill13_grframe,id.vars="samp2")
MilourHill13_grframelong_sum <- ddply(MilourHill13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill13_gr_max <- sum(MilourHill13_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill13_gr_max
MilourHill13_gr_pres <- sum(MilourHill13_grframelong_sum $max > 0)
MilourHill13_gr_pres

#number of sites which would be classified as low
MilourHill13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill13_grframelong_sum$max)
MilourHill13_gr_lw_ref
#number of sites which would be classified as high
MilourHill13_gr_high_ref <- sum( MilourHill13_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill13_gr_high_ref
#number of sites which would be classified as moderate
MilourHill13_gr_mod_ref <- 1000 - (MilourHill13_gr_high_ref + MilourHill13_gr_lw_ref)
MilourHill13_gr_mod_ref

#14 detectors
MilourHill14_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
MilourHill14_grframe<-data.frame(MilourHill14_gr, samp2)
MilourHill14_grframelong <- melt(MilourHill14_grframe,id.vars="samp2")
MilourHill14_grframelong_sum <- ddply(MilourHill14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill14_gr_max <- sum(MilourHill14_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill14_gr_max
MilourHill14_gr_pres <- sum(MilourHill14_grframelong_sum $max > 0)
MilourHill14_gr_pres

#number of sites which would be classified as low
MilourHill14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill14_grframelong_sum$max)
MilourHill14_gr_lw_ref
#number of sites which would be classified as high
MilourHill14_gr_high_ref <- sum( MilourHill14_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill14_gr_high_ref
#number of sites which would be classified as moderate
MilourHill14_gr_mod_ref <- 1000 - (MilourHill14_gr_high_ref + MilourHill14_gr_lw_ref)
MilourHill14_gr_mod_ref

#15 detectors
MilourHill15_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
MilourHill15_grframe<-data.frame(MilourHill15_gr, samp2)
MilourHill15_grframelong <- melt(MilourHill15_grframe,id.vars="samp2")
MilourHill15_grframelong_sum <- ddply(MilourHill15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill15_gr_max <- sum(MilourHill15_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill15_gr_max
MilourHill15_gr_pres <- sum(MilourHill15_grframelong_sum $max > 0)
MilourHill15_gr_pres

#number of sites which would be classified as low
MilourHill15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill15_grframelong_sum$max)
MilourHill15_gr_lw_ref
#number of sites which would be classified as high
MilourHill15_gr_high_ref <- sum( MilourHill15_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill15_gr_high_ref
#number of sites which would be classified as moderate
MilourHill15_gr_mod_ref <- 1000 - (MilourHill15_gr_high_ref + MilourHill15_gr_lw_ref)
MilourHill15_gr_mod_ref

#16 detectors
MilourHill16_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
MilourHill16_grframe<-data.frame(MilourHill16_gr, samp2)
MilourHill16_grframelong <- melt(MilourHill16_grframe,id.vars="samp2")
MilourHill16_grframelong_sum <- ddply(MilourHill16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill16_gr_max <- sum(MilourHill16_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill16_gr_max
MilourHill16_gr_pres <- sum(MilourHill16_grframelong_sum $max > 0)
MilourHill16_gr_pres

#number of sites which would be classified as low
MilourHill16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill16_grframelong_sum$max)
MilourHill16_gr_lw_ref
#number of sites which would be classified as high
MilourHill16_gr_high_ref <- sum( MilourHill16_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill16_gr_high_ref
#number of sites which would be classified as moderate
MilourHill16_gr_mod_ref <- 1000 - (MilourHill16_gr_high_ref + MilourHill16_gr_lw_ref)
MilourHill16_gr_mod_ref

#17 detectors
MilourHill17_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
MilourHill17_grframe<-data.frame(MilourHill17_gr, samp2)
MilourHill17_grframelong <- melt(MilourHill17_grframe,id.vars="samp2")
MilourHill17_grframelong_sum <- ddply(MilourHill17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill17_gr_max <- sum(MilourHill17_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill17_gr_max
MilourHill17_gr_pres <- sum(MilourHill17_grframelong_sum $max > 0)
MilourHill17_gr_pres

#number of sites which would be classified as low
MilourHill17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill17_grframelong_sum$max)
MilourHill17_gr_lw_ref
#number of sites which would be classified as high
MilourHill17_gr_high_ref <- sum( MilourHill17_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill17_gr_high_ref
#number of sites which would be classified as moderate
MilourHill17_gr_mod_ref <- 1000 - (MilourHill17_gr_high_ref + MilourHill17_gr_lw_ref)
MilourHill17_gr_mod_ref

#18 detectors
MilourHill18_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
MilourHill18_grframe<-data.frame(MilourHill18_gr, samp2)
MilourHill18_grframelong <- melt(MilourHill18_grframe,id.vars="samp2")
MilourHill18_grframelong_sum <- ddply(MilourHill18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill18_gr_max <- sum(MilourHill18_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill18_gr_max
MilourHill18_gr_pres <- sum(MilourHill18_grframelong_sum $max > 0)
MilourHill18_gr_pres

#number of sites which would be classified as low
MilourHill18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill18_grframelong_sum$max)
MilourHill18_gr_lw_ref
#number of sites which would be classified as high
MilourHill18_gr_high_ref <- sum( MilourHill18_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill18_gr_high_ref
#number of sites which would be classified as moderate
MilourHill18_gr_mod_ref <- 1000 - (MilourHill18_gr_high_ref + MilourHill18_gr_lw_ref)
MilourHill18_gr_mod_ref

#19 detectors
MilourHill19_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
MilourHill19_grframe<-data.frame(MilourHill19_gr, samp2)
MilourHill19_grframelong <- melt(MilourHill19_grframe,id.vars="samp2")
MilourHill19_grframelong_sum <- ddply(MilourHill19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill19_gr_max <- sum(MilourHill19_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill19_gr_max
MilourHill19_gr_pres <- sum(MilourHill19_grframelong_sum $max > 0)
MilourHill19_gr_pres

#number of sites which would be classified as low
MilourHill19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill19_grframelong_sum$max)
MilourHill19_gr_lw_ref
#number of sites which would be classified as high
MilourHill19_gr_high_ref <- sum( MilourHill19_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill19_gr_high_ref
#number of sites which would be classified as moderate
MilourHill19_gr_mod_ref <- 1000 - (MilourHill19_gr_high_ref + MilourHill19_gr_lw_ref)
MilourHill19_gr_mod_ref

#20 detectors
MilourHill20_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
MilourHill20_grframe<-data.frame(MilourHill20_gr, samp2)
MilourHill20_grframelong <- melt(MilourHill20_grframe,id.vars="samp2")
MilourHill20_grframelong_sum <- ddply(MilourHill20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill20_gr_max <- sum(MilourHill20_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill20_gr_max
MilourHill20_gr_pres <- sum(MilourHill20_grframelong_sum $max > 0)
MilourHill20_gr_pres

#number of sites which would be classified as low
MilourHill20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill20_grframelong_sum$max)
MilourHill20_gr_lw_ref
#number of sites which would be classified as high
MilourHill20_gr_high_ref <- sum( MilourHill20_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill20_gr_high_ref
#number of sites which would be classified as moderate
MilourHill20_gr_mod_ref <- 1000 - (MilourHill20_gr_high_ref + MilourHill20_gr_lw_ref)
MilourHill20_gr_mod_ref

#21 detectors
MilourHill21_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
MilourHill21_grframe<-data.frame(MilourHill21_gr, samp2)
MilourHill21_grframelong <- melt(MilourHill21_grframe,id.vars="samp2")
MilourHill21_grframelong_sum <- ddply(MilourHill21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill21_gr_max <- sum(MilourHill21_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill21_gr_max
MilourHill21_gr_pres <- sum(MilourHill21_grframelong_sum $max > 0)
MilourHill21_gr_pres

#number of sites which would be classified as low
MilourHill21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill21_grframelong_sum$max)
MilourHill21_gr_lw_ref
#number of sites which would be classified as high
MilourHill21_gr_high_ref <- sum( MilourHill21_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill21_gr_high_ref
#number of sites which would be classified as moderate
MilourHill21_gr_mod_ref <- 1000 - (MilourHill21_gr_high_ref + MilourHill21_gr_lw_ref)
MilourHill21_gr_mod_ref

#22 detectors
MilourHill22_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
MilourHill22_grframe<-data.frame(MilourHill22_gr, samp2)
MilourHill22_grframelong <- melt(MilourHill22_grframe,id.vars="samp2")
MilourHill22_grframelong_sum <- ddply(MilourHill22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill22_gr_max <- sum(MilourHill22_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill22_gr_max
MilourHill22_gr_pres <- sum(MilourHill22_grframelong_sum $max > 0)
MilourHill22_gr_pres

#number of sites which would be classified as low
MilourHill22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill22_grframelong_sum$max)
MilourHill22_gr_lw_ref
#number of sites which would be classified as high
MilourHill22_gr_high_ref <- sum( MilourHill22_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill22_gr_high_ref
#number of sites which would be classified as moderate
MilourHill22_gr_mod_ref <- 1000 - (MilourHill22_gr_high_ref + MilourHill22_gr_lw_ref)
MilourHill22_gr_mod_ref

#23 detectors
MilourHill23_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
MilourHill23_grframe<-data.frame(MilourHill23_gr, samp2)
MilourHill23_grframelong <- melt(MilourHill23_grframe,id.vars="samp2")
MilourHill23_grframelong_sum <- ddply(MilourHill23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill23_gr_max <- sum(MilourHill23_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill23_gr_max
MilourHill23_gr_pres <- sum(MilourHill23_grframelong_sum $max > 0)
MilourHill23_gr_pres

#number of sites which would be classified as low
MilourHill23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill23_grframelong_sum$max)
MilourHill23_gr_lw_ref
#number of sites which would be classified as high
MilourHill23_gr_high_ref <- sum( MilourHill23_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill23_gr_high_ref
#number of sites which would be classified as moderate
MilourHill23_gr_mod_ref <- 1000 - (MilourHill23_gr_high_ref + MilourHill23_gr_lw_ref)
MilourHill23_gr_mod_ref

#24 detectors
MilourHill24_gr<-(replicate(1000, (sample(MilourHillpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
MilourHill24_grframe<-data.frame(MilourHill24_gr, samp2)
MilourHill24_grframelong <- melt(MilourHill24_grframe,id.vars="samp2")
MilourHill24_grframelong_sum <- ddply(MilourHill24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MilourHill24_gr_max <- sum(MilourHill24_grframelong_sum $max > max20_MilourHillpipgr)
MilourHill24_gr_max
MilourHill24_gr_pres <- sum(MilourHill24_grframelong_sum $max > 0)
MilourHill24_gr_pres

#number of sites which would be classified as low
MilourHill24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MilourHill24_grframelong_sum$max)
MilourHill24_gr_lw_ref
#number of sites which would be classified as high
MilourHill24_gr_high_ref <- sum( MilourHill24_grframelong_sum$max > allsppgr_ppip_ref_high)
MilourHill24_gr_high_ref
#number of sites which would be classified as moderate
MilourHill24_gr_mod_ref <- 1000 - (MilourHill24_gr_high_ref + MilourHill24_gr_lw_ref)
MilourHill24_gr_mod_ref

Present<-c(MilourHill1_gr_pres,MilourHill2_gr_pres,
           MilourHill3_gr_pres,MilourHill4_gr_pres,
           MilourHill5_gr_pres,MilourHill6_gr_pres,
           MilourHill7_gr_pres,MilourHill8_gr_pres,
           MilourHill9_gr_pres,MilourHill10_gr_pres,
           MilourHill11_gr_pres,MilourHill12_gr_pres,
           MilourHill13_gr_pres,MilourHill14_gr_pres,
           MilourHill15_gr_pres,MilourHill16_gr_pres,
           MilourHill17_gr_pres,MilourHill18_gr_pres,
           MilourHill19_gr_pres,MilourHill20_gr_pres,
           MilourHill21_gr_pres,MilourHill22_gr_pres,
           MilourHill23_gr_pres,MilourHill24_gr_pres)


Maximum<-c(MilourHill1_gr_max,MilourHill2_gr_max,
           MilourHill3_gr_max,MilourHill4_gr_max,
           MilourHill5_gr_max,MilourHill6_gr_max,
           MilourHill7_gr_max,MilourHill8_gr_max,
           MilourHill9_gr_max,MilourHill10_gr_max,
           MilourHill11_gr_max,MilourHill12_gr_max,
           MilourHill13_gr_max,MilourHill14_gr_max,
           MilourHill15_gr_max,MilourHill16_gr_max,
           MilourHill17_gr_max,MilourHill18_gr_max,
           MilourHill19_gr_max,MilourHill20_gr_max,
           MilourHill21_gr_max,MilourHill22_gr_max,
           MilourHill23_gr_max,MilourHill24_gr_max)

Low<-c(MilourHill1_gr_lw_ref, MilourHill2_gr_lw_ref, MilourHill3_gr_lw_ref,
       MilourHill4_gr_lw_ref, MilourHill5_gr_lw_ref, MilourHill6_gr_lw_ref,
       MilourHill7_gr_lw_ref, MilourHill8_gr_lw_ref, MilourHill9_gr_lw_ref,
       MilourHill10_gr_lw_ref, MilourHill11_gr_lw_ref, MilourHill12_gr_lw_ref, 
       MilourHill13_gr_lw_ref, MilourHill14_gr_lw_ref, MilourHill15_gr_lw_ref, 
       MilourHill16_gr_lw_ref, MilourHill17_gr_lw_ref, MilourHill18_gr_lw_ref, 
       MilourHill19_gr_lw_ref, MilourHill20_gr_lw_ref, MilourHill21_gr_lw_ref,
       MilourHill22_gr_lw_ref,MilourHill23_gr_lw_ref,MilourHill24_gr_lw_ref)

Moderate<-c(MilourHill1_gr_mod_ref, MilourHill2_gr_mod_ref, MilourHill3_gr_mod_ref,
            MilourHill4_gr_mod_ref, MilourHill5_gr_mod_ref, MilourHill6_gr_mod_ref,
            MilourHill7_gr_mod_ref, MilourHill8_gr_mod_ref, MilourHill9_gr_mod_ref,
            MilourHill10_gr_mod_ref, MilourHill11_gr_mod_ref, MilourHill12_gr_mod_ref, 
            MilourHill13_gr_mod_ref, MilourHill14_gr_mod_ref, MilourHill15_gr_mod_ref, 
            MilourHill16_gr_mod_ref, MilourHill17_gr_mod_ref, MilourHill18_gr_mod_ref, 
            MilourHill19_gr_mod_ref, MilourHill20_gr_mod_ref, MilourHill21_gr_mod_ref,
            MilourHill22_gr_mod_ref,MilourHill23_gr_mod_ref,MilourHill24_gr_mod_ref)

High<-c(MilourHill1_gr_high_ref, MilourHill2_gr_high_ref, MilourHill3_gr_high_ref,
        MilourHill4_gr_high_ref, MilourHill5_gr_high_ref, MilourHill6_gr_high_ref,
        MilourHill7_gr_high_ref, MilourHill8_gr_high_ref, MilourHill9_gr_high_ref,
        MilourHill10_gr_high_ref, MilourHill11_gr_high_ref, MilourHill12_gr_high_ref, 
        MilourHill13_gr_high_ref, MilourHill14_gr_high_ref, MilourHill15_gr_high_ref, 
        MilourHill16_gr_high_ref, MilourHill17_gr_high_ref, MilourHill18_gr_high_ref, 
        MilourHill19_gr_high_ref, MilourHill20_gr_high_ref, MilourHill21_gr_high_ref,
        MilourHill22_gr_high_ref,MilourHill23_gr_high_ref,MilourHill24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("MilourHillgr",24)
Lowsite <- MilourHilllow
Modsite <- MilourHillmod
Highsite <-MilourHillhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



MilourHillgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##MynyddGordu

MynyddGordupipgr<-subset(allspp4gr_ppip, Site=="MynyddGordu")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_MynyddGordupipgr<-max(MynyddGordupipgr$Passes)

#calculate 20% from maximum nightly record

max20_MynyddGordupipgr<- (max_MynyddGordupipgr/100)*80

##calculate the site classification (reference range)

MynyddGorduhigh<- max_MynyddGordupipgr > allsppgr_ppip_ref_high

MynyddGordulow<- allsppgr_ppip_ref_low > max_MynyddGordupipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_MynyddGordupipgr
MynyddGordumod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
MynyddGordu1_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 1, replace=F))))
MynyddGordu1_gr_max <- sum(MynyddGordu1_gr > max20_MynyddGordupipgr)
MynyddGordu1_gr_max
MynyddGordu1_gr_pres <- sum(MynyddGordu1_gr > 0)
MynyddGordu1_gr_pres
#number of sites which would be classified as low
MynyddGordu1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu1_gr)
MynyddGordu1_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu1_gr_high_ref <- sum( MynyddGordu1_gr > allsppgr_ppip_ref_high)
MynyddGordu1_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu1_gr_mod_ref <- 1000 - (MynyddGordu1_gr_high_ref + MynyddGordu1_gr_lw_ref)
MynyddGordu1_gr_mod_ref


#2 nights
MynyddGordu2_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
MynyddGordu2_grframe<-data.frame(MynyddGordu2_gr, samp2)
MynyddGordu2_grframelong <- melt(MynyddGordu2_grframe,id.vars="samp2")
MynyddGordu2_grframelong_sum <- ddply(MynyddGordu2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu2_gr_max <- sum(MynyddGordu2_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu2_gr_max
MynyddGordu2_gr_pres <- sum(MynyddGordu2_grframelong_sum $max > 0)
MynyddGordu2_gr_pres

#number of sites which would be classified as low
MynyddGordu2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu2_grframelong_sum$max)
MynyddGordu2_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu2_gr_high_ref <- sum( MynyddGordu2_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu2_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu2_gr_mod_ref <- 1000 - (MynyddGordu2_gr_high_ref + MynyddGordu2_gr_lw_ref)
MynyddGordu2_gr_mod_ref


#3 nights
MynyddGordu3_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
MynyddGordu3_grframe<-data.frame(MynyddGordu3_gr, samp2)
MynyddGordu3_grframelong <- melt(MynyddGordu3_grframe,id.vars="samp2")
MynyddGordu3_grframelong_sum <- ddply(MynyddGordu3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu3_gr_max <- sum(MynyddGordu3_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu3_gr_max
MynyddGordu3_gr_pres <- sum(MynyddGordu3_grframelong_sum $max > 0)
MynyddGordu3_gr_pres

#number of sites which would be classified as low
MynyddGordu3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu3_grframelong_sum$max)
MynyddGordu3_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu3_gr_high_ref <- sum( MynyddGordu3_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu3_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu3_gr_mod_ref <- 1000 - (MynyddGordu3_gr_high_ref + MynyddGordu3_gr_lw_ref)
MynyddGordu3_gr_mod_ref

#4 nights
MynyddGordu4_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
MynyddGordu4_grframe<-data.frame(MynyddGordu4_gr, samp2)
MynyddGordu4_grframelong <- melt(MynyddGordu4_grframe,id.vars="samp2")
MynyddGordu4_grframelong_sum <- ddply(MynyddGordu4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu4_gr_max <- sum(MynyddGordu4_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu4_gr_max
MynyddGordu4_gr_pres <- sum(MynyddGordu4_grframelong_sum $max > 0)
MynyddGordu4_gr_pres

#number of sites which would be classified as low
MynyddGordu4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu4_grframelong_sum$max)
MynyddGordu4_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu4_gr_high_ref <- sum( MynyddGordu4_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu4_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu4_gr_mod_ref <- 1000 - (MynyddGordu4_gr_high_ref + MynyddGordu4_gr_lw_ref)
MynyddGordu4_gr_mod_ref

#5 nights
MynyddGordu5_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
MynyddGordu5_grframe<-data.frame(MynyddGordu5_gr, samp2)
MynyddGordu5_grframelong <- melt(MynyddGordu5_grframe,id.vars="samp2")
MynyddGordu5_grframelong_sum <- ddply(MynyddGordu5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu5_gr_max <- sum(MynyddGordu5_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu5_gr_max
MynyddGordu5_gr_pres <- sum(MynyddGordu5_grframelong_sum $max > 0)
MynyddGordu5_gr_pres

#number of sites which would be classified as low
MynyddGordu5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu5_grframelong_sum$max)
MynyddGordu5_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu5_gr_high_ref <- sum( MynyddGordu5_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu5_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu5_gr_mod_ref <- 1000 - (MynyddGordu5_gr_high_ref + MynyddGordu5_gr_lw_ref)
MynyddGordu5_gr_mod_ref

#6 nights
MynyddGordu6_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
MynyddGordu6_grframe<-data.frame(MynyddGordu6_gr, samp2)
MynyddGordu6_grframelong <- melt(MynyddGordu6_grframe,id.vars="samp2")
MynyddGordu6_grframelong_sum <- ddply(MynyddGordu6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu6_gr_max <- sum(MynyddGordu6_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu6_gr_max
MynyddGordu6_gr_pres <- sum(MynyddGordu6_grframelong_sum $max > 0)
MynyddGordu6_gr_pres

#number of sites which would be classified as low
MynyddGordu6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu6_grframelong_sum$max)
MynyddGordu6_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu6_gr_high_ref <- sum( MynyddGordu6_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu6_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu6_gr_mod_ref <- 1000 - (MynyddGordu6_gr_high_ref + MynyddGordu6_gr_lw_ref)
MynyddGordu6_gr_mod_ref

#7 nights
MynyddGordu7_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
MynyddGordu7_grframe<-data.frame(MynyddGordu7_gr, samp2)
MynyddGordu7_grframelong <- melt(MynyddGordu7_grframe,id.vars="samp2")
MynyddGordu7_grframelong_sum <- ddply(MynyddGordu7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu7_gr_max <- sum(MynyddGordu7_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu7_gr_max
MynyddGordu7_gr_pres <- sum(MynyddGordu7_grframelong_sum $max > 0)
MynyddGordu7_gr_pres

#number of sites which would be classified as low
MynyddGordu7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu7_grframelong_sum$max)
MynyddGordu7_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu7_gr_high_ref <- sum( MynyddGordu7_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu7_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu7_gr_mod_ref <- 1000 - (MynyddGordu7_gr_high_ref + MynyddGordu7_gr_lw_ref)
MynyddGordu7_gr_mod_ref

#8 nights
MynyddGordu8_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
MynyddGordu8_grframe<-data.frame(MynyddGordu8_gr, samp2)
MynyddGordu8_grframelong <- melt(MynyddGordu8_grframe,id.vars="samp2")
MynyddGordu8_grframelong_sum <- ddply(MynyddGordu8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu8_gr_max <- sum(MynyddGordu8_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu8_gr_max
MynyddGordu8_gr_pres <- sum(MynyddGordu8_grframelong_sum $max > 0)
MynyddGordu8_gr_pres

#number of sites which would be classified as low
MynyddGordu8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu8_grframelong_sum$max)
MynyddGordu8_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu8_gr_high_ref <- sum( MynyddGordu8_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu8_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu8_gr_mod_ref <- 1000 - (MynyddGordu8_gr_high_ref + MynyddGordu8_gr_lw_ref)
MynyddGordu8_gr_mod_ref

#9 nights
MynyddGordu9_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
MynyddGordu9_grframe<-data.frame(MynyddGordu9_gr, samp2)
MynyddGordu9_grframelong <- melt(MynyddGordu9_grframe,id.vars="samp2")
MynyddGordu9_grframelong_sum <- ddply(MynyddGordu9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
MynyddGordu9_gr_max <- sum(MynyddGordu9_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu9_gr_max
MynyddGordu9_gr_pres <- sum(MynyddGordu9_grframelong_sum $max > 0)
MynyddGordu9_gr_pres

#number of sites which would be classified as low
MynyddGordu9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu9_grframelong_sum$max)
MynyddGordu9_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu9_gr_high_ref <- sum( MynyddGordu9_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu9_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu9_gr_mod_ref <- 1000 - (MynyddGordu9_gr_high_ref + MynyddGordu9_gr_lw_ref)
MynyddGordu9_gr_mod_ref

#10 detectors
MynyddGordu10_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
MynyddGordu10_grframe<-data.frame(MynyddGordu10_gr, samp2)
MynyddGordu10_grframelong <- melt(MynyddGordu10_grframe,id.vars="samp2")
MynyddGordu10_grframelong_sum <- ddply(MynyddGordu10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu10_gr_max <- sum(MynyddGordu10_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu10_gr_max
MynyddGordu10_gr_pres <- sum(MynyddGordu10_grframelong_sum $max > 0)
MynyddGordu10_gr_pres

#number of sites which would be classified as low
MynyddGordu10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu10_grframelong_sum$max)
MynyddGordu10_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu10_gr_high_ref <- sum( MynyddGordu10_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu10_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu10_gr_mod_ref <- 1000 - (MynyddGordu10_gr_high_ref + MynyddGordu10_gr_lw_ref)
MynyddGordu10_gr_mod_ref

#11 detectors
MynyddGordu11_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
MynyddGordu11_grframe<-data.frame(MynyddGordu11_gr, samp2)
MynyddGordu11_grframelong <- melt(MynyddGordu11_grframe,id.vars="samp2")
MynyddGordu11_grframelong_sum <- ddply(MynyddGordu11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu11_gr_max <- sum(MynyddGordu11_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu11_gr_max
MynyddGordu11_gr_pres <- sum(MynyddGordu11_grframelong_sum $max > 0)
MynyddGordu11_gr_pres

#number of sites which would be classified as low
MynyddGordu11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu11_grframelong_sum$max)
MynyddGordu11_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu11_gr_high_ref <- sum( MynyddGordu11_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu11_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu11_gr_mod_ref <- 1000 - (MynyddGordu11_gr_high_ref + MynyddGordu11_gr_lw_ref)
MynyddGordu11_gr_mod_ref

#12 detectors
MynyddGordu12_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
MynyddGordu12_grframe<-data.frame(MynyddGordu12_gr, samp2)
MynyddGordu12_grframelong <- melt(MynyddGordu12_grframe,id.vars="samp2")
MynyddGordu12_grframelong_sum <- ddply(MynyddGordu12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu12_gr_max <- sum(MynyddGordu12_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu12_gr_max
MynyddGordu12_gr_pres <- sum(MynyddGordu12_grframelong_sum $max > 0)
MynyddGordu12_gr_pres

#number of sites which would be classified as low
MynyddGordu12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu12_grframelong_sum$max)
MynyddGordu12_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu12_gr_high_ref <- sum( MynyddGordu12_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu12_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu12_gr_mod_ref <- 1000 - (MynyddGordu12_gr_high_ref + MynyddGordu12_gr_lw_ref)
MynyddGordu12_gr_mod_ref

#13 detectors
MynyddGordu13_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
MynyddGordu13_grframe<-data.frame(MynyddGordu13_gr, samp2)
MynyddGordu13_grframelong <- melt(MynyddGordu13_grframe,id.vars="samp2")
MynyddGordu13_grframelong_sum <- ddply(MynyddGordu13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu13_gr_max <- sum(MynyddGordu13_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu13_gr_max
MynyddGordu13_gr_pres <- sum(MynyddGordu13_grframelong_sum $max > 0)
MynyddGordu13_gr_pres

#number of sites which would be classified as low
MynyddGordu13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu13_grframelong_sum$max)
MynyddGordu13_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu13_gr_high_ref <- sum( MynyddGordu13_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu13_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu13_gr_mod_ref <- 1000 - (MynyddGordu13_gr_high_ref + MynyddGordu13_gr_lw_ref)
MynyddGordu13_gr_mod_ref

#14 detectors
MynyddGordu14_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
MynyddGordu14_grframe<-data.frame(MynyddGordu14_gr, samp2)
MynyddGordu14_grframelong <- melt(MynyddGordu14_grframe,id.vars="samp2")
MynyddGordu14_grframelong_sum <- ddply(MynyddGordu14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu14_gr_max <- sum(MynyddGordu14_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu14_gr_max
MynyddGordu14_gr_pres <- sum(MynyddGordu14_grframelong_sum $max > 0)
MynyddGordu14_gr_pres

#number of sites which would be classified as low
MynyddGordu14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu14_grframelong_sum$max)
MynyddGordu14_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu14_gr_high_ref <- sum( MynyddGordu14_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu14_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu14_gr_mod_ref <- 1000 - (MynyddGordu14_gr_high_ref + MynyddGordu14_gr_lw_ref)
MynyddGordu14_gr_mod_ref

#15 detectors
MynyddGordu15_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
MynyddGordu15_grframe<-data.frame(MynyddGordu15_gr, samp2)
MynyddGordu15_grframelong <- melt(MynyddGordu15_grframe,id.vars="samp2")
MynyddGordu15_grframelong_sum <- ddply(MynyddGordu15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu15_gr_max <- sum(MynyddGordu15_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu15_gr_max
MynyddGordu15_gr_pres <- sum(MynyddGordu15_grframelong_sum $max > 0)
MynyddGordu15_gr_pres

#number of sites which would be classified as low
MynyddGordu15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu15_grframelong_sum$max)
MynyddGordu15_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu15_gr_high_ref <- sum( MynyddGordu15_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu15_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu15_gr_mod_ref <- 1000 - (MynyddGordu15_gr_high_ref + MynyddGordu15_gr_lw_ref)
MynyddGordu15_gr_mod_ref

#16 detectors
MynyddGordu16_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
MynyddGordu16_grframe<-data.frame(MynyddGordu16_gr, samp2)
MynyddGordu16_grframelong <- melt(MynyddGordu16_grframe,id.vars="samp2")
MynyddGordu16_grframelong_sum <- ddply(MynyddGordu16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu16_gr_max <- sum(MynyddGordu16_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu16_gr_max
MynyddGordu16_gr_pres <- sum(MynyddGordu16_grframelong_sum $max > 0)
MynyddGordu16_gr_pres

#number of sites which would be classified as low
MynyddGordu16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu16_grframelong_sum$max)
MynyddGordu16_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu16_gr_high_ref <- sum( MynyddGordu16_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu16_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu16_gr_mod_ref <- 1000 - (MynyddGordu16_gr_high_ref + MynyddGordu16_gr_lw_ref)
MynyddGordu16_gr_mod_ref

#17 detectors
MynyddGordu17_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
MynyddGordu17_grframe<-data.frame(MynyddGordu17_gr, samp2)
MynyddGordu17_grframelong <- melt(MynyddGordu17_grframe,id.vars="samp2")
MynyddGordu17_grframelong_sum <- ddply(MynyddGordu17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu17_gr_max <- sum(MynyddGordu17_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu17_gr_max
MynyddGordu17_gr_pres <- sum(MynyddGordu17_grframelong_sum $max > 0)
MynyddGordu17_gr_pres

#number of sites which would be classified as low
MynyddGordu17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu17_grframelong_sum$max)
MynyddGordu17_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu17_gr_high_ref <- sum( MynyddGordu17_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu17_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu17_gr_mod_ref <- 1000 - (MynyddGordu17_gr_high_ref + MynyddGordu17_gr_lw_ref)
MynyddGordu17_gr_mod_ref

#18 detectors
MynyddGordu18_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
MynyddGordu18_grframe<-data.frame(MynyddGordu18_gr, samp2)
MynyddGordu18_grframelong <- melt(MynyddGordu18_grframe,id.vars="samp2")
MynyddGordu18_grframelong_sum <- ddply(MynyddGordu18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu18_gr_max <- sum(MynyddGordu18_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu18_gr_max
MynyddGordu18_gr_pres <- sum(MynyddGordu18_grframelong_sum $max > 0)
MynyddGordu18_gr_pres

#number of sites which would be classified as low
MynyddGordu18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu18_grframelong_sum$max)
MynyddGordu18_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu18_gr_high_ref <- sum( MynyddGordu18_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu18_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu18_gr_mod_ref <- 1000 - (MynyddGordu18_gr_high_ref + MynyddGordu18_gr_lw_ref)
MynyddGordu18_gr_mod_ref

#19 detectors
MynyddGordu19_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
MynyddGordu19_grframe<-data.frame(MynyddGordu19_gr, samp2)
MynyddGordu19_grframelong <- melt(MynyddGordu19_grframe,id.vars="samp2")
MynyddGordu19_grframelong_sum <- ddply(MynyddGordu19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu19_gr_max <- sum(MynyddGordu19_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu19_gr_max
MynyddGordu19_gr_pres <- sum(MynyddGordu19_grframelong_sum $max > 0)
MynyddGordu19_gr_pres

#number of sites which would be classified as low
MynyddGordu19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu19_grframelong_sum$max)
MynyddGordu19_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu19_gr_high_ref <- sum( MynyddGordu19_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu19_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu19_gr_mod_ref <- 1000 - (MynyddGordu19_gr_high_ref + MynyddGordu19_gr_lw_ref)
MynyddGordu19_gr_mod_ref

#20 detectors
MynyddGordu20_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
MynyddGordu20_grframe<-data.frame(MynyddGordu20_gr, samp2)
MynyddGordu20_grframelong <- melt(MynyddGordu20_grframe,id.vars="samp2")
MynyddGordu20_grframelong_sum <- ddply(MynyddGordu20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu20_gr_max <- sum(MynyddGordu20_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu20_gr_max
MynyddGordu20_gr_pres <- sum(MynyddGordu20_grframelong_sum $max > 0)
MynyddGordu20_gr_pres

#number of sites which would be classified as low
MynyddGordu20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu20_grframelong_sum$max)
MynyddGordu20_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu20_gr_high_ref <- sum( MynyddGordu20_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu20_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu20_gr_mod_ref <- 1000 - (MynyddGordu20_gr_high_ref + MynyddGordu20_gr_lw_ref)
MynyddGordu20_gr_mod_ref

#21 detectors
MynyddGordu21_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
MynyddGordu21_grframe<-data.frame(MynyddGordu21_gr, samp2)
MynyddGordu21_grframelong <- melt(MynyddGordu21_grframe,id.vars="samp2")
MynyddGordu21_grframelong_sum <- ddply(MynyddGordu21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu21_gr_max <- sum(MynyddGordu21_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu21_gr_max
MynyddGordu21_gr_pres <- sum(MynyddGordu21_grframelong_sum $max > 0)
MynyddGordu21_gr_pres

#number of sites which would be classified as low
MynyddGordu21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu21_grframelong_sum$max)
MynyddGordu21_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu21_gr_high_ref <- sum( MynyddGordu21_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu21_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu21_gr_mod_ref <- 1000 - (MynyddGordu21_gr_high_ref + MynyddGordu21_gr_lw_ref)
MynyddGordu21_gr_mod_ref

#22 detectors
MynyddGordu22_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
MynyddGordu22_grframe<-data.frame(MynyddGordu22_gr, samp2)
MynyddGordu22_grframelong <- melt(MynyddGordu22_grframe,id.vars="samp2")
MynyddGordu22_grframelong_sum <- ddply(MynyddGordu22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu22_gr_max <- sum(MynyddGordu22_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu22_gr_max
MynyddGordu22_gr_pres <- sum(MynyddGordu22_grframelong_sum $max > 0)
MynyddGordu22_gr_pres

#number of sites which would be classified as low
MynyddGordu22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu22_grframelong_sum$max)
MynyddGordu22_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu22_gr_high_ref <- sum( MynyddGordu22_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu22_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu22_gr_mod_ref <- 1000 - (MynyddGordu22_gr_high_ref + MynyddGordu22_gr_lw_ref)
MynyddGordu22_gr_mod_ref

#23 detectors
MynyddGordu23_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
MynyddGordu23_grframe<-data.frame(MynyddGordu23_gr, samp2)
MynyddGordu23_grframelong <- melt(MynyddGordu23_grframe,id.vars="samp2")
MynyddGordu23_grframelong_sum <- ddply(MynyddGordu23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu23_gr_max <- sum(MynyddGordu23_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu23_gr_max
MynyddGordu23_gr_pres <- sum(MynyddGordu23_grframelong_sum $max > 0)
MynyddGordu23_gr_pres

#number of sites which would be classified as low
MynyddGordu23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu23_grframelong_sum$max)
MynyddGordu23_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu23_gr_high_ref <- sum( MynyddGordu23_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu23_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu23_gr_mod_ref <- 1000 - (MynyddGordu23_gr_high_ref + MynyddGordu23_gr_lw_ref)
MynyddGordu23_gr_mod_ref

#24 detectors
MynyddGordu24_gr<-(replicate(1000, (sample(MynyddGordupipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
MynyddGordu24_grframe<-data.frame(MynyddGordu24_gr, samp2)
MynyddGordu24_grframelong <- melt(MynyddGordu24_grframe,id.vars="samp2")
MynyddGordu24_grframelong_sum <- ddply(MynyddGordu24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddGordu24_gr_max <- sum(MynyddGordu24_grframelong_sum $max > max20_MynyddGordupipgr)
MynyddGordu24_gr_max
MynyddGordu24_gr_pres <- sum(MynyddGordu24_grframelong_sum $max > 0)
MynyddGordu24_gr_pres

#number of sites which would be classified as low
MynyddGordu24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddGordu24_grframelong_sum$max)
MynyddGordu24_gr_lw_ref
#number of sites which would be classified as high
MynyddGordu24_gr_high_ref <- sum( MynyddGordu24_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddGordu24_gr_high_ref
#number of sites which would be classified as moderate
MynyddGordu24_gr_mod_ref <- 1000 - (MynyddGordu24_gr_high_ref + MynyddGordu24_gr_lw_ref)
MynyddGordu24_gr_mod_ref

Present<-c(MynyddGordu1_gr_pres,MynyddGordu2_gr_pres,
           MynyddGordu3_gr_pres,MynyddGordu4_gr_pres,
           MynyddGordu5_gr_pres,MynyddGordu6_gr_pres,
           MynyddGordu7_gr_pres,MynyddGordu8_gr_pres,
           MynyddGordu9_gr_pres,MynyddGordu10_gr_pres,
           MynyddGordu11_gr_pres,MynyddGordu12_gr_pres,
           MynyddGordu13_gr_pres,MynyddGordu14_gr_pres,
           MynyddGordu15_gr_pres,MynyddGordu16_gr_pres,
           MynyddGordu17_gr_pres,MynyddGordu18_gr_pres,
           MynyddGordu19_gr_pres,MynyddGordu20_gr_pres,
           MynyddGordu21_gr_pres,MynyddGordu22_gr_pres,
           MynyddGordu23_gr_pres,MynyddGordu24_gr_pres)


Maximum<-c(MynyddGordu1_gr_max,MynyddGordu2_gr_max,
           MynyddGordu3_gr_max,MynyddGordu4_gr_max,
           MynyddGordu5_gr_max,MynyddGordu6_gr_max,
           MynyddGordu7_gr_max,MynyddGordu8_gr_max,
           MynyddGordu9_gr_max,MynyddGordu10_gr_max,
           MynyddGordu11_gr_max,MynyddGordu12_gr_max,
           MynyddGordu13_gr_max,MynyddGordu14_gr_max,
           MynyddGordu15_gr_max,MynyddGordu16_gr_max,
           MynyddGordu17_gr_max,MynyddGordu18_gr_max,
           MynyddGordu19_gr_max,MynyddGordu20_gr_max,
           MynyddGordu21_gr_max,MynyddGordu22_gr_max,
           MynyddGordu23_gr_max,MynyddGordu24_gr_max)

Low<-c(MynyddGordu1_gr_lw_ref, MynyddGordu2_gr_lw_ref, MynyddGordu3_gr_lw_ref,
       MynyddGordu4_gr_lw_ref, MynyddGordu5_gr_lw_ref, MynyddGordu6_gr_lw_ref,
       MynyddGordu7_gr_lw_ref, MynyddGordu8_gr_lw_ref, MynyddGordu9_gr_lw_ref,
       MynyddGordu10_gr_lw_ref, MynyddGordu11_gr_lw_ref, MynyddGordu12_gr_lw_ref, 
       MynyddGordu13_gr_lw_ref, MynyddGordu14_gr_lw_ref, MynyddGordu15_gr_lw_ref, 
       MynyddGordu16_gr_lw_ref, MynyddGordu17_gr_lw_ref, MynyddGordu18_gr_lw_ref, 
       MynyddGordu19_gr_lw_ref, MynyddGordu20_gr_lw_ref, MynyddGordu21_gr_lw_ref,
       MynyddGordu22_gr_lw_ref,MynyddGordu23_gr_lw_ref,MynyddGordu24_gr_lw_ref)

Moderate<-c(MynyddGordu1_gr_mod_ref, MynyddGordu2_gr_mod_ref, MynyddGordu3_gr_mod_ref,
            MynyddGordu4_gr_mod_ref, MynyddGordu5_gr_mod_ref, MynyddGordu6_gr_mod_ref,
            MynyddGordu7_gr_mod_ref, MynyddGordu8_gr_mod_ref, MynyddGordu9_gr_mod_ref,
            MynyddGordu10_gr_mod_ref, MynyddGordu11_gr_mod_ref, MynyddGordu12_gr_mod_ref, 
            MynyddGordu13_gr_mod_ref, MynyddGordu14_gr_mod_ref, MynyddGordu15_gr_mod_ref, 
            MynyddGordu16_gr_mod_ref, MynyddGordu17_gr_mod_ref, MynyddGordu18_gr_mod_ref, 
            MynyddGordu19_gr_mod_ref, MynyddGordu20_gr_mod_ref, MynyddGordu21_gr_mod_ref,
            MynyddGordu22_gr_mod_ref,MynyddGordu23_gr_mod_ref,MynyddGordu24_gr_mod_ref)

High<-c(MynyddGordu1_gr_high_ref, MynyddGordu2_gr_high_ref, MynyddGordu3_gr_high_ref,
        MynyddGordu4_gr_high_ref, MynyddGordu5_gr_high_ref, MynyddGordu6_gr_high_ref,
        MynyddGordu7_gr_high_ref, MynyddGordu8_gr_high_ref, MynyddGordu9_gr_high_ref,
        MynyddGordu10_gr_high_ref, MynyddGordu11_gr_high_ref, MynyddGordu12_gr_high_ref, 
        MynyddGordu13_gr_high_ref, MynyddGordu14_gr_high_ref, MynyddGordu15_gr_high_ref, 
        MynyddGordu16_gr_high_ref, MynyddGordu17_gr_high_ref, MynyddGordu18_gr_high_ref, 
        MynyddGordu19_gr_high_ref, MynyddGordu20_gr_high_ref, MynyddGordu21_gr_high_ref,
        MynyddGordu22_gr_high_ref,MynyddGordu23_gr_high_ref,MynyddGordu24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("MynyddGordugr",24)
Lowsite <- MynyddGordulow
Modsite <- MynyddGordumod
Highsite <-MynyddGorduhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



MynyddGordugr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##MynyddYBetws

MynyddYBetwspipgr<-subset(allspp4gr_ppip, Site=="MynyddYBetws")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_MynyddYBetwspipgr<-max(MynyddYBetwspipgr$Passes)

#calculate 20% from maximum nightly record

max20_MynyddYBetwspipgr<- (max_MynyddYBetwspipgr/100)*80

##calculate the site classification (reference range)

MynyddYBetwshigh<- max_MynyddYBetwspipgr > allsppgr_ppip_ref_high

MynyddYBetwslow<- allsppgr_ppip_ref_low > max_MynyddYBetwspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_MynyddYBetwspipgr
MynyddYBetwsmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
MynyddYBetws1_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 1, replace=F))))
MynyddYBetws1_gr_max <- sum(MynyddYBetws1_gr > max20_MynyddYBetwspipgr)
MynyddYBetws1_gr_max
MynyddYBetws1_gr_pres <- sum(MynyddYBetws1_gr > 0)
MynyddYBetws1_gr_pres
#number of sites which would be classified as low
MynyddYBetws1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws1_gr)
MynyddYBetws1_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws1_gr_high_ref <- sum( MynyddYBetws1_gr > allsppgr_ppip_ref_high)
MynyddYBetws1_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws1_gr_mod_ref <- 1000 - (MynyddYBetws1_gr_high_ref + MynyddYBetws1_gr_lw_ref)
MynyddYBetws1_gr_mod_ref


#2 nights
MynyddYBetws2_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
MynyddYBetws2_grframe<-data.frame(MynyddYBetws2_gr, samp2)
MynyddYBetws2_grframelong <- melt(MynyddYBetws2_grframe,id.vars="samp2")
MynyddYBetws2_grframelong_sum <- ddply(MynyddYBetws2_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws2_gr_max <- sum(MynyddYBetws2_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws2_gr_max
MynyddYBetws2_gr_pres <- sum(MynyddYBetws2_grframelong_sum $max > 0)
MynyddYBetws2_gr_pres

#number of sites which would be classified as low
MynyddYBetws2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws2_grframelong_sum$max)
MynyddYBetws2_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws2_gr_high_ref <- sum( MynyddYBetws2_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws2_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws2_gr_mod_ref <- 1000 - (MynyddYBetws2_gr_high_ref + MynyddYBetws2_gr_lw_ref)
MynyddYBetws2_gr_mod_ref


#3 nights
MynyddYBetws3_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
MynyddYBetws3_grframe<-data.frame(MynyddYBetws3_gr, samp2)
MynyddYBetws3_grframelong <- melt(MynyddYBetws3_grframe,id.vars="samp2")
MynyddYBetws3_grframelong_sum <- ddply(MynyddYBetws3_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws3_gr_max <- sum(MynyddYBetws3_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws3_gr_max
MynyddYBetws3_gr_pres <- sum(MynyddYBetws3_grframelong_sum $max > 0)
MynyddYBetws3_gr_pres

#number of sites which would be classified as low
MynyddYBetws3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws3_grframelong_sum$max)
MynyddYBetws3_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws3_gr_high_ref <- sum( MynyddYBetws3_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws3_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws3_gr_mod_ref <- 1000 - (MynyddYBetws3_gr_high_ref + MynyddYBetws3_gr_lw_ref)
MynyddYBetws3_gr_mod_ref

#4 nights
MynyddYBetws4_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
MynyddYBetws4_grframe<-data.frame(MynyddYBetws4_gr, samp2)
MynyddYBetws4_grframelong <- melt(MynyddYBetws4_grframe,id.vars="samp2")
MynyddYBetws4_grframelong_sum <- ddply(MynyddYBetws4_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws4_gr_max <- sum(MynyddYBetws4_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws4_gr_max
MynyddYBetws4_gr_pres <- sum(MynyddYBetws4_grframelong_sum $max > 0)
MynyddYBetws4_gr_pres

#number of sites which would be classified as low
MynyddYBetws4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws4_grframelong_sum$max)
MynyddYBetws4_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws4_gr_high_ref <- sum( MynyddYBetws4_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws4_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws4_gr_mod_ref <- 1000 - (MynyddYBetws4_gr_high_ref + MynyddYBetws4_gr_lw_ref)
MynyddYBetws4_gr_mod_ref

#5 nights
MynyddYBetws5_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
MynyddYBetws5_grframe<-data.frame(MynyddYBetws5_gr, samp2)
MynyddYBetws5_grframelong <- melt(MynyddYBetws5_grframe,id.vars="samp2")
MynyddYBetws5_grframelong_sum <- ddply(MynyddYBetws5_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws5_gr_max <- sum(MynyddYBetws5_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws5_gr_max
MynyddYBetws5_gr_pres <- sum(MynyddYBetws5_grframelong_sum $max > 0)
MynyddYBetws5_gr_pres

#number of sites which would be classified as low
MynyddYBetws5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws5_grframelong_sum$max)
MynyddYBetws5_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws5_gr_high_ref <- sum( MynyddYBetws5_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws5_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws5_gr_mod_ref <- 1000 - (MynyddYBetws5_gr_high_ref + MynyddYBetws5_gr_lw_ref)
MynyddYBetws5_gr_mod_ref

#6 nights
MynyddYBetws6_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
MynyddYBetws6_grframe<-data.frame(MynyddYBetws6_gr, samp2)
MynyddYBetws6_grframelong <- melt(MynyddYBetws6_grframe,id.vars="samp2")
MynyddYBetws6_grframelong_sum <- ddply(MynyddYBetws6_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws6_gr_max <- sum(MynyddYBetws6_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws6_gr_max
MynyddYBetws6_gr_pres <- sum(MynyddYBetws6_grframelong_sum $max > 0)
MynyddYBetws6_gr_pres

#number of sites which would be classified as low
MynyddYBetws6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws6_grframelong_sum$max)
MynyddYBetws6_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws6_gr_high_ref <- sum( MynyddYBetws6_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws6_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws6_gr_mod_ref <- 1000 - (MynyddYBetws6_gr_high_ref + MynyddYBetws6_gr_lw_ref)
MynyddYBetws6_gr_mod_ref

#7 nights
MynyddYBetws7_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
MynyddYBetws7_grframe<-data.frame(MynyddYBetws7_gr, samp2)
MynyddYBetws7_grframelong <- melt(MynyddYBetws7_grframe,id.vars="samp2")
MynyddYBetws7_grframelong_sum <- ddply(MynyddYBetws7_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws7_gr_max <- sum(MynyddYBetws7_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws7_gr_max
MynyddYBetws7_gr_pres <- sum(MynyddYBetws7_grframelong_sum $max > 0)
MynyddYBetws7_gr_pres

#number of sites which would be classified as low
MynyddYBetws7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws7_grframelong_sum$max)
MynyddYBetws7_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws7_gr_high_ref <- sum( MynyddYBetws7_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws7_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws7_gr_mod_ref <- 1000 - (MynyddYBetws7_gr_high_ref + MynyddYBetws7_gr_lw_ref)
MynyddYBetws7_gr_mod_ref

#8 nights
MynyddYBetws8_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
MynyddYBetws8_grframe<-data.frame(MynyddYBetws8_gr, samp2)
MynyddYBetws8_grframelong <- melt(MynyddYBetws8_grframe,id.vars="samp2")
MynyddYBetws8_grframelong_sum <- ddply(MynyddYBetws8_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws8_gr_max <- sum(MynyddYBetws8_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws8_gr_max
MynyddYBetws8_gr_pres <- sum(MynyddYBetws8_grframelong_sum $max > 0)
MynyddYBetws8_gr_pres

#number of sites which would be classified as low
MynyddYBetws8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws8_grframelong_sum$max)
MynyddYBetws8_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws8_gr_high_ref <- sum( MynyddYBetws8_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws8_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws8_gr_mod_ref <- 1000 - (MynyddYBetws8_gr_high_ref + MynyddYBetws8_gr_lw_ref)
MynyddYBetws8_gr_mod_ref

#9 nights
MynyddYBetws9_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
MynyddYBetws9_grframe<-data.frame(MynyddYBetws9_gr, samp2)
MynyddYBetws9_grframelong <- melt(MynyddYBetws9_grframe,id.vars="samp2")
MynyddYBetws9_grframelong_sum <- ddply(MynyddYBetws9_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
MynyddYBetws9_gr_max <- sum(MynyddYBetws9_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws9_gr_max
MynyddYBetws9_gr_pres <- sum(MynyddYBetws9_grframelong_sum $max > 0)
MynyddYBetws9_gr_pres

#number of sites which would be classified as low
MynyddYBetws9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws9_grframelong_sum$max)
MynyddYBetws9_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws9_gr_high_ref <- sum( MynyddYBetws9_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws9_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws9_gr_mod_ref <- 1000 - (MynyddYBetws9_gr_high_ref + MynyddYBetws9_gr_lw_ref)
MynyddYBetws9_gr_mod_ref

#10 detectors
MynyddYBetws10_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
MynyddYBetws10_grframe<-data.frame(MynyddYBetws10_gr, samp2)
MynyddYBetws10_grframelong <- melt(MynyddYBetws10_grframe,id.vars="samp2")
MynyddYBetws10_grframelong_sum <- ddply(MynyddYBetws10_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws10_gr_max <- sum(MynyddYBetws10_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws10_gr_max
MynyddYBetws10_gr_pres <- sum(MynyddYBetws10_grframelong_sum $max > 0)
MynyddYBetws10_gr_pres

#number of sites which would be classified as low
MynyddYBetws10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws10_grframelong_sum$max)
MynyddYBetws10_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws10_gr_high_ref <- sum( MynyddYBetws10_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws10_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws10_gr_mod_ref <- 1000 - (MynyddYBetws10_gr_high_ref + MynyddYBetws10_gr_lw_ref)
MynyddYBetws10_gr_mod_ref

#11 detectors
MynyddYBetws11_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
MynyddYBetws11_grframe<-data.frame(MynyddYBetws11_gr, samp2)
MynyddYBetws11_grframelong <- melt(MynyddYBetws11_grframe,id.vars="samp2")
MynyddYBetws11_grframelong_sum <- ddply(MynyddYBetws11_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws11_gr_max <- sum(MynyddYBetws11_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws11_gr_max
MynyddYBetws11_gr_pres <- sum(MynyddYBetws11_grframelong_sum $max > 0)
MynyddYBetws11_gr_pres

#number of sites which would be classified as low
MynyddYBetws11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws11_grframelong_sum$max)
MynyddYBetws11_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws11_gr_high_ref <- sum( MynyddYBetws11_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws11_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws11_gr_mod_ref <- 1000 - (MynyddYBetws11_gr_high_ref + MynyddYBetws11_gr_lw_ref)
MynyddYBetws11_gr_mod_ref

#12 detectors
MynyddYBetws12_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
MynyddYBetws12_grframe<-data.frame(MynyddYBetws12_gr, samp2)
MynyddYBetws12_grframelong <- melt(MynyddYBetws12_grframe,id.vars="samp2")
MynyddYBetws12_grframelong_sum <- ddply(MynyddYBetws12_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws12_gr_max <- sum(MynyddYBetws12_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws12_gr_max
MynyddYBetws12_gr_pres <- sum(MynyddYBetws12_grframelong_sum $max > 0)
MynyddYBetws12_gr_pres

#number of sites which would be classified as low
MynyddYBetws12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws12_grframelong_sum$max)
MynyddYBetws12_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws12_gr_high_ref <- sum( MynyddYBetws12_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws12_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws12_gr_mod_ref <- 1000 - (MynyddYBetws12_gr_high_ref + MynyddYBetws12_gr_lw_ref)
MynyddYBetws12_gr_mod_ref

#13 detectors
MynyddYBetws13_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
MynyddYBetws13_grframe<-data.frame(MynyddYBetws13_gr, samp2)
MynyddYBetws13_grframelong <- melt(MynyddYBetws13_grframe,id.vars="samp2")
MynyddYBetws13_grframelong_sum <- ddply(MynyddYBetws13_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws13_gr_max <- sum(MynyddYBetws13_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws13_gr_max
MynyddYBetws13_gr_pres <- sum(MynyddYBetws13_grframelong_sum $max > 0)
MynyddYBetws13_gr_pres

#number of sites which would be classified as low
MynyddYBetws13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws13_grframelong_sum$max)
MynyddYBetws13_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws13_gr_high_ref <- sum( MynyddYBetws13_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws13_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws13_gr_mod_ref <- 1000 - (MynyddYBetws13_gr_high_ref + MynyddYBetws13_gr_lw_ref)
MynyddYBetws13_gr_mod_ref

#14 detectors
MynyddYBetws14_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
MynyddYBetws14_grframe<-data.frame(MynyddYBetws14_gr, samp2)
MynyddYBetws14_grframelong <- melt(MynyddYBetws14_grframe,id.vars="samp2")
MynyddYBetws14_grframelong_sum <- ddply(MynyddYBetws14_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws14_gr_max <- sum(MynyddYBetws14_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws14_gr_max
MynyddYBetws14_gr_pres <- sum(MynyddYBetws14_grframelong_sum $max > 0)
MynyddYBetws14_gr_pres

#number of sites which would be classified as low
MynyddYBetws14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws14_grframelong_sum$max)
MynyddYBetws14_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws14_gr_high_ref <- sum( MynyddYBetws14_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws14_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws14_gr_mod_ref <- 1000 - (MynyddYBetws14_gr_high_ref + MynyddYBetws14_gr_lw_ref)
MynyddYBetws14_gr_mod_ref

#15 detectors
MynyddYBetws15_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
MynyddYBetws15_grframe<-data.frame(MynyddYBetws15_gr, samp2)
MynyddYBetws15_grframelong <- melt(MynyddYBetws15_grframe,id.vars="samp2")
MynyddYBetws15_grframelong_sum <- ddply(MynyddYBetws15_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws15_gr_max <- sum(MynyddYBetws15_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws15_gr_max
MynyddYBetws15_gr_pres <- sum(MynyddYBetws15_grframelong_sum $max > 0)
MynyddYBetws15_gr_pres

#number of sites which would be classified as low
MynyddYBetws15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws15_grframelong_sum$max)
MynyddYBetws15_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws15_gr_high_ref <- sum( MynyddYBetws15_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws15_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws15_gr_mod_ref <- 1000 - (MynyddYBetws15_gr_high_ref + MynyddYBetws15_gr_lw_ref)
MynyddYBetws15_gr_mod_ref

#16 detectors
MynyddYBetws16_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
MynyddYBetws16_grframe<-data.frame(MynyddYBetws16_gr, samp2)
MynyddYBetws16_grframelong <- melt(MynyddYBetws16_grframe,id.vars="samp2")
MynyddYBetws16_grframelong_sum <- ddply(MynyddYBetws16_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws16_gr_max <- sum(MynyddYBetws16_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws16_gr_max
MynyddYBetws16_gr_pres <- sum(MynyddYBetws16_grframelong_sum $max > 0)
MynyddYBetws16_gr_pres

#number of sites which would be classified as low
MynyddYBetws16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws16_grframelong_sum$max)
MynyddYBetws16_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws16_gr_high_ref <- sum( MynyddYBetws16_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws16_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws16_gr_mod_ref <- 1000 - (MynyddYBetws16_gr_high_ref + MynyddYBetws16_gr_lw_ref)
MynyddYBetws16_gr_mod_ref

#17 detectors
MynyddYBetws17_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
MynyddYBetws17_grframe<-data.frame(MynyddYBetws17_gr, samp2)
MynyddYBetws17_grframelong <- melt(MynyddYBetws17_grframe,id.vars="samp2")
MynyddYBetws17_grframelong_sum <- ddply(MynyddYBetws17_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws17_gr_max <- sum(MynyddYBetws17_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws17_gr_max
MynyddYBetws17_gr_pres <- sum(MynyddYBetws17_grframelong_sum $max > 0)
MynyddYBetws17_gr_pres

#number of sites which would be classified as low
MynyddYBetws17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws17_grframelong_sum$max)
MynyddYBetws17_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws17_gr_high_ref <- sum( MynyddYBetws17_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws17_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws17_gr_mod_ref <- 1000 - (MynyddYBetws17_gr_high_ref + MynyddYBetws17_gr_lw_ref)
MynyddYBetws17_gr_mod_ref

#18 detectors
MynyddYBetws18_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
MynyddYBetws18_grframe<-data.frame(MynyddYBetws18_gr, samp2)
MynyddYBetws18_grframelong <- melt(MynyddYBetws18_grframe,id.vars="samp2")
MynyddYBetws18_grframelong_sum <- ddply(MynyddYBetws18_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws18_gr_max <- sum(MynyddYBetws18_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws18_gr_max
MynyddYBetws18_gr_pres <- sum(MynyddYBetws18_grframelong_sum $max > 0)
MynyddYBetws18_gr_pres

#number of sites which would be classified as low
MynyddYBetws18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws18_grframelong_sum$max)
MynyddYBetws18_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws18_gr_high_ref <- sum( MynyddYBetws18_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws18_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws18_gr_mod_ref <- 1000 - (MynyddYBetws18_gr_high_ref + MynyddYBetws18_gr_lw_ref)
MynyddYBetws18_gr_mod_ref

#19 detectors
MynyddYBetws19_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
MynyddYBetws19_grframe<-data.frame(MynyddYBetws19_gr, samp2)
MynyddYBetws19_grframelong <- melt(MynyddYBetws19_grframe,id.vars="samp2")
MynyddYBetws19_grframelong_sum <- ddply(MynyddYBetws19_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws19_gr_max <- sum(MynyddYBetws19_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws19_gr_max
MynyddYBetws19_gr_pres <- sum(MynyddYBetws19_grframelong_sum $max > 0)
MynyddYBetws19_gr_pres

#number of sites which would be classified as low
MynyddYBetws19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws19_grframelong_sum$max)
MynyddYBetws19_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws19_gr_high_ref <- sum( MynyddYBetws19_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws19_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws19_gr_mod_ref <- 1000 - (MynyddYBetws19_gr_high_ref + MynyddYBetws19_gr_lw_ref)
MynyddYBetws19_gr_mod_ref

#20 detectors
MynyddYBetws20_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
MynyddYBetws20_grframe<-data.frame(MynyddYBetws20_gr, samp2)
MynyddYBetws20_grframelong <- melt(MynyddYBetws20_grframe,id.vars="samp2")
MynyddYBetws20_grframelong_sum <- ddply(MynyddYBetws20_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws20_gr_max <- sum(MynyddYBetws20_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws20_gr_max
MynyddYBetws20_gr_pres <- sum(MynyddYBetws20_grframelong_sum $max > 0)
MynyddYBetws20_gr_pres

#number of sites which would be classified as low
MynyddYBetws20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws20_grframelong_sum$max)
MynyddYBetws20_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws20_gr_high_ref <- sum( MynyddYBetws20_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws20_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws20_gr_mod_ref <- 1000 - (MynyddYBetws20_gr_high_ref + MynyddYBetws20_gr_lw_ref)
MynyddYBetws20_gr_mod_ref

#21 detectors
MynyddYBetws21_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
MynyddYBetws21_grframe<-data.frame(MynyddYBetws21_gr, samp2)
MynyddYBetws21_grframelong <- melt(MynyddYBetws21_grframe,id.vars="samp2")
MynyddYBetws21_grframelong_sum <- ddply(MynyddYBetws21_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws21_gr_max <- sum(MynyddYBetws21_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws21_gr_max
MynyddYBetws21_gr_pres <- sum(MynyddYBetws21_grframelong_sum $max > 0)
MynyddYBetws21_gr_pres

#number of sites which would be classified as low
MynyddYBetws21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws21_grframelong_sum$max)
MynyddYBetws21_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws21_gr_high_ref <- sum( MynyddYBetws21_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws21_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws21_gr_mod_ref <- 1000 - (MynyddYBetws21_gr_high_ref + MynyddYBetws21_gr_lw_ref)
MynyddYBetws21_gr_mod_ref

#22 detectors
MynyddYBetws22_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
MynyddYBetws22_grframe<-data.frame(MynyddYBetws22_gr, samp2)
MynyddYBetws22_grframelong <- melt(MynyddYBetws22_grframe,id.vars="samp2")
MynyddYBetws22_grframelong_sum <- ddply(MynyddYBetws22_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws22_gr_max <- sum(MynyddYBetws22_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws22_gr_max
MynyddYBetws22_gr_pres <- sum(MynyddYBetws22_grframelong_sum $max > 0)
MynyddYBetws22_gr_pres

#number of sites which would be classified as low
MynyddYBetws22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws22_grframelong_sum$max)
MynyddYBetws22_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws22_gr_high_ref <- sum( MynyddYBetws22_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws22_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws22_gr_mod_ref <- 1000 - (MynyddYBetws22_gr_high_ref + MynyddYBetws22_gr_lw_ref)
MynyddYBetws22_gr_mod_ref

#23 detectors
MynyddYBetws23_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
MynyddYBetws23_grframe<-data.frame(MynyddYBetws23_gr, samp2)
MynyddYBetws23_grframelong <- melt(MynyddYBetws23_grframe,id.vars="samp2")
MynyddYBetws23_grframelong_sum <- ddply(MynyddYBetws23_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws23_gr_max <- sum(MynyddYBetws23_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws23_gr_max
MynyddYBetws23_gr_pres <- sum(MynyddYBetws23_grframelong_sum $max > 0)
MynyddYBetws23_gr_pres

#number of sites which would be classified as low
MynyddYBetws23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws23_grframelong_sum$max)
MynyddYBetws23_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws23_gr_high_ref <- sum( MynyddYBetws23_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws23_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws23_gr_mod_ref <- 1000 - (MynyddYBetws23_gr_high_ref + MynyddYBetws23_gr_lw_ref)
MynyddYBetws23_gr_mod_ref

#24 detectors
MynyddYBetws24_gr<-(replicate(1000, (sample(MynyddYBetwspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
MynyddYBetws24_grframe<-data.frame(MynyddYBetws24_gr, samp2)
MynyddYBetws24_grframelong <- melt(MynyddYBetws24_grframe,id.vars="samp2")
MynyddYBetws24_grframelong_sum <- ddply(MynyddYBetws24_grframelong, "variable", summarise,
                                        N    = length(value),
                                        max  = max(value))
MynyddYBetws24_gr_max <- sum(MynyddYBetws24_grframelong_sum $max > max20_MynyddYBetwspipgr)
MynyddYBetws24_gr_max
MynyddYBetws24_gr_pres <- sum(MynyddYBetws24_grframelong_sum $max > 0)
MynyddYBetws24_gr_pres

#number of sites which would be classified as low
MynyddYBetws24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= MynyddYBetws24_grframelong_sum$max)
MynyddYBetws24_gr_lw_ref
#number of sites which would be classified as high
MynyddYBetws24_gr_high_ref <- sum( MynyddYBetws24_grframelong_sum$max > allsppgr_ppip_ref_high)
MynyddYBetws24_gr_high_ref
#number of sites which would be classified as moderate
MynyddYBetws24_gr_mod_ref <- 1000 - (MynyddYBetws24_gr_high_ref + MynyddYBetws24_gr_lw_ref)
MynyddYBetws24_gr_mod_ref

Present<-c(MynyddYBetws1_gr_pres,MynyddYBetws2_gr_pres,
           MynyddYBetws3_gr_pres,MynyddYBetws4_gr_pres,
           MynyddYBetws5_gr_pres,MynyddYBetws6_gr_pres,
           MynyddYBetws7_gr_pres,MynyddYBetws8_gr_pres,
           MynyddYBetws9_gr_pres,MynyddYBetws10_gr_pres,
           MynyddYBetws11_gr_pres,MynyddYBetws12_gr_pres,
           MynyddYBetws13_gr_pres,MynyddYBetws14_gr_pres,
           MynyddYBetws15_gr_pres,MynyddYBetws16_gr_pres,
           MynyddYBetws17_gr_pres,MynyddYBetws18_gr_pres,
           MynyddYBetws19_gr_pres,MynyddYBetws20_gr_pres,
           MynyddYBetws21_gr_pres,MynyddYBetws22_gr_pres,
           MynyddYBetws23_gr_pres,MynyddYBetws24_gr_pres)


Maximum<-c(MynyddYBetws1_gr_max,MynyddYBetws2_gr_max,
           MynyddYBetws3_gr_max,MynyddYBetws4_gr_max,
           MynyddYBetws5_gr_max,MynyddYBetws6_gr_max,
           MynyddYBetws7_gr_max,MynyddYBetws8_gr_max,
           MynyddYBetws9_gr_max,MynyddYBetws10_gr_max,
           MynyddYBetws11_gr_max,MynyddYBetws12_gr_max,
           MynyddYBetws13_gr_max,MynyddYBetws14_gr_max,
           MynyddYBetws15_gr_max,MynyddYBetws16_gr_max,
           MynyddYBetws17_gr_max,MynyddYBetws18_gr_max,
           MynyddYBetws19_gr_max,MynyddYBetws20_gr_max,
           MynyddYBetws21_gr_max,MynyddYBetws22_gr_max,
           MynyddYBetws23_gr_max,MynyddYBetws24_gr_max)

Low<-c(MynyddYBetws1_gr_lw_ref, MynyddYBetws2_gr_lw_ref, MynyddYBetws3_gr_lw_ref,
       MynyddYBetws4_gr_lw_ref, MynyddYBetws5_gr_lw_ref, MynyddYBetws6_gr_lw_ref,
       MynyddYBetws7_gr_lw_ref, MynyddYBetws8_gr_lw_ref, MynyddYBetws9_gr_lw_ref,
       MynyddYBetws10_gr_lw_ref, MynyddYBetws11_gr_lw_ref, MynyddYBetws12_gr_lw_ref, 
       MynyddYBetws13_gr_lw_ref, MynyddYBetws14_gr_lw_ref, MynyddYBetws15_gr_lw_ref, 
       MynyddYBetws16_gr_lw_ref, MynyddYBetws17_gr_lw_ref, MynyddYBetws18_gr_lw_ref, 
       MynyddYBetws19_gr_lw_ref, MynyddYBetws20_gr_lw_ref, MynyddYBetws21_gr_lw_ref,
       MynyddYBetws22_gr_lw_ref,MynyddYBetws23_gr_lw_ref,MynyddYBetws24_gr_lw_ref)

Moderate<-c(MynyddYBetws1_gr_mod_ref, MynyddYBetws2_gr_mod_ref, MynyddYBetws3_gr_mod_ref,
            MynyddYBetws4_gr_mod_ref, MynyddYBetws5_gr_mod_ref, MynyddYBetws6_gr_mod_ref,
            MynyddYBetws7_gr_mod_ref, MynyddYBetws8_gr_mod_ref, MynyddYBetws9_gr_mod_ref,
            MynyddYBetws10_gr_mod_ref, MynyddYBetws11_gr_mod_ref, MynyddYBetws12_gr_mod_ref, 
            MynyddYBetws13_gr_mod_ref, MynyddYBetws14_gr_mod_ref, MynyddYBetws15_gr_mod_ref, 
            MynyddYBetws16_gr_mod_ref, MynyddYBetws17_gr_mod_ref, MynyddYBetws18_gr_mod_ref, 
            MynyddYBetws19_gr_mod_ref, MynyddYBetws20_gr_mod_ref, MynyddYBetws21_gr_mod_ref,
            MynyddYBetws22_gr_mod_ref,MynyddYBetws23_gr_mod_ref,MynyddYBetws24_gr_mod_ref)

High<-c(MynyddYBetws1_gr_high_ref, MynyddYBetws2_gr_high_ref, MynyddYBetws3_gr_high_ref,
        MynyddYBetws4_gr_high_ref, MynyddYBetws5_gr_high_ref, MynyddYBetws6_gr_high_ref,
        MynyddYBetws7_gr_high_ref, MynyddYBetws8_gr_high_ref, MynyddYBetws9_gr_high_ref,
        MynyddYBetws10_gr_high_ref, MynyddYBetws11_gr_high_ref, MynyddYBetws12_gr_high_ref, 
        MynyddYBetws13_gr_high_ref, MynyddYBetws14_gr_high_ref, MynyddYBetws15_gr_high_ref, 
        MynyddYBetws16_gr_high_ref, MynyddYBetws17_gr_high_ref, MynyddYBetws18_gr_high_ref, 
        MynyddYBetws19_gr_high_ref, MynyddYBetws20_gr_high_ref, MynyddYBetws21_gr_high_ref,
        MynyddYBetws22_gr_high_ref,MynyddYBetws23_gr_high_ref,MynyddYBetws24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("MynyddYBetwsgr",24)
Lowsite <- MynyddYBetwslow
Modsite <- MynyddYBetwsmod
Highsite <-MynyddYBetwshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



MynyddYBetwsgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                   Site, Low, Moderate, High,
                                   Lowsite, Modsite, Highsite)

##NorthRhins

NorthRhinspipgr<-subset(allspp4gr_ppip, Site=="NorthRhins")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_NorthRhinspipgr<-max(NorthRhinspipgr$Passes)

#calculate 20% from maximum nightly record

max20_NorthRhinspipgr<- (max_NorthRhinspipgr/100)*80

##calculate the site classification (reference range)

NorthRhinshigh<- max_NorthRhinspipgr > allsppgr_ppip_ref_high

NorthRhinslow<- allsppgr_ppip_ref_low > max_NorthRhinspipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_NorthRhinspipgr
NorthRhinsmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
NorthRhins1_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 1, replace=F))))
NorthRhins1_gr_max <- sum(NorthRhins1_gr > max20_NorthRhinspipgr)
NorthRhins1_gr_max
NorthRhins1_gr_pres <- sum(NorthRhins1_gr > 0)
NorthRhins1_gr_pres
#number of sites which would be classified as low
NorthRhins1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins1_gr)
NorthRhins1_gr_lw_ref
#number of sites which would be classified as high
NorthRhins1_gr_high_ref <- sum( NorthRhins1_gr > allsppgr_ppip_ref_high)
NorthRhins1_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins1_gr_mod_ref <- 1000 - (NorthRhins1_gr_high_ref + NorthRhins1_gr_lw_ref)
NorthRhins1_gr_mod_ref


#2 nights
NorthRhins2_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
NorthRhins2_grframe<-data.frame(NorthRhins2_gr, samp2)
NorthRhins2_grframelong <- melt(NorthRhins2_grframe,id.vars="samp2")
NorthRhins2_grframelong_sum <- ddply(NorthRhins2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins2_gr_max <- sum(NorthRhins2_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins2_gr_max
NorthRhins2_gr_pres <- sum(NorthRhins2_grframelong_sum $max > 0)
NorthRhins2_gr_pres

#number of sites which would be classified as low
NorthRhins2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins2_grframelong_sum$max)
NorthRhins2_gr_lw_ref
#number of sites which would be classified as high
NorthRhins2_gr_high_ref <- sum( NorthRhins2_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins2_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins2_gr_mod_ref <- 1000 - (NorthRhins2_gr_high_ref + NorthRhins2_gr_lw_ref)
NorthRhins2_gr_mod_ref


#3 nights
NorthRhins3_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
NorthRhins3_grframe<-data.frame(NorthRhins3_gr, samp2)
NorthRhins3_grframelong <- melt(NorthRhins3_grframe,id.vars="samp2")
NorthRhins3_grframelong_sum <- ddply(NorthRhins3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins3_gr_max <- sum(NorthRhins3_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins3_gr_max
NorthRhins3_gr_pres <- sum(NorthRhins3_grframelong_sum $max > 0)
NorthRhins3_gr_pres

#number of sites which would be classified as low
NorthRhins3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins3_grframelong_sum$max)
NorthRhins3_gr_lw_ref
#number of sites which would be classified as high
NorthRhins3_gr_high_ref <- sum( NorthRhins3_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins3_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins3_gr_mod_ref <- 1000 - (NorthRhins3_gr_high_ref + NorthRhins3_gr_lw_ref)
NorthRhins3_gr_mod_ref

#4 nights
NorthRhins4_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
NorthRhins4_grframe<-data.frame(NorthRhins4_gr, samp2)
NorthRhins4_grframelong <- melt(NorthRhins4_grframe,id.vars="samp2")
NorthRhins4_grframelong_sum <- ddply(NorthRhins4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins4_gr_max <- sum(NorthRhins4_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins4_gr_max
NorthRhins4_gr_pres <- sum(NorthRhins4_grframelong_sum $max > 0)
NorthRhins4_gr_pres

#number of sites which would be classified as low
NorthRhins4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins4_grframelong_sum$max)
NorthRhins4_gr_lw_ref
#number of sites which would be classified as high
NorthRhins4_gr_high_ref <- sum( NorthRhins4_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins4_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins4_gr_mod_ref <- 1000 - (NorthRhins4_gr_high_ref + NorthRhins4_gr_lw_ref)
NorthRhins4_gr_mod_ref

#5 nights
NorthRhins5_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
NorthRhins5_grframe<-data.frame(NorthRhins5_gr, samp2)
NorthRhins5_grframelong <- melt(NorthRhins5_grframe,id.vars="samp2")
NorthRhins5_grframelong_sum <- ddply(NorthRhins5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins5_gr_max <- sum(NorthRhins5_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins5_gr_max
NorthRhins5_gr_pres <- sum(NorthRhins5_grframelong_sum $max > 0)
NorthRhins5_gr_pres

#number of sites which would be classified as low
NorthRhins5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins5_grframelong_sum$max)
NorthRhins5_gr_lw_ref
#number of sites which would be classified as high
NorthRhins5_gr_high_ref <- sum( NorthRhins5_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins5_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins5_gr_mod_ref <- 1000 - (NorthRhins5_gr_high_ref + NorthRhins5_gr_lw_ref)
NorthRhins5_gr_mod_ref

#6 nights
NorthRhins6_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
NorthRhins6_grframe<-data.frame(NorthRhins6_gr, samp2)
NorthRhins6_grframelong <- melt(NorthRhins6_grframe,id.vars="samp2")
NorthRhins6_grframelong_sum <- ddply(NorthRhins6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins6_gr_max <- sum(NorthRhins6_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins6_gr_max
NorthRhins6_gr_pres <- sum(NorthRhins6_grframelong_sum $max > 0)
NorthRhins6_gr_pres

#number of sites which would be classified as low
NorthRhins6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins6_grframelong_sum$max)
NorthRhins6_gr_lw_ref
#number of sites which would be classified as high
NorthRhins6_gr_high_ref <- sum( NorthRhins6_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins6_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins6_gr_mod_ref <- 1000 - (NorthRhins6_gr_high_ref + NorthRhins6_gr_lw_ref)
NorthRhins6_gr_mod_ref

#7 nights
NorthRhins7_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
NorthRhins7_grframe<-data.frame(NorthRhins7_gr, samp2)
NorthRhins7_grframelong <- melt(NorthRhins7_grframe,id.vars="samp2")
NorthRhins7_grframelong_sum <- ddply(NorthRhins7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins7_gr_max <- sum(NorthRhins7_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins7_gr_max
NorthRhins7_gr_pres <- sum(NorthRhins7_grframelong_sum $max > 0)
NorthRhins7_gr_pres

#number of sites which would be classified as low
NorthRhins7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins7_grframelong_sum$max)
NorthRhins7_gr_lw_ref
#number of sites which would be classified as high
NorthRhins7_gr_high_ref <- sum( NorthRhins7_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins7_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins7_gr_mod_ref <- 1000 - (NorthRhins7_gr_high_ref + NorthRhins7_gr_lw_ref)
NorthRhins7_gr_mod_ref

#8 nights
NorthRhins8_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
NorthRhins8_grframe<-data.frame(NorthRhins8_gr, samp2)
NorthRhins8_grframelong <- melt(NorthRhins8_grframe,id.vars="samp2")
NorthRhins8_grframelong_sum <- ddply(NorthRhins8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins8_gr_max <- sum(NorthRhins8_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins8_gr_max
NorthRhins8_gr_pres <- sum(NorthRhins8_grframelong_sum $max > 0)
NorthRhins8_gr_pres

#number of sites which would be classified as low
NorthRhins8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins8_grframelong_sum$max)
NorthRhins8_gr_lw_ref
#number of sites which would be classified as high
NorthRhins8_gr_high_ref <- sum( NorthRhins8_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins8_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins8_gr_mod_ref <- 1000 - (NorthRhins8_gr_high_ref + NorthRhins8_gr_lw_ref)
NorthRhins8_gr_mod_ref

#9 nights
NorthRhins9_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
NorthRhins9_grframe<-data.frame(NorthRhins9_gr, samp2)
NorthRhins9_grframelong <- melt(NorthRhins9_grframe,id.vars="samp2")
NorthRhins9_grframelong_sum <- ddply(NorthRhins9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
NorthRhins9_gr_max <- sum(NorthRhins9_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins9_gr_max
NorthRhins9_gr_pres <- sum(NorthRhins9_grframelong_sum $max > 0)
NorthRhins9_gr_pres

#number of sites which would be classified as low
NorthRhins9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins9_grframelong_sum$max)
NorthRhins9_gr_lw_ref
#number of sites which would be classified as high
NorthRhins9_gr_high_ref <- sum( NorthRhins9_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins9_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins9_gr_mod_ref <- 1000 - (NorthRhins9_gr_high_ref + NorthRhins9_gr_lw_ref)
NorthRhins9_gr_mod_ref

#10 detectors
NorthRhins10_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
NorthRhins10_grframe<-data.frame(NorthRhins10_gr, samp2)
NorthRhins10_grframelong <- melt(NorthRhins10_grframe,id.vars="samp2")
NorthRhins10_grframelong_sum <- ddply(NorthRhins10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins10_gr_max <- sum(NorthRhins10_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins10_gr_max
NorthRhins10_gr_pres <- sum(NorthRhins10_grframelong_sum $max > 0)
NorthRhins10_gr_pres

#number of sites which would be classified as low
NorthRhins10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins10_grframelong_sum$max)
NorthRhins10_gr_lw_ref
#number of sites which would be classified as high
NorthRhins10_gr_high_ref <- sum( NorthRhins10_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins10_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins10_gr_mod_ref <- 1000 - (NorthRhins10_gr_high_ref + NorthRhins10_gr_lw_ref)
NorthRhins10_gr_mod_ref

#11 detectors
NorthRhins11_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
NorthRhins11_grframe<-data.frame(NorthRhins11_gr, samp2)
NorthRhins11_grframelong <- melt(NorthRhins11_grframe,id.vars="samp2")
NorthRhins11_grframelong_sum <- ddply(NorthRhins11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins11_gr_max <- sum(NorthRhins11_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins11_gr_max
NorthRhins11_gr_pres <- sum(NorthRhins11_grframelong_sum $max > 0)
NorthRhins11_gr_pres

#number of sites which would be classified as low
NorthRhins11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins11_grframelong_sum$max)
NorthRhins11_gr_lw_ref
#number of sites which would be classified as high
NorthRhins11_gr_high_ref <- sum( NorthRhins11_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins11_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins11_gr_mod_ref <- 1000 - (NorthRhins11_gr_high_ref + NorthRhins11_gr_lw_ref)
NorthRhins11_gr_mod_ref

#12 detectors
NorthRhins12_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
NorthRhins12_grframe<-data.frame(NorthRhins12_gr, samp2)
NorthRhins12_grframelong <- melt(NorthRhins12_grframe,id.vars="samp2")
NorthRhins12_grframelong_sum <- ddply(NorthRhins12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins12_gr_max <- sum(NorthRhins12_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins12_gr_max
NorthRhins12_gr_pres <- sum(NorthRhins12_grframelong_sum $max > 0)
NorthRhins12_gr_pres

#number of sites which would be classified as low
NorthRhins12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins12_grframelong_sum$max)
NorthRhins12_gr_lw_ref
#number of sites which would be classified as high
NorthRhins12_gr_high_ref <- sum( NorthRhins12_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins12_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins12_gr_mod_ref <- 1000 - (NorthRhins12_gr_high_ref + NorthRhins12_gr_lw_ref)
NorthRhins12_gr_mod_ref

#13 detectors
NorthRhins13_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
NorthRhins13_grframe<-data.frame(NorthRhins13_gr, samp2)
NorthRhins13_grframelong <- melt(NorthRhins13_grframe,id.vars="samp2")
NorthRhins13_grframelong_sum <- ddply(NorthRhins13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins13_gr_max <- sum(NorthRhins13_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins13_gr_max
NorthRhins13_gr_pres <- sum(NorthRhins13_grframelong_sum $max > 0)
NorthRhins13_gr_pres

#number of sites which would be classified as low
NorthRhins13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins13_grframelong_sum$max)
NorthRhins13_gr_lw_ref
#number of sites which would be classified as high
NorthRhins13_gr_high_ref <- sum( NorthRhins13_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins13_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins13_gr_mod_ref <- 1000 - (NorthRhins13_gr_high_ref + NorthRhins13_gr_lw_ref)
NorthRhins13_gr_mod_ref

#14 detectors
NorthRhins14_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
NorthRhins14_grframe<-data.frame(NorthRhins14_gr, samp2)
NorthRhins14_grframelong <- melt(NorthRhins14_grframe,id.vars="samp2")
NorthRhins14_grframelong_sum <- ddply(NorthRhins14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins14_gr_max <- sum(NorthRhins14_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins14_gr_max
NorthRhins14_gr_pres <- sum(NorthRhins14_grframelong_sum $max > 0)
NorthRhins14_gr_pres

#number of sites which would be classified as low
NorthRhins14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins14_grframelong_sum$max)
NorthRhins14_gr_lw_ref
#number of sites which would be classified as high
NorthRhins14_gr_high_ref <- sum( NorthRhins14_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins14_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins14_gr_mod_ref <- 1000 - (NorthRhins14_gr_high_ref + NorthRhins14_gr_lw_ref)
NorthRhins14_gr_mod_ref

#15 detectors
NorthRhins15_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
NorthRhins15_grframe<-data.frame(NorthRhins15_gr, samp2)
NorthRhins15_grframelong <- melt(NorthRhins15_grframe,id.vars="samp2")
NorthRhins15_grframelong_sum <- ddply(NorthRhins15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins15_gr_max <- sum(NorthRhins15_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins15_gr_max
NorthRhins15_gr_pres <- sum(NorthRhins15_grframelong_sum $max > 0)
NorthRhins15_gr_pres

#number of sites which would be classified as low
NorthRhins15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins15_grframelong_sum$max)
NorthRhins15_gr_lw_ref
#number of sites which would be classified as high
NorthRhins15_gr_high_ref <- sum( NorthRhins15_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins15_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins15_gr_mod_ref <- 1000 - (NorthRhins15_gr_high_ref + NorthRhins15_gr_lw_ref)
NorthRhins15_gr_mod_ref

#16 detectors
NorthRhins16_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
NorthRhins16_grframe<-data.frame(NorthRhins16_gr, samp2)
NorthRhins16_grframelong <- melt(NorthRhins16_grframe,id.vars="samp2")
NorthRhins16_grframelong_sum <- ddply(NorthRhins16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins16_gr_max <- sum(NorthRhins16_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins16_gr_max
NorthRhins16_gr_pres <- sum(NorthRhins16_grframelong_sum $max > 0)
NorthRhins16_gr_pres

#number of sites which would be classified as low
NorthRhins16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins16_grframelong_sum$max)
NorthRhins16_gr_lw_ref
#number of sites which would be classified as high
NorthRhins16_gr_high_ref <- sum( NorthRhins16_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins16_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins16_gr_mod_ref <- 1000 - (NorthRhins16_gr_high_ref + NorthRhins16_gr_lw_ref)
NorthRhins16_gr_mod_ref

#17 detectors
NorthRhins17_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
NorthRhins17_grframe<-data.frame(NorthRhins17_gr, samp2)
NorthRhins17_grframelong <- melt(NorthRhins17_grframe,id.vars="samp2")
NorthRhins17_grframelong_sum <- ddply(NorthRhins17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins17_gr_max <- sum(NorthRhins17_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins17_gr_max
NorthRhins17_gr_pres <- sum(NorthRhins17_grframelong_sum $max > 0)
NorthRhins17_gr_pres

#number of sites which would be classified as low
NorthRhins17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins17_grframelong_sum$max)
NorthRhins17_gr_lw_ref
#number of sites which would be classified as high
NorthRhins17_gr_high_ref <- sum( NorthRhins17_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins17_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins17_gr_mod_ref <- 1000 - (NorthRhins17_gr_high_ref + NorthRhins17_gr_lw_ref)
NorthRhins17_gr_mod_ref

#18 detectors
NorthRhins18_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
NorthRhins18_grframe<-data.frame(NorthRhins18_gr, samp2)
NorthRhins18_grframelong <- melt(NorthRhins18_grframe,id.vars="samp2")
NorthRhins18_grframelong_sum <- ddply(NorthRhins18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins18_gr_max <- sum(NorthRhins18_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins18_gr_max
NorthRhins18_gr_pres <- sum(NorthRhins18_grframelong_sum $max > 0)
NorthRhins18_gr_pres

#number of sites which would be classified as low
NorthRhins18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins18_grframelong_sum$max)
NorthRhins18_gr_lw_ref
#number of sites which would be classified as high
NorthRhins18_gr_high_ref <- sum( NorthRhins18_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins18_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins18_gr_mod_ref <- 1000 - (NorthRhins18_gr_high_ref + NorthRhins18_gr_lw_ref)
NorthRhins18_gr_mod_ref

#19 detectors
NorthRhins19_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
NorthRhins19_grframe<-data.frame(NorthRhins19_gr, samp2)
NorthRhins19_grframelong <- melt(NorthRhins19_grframe,id.vars="samp2")
NorthRhins19_grframelong_sum <- ddply(NorthRhins19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins19_gr_max <- sum(NorthRhins19_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins19_gr_max
NorthRhins19_gr_pres <- sum(NorthRhins19_grframelong_sum $max > 0)
NorthRhins19_gr_pres

#number of sites which would be classified as low
NorthRhins19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins19_grframelong_sum$max)
NorthRhins19_gr_lw_ref
#number of sites which would be classified as high
NorthRhins19_gr_high_ref <- sum( NorthRhins19_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins19_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins19_gr_mod_ref <- 1000 - (NorthRhins19_gr_high_ref + NorthRhins19_gr_lw_ref)
NorthRhins19_gr_mod_ref

#20 detectors
NorthRhins20_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
NorthRhins20_grframe<-data.frame(NorthRhins20_gr, samp2)
NorthRhins20_grframelong <- melt(NorthRhins20_grframe,id.vars="samp2")
NorthRhins20_grframelong_sum <- ddply(NorthRhins20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins20_gr_max <- sum(NorthRhins20_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins20_gr_max
NorthRhins20_gr_pres <- sum(NorthRhins20_grframelong_sum $max > 0)
NorthRhins20_gr_pres

#number of sites which would be classified as low
NorthRhins20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins20_grframelong_sum$max)
NorthRhins20_gr_lw_ref
#number of sites which would be classified as high
NorthRhins20_gr_high_ref <- sum( NorthRhins20_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins20_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins20_gr_mod_ref <- 1000 - (NorthRhins20_gr_high_ref + NorthRhins20_gr_lw_ref)
NorthRhins20_gr_mod_ref

#21 detectors
NorthRhins21_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
NorthRhins21_grframe<-data.frame(NorthRhins21_gr, samp2)
NorthRhins21_grframelong <- melt(NorthRhins21_grframe,id.vars="samp2")
NorthRhins21_grframelong_sum <- ddply(NorthRhins21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins21_gr_max <- sum(NorthRhins21_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins21_gr_max
NorthRhins21_gr_pres <- sum(NorthRhins21_grframelong_sum $max > 0)
NorthRhins21_gr_pres

#number of sites which would be classified as low
NorthRhins21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins21_grframelong_sum$max)
NorthRhins21_gr_lw_ref
#number of sites which would be classified as high
NorthRhins21_gr_high_ref <- sum( NorthRhins21_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins21_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins21_gr_mod_ref <- 1000 - (NorthRhins21_gr_high_ref + NorthRhins21_gr_lw_ref)
NorthRhins21_gr_mod_ref

#22 detectors
NorthRhins22_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
NorthRhins22_grframe<-data.frame(NorthRhins22_gr, samp2)
NorthRhins22_grframelong <- melt(NorthRhins22_grframe,id.vars="samp2")
NorthRhins22_grframelong_sum <- ddply(NorthRhins22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins22_gr_max <- sum(NorthRhins22_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins22_gr_max
NorthRhins22_gr_pres <- sum(NorthRhins22_grframelong_sum $max > 0)
NorthRhins22_gr_pres

#number of sites which would be classified as low
NorthRhins22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins22_grframelong_sum$max)
NorthRhins22_gr_lw_ref
#number of sites which would be classified as high
NorthRhins22_gr_high_ref <- sum( NorthRhins22_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins22_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins22_gr_mod_ref <- 1000 - (NorthRhins22_gr_high_ref + NorthRhins22_gr_lw_ref)
NorthRhins22_gr_mod_ref

#23 detectors
NorthRhins23_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
NorthRhins23_grframe<-data.frame(NorthRhins23_gr, samp2)
NorthRhins23_grframelong <- melt(NorthRhins23_grframe,id.vars="samp2")
NorthRhins23_grframelong_sum <- ddply(NorthRhins23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins23_gr_max <- sum(NorthRhins23_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins23_gr_max
NorthRhins23_gr_pres <- sum(NorthRhins23_grframelong_sum $max > 0)
NorthRhins23_gr_pres

#number of sites which would be classified as low
NorthRhins23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins23_grframelong_sum$max)
NorthRhins23_gr_lw_ref
#number of sites which would be classified as high
NorthRhins23_gr_high_ref <- sum( NorthRhins23_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins23_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins23_gr_mod_ref <- 1000 - (NorthRhins23_gr_high_ref + NorthRhins23_gr_lw_ref)
NorthRhins23_gr_mod_ref

#24 detectors
NorthRhins24_gr<-(replicate(1000, (sample(NorthRhinspipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
NorthRhins24_grframe<-data.frame(NorthRhins24_gr, samp2)
NorthRhins24_grframelong <- melt(NorthRhins24_grframe,id.vars="samp2")
NorthRhins24_grframelong_sum <- ddply(NorthRhins24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
NorthRhins24_gr_max <- sum(NorthRhins24_grframelong_sum $max > max20_NorthRhinspipgr)
NorthRhins24_gr_max
NorthRhins24_gr_pres <- sum(NorthRhins24_grframelong_sum $max > 0)
NorthRhins24_gr_pres

#number of sites which would be classified as low
NorthRhins24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= NorthRhins24_grframelong_sum$max)
NorthRhins24_gr_lw_ref
#number of sites which would be classified as high
NorthRhins24_gr_high_ref <- sum( NorthRhins24_grframelong_sum$max > allsppgr_ppip_ref_high)
NorthRhins24_gr_high_ref
#number of sites which would be classified as moderate
NorthRhins24_gr_mod_ref <- 1000 - (NorthRhins24_gr_high_ref + NorthRhins24_gr_lw_ref)
NorthRhins24_gr_mod_ref

Present<-c(NorthRhins1_gr_pres,NorthRhins2_gr_pres,
           NorthRhins3_gr_pres,NorthRhins4_gr_pres,
           NorthRhins5_gr_pres,NorthRhins6_gr_pres,
           NorthRhins7_gr_pres,NorthRhins8_gr_pres,
           NorthRhins9_gr_pres,NorthRhins10_gr_pres,
           NorthRhins11_gr_pres,NorthRhins12_gr_pres,
           NorthRhins13_gr_pres,NorthRhins14_gr_pres,
           NorthRhins15_gr_pres,NorthRhins16_gr_pres,
           NorthRhins17_gr_pres,NorthRhins18_gr_pres,
           NorthRhins19_gr_pres,NorthRhins20_gr_pres,
           NorthRhins21_gr_pres,NorthRhins22_gr_pres,
           NorthRhins23_gr_pres,NorthRhins24_gr_pres)


Maximum<-c(NorthRhins1_gr_max,NorthRhins2_gr_max,
           NorthRhins3_gr_max,NorthRhins4_gr_max,
           NorthRhins5_gr_max,NorthRhins6_gr_max,
           NorthRhins7_gr_max,NorthRhins8_gr_max,
           NorthRhins9_gr_max,NorthRhins10_gr_max,
           NorthRhins11_gr_max,NorthRhins12_gr_max,
           NorthRhins13_gr_max,NorthRhins14_gr_max,
           NorthRhins15_gr_max,NorthRhins16_gr_max,
           NorthRhins17_gr_max,NorthRhins18_gr_max,
           NorthRhins19_gr_max,NorthRhins20_gr_max,
           NorthRhins21_gr_max,NorthRhins22_gr_max,
           NorthRhins23_gr_max,NorthRhins24_gr_max)

Low<-c(NorthRhins1_gr_lw_ref, NorthRhins2_gr_lw_ref, NorthRhins3_gr_lw_ref,
       NorthRhins4_gr_lw_ref, NorthRhins5_gr_lw_ref, NorthRhins6_gr_lw_ref,
       NorthRhins7_gr_lw_ref, NorthRhins8_gr_lw_ref, NorthRhins9_gr_lw_ref,
       NorthRhins10_gr_lw_ref, NorthRhins11_gr_lw_ref, NorthRhins12_gr_lw_ref, 
       NorthRhins13_gr_lw_ref, NorthRhins14_gr_lw_ref, NorthRhins15_gr_lw_ref, 
       NorthRhins16_gr_lw_ref, NorthRhins17_gr_lw_ref, NorthRhins18_gr_lw_ref, 
       NorthRhins19_gr_lw_ref, NorthRhins20_gr_lw_ref, NorthRhins21_gr_lw_ref,
       NorthRhins22_gr_lw_ref,NorthRhins23_gr_lw_ref,NorthRhins24_gr_lw_ref)

Moderate<-c(NorthRhins1_gr_mod_ref, NorthRhins2_gr_mod_ref, NorthRhins3_gr_mod_ref,
            NorthRhins4_gr_mod_ref, NorthRhins5_gr_mod_ref, NorthRhins6_gr_mod_ref,
            NorthRhins7_gr_mod_ref, NorthRhins8_gr_mod_ref, NorthRhins9_gr_mod_ref,
            NorthRhins10_gr_mod_ref, NorthRhins11_gr_mod_ref, NorthRhins12_gr_mod_ref, 
            NorthRhins13_gr_mod_ref, NorthRhins14_gr_mod_ref, NorthRhins15_gr_mod_ref, 
            NorthRhins16_gr_mod_ref, NorthRhins17_gr_mod_ref, NorthRhins18_gr_mod_ref, 
            NorthRhins19_gr_mod_ref, NorthRhins20_gr_mod_ref, NorthRhins21_gr_mod_ref,
            NorthRhins22_gr_mod_ref,NorthRhins23_gr_mod_ref,NorthRhins24_gr_mod_ref)

High<-c(NorthRhins1_gr_high_ref, NorthRhins2_gr_high_ref, NorthRhins3_gr_high_ref,
        NorthRhins4_gr_high_ref, NorthRhins5_gr_high_ref, NorthRhins6_gr_high_ref,
        NorthRhins7_gr_high_ref, NorthRhins8_gr_high_ref, NorthRhins9_gr_high_ref,
        NorthRhins10_gr_high_ref, NorthRhins11_gr_high_ref, NorthRhins12_gr_high_ref, 
        NorthRhins13_gr_high_ref, NorthRhins14_gr_high_ref, NorthRhins15_gr_high_ref, 
        NorthRhins16_gr_high_ref, NorthRhins17_gr_high_ref, NorthRhins18_gr_high_ref, 
        NorthRhins19_gr_high_ref, NorthRhins20_gr_high_ref, NorthRhins21_gr_high_ref,
        NorthRhins22_gr_high_ref,NorthRhins23_gr_high_ref,NorthRhins24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("NorthRhinsgr",24)
Lowsite <- NorthRhinslow
Modsite <- NorthRhinsmod
Highsite <-NorthRhinshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



NorthRhinsgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Oldside

Oldsidepipgr<-subset(allspp4gr_ppip, Site=="Oldside")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Oldsidepipgr<-max(Oldsidepipgr$Passes)

#calculate 20% from maximum nightly record

max20_Oldsidepipgr<- (max_Oldsidepipgr/100)*80

##calculate the site classification (reference range)

Oldsidehigh<- max_Oldsidepipgr > allsppgr_ppip_ref_high

Oldsidelow<- allsppgr_ppip_ref_low > max_Oldsidepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Oldsidepipgr
Oldsidemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Oldside1_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 1, replace=F))))
Oldside1_gr_max <- sum(Oldside1_gr > max20_Oldsidepipgr)
Oldside1_gr_max
Oldside1_gr_pres <- sum(Oldside1_gr > 0)
Oldside1_gr_pres
#number of sites which would be classified as low
Oldside1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside1_gr)
Oldside1_gr_lw_ref
#number of sites which would be classified as high
Oldside1_gr_high_ref <- sum( Oldside1_gr > allsppgr_ppip_ref_high)
Oldside1_gr_high_ref
#number of sites which would be classified as moderate
Oldside1_gr_mod_ref <- 1000 - (Oldside1_gr_high_ref + Oldside1_gr_lw_ref)
Oldside1_gr_mod_ref


#2 nights
Oldside2_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Oldside2_grframe<-data.frame(Oldside2_gr, samp2)
Oldside2_grframelong <- melt(Oldside2_grframe,id.vars="samp2")
Oldside2_grframelong_sum <- ddply(Oldside2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside2_gr_max <- sum(Oldside2_grframelong_sum $max > max20_Oldsidepipgr)
Oldside2_gr_max
Oldside2_gr_pres <- sum(Oldside2_grframelong_sum $max > 0)
Oldside2_gr_pres

#number of sites which would be classified as low
Oldside2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside2_grframelong_sum$max)
Oldside2_gr_lw_ref
#number of sites which would be classified as high
Oldside2_gr_high_ref <- sum( Oldside2_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside2_gr_high_ref
#number of sites which would be classified as moderate
Oldside2_gr_mod_ref <- 1000 - (Oldside2_gr_high_ref + Oldside2_gr_lw_ref)
Oldside2_gr_mod_ref


#3 nights
Oldside3_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Oldside3_grframe<-data.frame(Oldside3_gr, samp2)
Oldside3_grframelong <- melt(Oldside3_grframe,id.vars="samp2")
Oldside3_grframelong_sum <- ddply(Oldside3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside3_gr_max <- sum(Oldside3_grframelong_sum $max > max20_Oldsidepipgr)
Oldside3_gr_max
Oldside3_gr_pres <- sum(Oldside3_grframelong_sum $max > 0)
Oldside3_gr_pres

#number of sites which would be classified as low
Oldside3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside3_grframelong_sum$max)
Oldside3_gr_lw_ref
#number of sites which would be classified as high
Oldside3_gr_high_ref <- sum( Oldside3_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside3_gr_high_ref
#number of sites which would be classified as moderate
Oldside3_gr_mod_ref <- 1000 - (Oldside3_gr_high_ref + Oldside3_gr_lw_ref)
Oldside3_gr_mod_ref

#4 nights
Oldside4_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Oldside4_grframe<-data.frame(Oldside4_gr, samp2)
Oldside4_grframelong <- melt(Oldside4_grframe,id.vars="samp2")
Oldside4_grframelong_sum <- ddply(Oldside4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside4_gr_max <- sum(Oldside4_grframelong_sum $max > max20_Oldsidepipgr)
Oldside4_gr_max
Oldside4_gr_pres <- sum(Oldside4_grframelong_sum $max > 0)
Oldside4_gr_pres

#number of sites which would be classified as low
Oldside4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside4_grframelong_sum$max)
Oldside4_gr_lw_ref
#number of sites which would be classified as high
Oldside4_gr_high_ref <- sum( Oldside4_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside4_gr_high_ref
#number of sites which would be classified as moderate
Oldside4_gr_mod_ref <- 1000 - (Oldside4_gr_high_ref + Oldside4_gr_lw_ref)
Oldside4_gr_mod_ref

#5 nights
Oldside5_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Oldside5_grframe<-data.frame(Oldside5_gr, samp2)
Oldside5_grframelong <- melt(Oldside5_grframe,id.vars="samp2")
Oldside5_grframelong_sum <- ddply(Oldside5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside5_gr_max <- sum(Oldside5_grframelong_sum $max > max20_Oldsidepipgr)
Oldside5_gr_max
Oldside5_gr_pres <- sum(Oldside5_grframelong_sum $max > 0)
Oldside5_gr_pres

#number of sites which would be classified as low
Oldside5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside5_grframelong_sum$max)
Oldside5_gr_lw_ref
#number of sites which would be classified as high
Oldside5_gr_high_ref <- sum( Oldside5_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside5_gr_high_ref
#number of sites which would be classified as moderate
Oldside5_gr_mod_ref <- 1000 - (Oldside5_gr_high_ref + Oldside5_gr_lw_ref)
Oldside5_gr_mod_ref

#6 nights
Oldside6_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Oldside6_grframe<-data.frame(Oldside6_gr, samp2)
Oldside6_grframelong <- melt(Oldside6_grframe,id.vars="samp2")
Oldside6_grframelong_sum <- ddply(Oldside6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside6_gr_max <- sum(Oldside6_grframelong_sum $max > max20_Oldsidepipgr)
Oldside6_gr_max
Oldside6_gr_pres <- sum(Oldside6_grframelong_sum $max > 0)
Oldside6_gr_pres

#number of sites which would be classified as low
Oldside6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside6_grframelong_sum$max)
Oldside6_gr_lw_ref
#number of sites which would be classified as high
Oldside6_gr_high_ref <- sum( Oldside6_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside6_gr_high_ref
#number of sites which would be classified as moderate
Oldside6_gr_mod_ref <- 1000 - (Oldside6_gr_high_ref + Oldside6_gr_lw_ref)
Oldside6_gr_mod_ref

#7 nights
Oldside7_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Oldside7_grframe<-data.frame(Oldside7_gr, samp2)
Oldside7_grframelong <- melt(Oldside7_grframe,id.vars="samp2")
Oldside7_grframelong_sum <- ddply(Oldside7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside7_gr_max <- sum(Oldside7_grframelong_sum $max > max20_Oldsidepipgr)
Oldside7_gr_max
Oldside7_gr_pres <- sum(Oldside7_grframelong_sum $max > 0)
Oldside7_gr_pres

#number of sites which would be classified as low
Oldside7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside7_grframelong_sum$max)
Oldside7_gr_lw_ref
#number of sites which would be classified as high
Oldside7_gr_high_ref <- sum( Oldside7_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside7_gr_high_ref
#number of sites which would be classified as moderate
Oldside7_gr_mod_ref <- 1000 - (Oldside7_gr_high_ref + Oldside7_gr_lw_ref)
Oldside7_gr_mod_ref

#8 nights
Oldside8_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Oldside8_grframe<-data.frame(Oldside8_gr, samp2)
Oldside8_grframelong <- melt(Oldside8_grframe,id.vars="samp2")
Oldside8_grframelong_sum <- ddply(Oldside8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside8_gr_max <- sum(Oldside8_grframelong_sum $max > max20_Oldsidepipgr)
Oldside8_gr_max
Oldside8_gr_pres <- sum(Oldside8_grframelong_sum $max > 0)
Oldside8_gr_pres

#number of sites which would be classified as low
Oldside8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside8_grframelong_sum$max)
Oldside8_gr_lw_ref
#number of sites which would be classified as high
Oldside8_gr_high_ref <- sum( Oldside8_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside8_gr_high_ref
#number of sites which would be classified as moderate
Oldside8_gr_mod_ref <- 1000 - (Oldside8_gr_high_ref + Oldside8_gr_lw_ref)
Oldside8_gr_mod_ref

#9 nights
Oldside9_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Oldside9_grframe<-data.frame(Oldside9_gr, samp2)
Oldside9_grframelong <- melt(Oldside9_grframe,id.vars="samp2")
Oldside9_grframelong_sum <- ddply(Oldside9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Oldside9_gr_max <- sum(Oldside9_grframelong_sum $max > max20_Oldsidepipgr)
Oldside9_gr_max
Oldside9_gr_pres <- sum(Oldside9_grframelong_sum $max > 0)
Oldside9_gr_pres

#number of sites which would be classified as low
Oldside9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside9_grframelong_sum$max)
Oldside9_gr_lw_ref
#number of sites which would be classified as high
Oldside9_gr_high_ref <- sum( Oldside9_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside9_gr_high_ref
#number of sites which would be classified as moderate
Oldside9_gr_mod_ref <- 1000 - (Oldside9_gr_high_ref + Oldside9_gr_lw_ref)
Oldside9_gr_mod_ref

#10 detectors
Oldside10_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Oldside10_grframe<-data.frame(Oldside10_gr, samp2)
Oldside10_grframelong <- melt(Oldside10_grframe,id.vars="samp2")
Oldside10_grframelong_sum <- ddply(Oldside10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside10_gr_max <- sum(Oldside10_grframelong_sum $max > max20_Oldsidepipgr)
Oldside10_gr_max
Oldside10_gr_pres <- sum(Oldside10_grframelong_sum $max > 0)
Oldside10_gr_pres

#number of sites which would be classified as low
Oldside10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside10_grframelong_sum$max)
Oldside10_gr_lw_ref
#number of sites which would be classified as high
Oldside10_gr_high_ref <- sum( Oldside10_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside10_gr_high_ref
#number of sites which would be classified as moderate
Oldside10_gr_mod_ref <- 1000 - (Oldside10_gr_high_ref + Oldside10_gr_lw_ref)
Oldside10_gr_mod_ref

#11 detectors
Oldside11_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Oldside11_grframe<-data.frame(Oldside11_gr, samp2)
Oldside11_grframelong <- melt(Oldside11_grframe,id.vars="samp2")
Oldside11_grframelong_sum <- ddply(Oldside11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside11_gr_max <- sum(Oldside11_grframelong_sum $max > max20_Oldsidepipgr)
Oldside11_gr_max
Oldside11_gr_pres <- sum(Oldside11_grframelong_sum $max > 0)
Oldside11_gr_pres

#number of sites which would be classified as low
Oldside11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside11_grframelong_sum$max)
Oldside11_gr_lw_ref
#number of sites which would be classified as high
Oldside11_gr_high_ref <- sum( Oldside11_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside11_gr_high_ref
#number of sites which would be classified as moderate
Oldside11_gr_mod_ref <- 1000 - (Oldside11_gr_high_ref + Oldside11_gr_lw_ref)
Oldside11_gr_mod_ref

#12 detectors
Oldside12_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Oldside12_grframe<-data.frame(Oldside12_gr, samp2)
Oldside12_grframelong <- melt(Oldside12_grframe,id.vars="samp2")
Oldside12_grframelong_sum <- ddply(Oldside12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside12_gr_max <- sum(Oldside12_grframelong_sum $max > max20_Oldsidepipgr)
Oldside12_gr_max
Oldside12_gr_pres <- sum(Oldside12_grframelong_sum $max > 0)
Oldside12_gr_pres

#number of sites which would be classified as low
Oldside12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside12_grframelong_sum$max)
Oldside12_gr_lw_ref
#number of sites which would be classified as high
Oldside12_gr_high_ref <- sum( Oldside12_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside12_gr_high_ref
#number of sites which would be classified as moderate
Oldside12_gr_mod_ref <- 1000 - (Oldside12_gr_high_ref + Oldside12_gr_lw_ref)
Oldside12_gr_mod_ref

#13 detectors
Oldside13_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Oldside13_grframe<-data.frame(Oldside13_gr, samp2)
Oldside13_grframelong <- melt(Oldside13_grframe,id.vars="samp2")
Oldside13_grframelong_sum <- ddply(Oldside13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside13_gr_max <- sum(Oldside13_grframelong_sum $max > max20_Oldsidepipgr)
Oldside13_gr_max
Oldside13_gr_pres <- sum(Oldside13_grframelong_sum $max > 0)
Oldside13_gr_pres

#number of sites which would be classified as low
Oldside13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside13_grframelong_sum$max)
Oldside13_gr_lw_ref
#number of sites which would be classified as high
Oldside13_gr_high_ref <- sum( Oldside13_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside13_gr_high_ref
#number of sites which would be classified as moderate
Oldside13_gr_mod_ref <- 1000 - (Oldside13_gr_high_ref + Oldside13_gr_lw_ref)
Oldside13_gr_mod_ref

#14 detectors
Oldside14_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Oldside14_grframe<-data.frame(Oldside14_gr, samp2)
Oldside14_grframelong <- melt(Oldside14_grframe,id.vars="samp2")
Oldside14_grframelong_sum <- ddply(Oldside14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside14_gr_max <- sum(Oldside14_grframelong_sum $max > max20_Oldsidepipgr)
Oldside14_gr_max
Oldside14_gr_pres <- sum(Oldside14_grframelong_sum $max > 0)
Oldside14_gr_pres

#number of sites which would be classified as low
Oldside14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside14_grframelong_sum$max)
Oldside14_gr_lw_ref
#number of sites which would be classified as high
Oldside14_gr_high_ref <- sum( Oldside14_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside14_gr_high_ref
#number of sites which would be classified as moderate
Oldside14_gr_mod_ref <- 1000 - (Oldside14_gr_high_ref + Oldside14_gr_lw_ref)
Oldside14_gr_mod_ref

#15 detectors
Oldside15_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Oldside15_grframe<-data.frame(Oldside15_gr, samp2)
Oldside15_grframelong <- melt(Oldside15_grframe,id.vars="samp2")
Oldside15_grframelong_sum <- ddply(Oldside15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside15_gr_max <- sum(Oldside15_grframelong_sum $max > max20_Oldsidepipgr)
Oldside15_gr_max
Oldside15_gr_pres <- sum(Oldside15_grframelong_sum $max > 0)
Oldside15_gr_pres

#number of sites which would be classified as low
Oldside15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside15_grframelong_sum$max)
Oldside15_gr_lw_ref
#number of sites which would be classified as high
Oldside15_gr_high_ref <- sum( Oldside15_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside15_gr_high_ref
#number of sites which would be classified as moderate
Oldside15_gr_mod_ref <- 1000 - (Oldside15_gr_high_ref + Oldside15_gr_lw_ref)
Oldside15_gr_mod_ref

#16 detectors
Oldside16_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Oldside16_grframe<-data.frame(Oldside16_gr, samp2)
Oldside16_grframelong <- melt(Oldside16_grframe,id.vars="samp2")
Oldside16_grframelong_sum <- ddply(Oldside16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside16_gr_max <- sum(Oldside16_grframelong_sum $max > max20_Oldsidepipgr)
Oldside16_gr_max
Oldside16_gr_pres <- sum(Oldside16_grframelong_sum $max > 0)
Oldside16_gr_pres

#number of sites which would be classified as low
Oldside16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside16_grframelong_sum$max)
Oldside16_gr_lw_ref
#number of sites which would be classified as high
Oldside16_gr_high_ref <- sum( Oldside16_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside16_gr_high_ref
#number of sites which would be classified as moderate
Oldside16_gr_mod_ref <- 1000 - (Oldside16_gr_high_ref + Oldside16_gr_lw_ref)
Oldside16_gr_mod_ref

#17 detectors
Oldside17_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Oldside17_grframe<-data.frame(Oldside17_gr, samp2)
Oldside17_grframelong <- melt(Oldside17_grframe,id.vars="samp2")
Oldside17_grframelong_sum <- ddply(Oldside17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside17_gr_max <- sum(Oldside17_grframelong_sum $max > max20_Oldsidepipgr)
Oldside17_gr_max
Oldside17_gr_pres <- sum(Oldside17_grframelong_sum $max > 0)
Oldside17_gr_pres

#number of sites which would be classified as low
Oldside17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside17_grframelong_sum$max)
Oldside17_gr_lw_ref
#number of sites which would be classified as high
Oldside17_gr_high_ref <- sum( Oldside17_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside17_gr_high_ref
#number of sites which would be classified as moderate
Oldside17_gr_mod_ref <- 1000 - (Oldside17_gr_high_ref + Oldside17_gr_lw_ref)
Oldside17_gr_mod_ref

#18 detectors
Oldside18_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Oldside18_grframe<-data.frame(Oldside18_gr, samp2)
Oldside18_grframelong <- melt(Oldside18_grframe,id.vars="samp2")
Oldside18_grframelong_sum <- ddply(Oldside18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside18_gr_max <- sum(Oldside18_grframelong_sum $max > max20_Oldsidepipgr)
Oldside18_gr_max
Oldside18_gr_pres <- sum(Oldside18_grframelong_sum $max > 0)
Oldside18_gr_pres

#number of sites which would be classified as low
Oldside18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside18_grframelong_sum$max)
Oldside18_gr_lw_ref
#number of sites which would be classified as high
Oldside18_gr_high_ref <- sum( Oldside18_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside18_gr_high_ref
#number of sites which would be classified as moderate
Oldside18_gr_mod_ref <- 1000 - (Oldside18_gr_high_ref + Oldside18_gr_lw_ref)
Oldside18_gr_mod_ref

#19 detectors
Oldside19_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Oldside19_grframe<-data.frame(Oldside19_gr, samp2)
Oldside19_grframelong <- melt(Oldside19_grframe,id.vars="samp2")
Oldside19_grframelong_sum <- ddply(Oldside19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside19_gr_max <- sum(Oldside19_grframelong_sum $max > max20_Oldsidepipgr)
Oldside19_gr_max
Oldside19_gr_pres <- sum(Oldside19_grframelong_sum $max > 0)
Oldside19_gr_pres

#number of sites which would be classified as low
Oldside19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside19_grframelong_sum$max)
Oldside19_gr_lw_ref
#number of sites which would be classified as high
Oldside19_gr_high_ref <- sum( Oldside19_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside19_gr_high_ref
#number of sites which would be classified as moderate
Oldside19_gr_mod_ref <- 1000 - (Oldside19_gr_high_ref + Oldside19_gr_lw_ref)
Oldside19_gr_mod_ref

#20 detectors
Oldside20_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Oldside20_grframe<-data.frame(Oldside20_gr, samp2)
Oldside20_grframelong <- melt(Oldside20_grframe,id.vars="samp2")
Oldside20_grframelong_sum <- ddply(Oldside20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside20_gr_max <- sum(Oldside20_grframelong_sum $max > max20_Oldsidepipgr)
Oldside20_gr_max
Oldside20_gr_pres <- sum(Oldside20_grframelong_sum $max > 0)
Oldside20_gr_pres

#number of sites which would be classified as low
Oldside20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside20_grframelong_sum$max)
Oldside20_gr_lw_ref
#number of sites which would be classified as high
Oldside20_gr_high_ref <- sum( Oldside20_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside20_gr_high_ref
#number of sites which would be classified as moderate
Oldside20_gr_mod_ref <- 1000 - (Oldside20_gr_high_ref + Oldside20_gr_lw_ref)
Oldside20_gr_mod_ref

#21 detectors
Oldside21_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Oldside21_grframe<-data.frame(Oldside21_gr, samp2)
Oldside21_grframelong <- melt(Oldside21_grframe,id.vars="samp2")
Oldside21_grframelong_sum <- ddply(Oldside21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside21_gr_max <- sum(Oldside21_grframelong_sum $max > max20_Oldsidepipgr)
Oldside21_gr_max
Oldside21_gr_pres <- sum(Oldside21_grframelong_sum $max > 0)
Oldside21_gr_pres

#number of sites which would be classified as low
Oldside21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside21_grframelong_sum$max)
Oldside21_gr_lw_ref
#number of sites which would be classified as high
Oldside21_gr_high_ref <- sum( Oldside21_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside21_gr_high_ref
#number of sites which would be classified as moderate
Oldside21_gr_mod_ref <- 1000 - (Oldside21_gr_high_ref + Oldside21_gr_lw_ref)
Oldside21_gr_mod_ref

#22 detectors
Oldside22_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Oldside22_grframe<-data.frame(Oldside22_gr, samp2)
Oldside22_grframelong <- melt(Oldside22_grframe,id.vars="samp2")
Oldside22_grframelong_sum <- ddply(Oldside22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside22_gr_max <- sum(Oldside22_grframelong_sum $max > max20_Oldsidepipgr)
Oldside22_gr_max
Oldside22_gr_pres <- sum(Oldside22_grframelong_sum $max > 0)
Oldside22_gr_pres

#number of sites which would be classified as low
Oldside22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside22_grframelong_sum$max)
Oldside22_gr_lw_ref
#number of sites which would be classified as high
Oldside22_gr_high_ref <- sum( Oldside22_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside22_gr_high_ref
#number of sites which would be classified as moderate
Oldside22_gr_mod_ref <- 1000 - (Oldside22_gr_high_ref + Oldside22_gr_lw_ref)
Oldside22_gr_mod_ref

#23 detectors
Oldside23_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Oldside23_grframe<-data.frame(Oldside23_gr, samp2)
Oldside23_grframelong <- melt(Oldside23_grframe,id.vars="samp2")
Oldside23_grframelong_sum <- ddply(Oldside23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside23_gr_max <- sum(Oldside23_grframelong_sum $max > max20_Oldsidepipgr)
Oldside23_gr_max
Oldside23_gr_pres <- sum(Oldside23_grframelong_sum $max > 0)
Oldside23_gr_pres

#number of sites which would be classified as low
Oldside23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside23_grframelong_sum$max)
Oldside23_gr_lw_ref
#number of sites which would be classified as high
Oldside23_gr_high_ref <- sum( Oldside23_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside23_gr_high_ref
#number of sites which would be classified as moderate
Oldside23_gr_mod_ref <- 1000 - (Oldside23_gr_high_ref + Oldside23_gr_lw_ref)
Oldside23_gr_mod_ref

#24 detectors
Oldside24_gr<-(replicate(1000, (sample(Oldsidepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Oldside24_grframe<-data.frame(Oldside24_gr, samp2)
Oldside24_grframelong <- melt(Oldside24_grframe,id.vars="samp2")
Oldside24_grframelong_sum <- ddply(Oldside24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Oldside24_gr_max <- sum(Oldside24_grframelong_sum $max > max20_Oldsidepipgr)
Oldside24_gr_max
Oldside24_gr_pres <- sum(Oldside24_grframelong_sum $max > 0)
Oldside24_gr_pres

#number of sites which would be classified as low
Oldside24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Oldside24_grframelong_sum$max)
Oldside24_gr_lw_ref
#number of sites which would be classified as high
Oldside24_gr_high_ref <- sum( Oldside24_grframelong_sum$max > allsppgr_ppip_ref_high)
Oldside24_gr_high_ref
#number of sites which would be classified as moderate
Oldside24_gr_mod_ref <- 1000 - (Oldside24_gr_high_ref + Oldside24_gr_lw_ref)
Oldside24_gr_mod_ref

Present<-c(Oldside1_gr_pres,Oldside2_gr_pres,
           Oldside3_gr_pres,Oldside4_gr_pres,
           Oldside5_gr_pres,Oldside6_gr_pres,
           Oldside7_gr_pres,Oldside8_gr_pres,
           Oldside9_gr_pres,Oldside10_gr_pres,
           Oldside11_gr_pres,Oldside12_gr_pres,
           Oldside13_gr_pres,Oldside14_gr_pres,
           Oldside15_gr_pres,Oldside16_gr_pres,
           Oldside17_gr_pres,Oldside18_gr_pres,
           Oldside19_gr_pres,Oldside20_gr_pres,
           Oldside21_gr_pres,Oldside22_gr_pres,
           Oldside23_gr_pres,Oldside24_gr_pres)


Maximum<-c(Oldside1_gr_max,Oldside2_gr_max,
           Oldside3_gr_max,Oldside4_gr_max,
           Oldside5_gr_max,Oldside6_gr_max,
           Oldside7_gr_max,Oldside8_gr_max,
           Oldside9_gr_max,Oldside10_gr_max,
           Oldside11_gr_max,Oldside12_gr_max,
           Oldside13_gr_max,Oldside14_gr_max,
           Oldside15_gr_max,Oldside16_gr_max,
           Oldside17_gr_max,Oldside18_gr_max,
           Oldside19_gr_max,Oldside20_gr_max,
           Oldside21_gr_max,Oldside22_gr_max,
           Oldside23_gr_max,Oldside24_gr_max)

Low<-c(Oldside1_gr_lw_ref, Oldside2_gr_lw_ref, Oldside3_gr_lw_ref,
       Oldside4_gr_lw_ref, Oldside5_gr_lw_ref, Oldside6_gr_lw_ref,
       Oldside7_gr_lw_ref, Oldside8_gr_lw_ref, Oldside9_gr_lw_ref,
       Oldside10_gr_lw_ref, Oldside11_gr_lw_ref, Oldside12_gr_lw_ref, 
       Oldside13_gr_lw_ref, Oldside14_gr_lw_ref, Oldside15_gr_lw_ref, 
       Oldside16_gr_lw_ref, Oldside17_gr_lw_ref, Oldside18_gr_lw_ref, 
       Oldside19_gr_lw_ref, Oldside20_gr_lw_ref, Oldside21_gr_lw_ref,
       Oldside22_gr_lw_ref,Oldside23_gr_lw_ref,Oldside24_gr_lw_ref)

Moderate<-c(Oldside1_gr_mod_ref, Oldside2_gr_mod_ref, Oldside3_gr_mod_ref,
            Oldside4_gr_mod_ref, Oldside5_gr_mod_ref, Oldside6_gr_mod_ref,
            Oldside7_gr_mod_ref, Oldside8_gr_mod_ref, Oldside9_gr_mod_ref,
            Oldside10_gr_mod_ref, Oldside11_gr_mod_ref, Oldside12_gr_mod_ref, 
            Oldside13_gr_mod_ref, Oldside14_gr_mod_ref, Oldside15_gr_mod_ref, 
            Oldside16_gr_mod_ref, Oldside17_gr_mod_ref, Oldside18_gr_mod_ref, 
            Oldside19_gr_mod_ref, Oldside20_gr_mod_ref, Oldside21_gr_mod_ref,
            Oldside22_gr_mod_ref,Oldside23_gr_mod_ref,Oldside24_gr_mod_ref)

High<-c(Oldside1_gr_high_ref, Oldside2_gr_high_ref, Oldside3_gr_high_ref,
        Oldside4_gr_high_ref, Oldside5_gr_high_ref, Oldside6_gr_high_ref,
        Oldside7_gr_high_ref, Oldside8_gr_high_ref, Oldside9_gr_high_ref,
        Oldside10_gr_high_ref, Oldside11_gr_high_ref, Oldside12_gr_high_ref, 
        Oldside13_gr_high_ref, Oldside14_gr_high_ref, Oldside15_gr_high_ref, 
        Oldside16_gr_high_ref, Oldside17_gr_high_ref, Oldside18_gr_high_ref, 
        Oldside19_gr_high_ref, Oldside20_gr_high_ref, Oldside21_gr_high_ref,
        Oldside22_gr_high_ref,Oldside23_gr_high_ref,Oldside24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Oldsidegr",24)
Lowsite <- Oldsidelow
Modsite <- Oldsidemod
Highsite <-Oldsidehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Oldsidegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##Otterham

Otterhampipgr<-subset(allspp4gr_ppip, Site=="Otterham")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Otterhampipgr<-max(Otterhampipgr$Passes)

#calculate 20% from maximum nightly record

max20_Otterhampipgr<- (max_Otterhampipgr/100)*80

##calculate the site classification (reference range)

Otterhamhigh<- max_Otterhampipgr > allsppgr_ppip_ref_high

Otterhamlow<- allsppgr_ppip_ref_low > max_Otterhampipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Otterhampipgr
Otterhammod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Otterham1_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 1, replace=F))))
Otterham1_gr_max <- sum(Otterham1_gr > max20_Otterhampipgr)
Otterham1_gr_max
Otterham1_gr_pres <- sum(Otterham1_gr > 0)
Otterham1_gr_pres
#number of sites which would be classified as low
Otterham1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham1_gr)
Otterham1_gr_lw_ref
#number of sites which would be classified as high
Otterham1_gr_high_ref <- sum( Otterham1_gr > allsppgr_ppip_ref_high)
Otterham1_gr_high_ref
#number of sites which would be classified as moderate
Otterham1_gr_mod_ref <- 1000 - (Otterham1_gr_high_ref + Otterham1_gr_lw_ref)
Otterham1_gr_mod_ref


#2 nights
Otterham2_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Otterham2_grframe<-data.frame(Otterham2_gr, samp2)
Otterham2_grframelong <- melt(Otterham2_grframe,id.vars="samp2")
Otterham2_grframelong_sum <- ddply(Otterham2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham2_gr_max <- sum(Otterham2_grframelong_sum $max > max20_Otterhampipgr)
Otterham2_gr_max
Otterham2_gr_pres <- sum(Otterham2_grframelong_sum $max > 0)
Otterham2_gr_pres

#number of sites which would be classified as low
Otterham2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham2_grframelong_sum$max)
Otterham2_gr_lw_ref
#number of sites which would be classified as high
Otterham2_gr_high_ref <- sum( Otterham2_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham2_gr_high_ref
#number of sites which would be classified as moderate
Otterham2_gr_mod_ref <- 1000 - (Otterham2_gr_high_ref + Otterham2_gr_lw_ref)
Otterham2_gr_mod_ref


#3 nights
Otterham3_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Otterham3_grframe<-data.frame(Otterham3_gr, samp2)
Otterham3_grframelong <- melt(Otterham3_grframe,id.vars="samp2")
Otterham3_grframelong_sum <- ddply(Otterham3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham3_gr_max <- sum(Otterham3_grframelong_sum $max > max20_Otterhampipgr)
Otterham3_gr_max
Otterham3_gr_pres <- sum(Otterham3_grframelong_sum $max > 0)
Otterham3_gr_pres

#number of sites which would be classified as low
Otterham3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham3_grframelong_sum$max)
Otterham3_gr_lw_ref
#number of sites which would be classified as high
Otterham3_gr_high_ref <- sum( Otterham3_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham3_gr_high_ref
#number of sites which would be classified as moderate
Otterham3_gr_mod_ref <- 1000 - (Otterham3_gr_high_ref + Otterham3_gr_lw_ref)
Otterham3_gr_mod_ref

#4 nights
Otterham4_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Otterham4_grframe<-data.frame(Otterham4_gr, samp2)
Otterham4_grframelong <- melt(Otterham4_grframe,id.vars="samp2")
Otterham4_grframelong_sum <- ddply(Otterham4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham4_gr_max <- sum(Otterham4_grframelong_sum $max > max20_Otterhampipgr)
Otterham4_gr_max
Otterham4_gr_pres <- sum(Otterham4_grframelong_sum $max > 0)
Otterham4_gr_pres

#number of sites which would be classified as low
Otterham4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham4_grframelong_sum$max)
Otterham4_gr_lw_ref
#number of sites which would be classified as high
Otterham4_gr_high_ref <- sum( Otterham4_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham4_gr_high_ref
#number of sites which would be classified as moderate
Otterham4_gr_mod_ref <- 1000 - (Otterham4_gr_high_ref + Otterham4_gr_lw_ref)
Otterham4_gr_mod_ref

#5 nights
Otterham5_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Otterham5_grframe<-data.frame(Otterham5_gr, samp2)
Otterham5_grframelong <- melt(Otterham5_grframe,id.vars="samp2")
Otterham5_grframelong_sum <- ddply(Otterham5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham5_gr_max <- sum(Otterham5_grframelong_sum $max > max20_Otterhampipgr)
Otterham5_gr_max
Otterham5_gr_pres <- sum(Otterham5_grframelong_sum $max > 0)
Otterham5_gr_pres

#number of sites which would be classified as low
Otterham5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham5_grframelong_sum$max)
Otterham5_gr_lw_ref
#number of sites which would be classified as high
Otterham5_gr_high_ref <- sum( Otterham5_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham5_gr_high_ref
#number of sites which would be classified as moderate
Otterham5_gr_mod_ref <- 1000 - (Otterham5_gr_high_ref + Otterham5_gr_lw_ref)
Otterham5_gr_mod_ref

#6 nights
Otterham6_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Otterham6_grframe<-data.frame(Otterham6_gr, samp2)
Otterham6_grframelong <- melt(Otterham6_grframe,id.vars="samp2")
Otterham6_grframelong_sum <- ddply(Otterham6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham6_gr_max <- sum(Otterham6_grframelong_sum $max > max20_Otterhampipgr)
Otterham6_gr_max
Otterham6_gr_pres <- sum(Otterham6_grframelong_sum $max > 0)
Otterham6_gr_pres

#number of sites which would be classified as low
Otterham6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham6_grframelong_sum$max)
Otterham6_gr_lw_ref
#number of sites which would be classified as high
Otterham6_gr_high_ref <- sum( Otterham6_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham6_gr_high_ref
#number of sites which would be classified as moderate
Otterham6_gr_mod_ref <- 1000 - (Otterham6_gr_high_ref + Otterham6_gr_lw_ref)
Otterham6_gr_mod_ref

#7 nights
Otterham7_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Otterham7_grframe<-data.frame(Otterham7_gr, samp2)
Otterham7_grframelong <- melt(Otterham7_grframe,id.vars="samp2")
Otterham7_grframelong_sum <- ddply(Otterham7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham7_gr_max <- sum(Otterham7_grframelong_sum $max > max20_Otterhampipgr)
Otterham7_gr_max
Otterham7_gr_pres <- sum(Otterham7_grframelong_sum $max > 0)
Otterham7_gr_pres

#number of sites which would be classified as low
Otterham7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham7_grframelong_sum$max)
Otterham7_gr_lw_ref
#number of sites which would be classified as high
Otterham7_gr_high_ref <- sum( Otterham7_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham7_gr_high_ref
#number of sites which would be classified as moderate
Otterham7_gr_mod_ref <- 1000 - (Otterham7_gr_high_ref + Otterham7_gr_lw_ref)
Otterham7_gr_mod_ref

#8 nights
Otterham8_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Otterham8_grframe<-data.frame(Otterham8_gr, samp2)
Otterham8_grframelong <- melt(Otterham8_grframe,id.vars="samp2")
Otterham8_grframelong_sum <- ddply(Otterham8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham8_gr_max <- sum(Otterham8_grframelong_sum $max > max20_Otterhampipgr)
Otterham8_gr_max
Otterham8_gr_pres <- sum(Otterham8_grframelong_sum $max > 0)
Otterham8_gr_pres

#number of sites which would be classified as low
Otterham8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham8_grframelong_sum$max)
Otterham8_gr_lw_ref
#number of sites which would be classified as high
Otterham8_gr_high_ref <- sum( Otterham8_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham8_gr_high_ref
#number of sites which would be classified as moderate
Otterham8_gr_mod_ref <- 1000 - (Otterham8_gr_high_ref + Otterham8_gr_lw_ref)
Otterham8_gr_mod_ref

#9 nights
Otterham9_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Otterham9_grframe<-data.frame(Otterham9_gr, samp2)
Otterham9_grframelong <- melt(Otterham9_grframe,id.vars="samp2")
Otterham9_grframelong_sum <- ddply(Otterham9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Otterham9_gr_max <- sum(Otterham9_grframelong_sum $max > max20_Otterhampipgr)
Otterham9_gr_max
Otterham9_gr_pres <- sum(Otterham9_grframelong_sum $max > 0)
Otterham9_gr_pres

#number of sites which would be classified as low
Otterham9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham9_grframelong_sum$max)
Otterham9_gr_lw_ref
#number of sites which would be classified as high
Otterham9_gr_high_ref <- sum( Otterham9_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham9_gr_high_ref
#number of sites which would be classified as moderate
Otterham9_gr_mod_ref <- 1000 - (Otterham9_gr_high_ref + Otterham9_gr_lw_ref)
Otterham9_gr_mod_ref

#10 detectors
Otterham10_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Otterham10_grframe<-data.frame(Otterham10_gr, samp2)
Otterham10_grframelong <- melt(Otterham10_grframe,id.vars="samp2")
Otterham10_grframelong_sum <- ddply(Otterham10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham10_gr_max <- sum(Otterham10_grframelong_sum $max > max20_Otterhampipgr)
Otterham10_gr_max
Otterham10_gr_pres <- sum(Otterham10_grframelong_sum $max > 0)
Otterham10_gr_pres

#number of sites which would be classified as low
Otterham10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham10_grframelong_sum$max)
Otterham10_gr_lw_ref
#number of sites which would be classified as high
Otterham10_gr_high_ref <- sum( Otterham10_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham10_gr_high_ref
#number of sites which would be classified as moderate
Otterham10_gr_mod_ref <- 1000 - (Otterham10_gr_high_ref + Otterham10_gr_lw_ref)
Otterham10_gr_mod_ref

#11 detectors
Otterham11_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Otterham11_grframe<-data.frame(Otterham11_gr, samp2)
Otterham11_grframelong <- melt(Otterham11_grframe,id.vars="samp2")
Otterham11_grframelong_sum <- ddply(Otterham11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham11_gr_max <- sum(Otterham11_grframelong_sum $max > max20_Otterhampipgr)
Otterham11_gr_max
Otterham11_gr_pres <- sum(Otterham11_grframelong_sum $max > 0)
Otterham11_gr_pres

#number of sites which would be classified as low
Otterham11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham11_grframelong_sum$max)
Otterham11_gr_lw_ref
#number of sites which would be classified as high
Otterham11_gr_high_ref <- sum( Otterham11_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham11_gr_high_ref
#number of sites which would be classified as moderate
Otterham11_gr_mod_ref <- 1000 - (Otterham11_gr_high_ref + Otterham11_gr_lw_ref)
Otterham11_gr_mod_ref

#12 detectors
Otterham12_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Otterham12_grframe<-data.frame(Otterham12_gr, samp2)
Otterham12_grframelong <- melt(Otterham12_grframe,id.vars="samp2")
Otterham12_grframelong_sum <- ddply(Otterham12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham12_gr_max <- sum(Otterham12_grframelong_sum $max > max20_Otterhampipgr)
Otterham12_gr_max
Otterham12_gr_pres <- sum(Otterham12_grframelong_sum $max > 0)
Otterham12_gr_pres

#number of sites which would be classified as low
Otterham12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham12_grframelong_sum$max)
Otterham12_gr_lw_ref
#number of sites which would be classified as high
Otterham12_gr_high_ref <- sum( Otterham12_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham12_gr_high_ref
#number of sites which would be classified as moderate
Otterham12_gr_mod_ref <- 1000 - (Otterham12_gr_high_ref + Otterham12_gr_lw_ref)
Otterham12_gr_mod_ref

#13 detectors
Otterham13_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Otterham13_grframe<-data.frame(Otterham13_gr, samp2)
Otterham13_grframelong <- melt(Otterham13_grframe,id.vars="samp2")
Otterham13_grframelong_sum <- ddply(Otterham13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham13_gr_max <- sum(Otterham13_grframelong_sum $max > max20_Otterhampipgr)
Otterham13_gr_max
Otterham13_gr_pres <- sum(Otterham13_grframelong_sum $max > 0)
Otterham13_gr_pres

#number of sites which would be classified as low
Otterham13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham13_grframelong_sum$max)
Otterham13_gr_lw_ref
#number of sites which would be classified as high
Otterham13_gr_high_ref <- sum( Otterham13_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham13_gr_high_ref
#number of sites which would be classified as moderate
Otterham13_gr_mod_ref <- 1000 - (Otterham13_gr_high_ref + Otterham13_gr_lw_ref)
Otterham13_gr_mod_ref

#14 detectors
Otterham14_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Otterham14_grframe<-data.frame(Otterham14_gr, samp2)
Otterham14_grframelong <- melt(Otterham14_grframe,id.vars="samp2")
Otterham14_grframelong_sum <- ddply(Otterham14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham14_gr_max <- sum(Otterham14_grframelong_sum $max > max20_Otterhampipgr)
Otterham14_gr_max
Otterham14_gr_pres <- sum(Otterham14_grframelong_sum $max > 0)
Otterham14_gr_pres

#number of sites which would be classified as low
Otterham14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham14_grframelong_sum$max)
Otterham14_gr_lw_ref
#number of sites which would be classified as high
Otterham14_gr_high_ref <- sum( Otterham14_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham14_gr_high_ref
#number of sites which would be classified as moderate
Otterham14_gr_mod_ref <- 1000 - (Otterham14_gr_high_ref + Otterham14_gr_lw_ref)
Otterham14_gr_mod_ref

#15 detectors
Otterham15_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Otterham15_grframe<-data.frame(Otterham15_gr, samp2)
Otterham15_grframelong <- melt(Otterham15_grframe,id.vars="samp2")
Otterham15_grframelong_sum <- ddply(Otterham15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham15_gr_max <- sum(Otterham15_grframelong_sum $max > max20_Otterhampipgr)
Otterham15_gr_max
Otterham15_gr_pres <- sum(Otterham15_grframelong_sum $max > 0)
Otterham15_gr_pres

#number of sites which would be classified as low
Otterham15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham15_grframelong_sum$max)
Otterham15_gr_lw_ref
#number of sites which would be classified as high
Otterham15_gr_high_ref <- sum( Otterham15_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham15_gr_high_ref
#number of sites which would be classified as moderate
Otterham15_gr_mod_ref <- 1000 - (Otterham15_gr_high_ref + Otterham15_gr_lw_ref)
Otterham15_gr_mod_ref

#16 detectors
Otterham16_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Otterham16_grframe<-data.frame(Otterham16_gr, samp2)
Otterham16_grframelong <- melt(Otterham16_grframe,id.vars="samp2")
Otterham16_grframelong_sum <- ddply(Otterham16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham16_gr_max <- sum(Otterham16_grframelong_sum $max > max20_Otterhampipgr)
Otterham16_gr_max
Otterham16_gr_pres <- sum(Otterham16_grframelong_sum $max > 0)
Otterham16_gr_pres

#number of sites which would be classified as low
Otterham16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham16_grframelong_sum$max)
Otterham16_gr_lw_ref
#number of sites which would be classified as high
Otterham16_gr_high_ref <- sum( Otterham16_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham16_gr_high_ref
#number of sites which would be classified as moderate
Otterham16_gr_mod_ref <- 1000 - (Otterham16_gr_high_ref + Otterham16_gr_lw_ref)
Otterham16_gr_mod_ref

#17 detectors
Otterham17_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Otterham17_grframe<-data.frame(Otterham17_gr, samp2)
Otterham17_grframelong <- melt(Otterham17_grframe,id.vars="samp2")
Otterham17_grframelong_sum <- ddply(Otterham17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham17_gr_max <- sum(Otterham17_grframelong_sum $max > max20_Otterhampipgr)
Otterham17_gr_max
Otterham17_gr_pres <- sum(Otterham17_grframelong_sum $max > 0)
Otterham17_gr_pres

#number of sites which would be classified as low
Otterham17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham17_grframelong_sum$max)
Otterham17_gr_lw_ref
#number of sites which would be classified as high
Otterham17_gr_high_ref <- sum( Otterham17_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham17_gr_high_ref
#number of sites which would be classified as moderate
Otterham17_gr_mod_ref <- 1000 - (Otterham17_gr_high_ref + Otterham17_gr_lw_ref)
Otterham17_gr_mod_ref

#18 detectors
Otterham18_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Otterham18_grframe<-data.frame(Otterham18_gr, samp2)
Otterham18_grframelong <- melt(Otterham18_grframe,id.vars="samp2")
Otterham18_grframelong_sum <- ddply(Otterham18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham18_gr_max <- sum(Otterham18_grframelong_sum $max > max20_Otterhampipgr)
Otterham18_gr_max
Otterham18_gr_pres <- sum(Otterham18_grframelong_sum $max > 0)
Otterham18_gr_pres

#number of sites which would be classified as low
Otterham18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham18_grframelong_sum$max)
Otterham18_gr_lw_ref
#number of sites which would be classified as high
Otterham18_gr_high_ref <- sum( Otterham18_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham18_gr_high_ref
#number of sites which would be classified as moderate
Otterham18_gr_mod_ref <- 1000 - (Otterham18_gr_high_ref + Otterham18_gr_lw_ref)
Otterham18_gr_mod_ref

#19 detectors
Otterham19_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Otterham19_grframe<-data.frame(Otterham19_gr, samp2)
Otterham19_grframelong <- melt(Otterham19_grframe,id.vars="samp2")
Otterham19_grframelong_sum <- ddply(Otterham19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham19_gr_max <- sum(Otterham19_grframelong_sum $max > max20_Otterhampipgr)
Otterham19_gr_max
Otterham19_gr_pres <- sum(Otterham19_grframelong_sum $max > 0)
Otterham19_gr_pres

#number of sites which would be classified as low
Otterham19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham19_grframelong_sum$max)
Otterham19_gr_lw_ref
#number of sites which would be classified as high
Otterham19_gr_high_ref <- sum( Otterham19_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham19_gr_high_ref
#number of sites which would be classified as moderate
Otterham19_gr_mod_ref <- 1000 - (Otterham19_gr_high_ref + Otterham19_gr_lw_ref)
Otterham19_gr_mod_ref

#20 detectors
Otterham20_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Otterham20_grframe<-data.frame(Otterham20_gr, samp2)
Otterham20_grframelong <- melt(Otterham20_grframe,id.vars="samp2")
Otterham20_grframelong_sum <- ddply(Otterham20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham20_gr_max <- sum(Otterham20_grframelong_sum $max > max20_Otterhampipgr)
Otterham20_gr_max
Otterham20_gr_pres <- sum(Otterham20_grframelong_sum $max > 0)
Otterham20_gr_pres

#number of sites which would be classified as low
Otterham20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham20_grframelong_sum$max)
Otterham20_gr_lw_ref
#number of sites which would be classified as high
Otterham20_gr_high_ref <- sum( Otterham20_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham20_gr_high_ref
#number of sites which would be classified as moderate
Otterham20_gr_mod_ref <- 1000 - (Otterham20_gr_high_ref + Otterham20_gr_lw_ref)
Otterham20_gr_mod_ref

#21 detectors
Otterham21_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Otterham21_grframe<-data.frame(Otterham21_gr, samp2)
Otterham21_grframelong <- melt(Otterham21_grframe,id.vars="samp2")
Otterham21_grframelong_sum <- ddply(Otterham21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham21_gr_max <- sum(Otterham21_grframelong_sum $max > max20_Otterhampipgr)
Otterham21_gr_max
Otterham21_gr_pres <- sum(Otterham21_grframelong_sum $max > 0)
Otterham21_gr_pres

#number of sites which would be classified as low
Otterham21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham21_grframelong_sum$max)
Otterham21_gr_lw_ref
#number of sites which would be classified as high
Otterham21_gr_high_ref <- sum( Otterham21_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham21_gr_high_ref
#number of sites which would be classified as moderate
Otterham21_gr_mod_ref <- 1000 - (Otterham21_gr_high_ref + Otterham21_gr_lw_ref)
Otterham21_gr_mod_ref

#22 detectors
Otterham22_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Otterham22_grframe<-data.frame(Otterham22_gr, samp2)
Otterham22_grframelong <- melt(Otterham22_grframe,id.vars="samp2")
Otterham22_grframelong_sum <- ddply(Otterham22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham22_gr_max <- sum(Otterham22_grframelong_sum $max > max20_Otterhampipgr)
Otterham22_gr_max
Otterham22_gr_pres <- sum(Otterham22_grframelong_sum $max > 0)
Otterham22_gr_pres

#number of sites which would be classified as low
Otterham22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham22_grframelong_sum$max)
Otterham22_gr_lw_ref
#number of sites which would be classified as high
Otterham22_gr_high_ref <- sum( Otterham22_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham22_gr_high_ref
#number of sites which would be classified as moderate
Otterham22_gr_mod_ref <- 1000 - (Otterham22_gr_high_ref + Otterham22_gr_lw_ref)
Otterham22_gr_mod_ref

#23 detectors
Otterham23_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Otterham23_grframe<-data.frame(Otterham23_gr, samp2)
Otterham23_grframelong <- melt(Otterham23_grframe,id.vars="samp2")
Otterham23_grframelong_sum <- ddply(Otterham23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham23_gr_max <- sum(Otterham23_grframelong_sum $max > max20_Otterhampipgr)
Otterham23_gr_max
Otterham23_gr_pres <- sum(Otterham23_grframelong_sum $max > 0)
Otterham23_gr_pres

#number of sites which would be classified as low
Otterham23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham23_grframelong_sum$max)
Otterham23_gr_lw_ref
#number of sites which would be classified as high
Otterham23_gr_high_ref <- sum( Otterham23_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham23_gr_high_ref
#number of sites which would be classified as moderate
Otterham23_gr_mod_ref <- 1000 - (Otterham23_gr_high_ref + Otterham23_gr_lw_ref)
Otterham23_gr_mod_ref

#24 detectors
Otterham24_gr<-(replicate(1000, (sample(Otterhampipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Otterham24_grframe<-data.frame(Otterham24_gr, samp2)
Otterham24_grframelong <- melt(Otterham24_grframe,id.vars="samp2")
Otterham24_grframelong_sum <- ddply(Otterham24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Otterham24_gr_max <- sum(Otterham24_grframelong_sum $max > max20_Otterhampipgr)
Otterham24_gr_max
Otterham24_gr_pres <- sum(Otterham24_grframelong_sum $max > 0)
Otterham24_gr_pres

#number of sites which would be classified as low
Otterham24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Otterham24_grframelong_sum$max)
Otterham24_gr_lw_ref
#number of sites which would be classified as high
Otterham24_gr_high_ref <- sum( Otterham24_grframelong_sum$max > allsppgr_ppip_ref_high)
Otterham24_gr_high_ref
#number of sites which would be classified as moderate
Otterham24_gr_mod_ref <- 1000 - (Otterham24_gr_high_ref + Otterham24_gr_lw_ref)
Otterham24_gr_mod_ref

Present<-c(Otterham1_gr_pres,Otterham2_gr_pres,
           Otterham3_gr_pres,Otterham4_gr_pres,
           Otterham5_gr_pres,Otterham6_gr_pres,
           Otterham7_gr_pres,Otterham8_gr_pres,
           Otterham9_gr_pres,Otterham10_gr_pres,
           Otterham11_gr_pres,Otterham12_gr_pres,
           Otterham13_gr_pres,Otterham14_gr_pres,
           Otterham15_gr_pres,Otterham16_gr_pres,
           Otterham17_gr_pres,Otterham18_gr_pres,
           Otterham19_gr_pres,Otterham20_gr_pres,
           Otterham21_gr_pres,Otterham22_gr_pres,
           Otterham23_gr_pres,Otterham24_gr_pres)


Maximum<-c(Otterham1_gr_max,Otterham2_gr_max,
           Otterham3_gr_max,Otterham4_gr_max,
           Otterham5_gr_max,Otterham6_gr_max,
           Otterham7_gr_max,Otterham8_gr_max,
           Otterham9_gr_max,Otterham10_gr_max,
           Otterham11_gr_max,Otterham12_gr_max,
           Otterham13_gr_max,Otterham14_gr_max,
           Otterham15_gr_max,Otterham16_gr_max,
           Otterham17_gr_max,Otterham18_gr_max,
           Otterham19_gr_max,Otterham20_gr_max,
           Otterham21_gr_max,Otterham22_gr_max,
           Otterham23_gr_max,Otterham24_gr_max)

Low<-c(Otterham1_gr_lw_ref, Otterham2_gr_lw_ref, Otterham3_gr_lw_ref,
       Otterham4_gr_lw_ref, Otterham5_gr_lw_ref, Otterham6_gr_lw_ref,
       Otterham7_gr_lw_ref, Otterham8_gr_lw_ref, Otterham9_gr_lw_ref,
       Otterham10_gr_lw_ref, Otterham11_gr_lw_ref, Otterham12_gr_lw_ref, 
       Otterham13_gr_lw_ref, Otterham14_gr_lw_ref, Otterham15_gr_lw_ref, 
       Otterham16_gr_lw_ref, Otterham17_gr_lw_ref, Otterham18_gr_lw_ref, 
       Otterham19_gr_lw_ref, Otterham20_gr_lw_ref, Otterham21_gr_lw_ref,
       Otterham22_gr_lw_ref,Otterham23_gr_lw_ref,Otterham24_gr_lw_ref)

Moderate<-c(Otterham1_gr_mod_ref, Otterham2_gr_mod_ref, Otterham3_gr_mod_ref,
            Otterham4_gr_mod_ref, Otterham5_gr_mod_ref, Otterham6_gr_mod_ref,
            Otterham7_gr_mod_ref, Otterham8_gr_mod_ref, Otterham9_gr_mod_ref,
            Otterham10_gr_mod_ref, Otterham11_gr_mod_ref, Otterham12_gr_mod_ref, 
            Otterham13_gr_mod_ref, Otterham14_gr_mod_ref, Otterham15_gr_mod_ref, 
            Otterham16_gr_mod_ref, Otterham17_gr_mod_ref, Otterham18_gr_mod_ref, 
            Otterham19_gr_mod_ref, Otterham20_gr_mod_ref, Otterham21_gr_mod_ref,
            Otterham22_gr_mod_ref,Otterham23_gr_mod_ref,Otterham24_gr_mod_ref)

High<-c(Otterham1_gr_high_ref, Otterham2_gr_high_ref, Otterham3_gr_high_ref,
        Otterham4_gr_high_ref, Otterham5_gr_high_ref, Otterham6_gr_high_ref,
        Otterham7_gr_high_ref, Otterham8_gr_high_ref, Otterham9_gr_high_ref,
        Otterham10_gr_high_ref, Otterham11_gr_high_ref, Otterham12_gr_high_ref, 
        Otterham13_gr_high_ref, Otterham14_gr_high_ref, Otterham15_gr_high_ref, 
        Otterham16_gr_high_ref, Otterham17_gr_high_ref, Otterham18_gr_high_ref, 
        Otterham19_gr_high_ref, Otterham20_gr_high_ref, Otterham21_gr_high_ref,
        Otterham22_gr_high_ref,Otterham23_gr_high_ref,Otterham24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Otterhamgr",24)
Lowsite <- Otterhamlow
Modsite <- Otterhammod
Highsite <-Otterhamhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Otterhamgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##OutNewton

OutNewtonpipgr<-subset(allspp4gr_ppip, Site=="OutNewton")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_OutNewtonpipgr<-max(OutNewtonpipgr$Passes)

#calculate 20% from maximum nightly record

max20_OutNewtonpipgr<- (max_OutNewtonpipgr/100)*80

##calculate the site classification (reference range)

OutNewtonhigh<- max_OutNewtonpipgr > allsppgr_ppip_ref_high

OutNewtonlow<- allsppgr_ppip_ref_low > max_OutNewtonpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_OutNewtonpipgr
OutNewtonmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
OutNewton1_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 1, replace=F))))
OutNewton1_gr_max <- sum(OutNewton1_gr > max20_OutNewtonpipgr)
OutNewton1_gr_max
OutNewton1_gr_pres <- sum(OutNewton1_gr > 0)
OutNewton1_gr_pres
#number of sites which would be classified as low
OutNewton1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton1_gr)
OutNewton1_gr_lw_ref
#number of sites which would be classified as high
OutNewton1_gr_high_ref <- sum( OutNewton1_gr > allsppgr_ppip_ref_high)
OutNewton1_gr_high_ref
#number of sites which would be classified as moderate
OutNewton1_gr_mod_ref <- 1000 - (OutNewton1_gr_high_ref + OutNewton1_gr_lw_ref)
OutNewton1_gr_mod_ref


#2 nights
OutNewton2_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
OutNewton2_grframe<-data.frame(OutNewton2_gr, samp2)
OutNewton2_grframelong <- melt(OutNewton2_grframe,id.vars="samp2")
OutNewton2_grframelong_sum <- ddply(OutNewton2_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton2_gr_max <- sum(OutNewton2_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton2_gr_max
OutNewton2_gr_pres <- sum(OutNewton2_grframelong_sum $max > 0)
OutNewton2_gr_pres

#number of sites which would be classified as low
OutNewton2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton2_grframelong_sum$max)
OutNewton2_gr_lw_ref
#number of sites which would be classified as high
OutNewton2_gr_high_ref <- sum( OutNewton2_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton2_gr_high_ref
#number of sites which would be classified as moderate
OutNewton2_gr_mod_ref <- 1000 - (OutNewton2_gr_high_ref + OutNewton2_gr_lw_ref)
OutNewton2_gr_mod_ref


#3 nights
OutNewton3_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
OutNewton3_grframe<-data.frame(OutNewton3_gr, samp2)
OutNewton3_grframelong <- melt(OutNewton3_grframe,id.vars="samp2")
OutNewton3_grframelong_sum <- ddply(OutNewton3_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton3_gr_max <- sum(OutNewton3_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton3_gr_max
OutNewton3_gr_pres <- sum(OutNewton3_grframelong_sum $max > 0)
OutNewton3_gr_pres

#number of sites which would be classified as low
OutNewton3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton3_grframelong_sum$max)
OutNewton3_gr_lw_ref
#number of sites which would be classified as high
OutNewton3_gr_high_ref <- sum( OutNewton3_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton3_gr_high_ref
#number of sites which would be classified as moderate
OutNewton3_gr_mod_ref <- 1000 - (OutNewton3_gr_high_ref + OutNewton3_gr_lw_ref)
OutNewton3_gr_mod_ref

#4 nights
OutNewton4_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
OutNewton4_grframe<-data.frame(OutNewton4_gr, samp2)
OutNewton4_grframelong <- melt(OutNewton4_grframe,id.vars="samp2")
OutNewton4_grframelong_sum <- ddply(OutNewton4_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton4_gr_max <- sum(OutNewton4_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton4_gr_max
OutNewton4_gr_pres <- sum(OutNewton4_grframelong_sum $max > 0)
OutNewton4_gr_pres

#number of sites which would be classified as low
OutNewton4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton4_grframelong_sum$max)
OutNewton4_gr_lw_ref
#number of sites which would be classified as high
OutNewton4_gr_high_ref <- sum( OutNewton4_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton4_gr_high_ref
#number of sites which would be classified as moderate
OutNewton4_gr_mod_ref <- 1000 - (OutNewton4_gr_high_ref + OutNewton4_gr_lw_ref)
OutNewton4_gr_mod_ref

#5 nights
OutNewton5_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
OutNewton5_grframe<-data.frame(OutNewton5_gr, samp2)
OutNewton5_grframelong <- melt(OutNewton5_grframe,id.vars="samp2")
OutNewton5_grframelong_sum <- ddply(OutNewton5_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton5_gr_max <- sum(OutNewton5_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton5_gr_max
OutNewton5_gr_pres <- sum(OutNewton5_grframelong_sum $max > 0)
OutNewton5_gr_pres

#number of sites which would be classified as low
OutNewton5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton5_grframelong_sum$max)
OutNewton5_gr_lw_ref
#number of sites which would be classified as high
OutNewton5_gr_high_ref <- sum( OutNewton5_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton5_gr_high_ref
#number of sites which would be classified as moderate
OutNewton5_gr_mod_ref <- 1000 - (OutNewton5_gr_high_ref + OutNewton5_gr_lw_ref)
OutNewton5_gr_mod_ref

#6 nights
OutNewton6_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
OutNewton6_grframe<-data.frame(OutNewton6_gr, samp2)
OutNewton6_grframelong <- melt(OutNewton6_grframe,id.vars="samp2")
OutNewton6_grframelong_sum <- ddply(OutNewton6_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton6_gr_max <- sum(OutNewton6_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton6_gr_max
OutNewton6_gr_pres <- sum(OutNewton6_grframelong_sum $max > 0)
OutNewton6_gr_pres

#number of sites which would be classified as low
OutNewton6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton6_grframelong_sum$max)
OutNewton6_gr_lw_ref
#number of sites which would be classified as high
OutNewton6_gr_high_ref <- sum( OutNewton6_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton6_gr_high_ref
#number of sites which would be classified as moderate
OutNewton6_gr_mod_ref <- 1000 - (OutNewton6_gr_high_ref + OutNewton6_gr_lw_ref)
OutNewton6_gr_mod_ref

#7 nights
OutNewton7_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
OutNewton7_grframe<-data.frame(OutNewton7_gr, samp2)
OutNewton7_grframelong <- melt(OutNewton7_grframe,id.vars="samp2")
OutNewton7_grframelong_sum <- ddply(OutNewton7_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton7_gr_max <- sum(OutNewton7_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton7_gr_max
OutNewton7_gr_pres <- sum(OutNewton7_grframelong_sum $max > 0)
OutNewton7_gr_pres

#number of sites which would be classified as low
OutNewton7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton7_grframelong_sum$max)
OutNewton7_gr_lw_ref
#number of sites which would be classified as high
OutNewton7_gr_high_ref <- sum( OutNewton7_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton7_gr_high_ref
#number of sites which would be classified as moderate
OutNewton7_gr_mod_ref <- 1000 - (OutNewton7_gr_high_ref + OutNewton7_gr_lw_ref)
OutNewton7_gr_mod_ref

#8 nights
OutNewton8_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
OutNewton8_grframe<-data.frame(OutNewton8_gr, samp2)
OutNewton8_grframelong <- melt(OutNewton8_grframe,id.vars="samp2")
OutNewton8_grframelong_sum <- ddply(OutNewton8_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton8_gr_max <- sum(OutNewton8_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton8_gr_max
OutNewton8_gr_pres <- sum(OutNewton8_grframelong_sum $max > 0)
OutNewton8_gr_pres

#number of sites which would be classified as low
OutNewton8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton8_grframelong_sum$max)
OutNewton8_gr_lw_ref
#number of sites which would be classified as high
OutNewton8_gr_high_ref <- sum( OutNewton8_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton8_gr_high_ref
#number of sites which would be classified as moderate
OutNewton8_gr_mod_ref <- 1000 - (OutNewton8_gr_high_ref + OutNewton8_gr_lw_ref)
OutNewton8_gr_mod_ref

#9 nights
OutNewton9_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
OutNewton9_grframe<-data.frame(OutNewton9_gr, samp2)
OutNewton9_grframelong <- melt(OutNewton9_grframe,id.vars="samp2")
OutNewton9_grframelong_sum <- ddply(OutNewton9_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
OutNewton9_gr_max <- sum(OutNewton9_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton9_gr_max
OutNewton9_gr_pres <- sum(OutNewton9_grframelong_sum $max > 0)
OutNewton9_gr_pres

#number of sites which would be classified as low
OutNewton9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton9_grframelong_sum$max)
OutNewton9_gr_lw_ref
#number of sites which would be classified as high
OutNewton9_gr_high_ref <- sum( OutNewton9_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton9_gr_high_ref
#number of sites which would be classified as moderate
OutNewton9_gr_mod_ref <- 1000 - (OutNewton9_gr_high_ref + OutNewton9_gr_lw_ref)
OutNewton9_gr_mod_ref

#10 detectors
OutNewton10_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
OutNewton10_grframe<-data.frame(OutNewton10_gr, samp2)
OutNewton10_grframelong <- melt(OutNewton10_grframe,id.vars="samp2")
OutNewton10_grframelong_sum <- ddply(OutNewton10_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton10_gr_max <- sum(OutNewton10_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton10_gr_max
OutNewton10_gr_pres <- sum(OutNewton10_grframelong_sum $max > 0)
OutNewton10_gr_pres

#number of sites which would be classified as low
OutNewton10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton10_grframelong_sum$max)
OutNewton10_gr_lw_ref
#number of sites which would be classified as high
OutNewton10_gr_high_ref <- sum( OutNewton10_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton10_gr_high_ref
#number of sites which would be classified as moderate
OutNewton10_gr_mod_ref <- 1000 - (OutNewton10_gr_high_ref + OutNewton10_gr_lw_ref)
OutNewton10_gr_mod_ref

#11 detectors
OutNewton11_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
OutNewton11_grframe<-data.frame(OutNewton11_gr, samp2)
OutNewton11_grframelong <- melt(OutNewton11_grframe,id.vars="samp2")
OutNewton11_grframelong_sum <- ddply(OutNewton11_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton11_gr_max <- sum(OutNewton11_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton11_gr_max
OutNewton11_gr_pres <- sum(OutNewton11_grframelong_sum $max > 0)
OutNewton11_gr_pres

#number of sites which would be classified as low
OutNewton11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton11_grframelong_sum$max)
OutNewton11_gr_lw_ref
#number of sites which would be classified as high
OutNewton11_gr_high_ref <- sum( OutNewton11_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton11_gr_high_ref
#number of sites which would be classified as moderate
OutNewton11_gr_mod_ref <- 1000 - (OutNewton11_gr_high_ref + OutNewton11_gr_lw_ref)
OutNewton11_gr_mod_ref

#12 detectors
OutNewton12_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
OutNewton12_grframe<-data.frame(OutNewton12_gr, samp2)
OutNewton12_grframelong <- melt(OutNewton12_grframe,id.vars="samp2")
OutNewton12_grframelong_sum <- ddply(OutNewton12_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton12_gr_max <- sum(OutNewton12_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton12_gr_max
OutNewton12_gr_pres <- sum(OutNewton12_grframelong_sum $max > 0)
OutNewton12_gr_pres

#number of sites which would be classified as low
OutNewton12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton12_grframelong_sum$max)
OutNewton12_gr_lw_ref
#number of sites which would be classified as high
OutNewton12_gr_high_ref <- sum( OutNewton12_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton12_gr_high_ref
#number of sites which would be classified as moderate
OutNewton12_gr_mod_ref <- 1000 - (OutNewton12_gr_high_ref + OutNewton12_gr_lw_ref)
OutNewton12_gr_mod_ref

#13 detectors
OutNewton13_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
OutNewton13_grframe<-data.frame(OutNewton13_gr, samp2)
OutNewton13_grframelong <- melt(OutNewton13_grframe,id.vars="samp2")
OutNewton13_grframelong_sum <- ddply(OutNewton13_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton13_gr_max <- sum(OutNewton13_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton13_gr_max
OutNewton13_gr_pres <- sum(OutNewton13_grframelong_sum $max > 0)
OutNewton13_gr_pres

#number of sites which would be classified as low
OutNewton13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton13_grframelong_sum$max)
OutNewton13_gr_lw_ref
#number of sites which would be classified as high
OutNewton13_gr_high_ref <- sum( OutNewton13_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton13_gr_high_ref
#number of sites which would be classified as moderate
OutNewton13_gr_mod_ref <- 1000 - (OutNewton13_gr_high_ref + OutNewton13_gr_lw_ref)
OutNewton13_gr_mod_ref

#14 detectors
OutNewton14_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
OutNewton14_grframe<-data.frame(OutNewton14_gr, samp2)
OutNewton14_grframelong <- melt(OutNewton14_grframe,id.vars="samp2")
OutNewton14_grframelong_sum <- ddply(OutNewton14_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton14_gr_max <- sum(OutNewton14_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton14_gr_max
OutNewton14_gr_pres <- sum(OutNewton14_grframelong_sum $max > 0)
OutNewton14_gr_pres

#number of sites which would be classified as low
OutNewton14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton14_grframelong_sum$max)
OutNewton14_gr_lw_ref
#number of sites which would be classified as high
OutNewton14_gr_high_ref <- sum( OutNewton14_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton14_gr_high_ref
#number of sites which would be classified as moderate
OutNewton14_gr_mod_ref <- 1000 - (OutNewton14_gr_high_ref + OutNewton14_gr_lw_ref)
OutNewton14_gr_mod_ref

#15 detectors
OutNewton15_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
OutNewton15_grframe<-data.frame(OutNewton15_gr, samp2)
OutNewton15_grframelong <- melt(OutNewton15_grframe,id.vars="samp2")
OutNewton15_grframelong_sum <- ddply(OutNewton15_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton15_gr_max <- sum(OutNewton15_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton15_gr_max
OutNewton15_gr_pres <- sum(OutNewton15_grframelong_sum $max > 0)
OutNewton15_gr_pres

#number of sites which would be classified as low
OutNewton15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton15_grframelong_sum$max)
OutNewton15_gr_lw_ref
#number of sites which would be classified as high
OutNewton15_gr_high_ref <- sum( OutNewton15_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton15_gr_high_ref
#number of sites which would be classified as moderate
OutNewton15_gr_mod_ref <- 1000 - (OutNewton15_gr_high_ref + OutNewton15_gr_lw_ref)
OutNewton15_gr_mod_ref

#16 detectors
OutNewton16_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
OutNewton16_grframe<-data.frame(OutNewton16_gr, samp2)
OutNewton16_grframelong <- melt(OutNewton16_grframe,id.vars="samp2")
OutNewton16_grframelong_sum <- ddply(OutNewton16_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton16_gr_max <- sum(OutNewton16_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton16_gr_max
OutNewton16_gr_pres <- sum(OutNewton16_grframelong_sum $max > 0)
OutNewton16_gr_pres

#number of sites which would be classified as low
OutNewton16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton16_grframelong_sum$max)
OutNewton16_gr_lw_ref
#number of sites which would be classified as high
OutNewton16_gr_high_ref <- sum( OutNewton16_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton16_gr_high_ref
#number of sites which would be classified as moderate
OutNewton16_gr_mod_ref <- 1000 - (OutNewton16_gr_high_ref + OutNewton16_gr_lw_ref)
OutNewton16_gr_mod_ref

#17 detectors
OutNewton17_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
OutNewton17_grframe<-data.frame(OutNewton17_gr, samp2)
OutNewton17_grframelong <- melt(OutNewton17_grframe,id.vars="samp2")
OutNewton17_grframelong_sum <- ddply(OutNewton17_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton17_gr_max <- sum(OutNewton17_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton17_gr_max
OutNewton17_gr_pres <- sum(OutNewton17_grframelong_sum $max > 0)
OutNewton17_gr_pres

#number of sites which would be classified as low
OutNewton17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton17_grframelong_sum$max)
OutNewton17_gr_lw_ref
#number of sites which would be classified as high
OutNewton17_gr_high_ref <- sum( OutNewton17_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton17_gr_high_ref
#number of sites which would be classified as moderate
OutNewton17_gr_mod_ref <- 1000 - (OutNewton17_gr_high_ref + OutNewton17_gr_lw_ref)
OutNewton17_gr_mod_ref

#18 detectors
OutNewton18_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
OutNewton18_grframe<-data.frame(OutNewton18_gr, samp2)
OutNewton18_grframelong <- melt(OutNewton18_grframe,id.vars="samp2")
OutNewton18_grframelong_sum <- ddply(OutNewton18_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton18_gr_max <- sum(OutNewton18_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton18_gr_max
OutNewton18_gr_pres <- sum(OutNewton18_grframelong_sum $max > 0)
OutNewton18_gr_pres

#number of sites which would be classified as low
OutNewton18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton18_grframelong_sum$max)
OutNewton18_gr_lw_ref
#number of sites which would be classified as high
OutNewton18_gr_high_ref <- sum( OutNewton18_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton18_gr_high_ref
#number of sites which would be classified as moderate
OutNewton18_gr_mod_ref <- 1000 - (OutNewton18_gr_high_ref + OutNewton18_gr_lw_ref)
OutNewton18_gr_mod_ref

#19 detectors
OutNewton19_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
OutNewton19_grframe<-data.frame(OutNewton19_gr, samp2)
OutNewton19_grframelong <- melt(OutNewton19_grframe,id.vars="samp2")
OutNewton19_grframelong_sum <- ddply(OutNewton19_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton19_gr_max <- sum(OutNewton19_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton19_gr_max
OutNewton19_gr_pres <- sum(OutNewton19_grframelong_sum $max > 0)
OutNewton19_gr_pres

#number of sites which would be classified as low
OutNewton19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton19_grframelong_sum$max)
OutNewton19_gr_lw_ref
#number of sites which would be classified as high
OutNewton19_gr_high_ref <- sum( OutNewton19_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton19_gr_high_ref
#number of sites which would be classified as moderate
OutNewton19_gr_mod_ref <- 1000 - (OutNewton19_gr_high_ref + OutNewton19_gr_lw_ref)
OutNewton19_gr_mod_ref

#20 detectors
OutNewton20_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
OutNewton20_grframe<-data.frame(OutNewton20_gr, samp2)
OutNewton20_grframelong <- melt(OutNewton20_grframe,id.vars="samp2")
OutNewton20_grframelong_sum <- ddply(OutNewton20_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton20_gr_max <- sum(OutNewton20_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton20_gr_max
OutNewton20_gr_pres <- sum(OutNewton20_grframelong_sum $max > 0)
OutNewton20_gr_pres

#number of sites which would be classified as low
OutNewton20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton20_grframelong_sum$max)
OutNewton20_gr_lw_ref
#number of sites which would be classified as high
OutNewton20_gr_high_ref <- sum( OutNewton20_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton20_gr_high_ref
#number of sites which would be classified as moderate
OutNewton20_gr_mod_ref <- 1000 - (OutNewton20_gr_high_ref + OutNewton20_gr_lw_ref)
OutNewton20_gr_mod_ref

#21 detectors
OutNewton21_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
OutNewton21_grframe<-data.frame(OutNewton21_gr, samp2)
OutNewton21_grframelong <- melt(OutNewton21_grframe,id.vars="samp2")
OutNewton21_grframelong_sum <- ddply(OutNewton21_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton21_gr_max <- sum(OutNewton21_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton21_gr_max
OutNewton21_gr_pres <- sum(OutNewton21_grframelong_sum $max > 0)
OutNewton21_gr_pres

#number of sites which would be classified as low
OutNewton21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton21_grframelong_sum$max)
OutNewton21_gr_lw_ref
#number of sites which would be classified as high
OutNewton21_gr_high_ref <- sum( OutNewton21_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton21_gr_high_ref
#number of sites which would be classified as moderate
OutNewton21_gr_mod_ref <- 1000 - (OutNewton21_gr_high_ref + OutNewton21_gr_lw_ref)
OutNewton21_gr_mod_ref

#22 detectors
OutNewton22_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
OutNewton22_grframe<-data.frame(OutNewton22_gr, samp2)
OutNewton22_grframelong <- melt(OutNewton22_grframe,id.vars="samp2")
OutNewton22_grframelong_sum <- ddply(OutNewton22_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton22_gr_max <- sum(OutNewton22_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton22_gr_max
OutNewton22_gr_pres <- sum(OutNewton22_grframelong_sum $max > 0)
OutNewton22_gr_pres

#number of sites which would be classified as low
OutNewton22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton22_grframelong_sum$max)
OutNewton22_gr_lw_ref
#number of sites which would be classified as high
OutNewton22_gr_high_ref <- sum( OutNewton22_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton22_gr_high_ref
#number of sites which would be classified as moderate
OutNewton22_gr_mod_ref <- 1000 - (OutNewton22_gr_high_ref + OutNewton22_gr_lw_ref)
OutNewton22_gr_mod_ref

#23 detectors
OutNewton23_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
OutNewton23_grframe<-data.frame(OutNewton23_gr, samp2)
OutNewton23_grframelong <- melt(OutNewton23_grframe,id.vars="samp2")
OutNewton23_grframelong_sum <- ddply(OutNewton23_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton23_gr_max <- sum(OutNewton23_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton23_gr_max
OutNewton23_gr_pres <- sum(OutNewton23_grframelong_sum $max > 0)
OutNewton23_gr_pres

#number of sites which would be classified as low
OutNewton23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton23_grframelong_sum$max)
OutNewton23_gr_lw_ref
#number of sites which would be classified as high
OutNewton23_gr_high_ref <- sum( OutNewton23_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton23_gr_high_ref
#number of sites which would be classified as moderate
OutNewton23_gr_mod_ref <- 1000 - (OutNewton23_gr_high_ref + OutNewton23_gr_lw_ref)
OutNewton23_gr_mod_ref

#24 detectors
OutNewton24_gr<-(replicate(1000, (sample(OutNewtonpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
OutNewton24_grframe<-data.frame(OutNewton24_gr, samp2)
OutNewton24_grframelong <- melt(OutNewton24_grframe,id.vars="samp2")
OutNewton24_grframelong_sum <- ddply(OutNewton24_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
OutNewton24_gr_max <- sum(OutNewton24_grframelong_sum $max > max20_OutNewtonpipgr)
OutNewton24_gr_max
OutNewton24_gr_pres <- sum(OutNewton24_grframelong_sum $max > 0)
OutNewton24_gr_pres

#number of sites which would be classified as low
OutNewton24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= OutNewton24_grframelong_sum$max)
OutNewton24_gr_lw_ref
#number of sites which would be classified as high
OutNewton24_gr_high_ref <- sum( OutNewton24_grframelong_sum$max > allsppgr_ppip_ref_high)
OutNewton24_gr_high_ref
#number of sites which would be classified as moderate
OutNewton24_gr_mod_ref <- 1000 - (OutNewton24_gr_high_ref + OutNewton24_gr_lw_ref)
OutNewton24_gr_mod_ref

Present<-c(OutNewton1_gr_pres,OutNewton2_gr_pres,
           OutNewton3_gr_pres,OutNewton4_gr_pres,
           OutNewton5_gr_pres,OutNewton6_gr_pres,
           OutNewton7_gr_pres,OutNewton8_gr_pres,
           OutNewton9_gr_pres,OutNewton10_gr_pres,
           OutNewton11_gr_pres,OutNewton12_gr_pres,
           OutNewton13_gr_pres,OutNewton14_gr_pres,
           OutNewton15_gr_pres,OutNewton16_gr_pres,
           OutNewton17_gr_pres,OutNewton18_gr_pres,
           OutNewton19_gr_pres,OutNewton20_gr_pres,
           OutNewton21_gr_pres,OutNewton22_gr_pres,
           OutNewton23_gr_pres,OutNewton24_gr_pres)


Maximum<-c(OutNewton1_gr_max,OutNewton2_gr_max,
           OutNewton3_gr_max,OutNewton4_gr_max,
           OutNewton5_gr_max,OutNewton6_gr_max,
           OutNewton7_gr_max,OutNewton8_gr_max,
           OutNewton9_gr_max,OutNewton10_gr_max,
           OutNewton11_gr_max,OutNewton12_gr_max,
           OutNewton13_gr_max,OutNewton14_gr_max,
           OutNewton15_gr_max,OutNewton16_gr_max,
           OutNewton17_gr_max,OutNewton18_gr_max,
           OutNewton19_gr_max,OutNewton20_gr_max,
           OutNewton21_gr_max,OutNewton22_gr_max,
           OutNewton23_gr_max,OutNewton24_gr_max)

Low<-c(OutNewton1_gr_lw_ref, OutNewton2_gr_lw_ref, OutNewton3_gr_lw_ref,
       OutNewton4_gr_lw_ref, OutNewton5_gr_lw_ref, OutNewton6_gr_lw_ref,
       OutNewton7_gr_lw_ref, OutNewton8_gr_lw_ref, OutNewton9_gr_lw_ref,
       OutNewton10_gr_lw_ref, OutNewton11_gr_lw_ref, OutNewton12_gr_lw_ref, 
       OutNewton13_gr_lw_ref, OutNewton14_gr_lw_ref, OutNewton15_gr_lw_ref, 
       OutNewton16_gr_lw_ref, OutNewton17_gr_lw_ref, OutNewton18_gr_lw_ref, 
       OutNewton19_gr_lw_ref, OutNewton20_gr_lw_ref, OutNewton21_gr_lw_ref,
       OutNewton22_gr_lw_ref,OutNewton23_gr_lw_ref,OutNewton24_gr_lw_ref)

Moderate<-c(OutNewton1_gr_mod_ref, OutNewton2_gr_mod_ref, OutNewton3_gr_mod_ref,
            OutNewton4_gr_mod_ref, OutNewton5_gr_mod_ref, OutNewton6_gr_mod_ref,
            OutNewton7_gr_mod_ref, OutNewton8_gr_mod_ref, OutNewton9_gr_mod_ref,
            OutNewton10_gr_mod_ref, OutNewton11_gr_mod_ref, OutNewton12_gr_mod_ref, 
            OutNewton13_gr_mod_ref, OutNewton14_gr_mod_ref, OutNewton15_gr_mod_ref, 
            OutNewton16_gr_mod_ref, OutNewton17_gr_mod_ref, OutNewton18_gr_mod_ref, 
            OutNewton19_gr_mod_ref, OutNewton20_gr_mod_ref, OutNewton21_gr_mod_ref,
            OutNewton22_gr_mod_ref,OutNewton23_gr_mod_ref,OutNewton24_gr_mod_ref)

High<-c(OutNewton1_gr_high_ref, OutNewton2_gr_high_ref, OutNewton3_gr_high_ref,
        OutNewton4_gr_high_ref, OutNewton5_gr_high_ref, OutNewton6_gr_high_ref,
        OutNewton7_gr_high_ref, OutNewton8_gr_high_ref, OutNewton9_gr_high_ref,
        OutNewton10_gr_high_ref, OutNewton11_gr_high_ref, OutNewton12_gr_high_ref, 
        OutNewton13_gr_high_ref, OutNewton14_gr_high_ref, OutNewton15_gr_high_ref, 
        OutNewton16_gr_high_ref, OutNewton17_gr_high_ref, OutNewton18_gr_high_ref, 
        OutNewton19_gr_high_ref, OutNewton20_gr_high_ref, OutNewton21_gr_high_ref,
        OutNewton22_gr_high_ref,OutNewton23_gr_high_ref,OutNewton24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("OutNewtongr",24)
Lowsite <- OutNewtonlow
Modsite <- OutNewtonmod
Highsite <-OutNewtonhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



OutNewtongr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                Site, Low, Moderate, High,
                                Lowsite, Modsite, Highsite)

##PantYWal

PantYWalpipgr<-subset(allspp4gr_ppip, Site=="PantYWal")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_PantYWalpipgr<-max(PantYWalpipgr$Passes)

#calculate 20% from maximum nightly record

max20_PantYWalpipgr<- (max_PantYWalpipgr/100)*80

##calculate the site classification (reference range)

PantYWalhigh<- max_PantYWalpipgr > allsppgr_ppip_ref_high

PantYWallow<- allsppgr_ppip_ref_low > max_PantYWalpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_PantYWalpipgr
PantYWalmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
PantYWal1_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 1, replace=F))))
PantYWal1_gr_max <- sum(PantYWal1_gr > max20_PantYWalpipgr)
PantYWal1_gr_max
PantYWal1_gr_pres <- sum(PantYWal1_gr > 0)
PantYWal1_gr_pres
#number of sites which would be classified as low
PantYWal1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal1_gr)
PantYWal1_gr_lw_ref
#number of sites which would be classified as high
PantYWal1_gr_high_ref <- sum( PantYWal1_gr > allsppgr_ppip_ref_high)
PantYWal1_gr_high_ref
#number of sites which would be classified as moderate
PantYWal1_gr_mod_ref <- 1000 - (PantYWal1_gr_high_ref + PantYWal1_gr_lw_ref)
PantYWal1_gr_mod_ref


#2 nights
PantYWal2_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
PantYWal2_grframe<-data.frame(PantYWal2_gr, samp2)
PantYWal2_grframelong <- melt(PantYWal2_grframe,id.vars="samp2")
PantYWal2_grframelong_sum <- ddply(PantYWal2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal2_gr_max <- sum(PantYWal2_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal2_gr_max
PantYWal2_gr_pres <- sum(PantYWal2_grframelong_sum $max > 0)
PantYWal2_gr_pres

#number of sites which would be classified as low
PantYWal2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal2_grframelong_sum$max)
PantYWal2_gr_lw_ref
#number of sites which would be classified as high
PantYWal2_gr_high_ref <- sum( PantYWal2_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal2_gr_high_ref
#number of sites which would be classified as moderate
PantYWal2_gr_mod_ref <- 1000 - (PantYWal2_gr_high_ref + PantYWal2_gr_lw_ref)
PantYWal2_gr_mod_ref


#3 nights
PantYWal3_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
PantYWal3_grframe<-data.frame(PantYWal3_gr, samp2)
PantYWal3_grframelong <- melt(PantYWal3_grframe,id.vars="samp2")
PantYWal3_grframelong_sum <- ddply(PantYWal3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal3_gr_max <- sum(PantYWal3_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal3_gr_max
PantYWal3_gr_pres <- sum(PantYWal3_grframelong_sum $max > 0)
PantYWal3_gr_pres

#number of sites which would be classified as low
PantYWal3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal3_grframelong_sum$max)
PantYWal3_gr_lw_ref
#number of sites which would be classified as high
PantYWal3_gr_high_ref <- sum( PantYWal3_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal3_gr_high_ref
#number of sites which would be classified as moderate
PantYWal3_gr_mod_ref <- 1000 - (PantYWal3_gr_high_ref + PantYWal3_gr_lw_ref)
PantYWal3_gr_mod_ref

#4 nights
PantYWal4_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
PantYWal4_grframe<-data.frame(PantYWal4_gr, samp2)
PantYWal4_grframelong <- melt(PantYWal4_grframe,id.vars="samp2")
PantYWal4_grframelong_sum <- ddply(PantYWal4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal4_gr_max <- sum(PantYWal4_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal4_gr_max
PantYWal4_gr_pres <- sum(PantYWal4_grframelong_sum $max > 0)
PantYWal4_gr_pres

#number of sites which would be classified as low
PantYWal4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal4_grframelong_sum$max)
PantYWal4_gr_lw_ref
#number of sites which would be classified as high
PantYWal4_gr_high_ref <- sum( PantYWal4_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal4_gr_high_ref
#number of sites which would be classified as moderate
PantYWal4_gr_mod_ref <- 1000 - (PantYWal4_gr_high_ref + PantYWal4_gr_lw_ref)
PantYWal4_gr_mod_ref

#5 nights
PantYWal5_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
PantYWal5_grframe<-data.frame(PantYWal5_gr, samp2)
PantYWal5_grframelong <- melt(PantYWal5_grframe,id.vars="samp2")
PantYWal5_grframelong_sum <- ddply(PantYWal5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal5_gr_max <- sum(PantYWal5_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal5_gr_max
PantYWal5_gr_pres <- sum(PantYWal5_grframelong_sum $max > 0)
PantYWal5_gr_pres

#number of sites which would be classified as low
PantYWal5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal5_grframelong_sum$max)
PantYWal5_gr_lw_ref
#number of sites which would be classified as high
PantYWal5_gr_high_ref <- sum( PantYWal5_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal5_gr_high_ref
#number of sites which would be classified as moderate
PantYWal5_gr_mod_ref <- 1000 - (PantYWal5_gr_high_ref + PantYWal5_gr_lw_ref)
PantYWal5_gr_mod_ref

#6 nights
PantYWal6_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
PantYWal6_grframe<-data.frame(PantYWal6_gr, samp2)
PantYWal6_grframelong <- melt(PantYWal6_grframe,id.vars="samp2")
PantYWal6_grframelong_sum <- ddply(PantYWal6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal6_gr_max <- sum(PantYWal6_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal6_gr_max
PantYWal6_gr_pres <- sum(PantYWal6_grframelong_sum $max > 0)
PantYWal6_gr_pres

#number of sites which would be classified as low
PantYWal6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal6_grframelong_sum$max)
PantYWal6_gr_lw_ref
#number of sites which would be classified as high
PantYWal6_gr_high_ref <- sum( PantYWal6_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal6_gr_high_ref
#number of sites which would be classified as moderate
PantYWal6_gr_mod_ref <- 1000 - (PantYWal6_gr_high_ref + PantYWal6_gr_lw_ref)
PantYWal6_gr_mod_ref

#7 nights
PantYWal7_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
PantYWal7_grframe<-data.frame(PantYWal7_gr, samp2)
PantYWal7_grframelong <- melt(PantYWal7_grframe,id.vars="samp2")
PantYWal7_grframelong_sum <- ddply(PantYWal7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal7_gr_max <- sum(PantYWal7_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal7_gr_max
PantYWal7_gr_pres <- sum(PantYWal7_grframelong_sum $max > 0)
PantYWal7_gr_pres

#number of sites which would be classified as low
PantYWal7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal7_grframelong_sum$max)
PantYWal7_gr_lw_ref
#number of sites which would be classified as high
PantYWal7_gr_high_ref <- sum( PantYWal7_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal7_gr_high_ref
#number of sites which would be classified as moderate
PantYWal7_gr_mod_ref <- 1000 - (PantYWal7_gr_high_ref + PantYWal7_gr_lw_ref)
PantYWal7_gr_mod_ref

#8 nights
PantYWal8_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
PantYWal8_grframe<-data.frame(PantYWal8_gr, samp2)
PantYWal8_grframelong <- melt(PantYWal8_grframe,id.vars="samp2")
PantYWal8_grframelong_sum <- ddply(PantYWal8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal8_gr_max <- sum(PantYWal8_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal8_gr_max
PantYWal8_gr_pres <- sum(PantYWal8_grframelong_sum $max > 0)
PantYWal8_gr_pres

#number of sites which would be classified as low
PantYWal8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal8_grframelong_sum$max)
PantYWal8_gr_lw_ref
#number of sites which would be classified as high
PantYWal8_gr_high_ref <- sum( PantYWal8_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal8_gr_high_ref
#number of sites which would be classified as moderate
PantYWal8_gr_mod_ref <- 1000 - (PantYWal8_gr_high_ref + PantYWal8_gr_lw_ref)
PantYWal8_gr_mod_ref

#9 nights
PantYWal9_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
PantYWal9_grframe<-data.frame(PantYWal9_gr, samp2)
PantYWal9_grframelong <- melt(PantYWal9_grframe,id.vars="samp2")
PantYWal9_grframelong_sum <- ddply(PantYWal9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
PantYWal9_gr_max <- sum(PantYWal9_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal9_gr_max
PantYWal9_gr_pres <- sum(PantYWal9_grframelong_sum $max > 0)
PantYWal9_gr_pres

#number of sites which would be classified as low
PantYWal9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal9_grframelong_sum$max)
PantYWal9_gr_lw_ref
#number of sites which would be classified as high
PantYWal9_gr_high_ref <- sum( PantYWal9_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal9_gr_high_ref
#number of sites which would be classified as moderate
PantYWal9_gr_mod_ref <- 1000 - (PantYWal9_gr_high_ref + PantYWal9_gr_lw_ref)
PantYWal9_gr_mod_ref

#10 detectors
PantYWal10_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
PantYWal10_grframe<-data.frame(PantYWal10_gr, samp2)
PantYWal10_grframelong <- melt(PantYWal10_grframe,id.vars="samp2")
PantYWal10_grframelong_sum <- ddply(PantYWal10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal10_gr_max <- sum(PantYWal10_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal10_gr_max
PantYWal10_gr_pres <- sum(PantYWal10_grframelong_sum $max > 0)
PantYWal10_gr_pres

#number of sites which would be classified as low
PantYWal10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal10_grframelong_sum$max)
PantYWal10_gr_lw_ref
#number of sites which would be classified as high
PantYWal10_gr_high_ref <- sum( PantYWal10_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal10_gr_high_ref
#number of sites which would be classified as moderate
PantYWal10_gr_mod_ref <- 1000 - (PantYWal10_gr_high_ref + PantYWal10_gr_lw_ref)
PantYWal10_gr_mod_ref

#11 detectors
PantYWal11_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
PantYWal11_grframe<-data.frame(PantYWal11_gr, samp2)
PantYWal11_grframelong <- melt(PantYWal11_grframe,id.vars="samp2")
PantYWal11_grframelong_sum <- ddply(PantYWal11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal11_gr_max <- sum(PantYWal11_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal11_gr_max
PantYWal11_gr_pres <- sum(PantYWal11_grframelong_sum $max > 0)
PantYWal11_gr_pres

#number of sites which would be classified as low
PantYWal11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal11_grframelong_sum$max)
PantYWal11_gr_lw_ref
#number of sites which would be classified as high
PantYWal11_gr_high_ref <- sum( PantYWal11_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal11_gr_high_ref
#number of sites which would be classified as moderate
PantYWal11_gr_mod_ref <- 1000 - (PantYWal11_gr_high_ref + PantYWal11_gr_lw_ref)
PantYWal11_gr_mod_ref

#12 detectors
PantYWal12_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
PantYWal12_grframe<-data.frame(PantYWal12_gr, samp2)
PantYWal12_grframelong <- melt(PantYWal12_grframe,id.vars="samp2")
PantYWal12_grframelong_sum <- ddply(PantYWal12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal12_gr_max <- sum(PantYWal12_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal12_gr_max
PantYWal12_gr_pres <- sum(PantYWal12_grframelong_sum $max > 0)
PantYWal12_gr_pres

#number of sites which would be classified as low
PantYWal12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal12_grframelong_sum$max)
PantYWal12_gr_lw_ref
#number of sites which would be classified as high
PantYWal12_gr_high_ref <- sum( PantYWal12_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal12_gr_high_ref
#number of sites which would be classified as moderate
PantYWal12_gr_mod_ref <- 1000 - (PantYWal12_gr_high_ref + PantYWal12_gr_lw_ref)
PantYWal12_gr_mod_ref

#13 detectors
PantYWal13_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
PantYWal13_grframe<-data.frame(PantYWal13_gr, samp2)
PantYWal13_grframelong <- melt(PantYWal13_grframe,id.vars="samp2")
PantYWal13_grframelong_sum <- ddply(PantYWal13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal13_gr_max <- sum(PantYWal13_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal13_gr_max
PantYWal13_gr_pres <- sum(PantYWal13_grframelong_sum $max > 0)
PantYWal13_gr_pres

#number of sites which would be classified as low
PantYWal13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal13_grframelong_sum$max)
PantYWal13_gr_lw_ref
#number of sites which would be classified as high
PantYWal13_gr_high_ref <- sum( PantYWal13_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal13_gr_high_ref
#number of sites which would be classified as moderate
PantYWal13_gr_mod_ref <- 1000 - (PantYWal13_gr_high_ref + PantYWal13_gr_lw_ref)
PantYWal13_gr_mod_ref

#14 detectors
PantYWal14_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
PantYWal14_grframe<-data.frame(PantYWal14_gr, samp2)
PantYWal14_grframelong <- melt(PantYWal14_grframe,id.vars="samp2")
PantYWal14_grframelong_sum <- ddply(PantYWal14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal14_gr_max <- sum(PantYWal14_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal14_gr_max
PantYWal14_gr_pres <- sum(PantYWal14_grframelong_sum $max > 0)
PantYWal14_gr_pres

#number of sites which would be classified as low
PantYWal14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal14_grframelong_sum$max)
PantYWal14_gr_lw_ref
#number of sites which would be classified as high
PantYWal14_gr_high_ref <- sum( PantYWal14_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal14_gr_high_ref
#number of sites which would be classified as moderate
PantYWal14_gr_mod_ref <- 1000 - (PantYWal14_gr_high_ref + PantYWal14_gr_lw_ref)
PantYWal14_gr_mod_ref

#15 detectors
PantYWal15_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
PantYWal15_grframe<-data.frame(PantYWal15_gr, samp2)
PantYWal15_grframelong <- melt(PantYWal15_grframe,id.vars="samp2")
PantYWal15_grframelong_sum <- ddply(PantYWal15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal15_gr_max <- sum(PantYWal15_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal15_gr_max
PantYWal15_gr_pres <- sum(PantYWal15_grframelong_sum $max > 0)
PantYWal15_gr_pres

#number of sites which would be classified as low
PantYWal15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal15_grframelong_sum$max)
PantYWal15_gr_lw_ref
#number of sites which would be classified as high
PantYWal15_gr_high_ref <- sum( PantYWal15_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal15_gr_high_ref
#number of sites which would be classified as moderate
PantYWal15_gr_mod_ref <- 1000 - (PantYWal15_gr_high_ref + PantYWal15_gr_lw_ref)
PantYWal15_gr_mod_ref

#16 detectors
PantYWal16_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
PantYWal16_grframe<-data.frame(PantYWal16_gr, samp2)
PantYWal16_grframelong <- melt(PantYWal16_grframe,id.vars="samp2")
PantYWal16_grframelong_sum <- ddply(PantYWal16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal16_gr_max <- sum(PantYWal16_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal16_gr_max
PantYWal16_gr_pres <- sum(PantYWal16_grframelong_sum $max > 0)
PantYWal16_gr_pres

#number of sites which would be classified as low
PantYWal16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal16_grframelong_sum$max)
PantYWal16_gr_lw_ref
#number of sites which would be classified as high
PantYWal16_gr_high_ref <- sum( PantYWal16_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal16_gr_high_ref
#number of sites which would be classified as moderate
PantYWal16_gr_mod_ref <- 1000 - (PantYWal16_gr_high_ref + PantYWal16_gr_lw_ref)
PantYWal16_gr_mod_ref

#17 detectors
PantYWal17_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
PantYWal17_grframe<-data.frame(PantYWal17_gr, samp2)
PantYWal17_grframelong <- melt(PantYWal17_grframe,id.vars="samp2")
PantYWal17_grframelong_sum <- ddply(PantYWal17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal17_gr_max <- sum(PantYWal17_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal17_gr_max
PantYWal17_gr_pres <- sum(PantYWal17_grframelong_sum $max > 0)
PantYWal17_gr_pres

#number of sites which would be classified as low
PantYWal17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal17_grframelong_sum$max)
PantYWal17_gr_lw_ref
#number of sites which would be classified as high
PantYWal17_gr_high_ref <- sum( PantYWal17_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal17_gr_high_ref
#number of sites which would be classified as moderate
PantYWal17_gr_mod_ref <- 1000 - (PantYWal17_gr_high_ref + PantYWal17_gr_lw_ref)
PantYWal17_gr_mod_ref

#18 detectors
PantYWal18_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
PantYWal18_grframe<-data.frame(PantYWal18_gr, samp2)
PantYWal18_grframelong <- melt(PantYWal18_grframe,id.vars="samp2")
PantYWal18_grframelong_sum <- ddply(PantYWal18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal18_gr_max <- sum(PantYWal18_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal18_gr_max
PantYWal18_gr_pres <- sum(PantYWal18_grframelong_sum $max > 0)
PantYWal18_gr_pres

#number of sites which would be classified as low
PantYWal18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal18_grframelong_sum$max)
PantYWal18_gr_lw_ref
#number of sites which would be classified as high
PantYWal18_gr_high_ref <- sum( PantYWal18_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal18_gr_high_ref
#number of sites which would be classified as moderate
PantYWal18_gr_mod_ref <- 1000 - (PantYWal18_gr_high_ref + PantYWal18_gr_lw_ref)
PantYWal18_gr_mod_ref

#19 detectors
PantYWal19_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
PantYWal19_grframe<-data.frame(PantYWal19_gr, samp2)
PantYWal19_grframelong <- melt(PantYWal19_grframe,id.vars="samp2")
PantYWal19_grframelong_sum <- ddply(PantYWal19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal19_gr_max <- sum(PantYWal19_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal19_gr_max
PantYWal19_gr_pres <- sum(PantYWal19_grframelong_sum $max > 0)
PantYWal19_gr_pres

#number of sites which would be classified as low
PantYWal19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal19_grframelong_sum$max)
PantYWal19_gr_lw_ref
#number of sites which would be classified as high
PantYWal19_gr_high_ref <- sum( PantYWal19_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal19_gr_high_ref
#number of sites which would be classified as moderate
PantYWal19_gr_mod_ref <- 1000 - (PantYWal19_gr_high_ref + PantYWal19_gr_lw_ref)
PantYWal19_gr_mod_ref

#20 detectors
PantYWal20_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
PantYWal20_grframe<-data.frame(PantYWal20_gr, samp2)
PantYWal20_grframelong <- melt(PantYWal20_grframe,id.vars="samp2")
PantYWal20_grframelong_sum <- ddply(PantYWal20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal20_gr_max <- sum(PantYWal20_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal20_gr_max
PantYWal20_gr_pres <- sum(PantYWal20_grframelong_sum $max > 0)
PantYWal20_gr_pres

#number of sites which would be classified as low
PantYWal20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal20_grframelong_sum$max)
PantYWal20_gr_lw_ref
#number of sites which would be classified as high
PantYWal20_gr_high_ref <- sum( PantYWal20_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal20_gr_high_ref
#number of sites which would be classified as moderate
PantYWal20_gr_mod_ref <- 1000 - (PantYWal20_gr_high_ref + PantYWal20_gr_lw_ref)
PantYWal20_gr_mod_ref

#21 detectors
PantYWal21_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
PantYWal21_grframe<-data.frame(PantYWal21_gr, samp2)
PantYWal21_grframelong <- melt(PantYWal21_grframe,id.vars="samp2")
PantYWal21_grframelong_sum <- ddply(PantYWal21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal21_gr_max <- sum(PantYWal21_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal21_gr_max
PantYWal21_gr_pres <- sum(PantYWal21_grframelong_sum $max > 0)
PantYWal21_gr_pres

#number of sites which would be classified as low
PantYWal21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal21_grframelong_sum$max)
PantYWal21_gr_lw_ref
#number of sites which would be classified as high
PantYWal21_gr_high_ref <- sum( PantYWal21_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal21_gr_high_ref
#number of sites which would be classified as moderate
PantYWal21_gr_mod_ref <- 1000 - (PantYWal21_gr_high_ref + PantYWal21_gr_lw_ref)
PantYWal21_gr_mod_ref

#22 detectors
PantYWal22_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
PantYWal22_grframe<-data.frame(PantYWal22_gr, samp2)
PantYWal22_grframelong <- melt(PantYWal22_grframe,id.vars="samp2")
PantYWal22_grframelong_sum <- ddply(PantYWal22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal22_gr_max <- sum(PantYWal22_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal22_gr_max
PantYWal22_gr_pres <- sum(PantYWal22_grframelong_sum $max > 0)
PantYWal22_gr_pres

#number of sites which would be classified as low
PantYWal22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal22_grframelong_sum$max)
PantYWal22_gr_lw_ref
#number of sites which would be classified as high
PantYWal22_gr_high_ref <- sum( PantYWal22_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal22_gr_high_ref
#number of sites which would be classified as moderate
PantYWal22_gr_mod_ref <- 1000 - (PantYWal22_gr_high_ref + PantYWal22_gr_lw_ref)
PantYWal22_gr_mod_ref

#23 detectors
PantYWal23_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
PantYWal23_grframe<-data.frame(PantYWal23_gr, samp2)
PantYWal23_grframelong <- melt(PantYWal23_grframe,id.vars="samp2")
PantYWal23_grframelong_sum <- ddply(PantYWal23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal23_gr_max <- sum(PantYWal23_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal23_gr_max
PantYWal23_gr_pres <- sum(PantYWal23_grframelong_sum $max > 0)
PantYWal23_gr_pres

#number of sites which would be classified as low
PantYWal23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal23_grframelong_sum$max)
PantYWal23_gr_lw_ref
#number of sites which would be classified as high
PantYWal23_gr_high_ref <- sum( PantYWal23_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal23_gr_high_ref
#number of sites which would be classified as moderate
PantYWal23_gr_mod_ref <- 1000 - (PantYWal23_gr_high_ref + PantYWal23_gr_lw_ref)
PantYWal23_gr_mod_ref

#24 detectors
PantYWal24_gr<-(replicate(1000, (sample(PantYWalpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
PantYWal24_grframe<-data.frame(PantYWal24_gr, samp2)
PantYWal24_grframelong <- melt(PantYWal24_grframe,id.vars="samp2")
PantYWal24_grframelong_sum <- ddply(PantYWal24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
PantYWal24_gr_max <- sum(PantYWal24_grframelong_sum $max > max20_PantYWalpipgr)
PantYWal24_gr_max
PantYWal24_gr_pres <- sum(PantYWal24_grframelong_sum $max > 0)
PantYWal24_gr_pres

#number of sites which would be classified as low
PantYWal24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= PantYWal24_grframelong_sum$max)
PantYWal24_gr_lw_ref
#number of sites which would be classified as high
PantYWal24_gr_high_ref <- sum( PantYWal24_grframelong_sum$max > allsppgr_ppip_ref_high)
PantYWal24_gr_high_ref
#number of sites which would be classified as moderate
PantYWal24_gr_mod_ref <- 1000 - (PantYWal24_gr_high_ref + PantYWal24_gr_lw_ref)
PantYWal24_gr_mod_ref

Present<-c(PantYWal1_gr_pres,PantYWal2_gr_pres,
           PantYWal3_gr_pres,PantYWal4_gr_pres,
           PantYWal5_gr_pres,PantYWal6_gr_pres,
           PantYWal7_gr_pres,PantYWal8_gr_pres,
           PantYWal9_gr_pres,PantYWal10_gr_pres,
           PantYWal11_gr_pres,PantYWal12_gr_pres,
           PantYWal13_gr_pres,PantYWal14_gr_pres,
           PantYWal15_gr_pres,PantYWal16_gr_pres,
           PantYWal17_gr_pres,PantYWal18_gr_pres,
           PantYWal19_gr_pres,PantYWal20_gr_pres,
           PantYWal21_gr_pres,PantYWal22_gr_pres,
           PantYWal23_gr_pres,PantYWal24_gr_pres)


Maximum<-c(PantYWal1_gr_max,PantYWal2_gr_max,
           PantYWal3_gr_max,PantYWal4_gr_max,
           PantYWal5_gr_max,PantYWal6_gr_max,
           PantYWal7_gr_max,PantYWal8_gr_max,
           PantYWal9_gr_max,PantYWal10_gr_max,
           PantYWal11_gr_max,PantYWal12_gr_max,
           PantYWal13_gr_max,PantYWal14_gr_max,
           PantYWal15_gr_max,PantYWal16_gr_max,
           PantYWal17_gr_max,PantYWal18_gr_max,
           PantYWal19_gr_max,PantYWal20_gr_max,
           PantYWal21_gr_max,PantYWal22_gr_max,
           PantYWal23_gr_max,PantYWal24_gr_max)

Low<-c(PantYWal1_gr_lw_ref, PantYWal2_gr_lw_ref, PantYWal3_gr_lw_ref,
       PantYWal4_gr_lw_ref, PantYWal5_gr_lw_ref, PantYWal6_gr_lw_ref,
       PantYWal7_gr_lw_ref, PantYWal8_gr_lw_ref, PantYWal9_gr_lw_ref,
       PantYWal10_gr_lw_ref, PantYWal11_gr_lw_ref, PantYWal12_gr_lw_ref, 
       PantYWal13_gr_lw_ref, PantYWal14_gr_lw_ref, PantYWal15_gr_lw_ref, 
       PantYWal16_gr_lw_ref, PantYWal17_gr_lw_ref, PantYWal18_gr_lw_ref, 
       PantYWal19_gr_lw_ref, PantYWal20_gr_lw_ref, PantYWal21_gr_lw_ref,
       PantYWal22_gr_lw_ref,PantYWal23_gr_lw_ref,PantYWal24_gr_lw_ref)

Moderate<-c(PantYWal1_gr_mod_ref, PantYWal2_gr_mod_ref, PantYWal3_gr_mod_ref,
            PantYWal4_gr_mod_ref, PantYWal5_gr_mod_ref, PantYWal6_gr_mod_ref,
            PantYWal7_gr_mod_ref, PantYWal8_gr_mod_ref, PantYWal9_gr_mod_ref,
            PantYWal10_gr_mod_ref, PantYWal11_gr_mod_ref, PantYWal12_gr_mod_ref, 
            PantYWal13_gr_mod_ref, PantYWal14_gr_mod_ref, PantYWal15_gr_mod_ref, 
            PantYWal16_gr_mod_ref, PantYWal17_gr_mod_ref, PantYWal18_gr_mod_ref, 
            PantYWal19_gr_mod_ref, PantYWal20_gr_mod_ref, PantYWal21_gr_mod_ref,
            PantYWal22_gr_mod_ref,PantYWal23_gr_mod_ref,PantYWal24_gr_mod_ref)

High<-c(PantYWal1_gr_high_ref, PantYWal2_gr_high_ref, PantYWal3_gr_high_ref,
        PantYWal4_gr_high_ref, PantYWal5_gr_high_ref, PantYWal6_gr_high_ref,
        PantYWal7_gr_high_ref, PantYWal8_gr_high_ref, PantYWal9_gr_high_ref,
        PantYWal10_gr_high_ref, PantYWal11_gr_high_ref, PantYWal12_gr_high_ref, 
        PantYWal13_gr_high_ref, PantYWal14_gr_high_ref, PantYWal15_gr_high_ref, 
        PantYWal16_gr_high_ref, PantYWal17_gr_high_ref, PantYWal18_gr_high_ref, 
        PantYWal19_gr_high_ref, PantYWal20_gr_high_ref, PantYWal21_gr_high_ref,
        PantYWal22_gr_high_ref,PantYWal23_gr_high_ref,PantYWal24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("PantYWalgr",24)
Lowsite <- PantYWallow
Modsite <- PantYWalmod
Highsite <-PantYWalhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



PantYWalgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##Pendine

Pendinepipgr<-subset(allspp4gr_ppip, Site=="Pendine")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Pendinepipgr<-max(Pendinepipgr$Passes)

#calculate 20% from maximum nightly record

max20_Pendinepipgr<- (max_Pendinepipgr/100)*80

##calculate the site classification (reference range)

Pendinehigh<- max_Pendinepipgr > allsppgr_ppip_ref_high

Pendinelow<- allsppgr_ppip_ref_low > max_Pendinepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Pendinepipgr
Pendinemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Pendine1_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 1, replace=F))))
Pendine1_gr_max <- sum(Pendine1_gr > max20_Pendinepipgr)
Pendine1_gr_max
Pendine1_gr_pres <- sum(Pendine1_gr > 0)
Pendine1_gr_pres
#number of sites which would be classified as low
Pendine1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine1_gr)
Pendine1_gr_lw_ref
#number of sites which would be classified as high
Pendine1_gr_high_ref <- sum( Pendine1_gr > allsppgr_ppip_ref_high)
Pendine1_gr_high_ref
#number of sites which would be classified as moderate
Pendine1_gr_mod_ref <- 1000 - (Pendine1_gr_high_ref + Pendine1_gr_lw_ref)
Pendine1_gr_mod_ref


#2 nights
Pendine2_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Pendine2_grframe<-data.frame(Pendine2_gr, samp2)
Pendine2_grframelong <- melt(Pendine2_grframe,id.vars="samp2")
Pendine2_grframelong_sum <- ddply(Pendine2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine2_gr_max <- sum(Pendine2_grframelong_sum $max > max20_Pendinepipgr)
Pendine2_gr_max
Pendine2_gr_pres <- sum(Pendine2_grframelong_sum $max > 0)
Pendine2_gr_pres

#number of sites which would be classified as low
Pendine2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine2_grframelong_sum$max)
Pendine2_gr_lw_ref
#number of sites which would be classified as high
Pendine2_gr_high_ref <- sum( Pendine2_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine2_gr_high_ref
#number of sites which would be classified as moderate
Pendine2_gr_mod_ref <- 1000 - (Pendine2_gr_high_ref + Pendine2_gr_lw_ref)
Pendine2_gr_mod_ref


#3 nights
Pendine3_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Pendine3_grframe<-data.frame(Pendine3_gr, samp2)
Pendine3_grframelong <- melt(Pendine3_grframe,id.vars="samp2")
Pendine3_grframelong_sum <- ddply(Pendine3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine3_gr_max <- sum(Pendine3_grframelong_sum $max > max20_Pendinepipgr)
Pendine3_gr_max
Pendine3_gr_pres <- sum(Pendine3_grframelong_sum $max > 0)
Pendine3_gr_pres

#number of sites which would be classified as low
Pendine3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine3_grframelong_sum$max)
Pendine3_gr_lw_ref
#number of sites which would be classified as high
Pendine3_gr_high_ref <- sum( Pendine3_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine3_gr_high_ref
#number of sites which would be classified as moderate
Pendine3_gr_mod_ref <- 1000 - (Pendine3_gr_high_ref + Pendine3_gr_lw_ref)
Pendine3_gr_mod_ref

#4 nights
Pendine4_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Pendine4_grframe<-data.frame(Pendine4_gr, samp2)
Pendine4_grframelong <- melt(Pendine4_grframe,id.vars="samp2")
Pendine4_grframelong_sum <- ddply(Pendine4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine4_gr_max <- sum(Pendine4_grframelong_sum $max > max20_Pendinepipgr)
Pendine4_gr_max
Pendine4_gr_pres <- sum(Pendine4_grframelong_sum $max > 0)
Pendine4_gr_pres

#number of sites which would be classified as low
Pendine4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine4_grframelong_sum$max)
Pendine4_gr_lw_ref
#number of sites which would be classified as high
Pendine4_gr_high_ref <- sum( Pendine4_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine4_gr_high_ref
#number of sites which would be classified as moderate
Pendine4_gr_mod_ref <- 1000 - (Pendine4_gr_high_ref + Pendine4_gr_lw_ref)
Pendine4_gr_mod_ref

#5 nights
Pendine5_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Pendine5_grframe<-data.frame(Pendine5_gr, samp2)
Pendine5_grframelong <- melt(Pendine5_grframe,id.vars="samp2")
Pendine5_grframelong_sum <- ddply(Pendine5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine5_gr_max <- sum(Pendine5_grframelong_sum $max > max20_Pendinepipgr)
Pendine5_gr_max
Pendine5_gr_pres <- sum(Pendine5_grframelong_sum $max > 0)
Pendine5_gr_pres

#number of sites which would be classified as low
Pendine5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine5_grframelong_sum$max)
Pendine5_gr_lw_ref
#number of sites which would be classified as high
Pendine5_gr_high_ref <- sum( Pendine5_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine5_gr_high_ref
#number of sites which would be classified as moderate
Pendine5_gr_mod_ref <- 1000 - (Pendine5_gr_high_ref + Pendine5_gr_lw_ref)
Pendine5_gr_mod_ref

#6 nights
Pendine6_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Pendine6_grframe<-data.frame(Pendine6_gr, samp2)
Pendine6_grframelong <- melt(Pendine6_grframe,id.vars="samp2")
Pendine6_grframelong_sum <- ddply(Pendine6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine6_gr_max <- sum(Pendine6_grframelong_sum $max > max20_Pendinepipgr)
Pendine6_gr_max
Pendine6_gr_pres <- sum(Pendine6_grframelong_sum $max > 0)
Pendine6_gr_pres

#number of sites which would be classified as low
Pendine6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine6_grframelong_sum$max)
Pendine6_gr_lw_ref
#number of sites which would be classified as high
Pendine6_gr_high_ref <- sum( Pendine6_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine6_gr_high_ref
#number of sites which would be classified as moderate
Pendine6_gr_mod_ref <- 1000 - (Pendine6_gr_high_ref + Pendine6_gr_lw_ref)
Pendine6_gr_mod_ref

#7 nights
Pendine7_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Pendine7_grframe<-data.frame(Pendine7_gr, samp2)
Pendine7_grframelong <- melt(Pendine7_grframe,id.vars="samp2")
Pendine7_grframelong_sum <- ddply(Pendine7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine7_gr_max <- sum(Pendine7_grframelong_sum $max > max20_Pendinepipgr)
Pendine7_gr_max
Pendine7_gr_pres <- sum(Pendine7_grframelong_sum $max > 0)
Pendine7_gr_pres

#number of sites which would be classified as low
Pendine7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine7_grframelong_sum$max)
Pendine7_gr_lw_ref
#number of sites which would be classified as high
Pendine7_gr_high_ref <- sum( Pendine7_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine7_gr_high_ref
#number of sites which would be classified as moderate
Pendine7_gr_mod_ref <- 1000 - (Pendine7_gr_high_ref + Pendine7_gr_lw_ref)
Pendine7_gr_mod_ref

#8 nights
Pendine8_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Pendine8_grframe<-data.frame(Pendine8_gr, samp2)
Pendine8_grframelong <- melt(Pendine8_grframe,id.vars="samp2")
Pendine8_grframelong_sum <- ddply(Pendine8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine8_gr_max <- sum(Pendine8_grframelong_sum $max > max20_Pendinepipgr)
Pendine8_gr_max
Pendine8_gr_pres <- sum(Pendine8_grframelong_sum $max > 0)
Pendine8_gr_pres

#number of sites which would be classified as low
Pendine8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine8_grframelong_sum$max)
Pendine8_gr_lw_ref
#number of sites which would be classified as high
Pendine8_gr_high_ref <- sum( Pendine8_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine8_gr_high_ref
#number of sites which would be classified as moderate
Pendine8_gr_mod_ref <- 1000 - (Pendine8_gr_high_ref + Pendine8_gr_lw_ref)
Pendine8_gr_mod_ref

#9 nights
Pendine9_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Pendine9_grframe<-data.frame(Pendine9_gr, samp2)
Pendine9_grframelong <- melt(Pendine9_grframe,id.vars="samp2")
Pendine9_grframelong_sum <- ddply(Pendine9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Pendine9_gr_max <- sum(Pendine9_grframelong_sum $max > max20_Pendinepipgr)
Pendine9_gr_max
Pendine9_gr_pres <- sum(Pendine9_grframelong_sum $max > 0)
Pendine9_gr_pres

#number of sites which would be classified as low
Pendine9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine9_grframelong_sum$max)
Pendine9_gr_lw_ref
#number of sites which would be classified as high
Pendine9_gr_high_ref <- sum( Pendine9_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine9_gr_high_ref
#number of sites which would be classified as moderate
Pendine9_gr_mod_ref <- 1000 - (Pendine9_gr_high_ref + Pendine9_gr_lw_ref)
Pendine9_gr_mod_ref

#10 detectors
Pendine10_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Pendine10_grframe<-data.frame(Pendine10_gr, samp2)
Pendine10_grframelong <- melt(Pendine10_grframe,id.vars="samp2")
Pendine10_grframelong_sum <- ddply(Pendine10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine10_gr_max <- sum(Pendine10_grframelong_sum $max > max20_Pendinepipgr)
Pendine10_gr_max
Pendine10_gr_pres <- sum(Pendine10_grframelong_sum $max > 0)
Pendine10_gr_pres

#number of sites which would be classified as low
Pendine10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine10_grframelong_sum$max)
Pendine10_gr_lw_ref
#number of sites which would be classified as high
Pendine10_gr_high_ref <- sum( Pendine10_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine10_gr_high_ref
#number of sites which would be classified as moderate
Pendine10_gr_mod_ref <- 1000 - (Pendine10_gr_high_ref + Pendine10_gr_lw_ref)
Pendine10_gr_mod_ref

#11 detectors
Pendine11_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Pendine11_grframe<-data.frame(Pendine11_gr, samp2)
Pendine11_grframelong <- melt(Pendine11_grframe,id.vars="samp2")
Pendine11_grframelong_sum <- ddply(Pendine11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine11_gr_max <- sum(Pendine11_grframelong_sum $max > max20_Pendinepipgr)
Pendine11_gr_max
Pendine11_gr_pres <- sum(Pendine11_grframelong_sum $max > 0)
Pendine11_gr_pres

#number of sites which would be classified as low
Pendine11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine11_grframelong_sum$max)
Pendine11_gr_lw_ref
#number of sites which would be classified as high
Pendine11_gr_high_ref <- sum( Pendine11_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine11_gr_high_ref
#number of sites which would be classified as moderate
Pendine11_gr_mod_ref <- 1000 - (Pendine11_gr_high_ref + Pendine11_gr_lw_ref)
Pendine11_gr_mod_ref

#12 detectors
Pendine12_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Pendine12_grframe<-data.frame(Pendine12_gr, samp2)
Pendine12_grframelong <- melt(Pendine12_grframe,id.vars="samp2")
Pendine12_grframelong_sum <- ddply(Pendine12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine12_gr_max <- sum(Pendine12_grframelong_sum $max > max20_Pendinepipgr)
Pendine12_gr_max
Pendine12_gr_pres <- sum(Pendine12_grframelong_sum $max > 0)
Pendine12_gr_pres

#number of sites which would be classified as low
Pendine12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine12_grframelong_sum$max)
Pendine12_gr_lw_ref
#number of sites which would be classified as high
Pendine12_gr_high_ref <- sum( Pendine12_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine12_gr_high_ref
#number of sites which would be classified as moderate
Pendine12_gr_mod_ref <- 1000 - (Pendine12_gr_high_ref + Pendine12_gr_lw_ref)
Pendine12_gr_mod_ref

#13 detectors
Pendine13_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Pendine13_grframe<-data.frame(Pendine13_gr, samp2)
Pendine13_grframelong <- melt(Pendine13_grframe,id.vars="samp2")
Pendine13_grframelong_sum <- ddply(Pendine13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine13_gr_max <- sum(Pendine13_grframelong_sum $max > max20_Pendinepipgr)
Pendine13_gr_max
Pendine13_gr_pres <- sum(Pendine13_grframelong_sum $max > 0)
Pendine13_gr_pres

#number of sites which would be classified as low
Pendine13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine13_grframelong_sum$max)
Pendine13_gr_lw_ref
#number of sites which would be classified as high
Pendine13_gr_high_ref <- sum( Pendine13_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine13_gr_high_ref
#number of sites which would be classified as moderate
Pendine13_gr_mod_ref <- 1000 - (Pendine13_gr_high_ref + Pendine13_gr_lw_ref)
Pendine13_gr_mod_ref

#14 detectors
Pendine14_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Pendine14_grframe<-data.frame(Pendine14_gr, samp2)
Pendine14_grframelong <- melt(Pendine14_grframe,id.vars="samp2")
Pendine14_grframelong_sum <- ddply(Pendine14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine14_gr_max <- sum(Pendine14_grframelong_sum $max > max20_Pendinepipgr)
Pendine14_gr_max
Pendine14_gr_pres <- sum(Pendine14_grframelong_sum $max > 0)
Pendine14_gr_pres

#number of sites which would be classified as low
Pendine14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine14_grframelong_sum$max)
Pendine14_gr_lw_ref
#number of sites which would be classified as high
Pendine14_gr_high_ref <- sum( Pendine14_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine14_gr_high_ref
#number of sites which would be classified as moderate
Pendine14_gr_mod_ref <- 1000 - (Pendine14_gr_high_ref + Pendine14_gr_lw_ref)
Pendine14_gr_mod_ref

#15 detectors
Pendine15_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Pendine15_grframe<-data.frame(Pendine15_gr, samp2)
Pendine15_grframelong <- melt(Pendine15_grframe,id.vars="samp2")
Pendine15_grframelong_sum <- ddply(Pendine15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine15_gr_max <- sum(Pendine15_grframelong_sum $max > max20_Pendinepipgr)
Pendine15_gr_max
Pendine15_gr_pres <- sum(Pendine15_grframelong_sum $max > 0)
Pendine15_gr_pres

#number of sites which would be classified as low
Pendine15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine15_grframelong_sum$max)
Pendine15_gr_lw_ref
#number of sites which would be classified as high
Pendine15_gr_high_ref <- sum( Pendine15_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine15_gr_high_ref
#number of sites which would be classified as moderate
Pendine15_gr_mod_ref <- 1000 - (Pendine15_gr_high_ref + Pendine15_gr_lw_ref)
Pendine15_gr_mod_ref

#16 detectors
Pendine16_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Pendine16_grframe<-data.frame(Pendine16_gr, samp2)
Pendine16_grframelong <- melt(Pendine16_grframe,id.vars="samp2")
Pendine16_grframelong_sum <- ddply(Pendine16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine16_gr_max <- sum(Pendine16_grframelong_sum $max > max20_Pendinepipgr)
Pendine16_gr_max
Pendine16_gr_pres <- sum(Pendine16_grframelong_sum $max > 0)
Pendine16_gr_pres

#number of sites which would be classified as low
Pendine16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine16_grframelong_sum$max)
Pendine16_gr_lw_ref
#number of sites which would be classified as high
Pendine16_gr_high_ref <- sum( Pendine16_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine16_gr_high_ref
#number of sites which would be classified as moderate
Pendine16_gr_mod_ref <- 1000 - (Pendine16_gr_high_ref + Pendine16_gr_lw_ref)
Pendine16_gr_mod_ref

#17 detectors
Pendine17_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Pendine17_grframe<-data.frame(Pendine17_gr, samp2)
Pendine17_grframelong <- melt(Pendine17_grframe,id.vars="samp2")
Pendine17_grframelong_sum <- ddply(Pendine17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine17_gr_max <- sum(Pendine17_grframelong_sum $max > max20_Pendinepipgr)
Pendine17_gr_max
Pendine17_gr_pres <- sum(Pendine17_grframelong_sum $max > 0)
Pendine17_gr_pres

#number of sites which would be classified as low
Pendine17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine17_grframelong_sum$max)
Pendine17_gr_lw_ref
#number of sites which would be classified as high
Pendine17_gr_high_ref <- sum( Pendine17_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine17_gr_high_ref
#number of sites which would be classified as moderate
Pendine17_gr_mod_ref <- 1000 - (Pendine17_gr_high_ref + Pendine17_gr_lw_ref)
Pendine17_gr_mod_ref

#18 detectors
Pendine18_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Pendine18_grframe<-data.frame(Pendine18_gr, samp2)
Pendine18_grframelong <- melt(Pendine18_grframe,id.vars="samp2")
Pendine18_grframelong_sum <- ddply(Pendine18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine18_gr_max <- sum(Pendine18_grframelong_sum $max > max20_Pendinepipgr)
Pendine18_gr_max
Pendine18_gr_pres <- sum(Pendine18_grframelong_sum $max > 0)
Pendine18_gr_pres

#number of sites which would be classified as low
Pendine18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine18_grframelong_sum$max)
Pendine18_gr_lw_ref
#number of sites which would be classified as high
Pendine18_gr_high_ref <- sum( Pendine18_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine18_gr_high_ref
#number of sites which would be classified as moderate
Pendine18_gr_mod_ref <- 1000 - (Pendine18_gr_high_ref + Pendine18_gr_lw_ref)
Pendine18_gr_mod_ref

#19 detectors
Pendine19_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Pendine19_grframe<-data.frame(Pendine19_gr, samp2)
Pendine19_grframelong <- melt(Pendine19_grframe,id.vars="samp2")
Pendine19_grframelong_sum <- ddply(Pendine19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine19_gr_max <- sum(Pendine19_grframelong_sum $max > max20_Pendinepipgr)
Pendine19_gr_max
Pendine19_gr_pres <- sum(Pendine19_grframelong_sum $max > 0)
Pendine19_gr_pres

#number of sites which would be classified as low
Pendine19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine19_grframelong_sum$max)
Pendine19_gr_lw_ref
#number of sites which would be classified as high
Pendine19_gr_high_ref <- sum( Pendine19_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine19_gr_high_ref
#number of sites which would be classified as moderate
Pendine19_gr_mod_ref <- 1000 - (Pendine19_gr_high_ref + Pendine19_gr_lw_ref)
Pendine19_gr_mod_ref

#20 detectors
Pendine20_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Pendine20_grframe<-data.frame(Pendine20_gr, samp2)
Pendine20_grframelong <- melt(Pendine20_grframe,id.vars="samp2")
Pendine20_grframelong_sum <- ddply(Pendine20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine20_gr_max <- sum(Pendine20_grframelong_sum $max > max20_Pendinepipgr)
Pendine20_gr_max
Pendine20_gr_pres <- sum(Pendine20_grframelong_sum $max > 0)
Pendine20_gr_pres

#number of sites which would be classified as low
Pendine20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine20_grframelong_sum$max)
Pendine20_gr_lw_ref
#number of sites which would be classified as high
Pendine20_gr_high_ref <- sum( Pendine20_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine20_gr_high_ref
#number of sites which would be classified as moderate
Pendine20_gr_mod_ref <- 1000 - (Pendine20_gr_high_ref + Pendine20_gr_lw_ref)
Pendine20_gr_mod_ref

#21 detectors
Pendine21_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Pendine21_grframe<-data.frame(Pendine21_gr, samp2)
Pendine21_grframelong <- melt(Pendine21_grframe,id.vars="samp2")
Pendine21_grframelong_sum <- ddply(Pendine21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine21_gr_max <- sum(Pendine21_grframelong_sum $max > max20_Pendinepipgr)
Pendine21_gr_max
Pendine21_gr_pres <- sum(Pendine21_grframelong_sum $max > 0)
Pendine21_gr_pres

#number of sites which would be classified as low
Pendine21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine21_grframelong_sum$max)
Pendine21_gr_lw_ref
#number of sites which would be classified as high
Pendine21_gr_high_ref <- sum( Pendine21_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine21_gr_high_ref
#number of sites which would be classified as moderate
Pendine21_gr_mod_ref <- 1000 - (Pendine21_gr_high_ref + Pendine21_gr_lw_ref)
Pendine21_gr_mod_ref

#22 detectors
Pendine22_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Pendine22_grframe<-data.frame(Pendine22_gr, samp2)
Pendine22_grframelong <- melt(Pendine22_grframe,id.vars="samp2")
Pendine22_grframelong_sum <- ddply(Pendine22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine22_gr_max <- sum(Pendine22_grframelong_sum $max > max20_Pendinepipgr)
Pendine22_gr_max
Pendine22_gr_pres <- sum(Pendine22_grframelong_sum $max > 0)
Pendine22_gr_pres

#number of sites which would be classified as low
Pendine22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine22_grframelong_sum$max)
Pendine22_gr_lw_ref
#number of sites which would be classified as high
Pendine22_gr_high_ref <- sum( Pendine22_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine22_gr_high_ref
#number of sites which would be classified as moderate
Pendine22_gr_mod_ref <- 1000 - (Pendine22_gr_high_ref + Pendine22_gr_lw_ref)
Pendine22_gr_mod_ref

#23 detectors
Pendine23_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Pendine23_grframe<-data.frame(Pendine23_gr, samp2)
Pendine23_grframelong <- melt(Pendine23_grframe,id.vars="samp2")
Pendine23_grframelong_sum <- ddply(Pendine23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine23_gr_max <- sum(Pendine23_grframelong_sum $max > max20_Pendinepipgr)
Pendine23_gr_max
Pendine23_gr_pres <- sum(Pendine23_grframelong_sum $max > 0)
Pendine23_gr_pres

#number of sites which would be classified as low
Pendine23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine23_grframelong_sum$max)
Pendine23_gr_lw_ref
#number of sites which would be classified as high
Pendine23_gr_high_ref <- sum( Pendine23_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine23_gr_high_ref
#number of sites which would be classified as moderate
Pendine23_gr_mod_ref <- 1000 - (Pendine23_gr_high_ref + Pendine23_gr_lw_ref)
Pendine23_gr_mod_ref

#24 detectors
Pendine24_gr<-(replicate(1000, (sample(Pendinepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Pendine24_grframe<-data.frame(Pendine24_gr, samp2)
Pendine24_grframelong <- melt(Pendine24_grframe,id.vars="samp2")
Pendine24_grframelong_sum <- ddply(Pendine24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Pendine24_gr_max <- sum(Pendine24_grframelong_sum $max > max20_Pendinepipgr)
Pendine24_gr_max
Pendine24_gr_pres <- sum(Pendine24_grframelong_sum $max > 0)
Pendine24_gr_pres

#number of sites which would be classified as low
Pendine24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Pendine24_grframelong_sum$max)
Pendine24_gr_lw_ref
#number of sites which would be classified as high
Pendine24_gr_high_ref <- sum( Pendine24_grframelong_sum$max > allsppgr_ppip_ref_high)
Pendine24_gr_high_ref
#number of sites which would be classified as moderate
Pendine24_gr_mod_ref <- 1000 - (Pendine24_gr_high_ref + Pendine24_gr_lw_ref)
Pendine24_gr_mod_ref

Present<-c(Pendine1_gr_pres,Pendine2_gr_pres,
           Pendine3_gr_pres,Pendine4_gr_pres,
           Pendine5_gr_pres,Pendine6_gr_pres,
           Pendine7_gr_pres,Pendine8_gr_pres,
           Pendine9_gr_pres,Pendine10_gr_pres,
           Pendine11_gr_pres,Pendine12_gr_pres,
           Pendine13_gr_pres,Pendine14_gr_pres,
           Pendine15_gr_pres,Pendine16_gr_pres,
           Pendine17_gr_pres,Pendine18_gr_pres,
           Pendine19_gr_pres,Pendine20_gr_pres,
           Pendine21_gr_pres,Pendine22_gr_pres,
           Pendine23_gr_pres,Pendine24_gr_pres)


Maximum<-c(Pendine1_gr_max,Pendine2_gr_max,
           Pendine3_gr_max,Pendine4_gr_max,
           Pendine5_gr_max,Pendine6_gr_max,
           Pendine7_gr_max,Pendine8_gr_max,
           Pendine9_gr_max,Pendine10_gr_max,
           Pendine11_gr_max,Pendine12_gr_max,
           Pendine13_gr_max,Pendine14_gr_max,
           Pendine15_gr_max,Pendine16_gr_max,
           Pendine17_gr_max,Pendine18_gr_max,
           Pendine19_gr_max,Pendine20_gr_max,
           Pendine21_gr_max,Pendine22_gr_max,
           Pendine23_gr_max,Pendine24_gr_max)

Low<-c(Pendine1_gr_lw_ref, Pendine2_gr_lw_ref, Pendine3_gr_lw_ref,
       Pendine4_gr_lw_ref, Pendine5_gr_lw_ref, Pendine6_gr_lw_ref,
       Pendine7_gr_lw_ref, Pendine8_gr_lw_ref, Pendine9_gr_lw_ref,
       Pendine10_gr_lw_ref, Pendine11_gr_lw_ref, Pendine12_gr_lw_ref, 
       Pendine13_gr_lw_ref, Pendine14_gr_lw_ref, Pendine15_gr_lw_ref, 
       Pendine16_gr_lw_ref, Pendine17_gr_lw_ref, Pendine18_gr_lw_ref, 
       Pendine19_gr_lw_ref, Pendine20_gr_lw_ref, Pendine21_gr_lw_ref,
       Pendine22_gr_lw_ref,Pendine23_gr_lw_ref,Pendine24_gr_lw_ref)

Moderate<-c(Pendine1_gr_mod_ref, Pendine2_gr_mod_ref, Pendine3_gr_mod_ref,
            Pendine4_gr_mod_ref, Pendine5_gr_mod_ref, Pendine6_gr_mod_ref,
            Pendine7_gr_mod_ref, Pendine8_gr_mod_ref, Pendine9_gr_mod_ref,
            Pendine10_gr_mod_ref, Pendine11_gr_mod_ref, Pendine12_gr_mod_ref, 
            Pendine13_gr_mod_ref, Pendine14_gr_mod_ref, Pendine15_gr_mod_ref, 
            Pendine16_gr_mod_ref, Pendine17_gr_mod_ref, Pendine18_gr_mod_ref, 
            Pendine19_gr_mod_ref, Pendine20_gr_mod_ref, Pendine21_gr_mod_ref,
            Pendine22_gr_mod_ref,Pendine23_gr_mod_ref,Pendine24_gr_mod_ref)

High<-c(Pendine1_gr_high_ref, Pendine2_gr_high_ref, Pendine3_gr_high_ref,
        Pendine4_gr_high_ref, Pendine5_gr_high_ref, Pendine6_gr_high_ref,
        Pendine7_gr_high_ref, Pendine8_gr_high_ref, Pendine9_gr_high_ref,
        Pendine10_gr_high_ref, Pendine11_gr_high_ref, Pendine12_gr_high_ref, 
        Pendine13_gr_high_ref, Pendine14_gr_high_ref, Pendine15_gr_high_ref, 
        Pendine16_gr_high_ref, Pendine17_gr_high_ref, Pendine18_gr_high_ref, 
        Pendine19_gr_high_ref, Pendine20_gr_high_ref, Pendine21_gr_high_ref,
        Pendine22_gr_high_ref,Pendine23_gr_high_ref,Pendine24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Pendinegr",24)
Lowsite <- Pendinelow
Modsite <- Pendinemod
Highsite <-Pendinehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Pendinegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##RedTile

RedTilepipgr<-subset(allspp4gr_ppip, Site=="RedTile")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_RedTilepipgr<-max(RedTilepipgr$Passes)

#calculate 20% from maximum nightly record

max20_RedTilepipgr<- (max_RedTilepipgr/100)*80

##calculate the site classification (reference range)

RedTilehigh<- max_RedTilepipgr > allsppgr_ppip_ref_high

RedTilelow<- allsppgr_ppip_ref_low > max_RedTilepipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_RedTilepipgr
RedTilemod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
RedTile1_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 1, replace=F))))
RedTile1_gr_max <- sum(RedTile1_gr > max20_RedTilepipgr)
RedTile1_gr_max
RedTile1_gr_pres <- sum(RedTile1_gr > 0)
RedTile1_gr_pres
#number of sites which would be classified as low
RedTile1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile1_gr)
RedTile1_gr_lw_ref
#number of sites which would be classified as high
RedTile1_gr_high_ref <- sum( RedTile1_gr > allsppgr_ppip_ref_high)
RedTile1_gr_high_ref
#number of sites which would be classified as moderate
RedTile1_gr_mod_ref <- 1000 - (RedTile1_gr_high_ref + RedTile1_gr_lw_ref)
RedTile1_gr_mod_ref


#2 nights
RedTile2_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
RedTile2_grframe<-data.frame(RedTile2_gr, samp2)
RedTile2_grframelong <- melt(RedTile2_grframe,id.vars="samp2")
RedTile2_grframelong_sum <- ddply(RedTile2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile2_gr_max <- sum(RedTile2_grframelong_sum $max > max20_RedTilepipgr)
RedTile2_gr_max
RedTile2_gr_pres <- sum(RedTile2_grframelong_sum $max > 0)
RedTile2_gr_pres

#number of sites which would be classified as low
RedTile2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile2_grframelong_sum$max)
RedTile2_gr_lw_ref
#number of sites which would be classified as high
RedTile2_gr_high_ref <- sum( RedTile2_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile2_gr_high_ref
#number of sites which would be classified as moderate
RedTile2_gr_mod_ref <- 1000 - (RedTile2_gr_high_ref + RedTile2_gr_lw_ref)
RedTile2_gr_mod_ref


#3 nights
RedTile3_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
RedTile3_grframe<-data.frame(RedTile3_gr, samp2)
RedTile3_grframelong <- melt(RedTile3_grframe,id.vars="samp2")
RedTile3_grframelong_sum <- ddply(RedTile3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile3_gr_max <- sum(RedTile3_grframelong_sum $max > max20_RedTilepipgr)
RedTile3_gr_max
RedTile3_gr_pres <- sum(RedTile3_grframelong_sum $max > 0)
RedTile3_gr_pres

#number of sites which would be classified as low
RedTile3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile3_grframelong_sum$max)
RedTile3_gr_lw_ref
#number of sites which would be classified as high
RedTile3_gr_high_ref <- sum( RedTile3_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile3_gr_high_ref
#number of sites which would be classified as moderate
RedTile3_gr_mod_ref <- 1000 - (RedTile3_gr_high_ref + RedTile3_gr_lw_ref)
RedTile3_gr_mod_ref

#4 nights
RedTile4_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
RedTile4_grframe<-data.frame(RedTile4_gr, samp2)
RedTile4_grframelong <- melt(RedTile4_grframe,id.vars="samp2")
RedTile4_grframelong_sum <- ddply(RedTile4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile4_gr_max <- sum(RedTile4_grframelong_sum $max > max20_RedTilepipgr)
RedTile4_gr_max
RedTile4_gr_pres <- sum(RedTile4_grframelong_sum $max > 0)
RedTile4_gr_pres

#number of sites which would be classified as low
RedTile4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile4_grframelong_sum$max)
RedTile4_gr_lw_ref
#number of sites which would be classified as high
RedTile4_gr_high_ref <- sum( RedTile4_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile4_gr_high_ref
#number of sites which would be classified as moderate
RedTile4_gr_mod_ref <- 1000 - (RedTile4_gr_high_ref + RedTile4_gr_lw_ref)
RedTile4_gr_mod_ref

#5 nights
RedTile5_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
RedTile5_grframe<-data.frame(RedTile5_gr, samp2)
RedTile5_grframelong <- melt(RedTile5_grframe,id.vars="samp2")
RedTile5_grframelong_sum <- ddply(RedTile5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile5_gr_max <- sum(RedTile5_grframelong_sum $max > max20_RedTilepipgr)
RedTile5_gr_max
RedTile5_gr_pres <- sum(RedTile5_grframelong_sum $max > 0)
RedTile5_gr_pres

#number of sites which would be classified as low
RedTile5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile5_grframelong_sum$max)
RedTile5_gr_lw_ref
#number of sites which would be classified as high
RedTile5_gr_high_ref <- sum( RedTile5_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile5_gr_high_ref
#number of sites which would be classified as moderate
RedTile5_gr_mod_ref <- 1000 - (RedTile5_gr_high_ref + RedTile5_gr_lw_ref)
RedTile5_gr_mod_ref

#6 nights
RedTile6_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
RedTile6_grframe<-data.frame(RedTile6_gr, samp2)
RedTile6_grframelong <- melt(RedTile6_grframe,id.vars="samp2")
RedTile6_grframelong_sum <- ddply(RedTile6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile6_gr_max <- sum(RedTile6_grframelong_sum $max > max20_RedTilepipgr)
RedTile6_gr_max
RedTile6_gr_pres <- sum(RedTile6_grframelong_sum $max > 0)
RedTile6_gr_pres

#number of sites which would be classified as low
RedTile6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile6_grframelong_sum$max)
RedTile6_gr_lw_ref
#number of sites which would be classified as high
RedTile6_gr_high_ref <- sum( RedTile6_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile6_gr_high_ref
#number of sites which would be classified as moderate
RedTile6_gr_mod_ref <- 1000 - (RedTile6_gr_high_ref + RedTile6_gr_lw_ref)
RedTile6_gr_mod_ref

#7 nights
RedTile7_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
RedTile7_grframe<-data.frame(RedTile7_gr, samp2)
RedTile7_grframelong <- melt(RedTile7_grframe,id.vars="samp2")
RedTile7_grframelong_sum <- ddply(RedTile7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile7_gr_max <- sum(RedTile7_grframelong_sum $max > max20_RedTilepipgr)
RedTile7_gr_max
RedTile7_gr_pres <- sum(RedTile7_grframelong_sum $max > 0)
RedTile7_gr_pres

#number of sites which would be classified as low
RedTile7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile7_grframelong_sum$max)
RedTile7_gr_lw_ref
#number of sites which would be classified as high
RedTile7_gr_high_ref <- sum( RedTile7_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile7_gr_high_ref
#number of sites which would be classified as moderate
RedTile7_gr_mod_ref <- 1000 - (RedTile7_gr_high_ref + RedTile7_gr_lw_ref)
RedTile7_gr_mod_ref

#8 nights
RedTile8_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
RedTile8_grframe<-data.frame(RedTile8_gr, samp2)
RedTile8_grframelong <- melt(RedTile8_grframe,id.vars="samp2")
RedTile8_grframelong_sum <- ddply(RedTile8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile8_gr_max <- sum(RedTile8_grframelong_sum $max > max20_RedTilepipgr)
RedTile8_gr_max
RedTile8_gr_pres <- sum(RedTile8_grframelong_sum $max > 0)
RedTile8_gr_pres

#number of sites which would be classified as low
RedTile8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile8_grframelong_sum$max)
RedTile8_gr_lw_ref
#number of sites which would be classified as high
RedTile8_gr_high_ref <- sum( RedTile8_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile8_gr_high_ref
#number of sites which would be classified as moderate
RedTile8_gr_mod_ref <- 1000 - (RedTile8_gr_high_ref + RedTile8_gr_lw_ref)
RedTile8_gr_mod_ref

#9 nights
RedTile9_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
RedTile9_grframe<-data.frame(RedTile9_gr, samp2)
RedTile9_grframelong <- melt(RedTile9_grframe,id.vars="samp2")
RedTile9_grframelong_sum <- ddply(RedTile9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
RedTile9_gr_max <- sum(RedTile9_grframelong_sum $max > max20_RedTilepipgr)
RedTile9_gr_max
RedTile9_gr_pres <- sum(RedTile9_grframelong_sum $max > 0)
RedTile9_gr_pres

#number of sites which would be classified as low
RedTile9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile9_grframelong_sum$max)
RedTile9_gr_lw_ref
#number of sites which would be classified as high
RedTile9_gr_high_ref <- sum( RedTile9_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile9_gr_high_ref
#number of sites which would be classified as moderate
RedTile9_gr_mod_ref <- 1000 - (RedTile9_gr_high_ref + RedTile9_gr_lw_ref)
RedTile9_gr_mod_ref

#10 detectors
RedTile10_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
RedTile10_grframe<-data.frame(RedTile10_gr, samp2)
RedTile10_grframelong <- melt(RedTile10_grframe,id.vars="samp2")
RedTile10_grframelong_sum <- ddply(RedTile10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile10_gr_max <- sum(RedTile10_grframelong_sum $max > max20_RedTilepipgr)
RedTile10_gr_max
RedTile10_gr_pres <- sum(RedTile10_grframelong_sum $max > 0)
RedTile10_gr_pres

#number of sites which would be classified as low
RedTile10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile10_grframelong_sum$max)
RedTile10_gr_lw_ref
#number of sites which would be classified as high
RedTile10_gr_high_ref <- sum( RedTile10_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile10_gr_high_ref
#number of sites which would be classified as moderate
RedTile10_gr_mod_ref <- 1000 - (RedTile10_gr_high_ref + RedTile10_gr_lw_ref)
RedTile10_gr_mod_ref

#11 detectors
RedTile11_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
RedTile11_grframe<-data.frame(RedTile11_gr, samp2)
RedTile11_grframelong <- melt(RedTile11_grframe,id.vars="samp2")
RedTile11_grframelong_sum <- ddply(RedTile11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile11_gr_max <- sum(RedTile11_grframelong_sum $max > max20_RedTilepipgr)
RedTile11_gr_max
RedTile11_gr_pres <- sum(RedTile11_grframelong_sum $max > 0)
RedTile11_gr_pres

#number of sites which would be classified as low
RedTile11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile11_grframelong_sum$max)
RedTile11_gr_lw_ref
#number of sites which would be classified as high
RedTile11_gr_high_ref <- sum( RedTile11_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile11_gr_high_ref
#number of sites which would be classified as moderate
RedTile11_gr_mod_ref <- 1000 - (RedTile11_gr_high_ref + RedTile11_gr_lw_ref)
RedTile11_gr_mod_ref

#12 detectors
RedTile12_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
RedTile12_grframe<-data.frame(RedTile12_gr, samp2)
RedTile12_grframelong <- melt(RedTile12_grframe,id.vars="samp2")
RedTile12_grframelong_sum <- ddply(RedTile12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile12_gr_max <- sum(RedTile12_grframelong_sum $max > max20_RedTilepipgr)
RedTile12_gr_max
RedTile12_gr_pres <- sum(RedTile12_grframelong_sum $max > 0)
RedTile12_gr_pres

#number of sites which would be classified as low
RedTile12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile12_grframelong_sum$max)
RedTile12_gr_lw_ref
#number of sites which would be classified as high
RedTile12_gr_high_ref <- sum( RedTile12_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile12_gr_high_ref
#number of sites which would be classified as moderate
RedTile12_gr_mod_ref <- 1000 - (RedTile12_gr_high_ref + RedTile12_gr_lw_ref)
RedTile12_gr_mod_ref

#13 detectors
RedTile13_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
RedTile13_grframe<-data.frame(RedTile13_gr, samp2)
RedTile13_grframelong <- melt(RedTile13_grframe,id.vars="samp2")
RedTile13_grframelong_sum <- ddply(RedTile13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile13_gr_max <- sum(RedTile13_grframelong_sum $max > max20_RedTilepipgr)
RedTile13_gr_max
RedTile13_gr_pres <- sum(RedTile13_grframelong_sum $max > 0)
RedTile13_gr_pres

#number of sites which would be classified as low
RedTile13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile13_grframelong_sum$max)
RedTile13_gr_lw_ref
#number of sites which would be classified as high
RedTile13_gr_high_ref <- sum( RedTile13_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile13_gr_high_ref
#number of sites which would be classified as moderate
RedTile13_gr_mod_ref <- 1000 - (RedTile13_gr_high_ref + RedTile13_gr_lw_ref)
RedTile13_gr_mod_ref

#14 detectors
RedTile14_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
RedTile14_grframe<-data.frame(RedTile14_gr, samp2)
RedTile14_grframelong <- melt(RedTile14_grframe,id.vars="samp2")
RedTile14_grframelong_sum <- ddply(RedTile14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile14_gr_max <- sum(RedTile14_grframelong_sum $max > max20_RedTilepipgr)
RedTile14_gr_max
RedTile14_gr_pres <- sum(RedTile14_grframelong_sum $max > 0)
RedTile14_gr_pres

#number of sites which would be classified as low
RedTile14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile14_grframelong_sum$max)
RedTile14_gr_lw_ref
#number of sites which would be classified as high
RedTile14_gr_high_ref <- sum( RedTile14_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile14_gr_high_ref
#number of sites which would be classified as moderate
RedTile14_gr_mod_ref <- 1000 - (RedTile14_gr_high_ref + RedTile14_gr_lw_ref)
RedTile14_gr_mod_ref

#15 detectors
RedTile15_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
RedTile15_grframe<-data.frame(RedTile15_gr, samp2)
RedTile15_grframelong <- melt(RedTile15_grframe,id.vars="samp2")
RedTile15_grframelong_sum <- ddply(RedTile15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile15_gr_max <- sum(RedTile15_grframelong_sum $max > max20_RedTilepipgr)
RedTile15_gr_max
RedTile15_gr_pres <- sum(RedTile15_grframelong_sum $max > 0)
RedTile15_gr_pres

#number of sites which would be classified as low
RedTile15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile15_grframelong_sum$max)
RedTile15_gr_lw_ref
#number of sites which would be classified as high
RedTile15_gr_high_ref <- sum( RedTile15_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile15_gr_high_ref
#number of sites which would be classified as moderate
RedTile15_gr_mod_ref <- 1000 - (RedTile15_gr_high_ref + RedTile15_gr_lw_ref)
RedTile15_gr_mod_ref

#16 detectors
RedTile16_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
RedTile16_grframe<-data.frame(RedTile16_gr, samp2)
RedTile16_grframelong <- melt(RedTile16_grframe,id.vars="samp2")
RedTile16_grframelong_sum <- ddply(RedTile16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile16_gr_max <- sum(RedTile16_grframelong_sum $max > max20_RedTilepipgr)
RedTile16_gr_max
RedTile16_gr_pres <- sum(RedTile16_grframelong_sum $max > 0)
RedTile16_gr_pres

#number of sites which would be classified as low
RedTile16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile16_grframelong_sum$max)
RedTile16_gr_lw_ref
#number of sites which would be classified as high
RedTile16_gr_high_ref <- sum( RedTile16_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile16_gr_high_ref
#number of sites which would be classified as moderate
RedTile16_gr_mod_ref <- 1000 - (RedTile16_gr_high_ref + RedTile16_gr_lw_ref)
RedTile16_gr_mod_ref

#17 detectors
RedTile17_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
RedTile17_grframe<-data.frame(RedTile17_gr, samp2)
RedTile17_grframelong <- melt(RedTile17_grframe,id.vars="samp2")
RedTile17_grframelong_sum <- ddply(RedTile17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile17_gr_max <- sum(RedTile17_grframelong_sum $max > max20_RedTilepipgr)
RedTile17_gr_max
RedTile17_gr_pres <- sum(RedTile17_grframelong_sum $max > 0)
RedTile17_gr_pres

#number of sites which would be classified as low
RedTile17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile17_grframelong_sum$max)
RedTile17_gr_lw_ref
#number of sites which would be classified as high
RedTile17_gr_high_ref <- sum( RedTile17_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile17_gr_high_ref
#number of sites which would be classified as moderate
RedTile17_gr_mod_ref <- 1000 - (RedTile17_gr_high_ref + RedTile17_gr_lw_ref)
RedTile17_gr_mod_ref

#18 detectors
RedTile18_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
RedTile18_grframe<-data.frame(RedTile18_gr, samp2)
RedTile18_grframelong <- melt(RedTile18_grframe,id.vars="samp2")
RedTile18_grframelong_sum <- ddply(RedTile18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile18_gr_max <- sum(RedTile18_grframelong_sum $max > max20_RedTilepipgr)
RedTile18_gr_max
RedTile18_gr_pres <- sum(RedTile18_grframelong_sum $max > 0)
RedTile18_gr_pres

#number of sites which would be classified as low
RedTile18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile18_grframelong_sum$max)
RedTile18_gr_lw_ref
#number of sites which would be classified as high
RedTile18_gr_high_ref <- sum( RedTile18_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile18_gr_high_ref
#number of sites which would be classified as moderate
RedTile18_gr_mod_ref <- 1000 - (RedTile18_gr_high_ref + RedTile18_gr_lw_ref)
RedTile18_gr_mod_ref

#19 detectors
RedTile19_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
RedTile19_grframe<-data.frame(RedTile19_gr, samp2)
RedTile19_grframelong <- melt(RedTile19_grframe,id.vars="samp2")
RedTile19_grframelong_sum <- ddply(RedTile19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile19_gr_max <- sum(RedTile19_grframelong_sum $max > max20_RedTilepipgr)
RedTile19_gr_max
RedTile19_gr_pres <- sum(RedTile19_grframelong_sum $max > 0)
RedTile19_gr_pres

#number of sites which would be classified as low
RedTile19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile19_grframelong_sum$max)
RedTile19_gr_lw_ref
#number of sites which would be classified as high
RedTile19_gr_high_ref <- sum( RedTile19_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile19_gr_high_ref
#number of sites which would be classified as moderate
RedTile19_gr_mod_ref <- 1000 - (RedTile19_gr_high_ref + RedTile19_gr_lw_ref)
RedTile19_gr_mod_ref

#20 detectors
RedTile20_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
RedTile20_grframe<-data.frame(RedTile20_gr, samp2)
RedTile20_grframelong <- melt(RedTile20_grframe,id.vars="samp2")
RedTile20_grframelong_sum <- ddply(RedTile20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile20_gr_max <- sum(RedTile20_grframelong_sum $max > max20_RedTilepipgr)
RedTile20_gr_max
RedTile20_gr_pres <- sum(RedTile20_grframelong_sum $max > 0)
RedTile20_gr_pres

#number of sites which would be classified as low
RedTile20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile20_grframelong_sum$max)
RedTile20_gr_lw_ref
#number of sites which would be classified as high
RedTile20_gr_high_ref <- sum( RedTile20_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile20_gr_high_ref
#number of sites which would be classified as moderate
RedTile20_gr_mod_ref <- 1000 - (RedTile20_gr_high_ref + RedTile20_gr_lw_ref)
RedTile20_gr_mod_ref

#21 detectors
RedTile21_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
RedTile21_grframe<-data.frame(RedTile21_gr, samp2)
RedTile21_grframelong <- melt(RedTile21_grframe,id.vars="samp2")
RedTile21_grframelong_sum <- ddply(RedTile21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile21_gr_max <- sum(RedTile21_grframelong_sum $max > max20_RedTilepipgr)
RedTile21_gr_max
RedTile21_gr_pres <- sum(RedTile21_grframelong_sum $max > 0)
RedTile21_gr_pres

#number of sites which would be classified as low
RedTile21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile21_grframelong_sum$max)
RedTile21_gr_lw_ref
#number of sites which would be classified as high
RedTile21_gr_high_ref <- sum( RedTile21_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile21_gr_high_ref
#number of sites which would be classified as moderate
RedTile21_gr_mod_ref <- 1000 - (RedTile21_gr_high_ref + RedTile21_gr_lw_ref)
RedTile21_gr_mod_ref

#22 detectors
RedTile22_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
RedTile22_grframe<-data.frame(RedTile22_gr, samp2)
RedTile22_grframelong <- melt(RedTile22_grframe,id.vars="samp2")
RedTile22_grframelong_sum <- ddply(RedTile22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile22_gr_max <- sum(RedTile22_grframelong_sum $max > max20_RedTilepipgr)
RedTile22_gr_max
RedTile22_gr_pres <- sum(RedTile22_grframelong_sum $max > 0)
RedTile22_gr_pres

#number of sites which would be classified as low
RedTile22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile22_grframelong_sum$max)
RedTile22_gr_lw_ref
#number of sites which would be classified as high
RedTile22_gr_high_ref <- sum( RedTile22_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile22_gr_high_ref
#number of sites which would be classified as moderate
RedTile22_gr_mod_ref <- 1000 - (RedTile22_gr_high_ref + RedTile22_gr_lw_ref)
RedTile22_gr_mod_ref

#23 detectors
RedTile23_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
RedTile23_grframe<-data.frame(RedTile23_gr, samp2)
RedTile23_grframelong <- melt(RedTile23_grframe,id.vars="samp2")
RedTile23_grframelong_sum <- ddply(RedTile23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile23_gr_max <- sum(RedTile23_grframelong_sum $max > max20_RedTilepipgr)
RedTile23_gr_max
RedTile23_gr_pres <- sum(RedTile23_grframelong_sum $max > 0)
RedTile23_gr_pres

#number of sites which would be classified as low
RedTile23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile23_grframelong_sum$max)
RedTile23_gr_lw_ref
#number of sites which would be classified as high
RedTile23_gr_high_ref <- sum( RedTile23_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile23_gr_high_ref
#number of sites which would be classified as moderate
RedTile23_gr_mod_ref <- 1000 - (RedTile23_gr_high_ref + RedTile23_gr_lw_ref)
RedTile23_gr_mod_ref

#24 detectors
RedTile24_gr<-(replicate(1000, (sample(RedTilepipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
RedTile24_grframe<-data.frame(RedTile24_gr, samp2)
RedTile24_grframelong <- melt(RedTile24_grframe,id.vars="samp2")
RedTile24_grframelong_sum <- ddply(RedTile24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
RedTile24_gr_max <- sum(RedTile24_grframelong_sum $max > max20_RedTilepipgr)
RedTile24_gr_max
RedTile24_gr_pres <- sum(RedTile24_grframelong_sum $max > 0)
RedTile24_gr_pres

#number of sites which would be classified as low
RedTile24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= RedTile24_grframelong_sum$max)
RedTile24_gr_lw_ref
#number of sites which would be classified as high
RedTile24_gr_high_ref <- sum( RedTile24_grframelong_sum$max > allsppgr_ppip_ref_high)
RedTile24_gr_high_ref
#number of sites which would be classified as moderate
RedTile24_gr_mod_ref <- 1000 - (RedTile24_gr_high_ref + RedTile24_gr_lw_ref)
RedTile24_gr_mod_ref

Present<-c(RedTile1_gr_pres,RedTile2_gr_pres,
           RedTile3_gr_pres,RedTile4_gr_pres,
           RedTile5_gr_pres,RedTile6_gr_pres,
           RedTile7_gr_pres,RedTile8_gr_pres,
           RedTile9_gr_pres,RedTile10_gr_pres,
           RedTile11_gr_pres,RedTile12_gr_pres,
           RedTile13_gr_pres,RedTile14_gr_pres,
           RedTile15_gr_pres,RedTile16_gr_pres,
           RedTile17_gr_pres,RedTile18_gr_pres,
           RedTile19_gr_pres,RedTile20_gr_pres,
           RedTile21_gr_pres,RedTile22_gr_pres,
           RedTile23_gr_pres,RedTile24_gr_pres)


Maximum<-c(RedTile1_gr_max,RedTile2_gr_max,
           RedTile3_gr_max,RedTile4_gr_max,
           RedTile5_gr_max,RedTile6_gr_max,
           RedTile7_gr_max,RedTile8_gr_max,
           RedTile9_gr_max,RedTile10_gr_max,
           RedTile11_gr_max,RedTile12_gr_max,
           RedTile13_gr_max,RedTile14_gr_max,
           RedTile15_gr_max,RedTile16_gr_max,
           RedTile17_gr_max,RedTile18_gr_max,
           RedTile19_gr_max,RedTile20_gr_max,
           RedTile21_gr_max,RedTile22_gr_max,
           RedTile23_gr_max,RedTile24_gr_max)

Low<-c(RedTile1_gr_lw_ref, RedTile2_gr_lw_ref, RedTile3_gr_lw_ref,
       RedTile4_gr_lw_ref, RedTile5_gr_lw_ref, RedTile6_gr_lw_ref,
       RedTile7_gr_lw_ref, RedTile8_gr_lw_ref, RedTile9_gr_lw_ref,
       RedTile10_gr_lw_ref, RedTile11_gr_lw_ref, RedTile12_gr_lw_ref, 
       RedTile13_gr_lw_ref, RedTile14_gr_lw_ref, RedTile15_gr_lw_ref, 
       RedTile16_gr_lw_ref, RedTile17_gr_lw_ref, RedTile18_gr_lw_ref, 
       RedTile19_gr_lw_ref, RedTile20_gr_lw_ref, RedTile21_gr_lw_ref,
       RedTile22_gr_lw_ref,RedTile23_gr_lw_ref,RedTile24_gr_lw_ref)

Moderate<-c(RedTile1_gr_mod_ref, RedTile2_gr_mod_ref, RedTile3_gr_mod_ref,
            RedTile4_gr_mod_ref, RedTile5_gr_mod_ref, RedTile6_gr_mod_ref,
            RedTile7_gr_mod_ref, RedTile8_gr_mod_ref, RedTile9_gr_mod_ref,
            RedTile10_gr_mod_ref, RedTile11_gr_mod_ref, RedTile12_gr_mod_ref, 
            RedTile13_gr_mod_ref, RedTile14_gr_mod_ref, RedTile15_gr_mod_ref, 
            RedTile16_gr_mod_ref, RedTile17_gr_mod_ref, RedTile18_gr_mod_ref, 
            RedTile19_gr_mod_ref, RedTile20_gr_mod_ref, RedTile21_gr_mod_ref,
            RedTile22_gr_mod_ref,RedTile23_gr_mod_ref,RedTile24_gr_mod_ref)

High<-c(RedTile1_gr_high_ref, RedTile2_gr_high_ref, RedTile3_gr_high_ref,
        RedTile4_gr_high_ref, RedTile5_gr_high_ref, RedTile6_gr_high_ref,
        RedTile7_gr_high_ref, RedTile8_gr_high_ref, RedTile9_gr_high_ref,
        RedTile10_gr_high_ref, RedTile11_gr_high_ref, RedTile12_gr_high_ref, 
        RedTile13_gr_high_ref, RedTile14_gr_high_ref, RedTile15_gr_high_ref, 
        RedTile16_gr_high_ref, RedTile17_gr_high_ref, RedTile18_gr_high_ref, 
        RedTile19_gr_high_ref, RedTile20_gr_high_ref, RedTile21_gr_high_ref,
        RedTile22_gr_high_ref,RedTile23_gr_high_ref,RedTile24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("RedTilegr",24)
Lowsite <- RedTilelow
Modsite <- RedTilemod
Highsite <-RedTilehigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



RedTilegr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##Roos

Roospipgr<-subset(allspp4gr_ppip, Site=="Roos")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Roospipgr<-max(Roospipgr$Passes)

#calculate 20% from maximum nightly record

max20_Roospipgr<- (max_Roospipgr/100)*80

##calculate the site classification (reference range)

Rooshigh<- max_Roospipgr > allsppgr_ppip_ref_high

Rooslow<- allsppgr_ppip_ref_low > max_Roospipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Roospipgr
Roosmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Roos1_gr<-(replicate(1000, (sample(Roospipgr$Passes, 1, replace=F))))
Roos1_gr_max <- sum(Roos1_gr > max20_Roospipgr)
Roos1_gr_max
Roos1_gr_pres <- sum(Roos1_gr > 0)
Roos1_gr_pres
#number of sites which would be classified as low
Roos1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos1_gr)
Roos1_gr_lw_ref
#number of sites which would be classified as high
Roos1_gr_high_ref <- sum( Roos1_gr > allsppgr_ppip_ref_high)
Roos1_gr_high_ref
#number of sites which would be classified as moderate
Roos1_gr_mod_ref <- 1000 - (Roos1_gr_high_ref + Roos1_gr_lw_ref)
Roos1_gr_mod_ref


#2 nights
Roos2_gr<-(replicate(1000, (sample(Roospipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Roos2_grframe<-data.frame(Roos2_gr, samp2)
Roos2_grframelong <- melt(Roos2_grframe,id.vars="samp2")
Roos2_grframelong_sum <- ddply(Roos2_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos2_gr_max <- sum(Roos2_grframelong_sum $max > max20_Roospipgr)
Roos2_gr_max
Roos2_gr_pres <- sum(Roos2_grframelong_sum $max > 0)
Roos2_gr_pres

#number of sites which would be classified as low
Roos2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos2_grframelong_sum$max)
Roos2_gr_lw_ref
#number of sites which would be classified as high
Roos2_gr_high_ref <- sum( Roos2_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos2_gr_high_ref
#number of sites which would be classified as moderate
Roos2_gr_mod_ref <- 1000 - (Roos2_gr_high_ref + Roos2_gr_lw_ref)
Roos2_gr_mod_ref


#3 nights
Roos3_gr<-(replicate(1000, (sample(Roospipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Roos3_grframe<-data.frame(Roos3_gr, samp2)
Roos3_grframelong <- melt(Roos3_grframe,id.vars="samp2")
Roos3_grframelong_sum <- ddply(Roos3_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos3_gr_max <- sum(Roos3_grframelong_sum $max > max20_Roospipgr)
Roos3_gr_max
Roos3_gr_pres <- sum(Roos3_grframelong_sum $max > 0)
Roos3_gr_pres

#number of sites which would be classified as low
Roos3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos3_grframelong_sum$max)
Roos3_gr_lw_ref
#number of sites which would be classified as high
Roos3_gr_high_ref <- sum( Roos3_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos3_gr_high_ref
#number of sites which would be classified as moderate
Roos3_gr_mod_ref <- 1000 - (Roos3_gr_high_ref + Roos3_gr_lw_ref)
Roos3_gr_mod_ref

#4 nights
Roos4_gr<-(replicate(1000, (sample(Roospipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Roos4_grframe<-data.frame(Roos4_gr, samp2)
Roos4_grframelong <- melt(Roos4_grframe,id.vars="samp2")
Roos4_grframelong_sum <- ddply(Roos4_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos4_gr_max <- sum(Roos4_grframelong_sum $max > max20_Roospipgr)
Roos4_gr_max
Roos4_gr_pres <- sum(Roos4_grframelong_sum $max > 0)
Roos4_gr_pres

#number of sites which would be classified as low
Roos4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos4_grframelong_sum$max)
Roos4_gr_lw_ref
#number of sites which would be classified as high
Roos4_gr_high_ref <- sum( Roos4_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos4_gr_high_ref
#number of sites which would be classified as moderate
Roos4_gr_mod_ref <- 1000 - (Roos4_gr_high_ref + Roos4_gr_lw_ref)
Roos4_gr_mod_ref

#5 nights
Roos5_gr<-(replicate(1000, (sample(Roospipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Roos5_grframe<-data.frame(Roos5_gr, samp2)
Roos5_grframelong <- melt(Roos5_grframe,id.vars="samp2")
Roos5_grframelong_sum <- ddply(Roos5_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos5_gr_max <- sum(Roos5_grframelong_sum $max > max20_Roospipgr)
Roos5_gr_max
Roos5_gr_pres <- sum(Roos5_grframelong_sum $max > 0)
Roos5_gr_pres

#number of sites which would be classified as low
Roos5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos5_grframelong_sum$max)
Roos5_gr_lw_ref
#number of sites which would be classified as high
Roos5_gr_high_ref <- sum( Roos5_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos5_gr_high_ref
#number of sites which would be classified as moderate
Roos5_gr_mod_ref <- 1000 - (Roos5_gr_high_ref + Roos5_gr_lw_ref)
Roos5_gr_mod_ref

#6 nights
Roos6_gr<-(replicate(1000, (sample(Roospipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Roos6_grframe<-data.frame(Roos6_gr, samp2)
Roos6_grframelong <- melt(Roos6_grframe,id.vars="samp2")
Roos6_grframelong_sum <- ddply(Roos6_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos6_gr_max <- sum(Roos6_grframelong_sum $max > max20_Roospipgr)
Roos6_gr_max
Roos6_gr_pres <- sum(Roos6_grframelong_sum $max > 0)
Roos6_gr_pres

#number of sites which would be classified as low
Roos6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos6_grframelong_sum$max)
Roos6_gr_lw_ref
#number of sites which would be classified as high
Roos6_gr_high_ref <- sum( Roos6_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos6_gr_high_ref
#number of sites which would be classified as moderate
Roos6_gr_mod_ref <- 1000 - (Roos6_gr_high_ref + Roos6_gr_lw_ref)
Roos6_gr_mod_ref

#7 nights
Roos7_gr<-(replicate(1000, (sample(Roospipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Roos7_grframe<-data.frame(Roos7_gr, samp2)
Roos7_grframelong <- melt(Roos7_grframe,id.vars="samp2")
Roos7_grframelong_sum <- ddply(Roos7_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos7_gr_max <- sum(Roos7_grframelong_sum $max > max20_Roospipgr)
Roos7_gr_max
Roos7_gr_pres <- sum(Roos7_grframelong_sum $max > 0)
Roos7_gr_pres

#number of sites which would be classified as low
Roos7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos7_grframelong_sum$max)
Roos7_gr_lw_ref
#number of sites which would be classified as high
Roos7_gr_high_ref <- sum( Roos7_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos7_gr_high_ref
#number of sites which would be classified as moderate
Roos7_gr_mod_ref <- 1000 - (Roos7_gr_high_ref + Roos7_gr_lw_ref)
Roos7_gr_mod_ref

#8 nights
Roos8_gr<-(replicate(1000, (sample(Roospipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Roos8_grframe<-data.frame(Roos8_gr, samp2)
Roos8_grframelong <- melt(Roos8_grframe,id.vars="samp2")
Roos8_grframelong_sum <- ddply(Roos8_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos8_gr_max <- sum(Roos8_grframelong_sum $max > max20_Roospipgr)
Roos8_gr_max
Roos8_gr_pres <- sum(Roos8_grframelong_sum $max > 0)
Roos8_gr_pres

#number of sites which would be classified as low
Roos8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos8_grframelong_sum$max)
Roos8_gr_lw_ref
#number of sites which would be classified as high
Roos8_gr_high_ref <- sum( Roos8_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos8_gr_high_ref
#number of sites which would be classified as moderate
Roos8_gr_mod_ref <- 1000 - (Roos8_gr_high_ref + Roos8_gr_lw_ref)
Roos8_gr_mod_ref

#9 nights
Roos9_gr<-(replicate(1000, (sample(Roospipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Roos9_grframe<-data.frame(Roos9_gr, samp2)
Roos9_grframelong <- melt(Roos9_grframe,id.vars="samp2")
Roos9_grframelong_sum <- ddply(Roos9_grframelong, "variable", summarise,
                               N    = length(value),
                               max  = max(value))
Roos9_gr_max <- sum(Roos9_grframelong_sum $max > max20_Roospipgr)
Roos9_gr_max
Roos9_gr_pres <- sum(Roos9_grframelong_sum $max > 0)
Roos9_gr_pres

#number of sites which would be classified as low
Roos9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos9_grframelong_sum$max)
Roos9_gr_lw_ref
#number of sites which would be classified as high
Roos9_gr_high_ref <- sum( Roos9_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos9_gr_high_ref
#number of sites which would be classified as moderate
Roos9_gr_mod_ref <- 1000 - (Roos9_gr_high_ref + Roos9_gr_lw_ref)
Roos9_gr_mod_ref

#10 detectors
Roos10_gr<-(replicate(1000, (sample(Roospipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Roos10_grframe<-data.frame(Roos10_gr, samp2)
Roos10_grframelong <- melt(Roos10_grframe,id.vars="samp2")
Roos10_grframelong_sum <- ddply(Roos10_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos10_gr_max <- sum(Roos10_grframelong_sum $max > max20_Roospipgr)
Roos10_gr_max
Roos10_gr_pres <- sum(Roos10_grframelong_sum $max > 0)
Roos10_gr_pres

#number of sites which would be classified as low
Roos10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos10_grframelong_sum$max)
Roos10_gr_lw_ref
#number of sites which would be classified as high
Roos10_gr_high_ref <- sum( Roos10_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos10_gr_high_ref
#number of sites which would be classified as moderate
Roos10_gr_mod_ref <- 1000 - (Roos10_gr_high_ref + Roos10_gr_lw_ref)
Roos10_gr_mod_ref

#11 detectors
Roos11_gr<-(replicate(1000, (sample(Roospipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Roos11_grframe<-data.frame(Roos11_gr, samp2)
Roos11_grframelong <- melt(Roos11_grframe,id.vars="samp2")
Roos11_grframelong_sum <- ddply(Roos11_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos11_gr_max <- sum(Roos11_grframelong_sum $max > max20_Roospipgr)
Roos11_gr_max
Roos11_gr_pres <- sum(Roos11_grframelong_sum $max > 0)
Roos11_gr_pres

#number of sites which would be classified as low
Roos11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos11_grframelong_sum$max)
Roos11_gr_lw_ref
#number of sites which would be classified as high
Roos11_gr_high_ref <- sum( Roos11_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos11_gr_high_ref
#number of sites which would be classified as moderate
Roos11_gr_mod_ref <- 1000 - (Roos11_gr_high_ref + Roos11_gr_lw_ref)
Roos11_gr_mod_ref

#12 detectors
Roos12_gr<-(replicate(1000, (sample(Roospipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Roos12_grframe<-data.frame(Roos12_gr, samp2)
Roos12_grframelong <- melt(Roos12_grframe,id.vars="samp2")
Roos12_grframelong_sum <- ddply(Roos12_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos12_gr_max <- sum(Roos12_grframelong_sum $max > max20_Roospipgr)
Roos12_gr_max
Roos12_gr_pres <- sum(Roos12_grframelong_sum $max > 0)
Roos12_gr_pres

#number of sites which would be classified as low
Roos12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos12_grframelong_sum$max)
Roos12_gr_lw_ref
#number of sites which would be classified as high
Roos12_gr_high_ref <- sum( Roos12_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos12_gr_high_ref
#number of sites which would be classified as moderate
Roos12_gr_mod_ref <- 1000 - (Roos12_gr_high_ref + Roos12_gr_lw_ref)
Roos12_gr_mod_ref

#13 detectors
Roos13_gr<-(replicate(1000, (sample(Roospipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Roos13_grframe<-data.frame(Roos13_gr, samp2)
Roos13_grframelong <- melt(Roos13_grframe,id.vars="samp2")
Roos13_grframelong_sum <- ddply(Roos13_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos13_gr_max <- sum(Roos13_grframelong_sum $max > max20_Roospipgr)
Roos13_gr_max
Roos13_gr_pres <- sum(Roos13_grframelong_sum $max > 0)
Roos13_gr_pres

#number of sites which would be classified as low
Roos13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos13_grframelong_sum$max)
Roos13_gr_lw_ref
#number of sites which would be classified as high
Roos13_gr_high_ref <- sum( Roos13_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos13_gr_high_ref
#number of sites which would be classified as moderate
Roos13_gr_mod_ref <- 1000 - (Roos13_gr_high_ref + Roos13_gr_lw_ref)
Roos13_gr_mod_ref

#14 detectors
Roos14_gr<-(replicate(1000, (sample(Roospipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Roos14_grframe<-data.frame(Roos14_gr, samp2)
Roos14_grframelong <- melt(Roos14_grframe,id.vars="samp2")
Roos14_grframelong_sum <- ddply(Roos14_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos14_gr_max <- sum(Roos14_grframelong_sum $max > max20_Roospipgr)
Roos14_gr_max
Roos14_gr_pres <- sum(Roos14_grframelong_sum $max > 0)
Roos14_gr_pres

#number of sites which would be classified as low
Roos14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos14_grframelong_sum$max)
Roos14_gr_lw_ref
#number of sites which would be classified as high
Roos14_gr_high_ref <- sum( Roos14_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos14_gr_high_ref
#number of sites which would be classified as moderate
Roos14_gr_mod_ref <- 1000 - (Roos14_gr_high_ref + Roos14_gr_lw_ref)
Roos14_gr_mod_ref

#15 detectors
Roos15_gr<-(replicate(1000, (sample(Roospipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Roos15_grframe<-data.frame(Roos15_gr, samp2)
Roos15_grframelong <- melt(Roos15_grframe,id.vars="samp2")
Roos15_grframelong_sum <- ddply(Roos15_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos15_gr_max <- sum(Roos15_grframelong_sum $max > max20_Roospipgr)
Roos15_gr_max
Roos15_gr_pres <- sum(Roos15_grframelong_sum $max > 0)
Roos15_gr_pres

#number of sites which would be classified as low
Roos15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos15_grframelong_sum$max)
Roos15_gr_lw_ref
#number of sites which would be classified as high
Roos15_gr_high_ref <- sum( Roos15_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos15_gr_high_ref
#number of sites which would be classified as moderate
Roos15_gr_mod_ref <- 1000 - (Roos15_gr_high_ref + Roos15_gr_lw_ref)
Roos15_gr_mod_ref

#16 detectors
Roos16_gr<-(replicate(1000, (sample(Roospipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Roos16_grframe<-data.frame(Roos16_gr, samp2)
Roos16_grframelong <- melt(Roos16_grframe,id.vars="samp2")
Roos16_grframelong_sum <- ddply(Roos16_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos16_gr_max <- sum(Roos16_grframelong_sum $max > max20_Roospipgr)
Roos16_gr_max
Roos16_gr_pres <- sum(Roos16_grframelong_sum $max > 0)
Roos16_gr_pres

#number of sites which would be classified as low
Roos16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos16_grframelong_sum$max)
Roos16_gr_lw_ref
#number of sites which would be classified as high
Roos16_gr_high_ref <- sum( Roos16_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos16_gr_high_ref
#number of sites which would be classified as moderate
Roos16_gr_mod_ref <- 1000 - (Roos16_gr_high_ref + Roos16_gr_lw_ref)
Roos16_gr_mod_ref

#17 detectors
Roos17_gr<-(replicate(1000, (sample(Roospipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Roos17_grframe<-data.frame(Roos17_gr, samp2)
Roos17_grframelong <- melt(Roos17_grframe,id.vars="samp2")
Roos17_grframelong_sum <- ddply(Roos17_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos17_gr_max <- sum(Roos17_grframelong_sum $max > max20_Roospipgr)
Roos17_gr_max
Roos17_gr_pres <- sum(Roos17_grframelong_sum $max > 0)
Roos17_gr_pres

#number of sites which would be classified as low
Roos17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos17_grframelong_sum$max)
Roos17_gr_lw_ref
#number of sites which would be classified as high
Roos17_gr_high_ref <- sum( Roos17_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos17_gr_high_ref
#number of sites which would be classified as moderate
Roos17_gr_mod_ref <- 1000 - (Roos17_gr_high_ref + Roos17_gr_lw_ref)
Roos17_gr_mod_ref

#18 detectors
Roos18_gr<-(replicate(1000, (sample(Roospipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Roos18_grframe<-data.frame(Roos18_gr, samp2)
Roos18_grframelong <- melt(Roos18_grframe,id.vars="samp2")
Roos18_grframelong_sum <- ddply(Roos18_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos18_gr_max <- sum(Roos18_grframelong_sum $max > max20_Roospipgr)
Roos18_gr_max
Roos18_gr_pres <- sum(Roos18_grframelong_sum $max > 0)
Roos18_gr_pres

#number of sites which would be classified as low
Roos18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos18_grframelong_sum$max)
Roos18_gr_lw_ref
#number of sites which would be classified as high
Roos18_gr_high_ref <- sum( Roos18_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos18_gr_high_ref
#number of sites which would be classified as moderate
Roos18_gr_mod_ref <- 1000 - (Roos18_gr_high_ref + Roos18_gr_lw_ref)
Roos18_gr_mod_ref

#19 detectors
Roos19_gr<-(replicate(1000, (sample(Roospipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Roos19_grframe<-data.frame(Roos19_gr, samp2)
Roos19_grframelong <- melt(Roos19_grframe,id.vars="samp2")
Roos19_grframelong_sum <- ddply(Roos19_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos19_gr_max <- sum(Roos19_grframelong_sum $max > max20_Roospipgr)
Roos19_gr_max
Roos19_gr_pres <- sum(Roos19_grframelong_sum $max > 0)
Roos19_gr_pres

#number of sites which would be classified as low
Roos19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos19_grframelong_sum$max)
Roos19_gr_lw_ref
#number of sites which would be classified as high
Roos19_gr_high_ref <- sum( Roos19_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos19_gr_high_ref
#number of sites which would be classified as moderate
Roos19_gr_mod_ref <- 1000 - (Roos19_gr_high_ref + Roos19_gr_lw_ref)
Roos19_gr_mod_ref

#20 detectors
Roos20_gr<-(replicate(1000, (sample(Roospipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Roos20_grframe<-data.frame(Roos20_gr, samp2)
Roos20_grframelong <- melt(Roos20_grframe,id.vars="samp2")
Roos20_grframelong_sum <- ddply(Roos20_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos20_gr_max <- sum(Roos20_grframelong_sum $max > max20_Roospipgr)
Roos20_gr_max
Roos20_gr_pres <- sum(Roos20_grframelong_sum $max > 0)
Roos20_gr_pres

#number of sites which would be classified as low
Roos20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos20_grframelong_sum$max)
Roos20_gr_lw_ref
#number of sites which would be classified as high
Roos20_gr_high_ref <- sum( Roos20_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos20_gr_high_ref
#number of sites which would be classified as moderate
Roos20_gr_mod_ref <- 1000 - (Roos20_gr_high_ref + Roos20_gr_lw_ref)
Roos20_gr_mod_ref

#21 detectors
Roos21_gr<-(replicate(1000, (sample(Roospipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Roos21_grframe<-data.frame(Roos21_gr, samp2)
Roos21_grframelong <- melt(Roos21_grframe,id.vars="samp2")
Roos21_grframelong_sum <- ddply(Roos21_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos21_gr_max <- sum(Roos21_grframelong_sum $max > max20_Roospipgr)
Roos21_gr_max
Roos21_gr_pres <- sum(Roos21_grframelong_sum $max > 0)
Roos21_gr_pres

#number of sites which would be classified as low
Roos21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos21_grframelong_sum$max)
Roos21_gr_lw_ref
#number of sites which would be classified as high
Roos21_gr_high_ref <- sum( Roos21_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos21_gr_high_ref
#number of sites which would be classified as moderate
Roos21_gr_mod_ref <- 1000 - (Roos21_gr_high_ref + Roos21_gr_lw_ref)
Roos21_gr_mod_ref

#22 detectors
Roos22_gr<-(replicate(1000, (sample(Roospipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Roos22_grframe<-data.frame(Roos22_gr, samp2)
Roos22_grframelong <- melt(Roos22_grframe,id.vars="samp2")
Roos22_grframelong_sum <- ddply(Roos22_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos22_gr_max <- sum(Roos22_grframelong_sum $max > max20_Roospipgr)
Roos22_gr_max
Roos22_gr_pres <- sum(Roos22_grframelong_sum $max > 0)
Roos22_gr_pres

#number of sites which would be classified as low
Roos22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos22_grframelong_sum$max)
Roos22_gr_lw_ref
#number of sites which would be classified as high
Roos22_gr_high_ref <- sum( Roos22_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos22_gr_high_ref
#number of sites which would be classified as moderate
Roos22_gr_mod_ref <- 1000 - (Roos22_gr_high_ref + Roos22_gr_lw_ref)
Roos22_gr_mod_ref

#23 detectors
Roos23_gr<-(replicate(1000, (sample(Roospipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Roos23_grframe<-data.frame(Roos23_gr, samp2)
Roos23_grframelong <- melt(Roos23_grframe,id.vars="samp2")
Roos23_grframelong_sum <- ddply(Roos23_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos23_gr_max <- sum(Roos23_grframelong_sum $max > max20_Roospipgr)
Roos23_gr_max
Roos23_gr_pres <- sum(Roos23_grframelong_sum $max > 0)
Roos23_gr_pres

#number of sites which would be classified as low
Roos23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos23_grframelong_sum$max)
Roos23_gr_lw_ref
#number of sites which would be classified as high
Roos23_gr_high_ref <- sum( Roos23_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos23_gr_high_ref
#number of sites which would be classified as moderate
Roos23_gr_mod_ref <- 1000 - (Roos23_gr_high_ref + Roos23_gr_lw_ref)
Roos23_gr_mod_ref

#24 detectors
Roos24_gr<-(replicate(1000, (sample(Roospipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Roos24_grframe<-data.frame(Roos24_gr, samp2)
Roos24_grframelong <- melt(Roos24_grframe,id.vars="samp2")
Roos24_grframelong_sum <- ddply(Roos24_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Roos24_gr_max <- sum(Roos24_grframelong_sum $max > max20_Roospipgr)
Roos24_gr_max
Roos24_gr_pres <- sum(Roos24_grframelong_sum $max > 0)
Roos24_gr_pres

#number of sites which would be classified as low
Roos24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Roos24_grframelong_sum$max)
Roos24_gr_lw_ref
#number of sites which would be classified as high
Roos24_gr_high_ref <- sum( Roos24_grframelong_sum$max > allsppgr_ppip_ref_high)
Roos24_gr_high_ref
#number of sites which would be classified as moderate
Roos24_gr_mod_ref <- 1000 - (Roos24_gr_high_ref + Roos24_gr_lw_ref)
Roos24_gr_mod_ref

Present<-c(Roos1_gr_pres,Roos2_gr_pres,
           Roos3_gr_pres,Roos4_gr_pres,
           Roos5_gr_pres,Roos6_gr_pres,
           Roos7_gr_pres,Roos8_gr_pres,
           Roos9_gr_pres,Roos10_gr_pres,
           Roos11_gr_pres,Roos12_gr_pres,
           Roos13_gr_pres,Roos14_gr_pres,
           Roos15_gr_pres,Roos16_gr_pres,
           Roos17_gr_pres,Roos18_gr_pres,
           Roos19_gr_pres,Roos20_gr_pres,
           Roos21_gr_pres,Roos22_gr_pres,
           Roos23_gr_pres,Roos24_gr_pres)


Maximum<-c(Roos1_gr_max,Roos2_gr_max,
           Roos3_gr_max,Roos4_gr_max,
           Roos5_gr_max,Roos6_gr_max,
           Roos7_gr_max,Roos8_gr_max,
           Roos9_gr_max,Roos10_gr_max,
           Roos11_gr_max,Roos12_gr_max,
           Roos13_gr_max,Roos14_gr_max,
           Roos15_gr_max,Roos16_gr_max,
           Roos17_gr_max,Roos18_gr_max,
           Roos19_gr_max,Roos20_gr_max,
           Roos21_gr_max,Roos22_gr_max,
           Roos23_gr_max,Roos24_gr_max)

Low<-c(Roos1_gr_lw_ref, Roos2_gr_lw_ref, Roos3_gr_lw_ref,
       Roos4_gr_lw_ref, Roos5_gr_lw_ref, Roos6_gr_lw_ref,
       Roos7_gr_lw_ref, Roos8_gr_lw_ref, Roos9_gr_lw_ref,
       Roos10_gr_lw_ref, Roos11_gr_lw_ref, Roos12_gr_lw_ref, 
       Roos13_gr_lw_ref, Roos14_gr_lw_ref, Roos15_gr_lw_ref, 
       Roos16_gr_lw_ref, Roos17_gr_lw_ref, Roos18_gr_lw_ref, 
       Roos19_gr_lw_ref, Roos20_gr_lw_ref, Roos21_gr_lw_ref,
       Roos22_gr_lw_ref,Roos23_gr_lw_ref,Roos24_gr_lw_ref)

Moderate<-c(Roos1_gr_mod_ref, Roos2_gr_mod_ref, Roos3_gr_mod_ref,
            Roos4_gr_mod_ref, Roos5_gr_mod_ref, Roos6_gr_mod_ref,
            Roos7_gr_mod_ref, Roos8_gr_mod_ref, Roos9_gr_mod_ref,
            Roos10_gr_mod_ref, Roos11_gr_mod_ref, Roos12_gr_mod_ref, 
            Roos13_gr_mod_ref, Roos14_gr_mod_ref, Roos15_gr_mod_ref, 
            Roos16_gr_mod_ref, Roos17_gr_mod_ref, Roos18_gr_mod_ref, 
            Roos19_gr_mod_ref, Roos20_gr_mod_ref, Roos21_gr_mod_ref,
            Roos22_gr_mod_ref,Roos23_gr_mod_ref,Roos24_gr_mod_ref)

High<-c(Roos1_gr_high_ref, Roos2_gr_high_ref, Roos3_gr_high_ref,
        Roos4_gr_high_ref, Roos5_gr_high_ref, Roos6_gr_high_ref,
        Roos7_gr_high_ref, Roos8_gr_high_ref, Roos9_gr_high_ref,
        Roos10_gr_high_ref, Roos11_gr_high_ref, Roos12_gr_high_ref, 
        Roos13_gr_high_ref, Roos14_gr_high_ref, Roos15_gr_high_ref, 
        Roos16_gr_high_ref, Roos17_gr_high_ref, Roos18_gr_high_ref, 
        Roos19_gr_high_ref, Roos20_gr_high_ref, Roos21_gr_high_ref,
        Roos22_gr_high_ref,Roos23_gr_high_ref,Roos24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Roosgr",24)
Lowsite <- Rooslow
Modsite <- Roosmod
Highsite <-Rooshigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Roosgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                           Site, Low, Moderate, High,
                           Lowsite, Modsite, Highsite)

##Swinford

Swinfordpipgr<-subset(allspp4gr_ppip, Site=="Swinford")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Swinfordpipgr<-max(Swinfordpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Swinfordpipgr<- (max_Swinfordpipgr/100)*80

##calculate the site classification (reference range)

Swinfordhigh<- max_Swinfordpipgr > allsppgr_ppip_ref_high

Swinfordlow<- allsppgr_ppip_ref_low > max_Swinfordpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Swinfordpipgr
Swinfordmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Swinford1_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 1, replace=F))))
Swinford1_gr_max <- sum(Swinford1_gr > max20_Swinfordpipgr)
Swinford1_gr_max
Swinford1_gr_pres <- sum(Swinford1_gr > 0)
Swinford1_gr_pres
#number of sites which would be classified as low
Swinford1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford1_gr)
Swinford1_gr_lw_ref
#number of sites which would be classified as high
Swinford1_gr_high_ref <- sum( Swinford1_gr > allsppgr_ppip_ref_high)
Swinford1_gr_high_ref
#number of sites which would be classified as moderate
Swinford1_gr_mod_ref <- 1000 - (Swinford1_gr_high_ref + Swinford1_gr_lw_ref)
Swinford1_gr_mod_ref


#2 nights
Swinford2_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Swinford2_grframe<-data.frame(Swinford2_gr, samp2)
Swinford2_grframelong <- melt(Swinford2_grframe,id.vars="samp2")
Swinford2_grframelong_sum <- ddply(Swinford2_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford2_gr_max <- sum(Swinford2_grframelong_sum $max > max20_Swinfordpipgr)
Swinford2_gr_max
Swinford2_gr_pres <- sum(Swinford2_grframelong_sum $max > 0)
Swinford2_gr_pres

#number of sites which would be classified as low
Swinford2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford2_grframelong_sum$max)
Swinford2_gr_lw_ref
#number of sites which would be classified as high
Swinford2_gr_high_ref <- sum( Swinford2_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford2_gr_high_ref
#number of sites which would be classified as moderate
Swinford2_gr_mod_ref <- 1000 - (Swinford2_gr_high_ref + Swinford2_gr_lw_ref)
Swinford2_gr_mod_ref


#3 nights
Swinford3_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Swinford3_grframe<-data.frame(Swinford3_gr, samp2)
Swinford3_grframelong <- melt(Swinford3_grframe,id.vars="samp2")
Swinford3_grframelong_sum <- ddply(Swinford3_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford3_gr_max <- sum(Swinford3_grframelong_sum $max > max20_Swinfordpipgr)
Swinford3_gr_max
Swinford3_gr_pres <- sum(Swinford3_grframelong_sum $max > 0)
Swinford3_gr_pres

#number of sites which would be classified as low
Swinford3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford3_grframelong_sum$max)
Swinford3_gr_lw_ref
#number of sites which would be classified as high
Swinford3_gr_high_ref <- sum( Swinford3_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford3_gr_high_ref
#number of sites which would be classified as moderate
Swinford3_gr_mod_ref <- 1000 - (Swinford3_gr_high_ref + Swinford3_gr_lw_ref)
Swinford3_gr_mod_ref

#4 nights
Swinford4_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Swinford4_grframe<-data.frame(Swinford4_gr, samp2)
Swinford4_grframelong <- melt(Swinford4_grframe,id.vars="samp2")
Swinford4_grframelong_sum <- ddply(Swinford4_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford4_gr_max <- sum(Swinford4_grframelong_sum $max > max20_Swinfordpipgr)
Swinford4_gr_max
Swinford4_gr_pres <- sum(Swinford4_grframelong_sum $max > 0)
Swinford4_gr_pres

#number of sites which would be classified as low
Swinford4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford4_grframelong_sum$max)
Swinford4_gr_lw_ref
#number of sites which would be classified as high
Swinford4_gr_high_ref <- sum( Swinford4_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford4_gr_high_ref
#number of sites which would be classified as moderate
Swinford4_gr_mod_ref <- 1000 - (Swinford4_gr_high_ref + Swinford4_gr_lw_ref)
Swinford4_gr_mod_ref

#5 nights
Swinford5_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Swinford5_grframe<-data.frame(Swinford5_gr, samp2)
Swinford5_grframelong <- melt(Swinford5_grframe,id.vars="samp2")
Swinford5_grframelong_sum <- ddply(Swinford5_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford5_gr_max <- sum(Swinford5_grframelong_sum $max > max20_Swinfordpipgr)
Swinford5_gr_max
Swinford5_gr_pres <- sum(Swinford5_grframelong_sum $max > 0)
Swinford5_gr_pres

#number of sites which would be classified as low
Swinford5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford5_grframelong_sum$max)
Swinford5_gr_lw_ref
#number of sites which would be classified as high
Swinford5_gr_high_ref <- sum( Swinford5_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford5_gr_high_ref
#number of sites which would be classified as moderate
Swinford5_gr_mod_ref <- 1000 - (Swinford5_gr_high_ref + Swinford5_gr_lw_ref)
Swinford5_gr_mod_ref

#6 nights
Swinford6_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Swinford6_grframe<-data.frame(Swinford6_gr, samp2)
Swinford6_grframelong <- melt(Swinford6_grframe,id.vars="samp2")
Swinford6_grframelong_sum <- ddply(Swinford6_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford6_gr_max <- sum(Swinford6_grframelong_sum $max > max20_Swinfordpipgr)
Swinford6_gr_max
Swinford6_gr_pres <- sum(Swinford6_grframelong_sum $max > 0)
Swinford6_gr_pres

#number of sites which would be classified as low
Swinford6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford6_grframelong_sum$max)
Swinford6_gr_lw_ref
#number of sites which would be classified as high
Swinford6_gr_high_ref <- sum( Swinford6_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford6_gr_high_ref
#number of sites which would be classified as moderate
Swinford6_gr_mod_ref <- 1000 - (Swinford6_gr_high_ref + Swinford6_gr_lw_ref)
Swinford6_gr_mod_ref

#7 nights
Swinford7_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Swinford7_grframe<-data.frame(Swinford7_gr, samp2)
Swinford7_grframelong <- melt(Swinford7_grframe,id.vars="samp2")
Swinford7_grframelong_sum <- ddply(Swinford7_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford7_gr_max <- sum(Swinford7_grframelong_sum $max > max20_Swinfordpipgr)
Swinford7_gr_max
Swinford7_gr_pres <- sum(Swinford7_grframelong_sum $max > 0)
Swinford7_gr_pres

#number of sites which would be classified as low
Swinford7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford7_grframelong_sum$max)
Swinford7_gr_lw_ref
#number of sites which would be classified as high
Swinford7_gr_high_ref <- sum( Swinford7_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford7_gr_high_ref
#number of sites which would be classified as moderate
Swinford7_gr_mod_ref <- 1000 - (Swinford7_gr_high_ref + Swinford7_gr_lw_ref)
Swinford7_gr_mod_ref

#8 nights
Swinford8_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Swinford8_grframe<-data.frame(Swinford8_gr, samp2)
Swinford8_grframelong <- melt(Swinford8_grframe,id.vars="samp2")
Swinford8_grframelong_sum <- ddply(Swinford8_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford8_gr_max <- sum(Swinford8_grframelong_sum $max > max20_Swinfordpipgr)
Swinford8_gr_max
Swinford8_gr_pres <- sum(Swinford8_grframelong_sum $max > 0)
Swinford8_gr_pres

#number of sites which would be classified as low
Swinford8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford8_grframelong_sum$max)
Swinford8_gr_lw_ref
#number of sites which would be classified as high
Swinford8_gr_high_ref <- sum( Swinford8_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford8_gr_high_ref
#number of sites which would be classified as moderate
Swinford8_gr_mod_ref <- 1000 - (Swinford8_gr_high_ref + Swinford8_gr_lw_ref)
Swinford8_gr_mod_ref

#9 nights
Swinford9_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Swinford9_grframe<-data.frame(Swinford9_gr, samp2)
Swinford9_grframelong <- melt(Swinford9_grframe,id.vars="samp2")
Swinford9_grframelong_sum <- ddply(Swinford9_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Swinford9_gr_max <- sum(Swinford9_grframelong_sum $max > max20_Swinfordpipgr)
Swinford9_gr_max
Swinford9_gr_pres <- sum(Swinford9_grframelong_sum $max > 0)
Swinford9_gr_pres

#number of sites which would be classified as low
Swinford9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford9_grframelong_sum$max)
Swinford9_gr_lw_ref
#number of sites which would be classified as high
Swinford9_gr_high_ref <- sum( Swinford9_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford9_gr_high_ref
#number of sites which would be classified as moderate
Swinford9_gr_mod_ref <- 1000 - (Swinford9_gr_high_ref + Swinford9_gr_lw_ref)
Swinford9_gr_mod_ref

#10 detectors
Swinford10_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Swinford10_grframe<-data.frame(Swinford10_gr, samp2)
Swinford10_grframelong <- melt(Swinford10_grframe,id.vars="samp2")
Swinford10_grframelong_sum <- ddply(Swinford10_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford10_gr_max <- sum(Swinford10_grframelong_sum $max > max20_Swinfordpipgr)
Swinford10_gr_max
Swinford10_gr_pres <- sum(Swinford10_grframelong_sum $max > 0)
Swinford10_gr_pres

#number of sites which would be classified as low
Swinford10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford10_grframelong_sum$max)
Swinford10_gr_lw_ref
#number of sites which would be classified as high
Swinford10_gr_high_ref <- sum( Swinford10_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford10_gr_high_ref
#number of sites which would be classified as moderate
Swinford10_gr_mod_ref <- 1000 - (Swinford10_gr_high_ref + Swinford10_gr_lw_ref)
Swinford10_gr_mod_ref

#11 detectors
Swinford11_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Swinford11_grframe<-data.frame(Swinford11_gr, samp2)
Swinford11_grframelong <- melt(Swinford11_grframe,id.vars="samp2")
Swinford11_grframelong_sum <- ddply(Swinford11_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford11_gr_max <- sum(Swinford11_grframelong_sum $max > max20_Swinfordpipgr)
Swinford11_gr_max
Swinford11_gr_pres <- sum(Swinford11_grframelong_sum $max > 0)
Swinford11_gr_pres

#number of sites which would be classified as low
Swinford11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford11_grframelong_sum$max)
Swinford11_gr_lw_ref
#number of sites which would be classified as high
Swinford11_gr_high_ref <- sum( Swinford11_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford11_gr_high_ref
#number of sites which would be classified as moderate
Swinford11_gr_mod_ref <- 1000 - (Swinford11_gr_high_ref + Swinford11_gr_lw_ref)
Swinford11_gr_mod_ref

#12 detectors
Swinford12_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Swinford12_grframe<-data.frame(Swinford12_gr, samp2)
Swinford12_grframelong <- melt(Swinford12_grframe,id.vars="samp2")
Swinford12_grframelong_sum <- ddply(Swinford12_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford12_gr_max <- sum(Swinford12_grframelong_sum $max > max20_Swinfordpipgr)
Swinford12_gr_max
Swinford12_gr_pres <- sum(Swinford12_grframelong_sum $max > 0)
Swinford12_gr_pres

#number of sites which would be classified as low
Swinford12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford12_grframelong_sum$max)
Swinford12_gr_lw_ref
#number of sites which would be classified as high
Swinford12_gr_high_ref <- sum( Swinford12_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford12_gr_high_ref
#number of sites which would be classified as moderate
Swinford12_gr_mod_ref <- 1000 - (Swinford12_gr_high_ref + Swinford12_gr_lw_ref)
Swinford12_gr_mod_ref

#13 detectors
Swinford13_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Swinford13_grframe<-data.frame(Swinford13_gr, samp2)
Swinford13_grframelong <- melt(Swinford13_grframe,id.vars="samp2")
Swinford13_grframelong_sum <- ddply(Swinford13_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford13_gr_max <- sum(Swinford13_grframelong_sum $max > max20_Swinfordpipgr)
Swinford13_gr_max
Swinford13_gr_pres <- sum(Swinford13_grframelong_sum $max > 0)
Swinford13_gr_pres

#number of sites which would be classified as low
Swinford13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford13_grframelong_sum$max)
Swinford13_gr_lw_ref
#number of sites which would be classified as high
Swinford13_gr_high_ref <- sum( Swinford13_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford13_gr_high_ref
#number of sites which would be classified as moderate
Swinford13_gr_mod_ref <- 1000 - (Swinford13_gr_high_ref + Swinford13_gr_lw_ref)
Swinford13_gr_mod_ref

#14 detectors
Swinford14_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Swinford14_grframe<-data.frame(Swinford14_gr, samp2)
Swinford14_grframelong <- melt(Swinford14_grframe,id.vars="samp2")
Swinford14_grframelong_sum <- ddply(Swinford14_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford14_gr_max <- sum(Swinford14_grframelong_sum $max > max20_Swinfordpipgr)
Swinford14_gr_max
Swinford14_gr_pres <- sum(Swinford14_grframelong_sum $max > 0)
Swinford14_gr_pres

#number of sites which would be classified as low
Swinford14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford14_grframelong_sum$max)
Swinford14_gr_lw_ref
#number of sites which would be classified as high
Swinford14_gr_high_ref <- sum( Swinford14_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford14_gr_high_ref
#number of sites which would be classified as moderate
Swinford14_gr_mod_ref <- 1000 - (Swinford14_gr_high_ref + Swinford14_gr_lw_ref)
Swinford14_gr_mod_ref

#15 detectors
Swinford15_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Swinford15_grframe<-data.frame(Swinford15_gr, samp2)
Swinford15_grframelong <- melt(Swinford15_grframe,id.vars="samp2")
Swinford15_grframelong_sum <- ddply(Swinford15_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford15_gr_max <- sum(Swinford15_grframelong_sum $max > max20_Swinfordpipgr)
Swinford15_gr_max
Swinford15_gr_pres <- sum(Swinford15_grframelong_sum $max > 0)
Swinford15_gr_pres

#number of sites which would be classified as low
Swinford15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford15_grframelong_sum$max)
Swinford15_gr_lw_ref
#number of sites which would be classified as high
Swinford15_gr_high_ref <- sum( Swinford15_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford15_gr_high_ref
#number of sites which would be classified as moderate
Swinford15_gr_mod_ref <- 1000 - (Swinford15_gr_high_ref + Swinford15_gr_lw_ref)
Swinford15_gr_mod_ref

#16 detectors
Swinford16_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Swinford16_grframe<-data.frame(Swinford16_gr, samp2)
Swinford16_grframelong <- melt(Swinford16_grframe,id.vars="samp2")
Swinford16_grframelong_sum <- ddply(Swinford16_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford16_gr_max <- sum(Swinford16_grframelong_sum $max > max20_Swinfordpipgr)
Swinford16_gr_max
Swinford16_gr_pres <- sum(Swinford16_grframelong_sum $max > 0)
Swinford16_gr_pres

#number of sites which would be classified as low
Swinford16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford16_grframelong_sum$max)
Swinford16_gr_lw_ref
#number of sites which would be classified as high
Swinford16_gr_high_ref <- sum( Swinford16_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford16_gr_high_ref
#number of sites which would be classified as moderate
Swinford16_gr_mod_ref <- 1000 - (Swinford16_gr_high_ref + Swinford16_gr_lw_ref)
Swinford16_gr_mod_ref

#17 detectors
Swinford17_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Swinford17_grframe<-data.frame(Swinford17_gr, samp2)
Swinford17_grframelong <- melt(Swinford17_grframe,id.vars="samp2")
Swinford17_grframelong_sum <- ddply(Swinford17_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford17_gr_max <- sum(Swinford17_grframelong_sum $max > max20_Swinfordpipgr)
Swinford17_gr_max
Swinford17_gr_pres <- sum(Swinford17_grframelong_sum $max > 0)
Swinford17_gr_pres

#number of sites which would be classified as low
Swinford17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford17_grframelong_sum$max)
Swinford17_gr_lw_ref
#number of sites which would be classified as high
Swinford17_gr_high_ref <- sum( Swinford17_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford17_gr_high_ref
#number of sites which would be classified as moderate
Swinford17_gr_mod_ref <- 1000 - (Swinford17_gr_high_ref + Swinford17_gr_lw_ref)
Swinford17_gr_mod_ref

#18 detectors
Swinford18_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Swinford18_grframe<-data.frame(Swinford18_gr, samp2)
Swinford18_grframelong <- melt(Swinford18_grframe,id.vars="samp2")
Swinford18_grframelong_sum <- ddply(Swinford18_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford18_gr_max <- sum(Swinford18_grframelong_sum $max > max20_Swinfordpipgr)
Swinford18_gr_max
Swinford18_gr_pres <- sum(Swinford18_grframelong_sum $max > 0)
Swinford18_gr_pres

#number of sites which would be classified as low
Swinford18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford18_grframelong_sum$max)
Swinford18_gr_lw_ref
#number of sites which would be classified as high
Swinford18_gr_high_ref <- sum( Swinford18_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford18_gr_high_ref
#number of sites which would be classified as moderate
Swinford18_gr_mod_ref <- 1000 - (Swinford18_gr_high_ref + Swinford18_gr_lw_ref)
Swinford18_gr_mod_ref

#19 detectors
Swinford19_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Swinford19_grframe<-data.frame(Swinford19_gr, samp2)
Swinford19_grframelong <- melt(Swinford19_grframe,id.vars="samp2")
Swinford19_grframelong_sum <- ddply(Swinford19_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford19_gr_max <- sum(Swinford19_grframelong_sum $max > max20_Swinfordpipgr)
Swinford19_gr_max
Swinford19_gr_pres <- sum(Swinford19_grframelong_sum $max > 0)
Swinford19_gr_pres

#number of sites which would be classified as low
Swinford19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford19_grframelong_sum$max)
Swinford19_gr_lw_ref
#number of sites which would be classified as high
Swinford19_gr_high_ref <- sum( Swinford19_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford19_gr_high_ref
#number of sites which would be classified as moderate
Swinford19_gr_mod_ref <- 1000 - (Swinford19_gr_high_ref + Swinford19_gr_lw_ref)
Swinford19_gr_mod_ref

#20 detectors
Swinford20_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Swinford20_grframe<-data.frame(Swinford20_gr, samp2)
Swinford20_grframelong <- melt(Swinford20_grframe,id.vars="samp2")
Swinford20_grframelong_sum <- ddply(Swinford20_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford20_gr_max <- sum(Swinford20_grframelong_sum $max > max20_Swinfordpipgr)
Swinford20_gr_max
Swinford20_gr_pres <- sum(Swinford20_grframelong_sum $max > 0)
Swinford20_gr_pres

#number of sites which would be classified as low
Swinford20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford20_grframelong_sum$max)
Swinford20_gr_lw_ref
#number of sites which would be classified as high
Swinford20_gr_high_ref <- sum( Swinford20_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford20_gr_high_ref
#number of sites which would be classified as moderate
Swinford20_gr_mod_ref <- 1000 - (Swinford20_gr_high_ref + Swinford20_gr_lw_ref)
Swinford20_gr_mod_ref

#21 detectors
Swinford21_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Swinford21_grframe<-data.frame(Swinford21_gr, samp2)
Swinford21_grframelong <- melt(Swinford21_grframe,id.vars="samp2")
Swinford21_grframelong_sum <- ddply(Swinford21_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford21_gr_max <- sum(Swinford21_grframelong_sum $max > max20_Swinfordpipgr)
Swinford21_gr_max
Swinford21_gr_pres <- sum(Swinford21_grframelong_sum $max > 0)
Swinford21_gr_pres

#number of sites which would be classified as low
Swinford21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford21_grframelong_sum$max)
Swinford21_gr_lw_ref
#number of sites which would be classified as high
Swinford21_gr_high_ref <- sum( Swinford21_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford21_gr_high_ref
#number of sites which would be classified as moderate
Swinford21_gr_mod_ref <- 1000 - (Swinford21_gr_high_ref + Swinford21_gr_lw_ref)
Swinford21_gr_mod_ref

#22 detectors
Swinford22_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Swinford22_grframe<-data.frame(Swinford22_gr, samp2)
Swinford22_grframelong <- melt(Swinford22_grframe,id.vars="samp2")
Swinford22_grframelong_sum <- ddply(Swinford22_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford22_gr_max <- sum(Swinford22_grframelong_sum $max > max20_Swinfordpipgr)
Swinford22_gr_max
Swinford22_gr_pres <- sum(Swinford22_grframelong_sum $max > 0)
Swinford22_gr_pres

#number of sites which would be classified as low
Swinford22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford22_grframelong_sum$max)
Swinford22_gr_lw_ref
#number of sites which would be classified as high
Swinford22_gr_high_ref <- sum( Swinford22_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford22_gr_high_ref
#number of sites which would be classified as moderate
Swinford22_gr_mod_ref <- 1000 - (Swinford22_gr_high_ref + Swinford22_gr_lw_ref)
Swinford22_gr_mod_ref

#23 detectors
Swinford23_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Swinford23_grframe<-data.frame(Swinford23_gr, samp2)
Swinford23_grframelong <- melt(Swinford23_grframe,id.vars="samp2")
Swinford23_grframelong_sum <- ddply(Swinford23_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford23_gr_max <- sum(Swinford23_grframelong_sum $max > max20_Swinfordpipgr)
Swinford23_gr_max
Swinford23_gr_pres <- sum(Swinford23_grframelong_sum $max > 0)
Swinford23_gr_pres

#number of sites which would be classified as low
Swinford23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford23_grframelong_sum$max)
Swinford23_gr_lw_ref
#number of sites which would be classified as high
Swinford23_gr_high_ref <- sum( Swinford23_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford23_gr_high_ref
#number of sites which would be classified as moderate
Swinford23_gr_mod_ref <- 1000 - (Swinford23_gr_high_ref + Swinford23_gr_lw_ref)
Swinford23_gr_mod_ref

#24 detectors
Swinford24_gr<-(replicate(1000, (sample(Swinfordpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Swinford24_grframe<-data.frame(Swinford24_gr, samp2)
Swinford24_grframelong <- melt(Swinford24_grframe,id.vars="samp2")
Swinford24_grframelong_sum <- ddply(Swinford24_grframelong, "variable", summarise,
                                    N    = length(value),
                                    max  = max(value))
Swinford24_gr_max <- sum(Swinford24_grframelong_sum $max > max20_Swinfordpipgr)
Swinford24_gr_max
Swinford24_gr_pres <- sum(Swinford24_grframelong_sum $max > 0)
Swinford24_gr_pres

#number of sites which would be classified as low
Swinford24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Swinford24_grframelong_sum$max)
Swinford24_gr_lw_ref
#number of sites which would be classified as high
Swinford24_gr_high_ref <- sum( Swinford24_grframelong_sum$max > allsppgr_ppip_ref_high)
Swinford24_gr_high_ref
#number of sites which would be classified as moderate
Swinford24_gr_mod_ref <- 1000 - (Swinford24_gr_high_ref + Swinford24_gr_lw_ref)
Swinford24_gr_mod_ref

Present<-c(Swinford1_gr_pres,Swinford2_gr_pres,
           Swinford3_gr_pres,Swinford4_gr_pres,
           Swinford5_gr_pres,Swinford6_gr_pres,
           Swinford7_gr_pres,Swinford8_gr_pres,
           Swinford9_gr_pres,Swinford10_gr_pres,
           Swinford11_gr_pres,Swinford12_gr_pres,
           Swinford13_gr_pres,Swinford14_gr_pres,
           Swinford15_gr_pres,Swinford16_gr_pres,
           Swinford17_gr_pres,Swinford18_gr_pres,
           Swinford19_gr_pres,Swinford20_gr_pres,
           Swinford21_gr_pres,Swinford22_gr_pres,
           Swinford23_gr_pres,Swinford24_gr_pres)


Maximum<-c(Swinford1_gr_max,Swinford2_gr_max,
           Swinford3_gr_max,Swinford4_gr_max,
           Swinford5_gr_max,Swinford6_gr_max,
           Swinford7_gr_max,Swinford8_gr_max,
           Swinford9_gr_max,Swinford10_gr_max,
           Swinford11_gr_max,Swinford12_gr_max,
           Swinford13_gr_max,Swinford14_gr_max,
           Swinford15_gr_max,Swinford16_gr_max,
           Swinford17_gr_max,Swinford18_gr_max,
           Swinford19_gr_max,Swinford20_gr_max,
           Swinford21_gr_max,Swinford22_gr_max,
           Swinford23_gr_max,Swinford24_gr_max)

Low<-c(Swinford1_gr_lw_ref, Swinford2_gr_lw_ref, Swinford3_gr_lw_ref,
       Swinford4_gr_lw_ref, Swinford5_gr_lw_ref, Swinford6_gr_lw_ref,
       Swinford7_gr_lw_ref, Swinford8_gr_lw_ref, Swinford9_gr_lw_ref,
       Swinford10_gr_lw_ref, Swinford11_gr_lw_ref, Swinford12_gr_lw_ref, 
       Swinford13_gr_lw_ref, Swinford14_gr_lw_ref, Swinford15_gr_lw_ref, 
       Swinford16_gr_lw_ref, Swinford17_gr_lw_ref, Swinford18_gr_lw_ref, 
       Swinford19_gr_lw_ref, Swinford20_gr_lw_ref, Swinford21_gr_lw_ref,
       Swinford22_gr_lw_ref,Swinford23_gr_lw_ref,Swinford24_gr_lw_ref)

Moderate<-c(Swinford1_gr_mod_ref, Swinford2_gr_mod_ref, Swinford3_gr_mod_ref,
            Swinford4_gr_mod_ref, Swinford5_gr_mod_ref, Swinford6_gr_mod_ref,
            Swinford7_gr_mod_ref, Swinford8_gr_mod_ref, Swinford9_gr_mod_ref,
            Swinford10_gr_mod_ref, Swinford11_gr_mod_ref, Swinford12_gr_mod_ref, 
            Swinford13_gr_mod_ref, Swinford14_gr_mod_ref, Swinford15_gr_mod_ref, 
            Swinford16_gr_mod_ref, Swinford17_gr_mod_ref, Swinford18_gr_mod_ref, 
            Swinford19_gr_mod_ref, Swinford20_gr_mod_ref, Swinford21_gr_mod_ref,
            Swinford22_gr_mod_ref,Swinford23_gr_mod_ref,Swinford24_gr_mod_ref)

High<-c(Swinford1_gr_high_ref, Swinford2_gr_high_ref, Swinford3_gr_high_ref,
        Swinford4_gr_high_ref, Swinford5_gr_high_ref, Swinford6_gr_high_ref,
        Swinford7_gr_high_ref, Swinford8_gr_high_ref, Swinford9_gr_high_ref,
        Swinford10_gr_high_ref, Swinford11_gr_high_ref, Swinford12_gr_high_ref, 
        Swinford13_gr_high_ref, Swinford14_gr_high_ref, Swinford15_gr_high_ref, 
        Swinford16_gr_high_ref, Swinford17_gr_high_ref, Swinford18_gr_high_ref, 
        Swinford19_gr_high_ref, Swinford20_gr_high_ref, Swinford21_gr_high_ref,
        Swinford22_gr_high_ref,Swinford23_gr_high_ref,Swinford24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Swinfordgr",24)
Lowsite <- Swinfordlow
Modsite <- Swinfordmod
Highsite <-Swinfordhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Swinfordgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                               Site, Low, Moderate, High,
                               Lowsite, Modsite, Highsite)

##Tangy

Tangypipgr<-subset(allspp4gr_ppip, Site=="Tangy")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Tangypipgr<-max(Tangypipgr$Passes)

#calculate 20% from maximum nightly record

max20_Tangypipgr<- (max_Tangypipgr/100)*80

##calculate the site classification (reference range)

Tangyhigh<- max_Tangypipgr > allsppgr_ppip_ref_high

Tangylow<- allsppgr_ppip_ref_low > max_Tangypipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Tangypipgr
Tangymod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Tangy1_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 1, replace=F))))
Tangy1_gr_max <- sum(Tangy1_gr > max20_Tangypipgr)
Tangy1_gr_max
Tangy1_gr_pres <- sum(Tangy1_gr > 0)
Tangy1_gr_pres
#number of sites which would be classified as low
Tangy1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy1_gr)
Tangy1_gr_lw_ref
#number of sites which would be classified as high
Tangy1_gr_high_ref <- sum( Tangy1_gr > allsppgr_ppip_ref_high)
Tangy1_gr_high_ref
#number of sites which would be classified as moderate
Tangy1_gr_mod_ref <- 1000 - (Tangy1_gr_high_ref + Tangy1_gr_lw_ref)
Tangy1_gr_mod_ref


#2 nights
Tangy2_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Tangy2_grframe<-data.frame(Tangy2_gr, samp2)
Tangy2_grframelong <- melt(Tangy2_grframe,id.vars="samp2")
Tangy2_grframelong_sum <- ddply(Tangy2_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy2_gr_max <- sum(Tangy2_grframelong_sum $max > max20_Tangypipgr)
Tangy2_gr_max
Tangy2_gr_pres <- sum(Tangy2_grframelong_sum $max > 0)
Tangy2_gr_pres

#number of sites which would be classified as low
Tangy2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy2_grframelong_sum$max)
Tangy2_gr_lw_ref
#number of sites which would be classified as high
Tangy2_gr_high_ref <- sum( Tangy2_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy2_gr_high_ref
#number of sites which would be classified as moderate
Tangy2_gr_mod_ref <- 1000 - (Tangy2_gr_high_ref + Tangy2_gr_lw_ref)
Tangy2_gr_mod_ref


#3 nights
Tangy3_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Tangy3_grframe<-data.frame(Tangy3_gr, samp2)
Tangy3_grframelong <- melt(Tangy3_grframe,id.vars="samp2")
Tangy3_grframelong_sum <- ddply(Tangy3_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy3_gr_max <- sum(Tangy3_grframelong_sum $max > max20_Tangypipgr)
Tangy3_gr_max
Tangy3_gr_pres <- sum(Tangy3_grframelong_sum $max > 0)
Tangy3_gr_pres

#number of sites which would be classified as low
Tangy3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy3_grframelong_sum$max)
Tangy3_gr_lw_ref
#number of sites which would be classified as high
Tangy3_gr_high_ref <- sum( Tangy3_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy3_gr_high_ref
#number of sites which would be classified as moderate
Tangy3_gr_mod_ref <- 1000 - (Tangy3_gr_high_ref + Tangy3_gr_lw_ref)
Tangy3_gr_mod_ref

#4 nights
Tangy4_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Tangy4_grframe<-data.frame(Tangy4_gr, samp2)
Tangy4_grframelong <- melt(Tangy4_grframe,id.vars="samp2")
Tangy4_grframelong_sum <- ddply(Tangy4_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy4_gr_max <- sum(Tangy4_grframelong_sum $max > max20_Tangypipgr)
Tangy4_gr_max
Tangy4_gr_pres <- sum(Tangy4_grframelong_sum $max > 0)
Tangy4_gr_pres

#number of sites which would be classified as low
Tangy4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy4_grframelong_sum$max)
Tangy4_gr_lw_ref
#number of sites which would be classified as high
Tangy4_gr_high_ref <- sum( Tangy4_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy4_gr_high_ref
#number of sites which would be classified as moderate
Tangy4_gr_mod_ref <- 1000 - (Tangy4_gr_high_ref + Tangy4_gr_lw_ref)
Tangy4_gr_mod_ref

#5 nights
Tangy5_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Tangy5_grframe<-data.frame(Tangy5_gr, samp2)
Tangy5_grframelong <- melt(Tangy5_grframe,id.vars="samp2")
Tangy5_grframelong_sum <- ddply(Tangy5_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy5_gr_max <- sum(Tangy5_grframelong_sum $max > max20_Tangypipgr)
Tangy5_gr_max
Tangy5_gr_pres <- sum(Tangy5_grframelong_sum $max > 0)
Tangy5_gr_pres

#number of sites which would be classified as low
Tangy5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy5_grframelong_sum$max)
Tangy5_gr_lw_ref
#number of sites which would be classified as high
Tangy5_gr_high_ref <- sum( Tangy5_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy5_gr_high_ref
#number of sites which would be classified as moderate
Tangy5_gr_mod_ref <- 1000 - (Tangy5_gr_high_ref + Tangy5_gr_lw_ref)
Tangy5_gr_mod_ref

#6 nights
Tangy6_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Tangy6_grframe<-data.frame(Tangy6_gr, samp2)
Tangy6_grframelong <- melt(Tangy6_grframe,id.vars="samp2")
Tangy6_grframelong_sum <- ddply(Tangy6_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy6_gr_max <- sum(Tangy6_grframelong_sum $max > max20_Tangypipgr)
Tangy6_gr_max
Tangy6_gr_pres <- sum(Tangy6_grframelong_sum $max > 0)
Tangy6_gr_pres

#number of sites which would be classified as low
Tangy6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy6_grframelong_sum$max)
Tangy6_gr_lw_ref
#number of sites which would be classified as high
Tangy6_gr_high_ref <- sum( Tangy6_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy6_gr_high_ref
#number of sites which would be classified as moderate
Tangy6_gr_mod_ref <- 1000 - (Tangy6_gr_high_ref + Tangy6_gr_lw_ref)
Tangy6_gr_mod_ref

#7 nights
Tangy7_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Tangy7_grframe<-data.frame(Tangy7_gr, samp2)
Tangy7_grframelong <- melt(Tangy7_grframe,id.vars="samp2")
Tangy7_grframelong_sum <- ddply(Tangy7_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy7_gr_max <- sum(Tangy7_grframelong_sum $max > max20_Tangypipgr)
Tangy7_gr_max
Tangy7_gr_pres <- sum(Tangy7_grframelong_sum $max > 0)
Tangy7_gr_pres

#number of sites which would be classified as low
Tangy7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy7_grframelong_sum$max)
Tangy7_gr_lw_ref
#number of sites which would be classified as high
Tangy7_gr_high_ref <- sum( Tangy7_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy7_gr_high_ref
#number of sites which would be classified as moderate
Tangy7_gr_mod_ref <- 1000 - (Tangy7_gr_high_ref + Tangy7_gr_lw_ref)
Tangy7_gr_mod_ref

#8 nights
Tangy8_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Tangy8_grframe<-data.frame(Tangy8_gr, samp2)
Tangy8_grframelong <- melt(Tangy8_grframe,id.vars="samp2")
Tangy8_grframelong_sum <- ddply(Tangy8_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy8_gr_max <- sum(Tangy8_grframelong_sum $max > max20_Tangypipgr)
Tangy8_gr_max
Tangy8_gr_pres <- sum(Tangy8_grframelong_sum $max > 0)
Tangy8_gr_pres

#number of sites which would be classified as low
Tangy8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy8_grframelong_sum$max)
Tangy8_gr_lw_ref
#number of sites which would be classified as high
Tangy8_gr_high_ref <- sum( Tangy8_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy8_gr_high_ref
#number of sites which would be classified as moderate
Tangy8_gr_mod_ref <- 1000 - (Tangy8_gr_high_ref + Tangy8_gr_lw_ref)
Tangy8_gr_mod_ref

#9 nights
Tangy9_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Tangy9_grframe<-data.frame(Tangy9_gr, samp2)
Tangy9_grframelong <- melt(Tangy9_grframe,id.vars="samp2")
Tangy9_grframelong_sum <- ddply(Tangy9_grframelong, "variable", summarise,
                                N    = length(value),
                                max  = max(value))
Tangy9_gr_max <- sum(Tangy9_grframelong_sum $max > max20_Tangypipgr)
Tangy9_gr_max
Tangy9_gr_pres <- sum(Tangy9_grframelong_sum $max > 0)
Tangy9_gr_pres

#number of sites which would be classified as low
Tangy9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy9_grframelong_sum$max)
Tangy9_gr_lw_ref
#number of sites which would be classified as high
Tangy9_gr_high_ref <- sum( Tangy9_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy9_gr_high_ref
#number of sites which would be classified as moderate
Tangy9_gr_mod_ref <- 1000 - (Tangy9_gr_high_ref + Tangy9_gr_lw_ref)
Tangy9_gr_mod_ref

#10 detectors
Tangy10_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Tangy10_grframe<-data.frame(Tangy10_gr, samp2)
Tangy10_grframelong <- melt(Tangy10_grframe,id.vars="samp2")
Tangy10_grframelong_sum <- ddply(Tangy10_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy10_gr_max <- sum(Tangy10_grframelong_sum $max > max20_Tangypipgr)
Tangy10_gr_max
Tangy10_gr_pres <- sum(Tangy10_grframelong_sum $max > 0)
Tangy10_gr_pres

#number of sites which would be classified as low
Tangy10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy10_grframelong_sum$max)
Tangy10_gr_lw_ref
#number of sites which would be classified as high
Tangy10_gr_high_ref <- sum( Tangy10_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy10_gr_high_ref
#number of sites which would be classified as moderate
Tangy10_gr_mod_ref <- 1000 - (Tangy10_gr_high_ref + Tangy10_gr_lw_ref)
Tangy10_gr_mod_ref

#11 detectors
Tangy11_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Tangy11_grframe<-data.frame(Tangy11_gr, samp2)
Tangy11_grframelong <- melt(Tangy11_grframe,id.vars="samp2")
Tangy11_grframelong_sum <- ddply(Tangy11_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy11_gr_max <- sum(Tangy11_grframelong_sum $max > max20_Tangypipgr)
Tangy11_gr_max
Tangy11_gr_pres <- sum(Tangy11_grframelong_sum $max > 0)
Tangy11_gr_pres

#number of sites which would be classified as low
Tangy11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy11_grframelong_sum$max)
Tangy11_gr_lw_ref
#number of sites which would be classified as high
Tangy11_gr_high_ref <- sum( Tangy11_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy11_gr_high_ref
#number of sites which would be classified as moderate
Tangy11_gr_mod_ref <- 1000 - (Tangy11_gr_high_ref + Tangy11_gr_lw_ref)
Tangy11_gr_mod_ref

#12 detectors
Tangy12_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Tangy12_grframe<-data.frame(Tangy12_gr, samp2)
Tangy12_grframelong <- melt(Tangy12_grframe,id.vars="samp2")
Tangy12_grframelong_sum <- ddply(Tangy12_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy12_gr_max <- sum(Tangy12_grframelong_sum $max > max20_Tangypipgr)
Tangy12_gr_max
Tangy12_gr_pres <- sum(Tangy12_grframelong_sum $max > 0)
Tangy12_gr_pres

#number of sites which would be classified as low
Tangy12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy12_grframelong_sum$max)
Tangy12_gr_lw_ref
#number of sites which would be classified as high
Tangy12_gr_high_ref <- sum( Tangy12_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy12_gr_high_ref
#number of sites which would be classified as moderate
Tangy12_gr_mod_ref <- 1000 - (Tangy12_gr_high_ref + Tangy12_gr_lw_ref)
Tangy12_gr_mod_ref

#13 detectors
Tangy13_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Tangy13_grframe<-data.frame(Tangy13_gr, samp2)
Tangy13_grframelong <- melt(Tangy13_grframe,id.vars="samp2")
Tangy13_grframelong_sum <- ddply(Tangy13_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy13_gr_max <- sum(Tangy13_grframelong_sum $max > max20_Tangypipgr)
Tangy13_gr_max
Tangy13_gr_pres <- sum(Tangy13_grframelong_sum $max > 0)
Tangy13_gr_pres

#number of sites which would be classified as low
Tangy13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy13_grframelong_sum$max)
Tangy13_gr_lw_ref
#number of sites which would be classified as high
Tangy13_gr_high_ref <- sum( Tangy13_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy13_gr_high_ref
#number of sites which would be classified as moderate
Tangy13_gr_mod_ref <- 1000 - (Tangy13_gr_high_ref + Tangy13_gr_lw_ref)
Tangy13_gr_mod_ref

#14 detectors
Tangy14_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Tangy14_grframe<-data.frame(Tangy14_gr, samp2)
Tangy14_grframelong <- melt(Tangy14_grframe,id.vars="samp2")
Tangy14_grframelong_sum <- ddply(Tangy14_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy14_gr_max <- sum(Tangy14_grframelong_sum $max > max20_Tangypipgr)
Tangy14_gr_max
Tangy14_gr_pres <- sum(Tangy14_grframelong_sum $max > 0)
Tangy14_gr_pres

#number of sites which would be classified as low
Tangy14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy14_grframelong_sum$max)
Tangy14_gr_lw_ref
#number of sites which would be classified as high
Tangy14_gr_high_ref <- sum( Tangy14_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy14_gr_high_ref
#number of sites which would be classified as moderate
Tangy14_gr_mod_ref <- 1000 - (Tangy14_gr_high_ref + Tangy14_gr_lw_ref)
Tangy14_gr_mod_ref

#15 detectors
Tangy15_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Tangy15_grframe<-data.frame(Tangy15_gr, samp2)
Tangy15_grframelong <- melt(Tangy15_grframe,id.vars="samp2")
Tangy15_grframelong_sum <- ddply(Tangy15_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy15_gr_max <- sum(Tangy15_grframelong_sum $max > max20_Tangypipgr)
Tangy15_gr_max
Tangy15_gr_pres <- sum(Tangy15_grframelong_sum $max > 0)
Tangy15_gr_pres

#number of sites which would be classified as low
Tangy15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy15_grframelong_sum$max)
Tangy15_gr_lw_ref
#number of sites which would be classified as high
Tangy15_gr_high_ref <- sum( Tangy15_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy15_gr_high_ref
#number of sites which would be classified as moderate
Tangy15_gr_mod_ref <- 1000 - (Tangy15_gr_high_ref + Tangy15_gr_lw_ref)
Tangy15_gr_mod_ref

#16 detectors
Tangy16_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Tangy16_grframe<-data.frame(Tangy16_gr, samp2)
Tangy16_grframelong <- melt(Tangy16_grframe,id.vars="samp2")
Tangy16_grframelong_sum <- ddply(Tangy16_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy16_gr_max <- sum(Tangy16_grframelong_sum $max > max20_Tangypipgr)
Tangy16_gr_max
Tangy16_gr_pres <- sum(Tangy16_grframelong_sum $max > 0)
Tangy16_gr_pres

#number of sites which would be classified as low
Tangy16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy16_grframelong_sum$max)
Tangy16_gr_lw_ref
#number of sites which would be classified as high
Tangy16_gr_high_ref <- sum( Tangy16_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy16_gr_high_ref
#number of sites which would be classified as moderate
Tangy16_gr_mod_ref <- 1000 - (Tangy16_gr_high_ref + Tangy16_gr_lw_ref)
Tangy16_gr_mod_ref

#17 detectors
Tangy17_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Tangy17_grframe<-data.frame(Tangy17_gr, samp2)
Tangy17_grframelong <- melt(Tangy17_grframe,id.vars="samp2")
Tangy17_grframelong_sum <- ddply(Tangy17_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy17_gr_max <- sum(Tangy17_grframelong_sum $max > max20_Tangypipgr)
Tangy17_gr_max
Tangy17_gr_pres <- sum(Tangy17_grframelong_sum $max > 0)
Tangy17_gr_pres

#number of sites which would be classified as low
Tangy17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy17_grframelong_sum$max)
Tangy17_gr_lw_ref
#number of sites which would be classified as high
Tangy17_gr_high_ref <- sum( Tangy17_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy17_gr_high_ref
#number of sites which would be classified as moderate
Tangy17_gr_mod_ref <- 1000 - (Tangy17_gr_high_ref + Tangy17_gr_lw_ref)
Tangy17_gr_mod_ref

#18 detectors
Tangy18_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Tangy18_grframe<-data.frame(Tangy18_gr, samp2)
Tangy18_grframelong <- melt(Tangy18_grframe,id.vars="samp2")
Tangy18_grframelong_sum <- ddply(Tangy18_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy18_gr_max <- sum(Tangy18_grframelong_sum $max > max20_Tangypipgr)
Tangy18_gr_max
Tangy18_gr_pres <- sum(Tangy18_grframelong_sum $max > 0)
Tangy18_gr_pres

#number of sites which would be classified as low
Tangy18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy18_grframelong_sum$max)
Tangy18_gr_lw_ref
#number of sites which would be classified as high
Tangy18_gr_high_ref <- sum( Tangy18_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy18_gr_high_ref
#number of sites which would be classified as moderate
Tangy18_gr_mod_ref <- 1000 - (Tangy18_gr_high_ref + Tangy18_gr_lw_ref)
Tangy18_gr_mod_ref

#19 detectors
Tangy19_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Tangy19_grframe<-data.frame(Tangy19_gr, samp2)
Tangy19_grframelong <- melt(Tangy19_grframe,id.vars="samp2")
Tangy19_grframelong_sum <- ddply(Tangy19_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy19_gr_max <- sum(Tangy19_grframelong_sum $max > max20_Tangypipgr)
Tangy19_gr_max
Tangy19_gr_pres <- sum(Tangy19_grframelong_sum $max > 0)
Tangy19_gr_pres

#number of sites which would be classified as low
Tangy19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy19_grframelong_sum$max)
Tangy19_gr_lw_ref
#number of sites which would be classified as high
Tangy19_gr_high_ref <- sum( Tangy19_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy19_gr_high_ref
#number of sites which would be classified as moderate
Tangy19_gr_mod_ref <- 1000 - (Tangy19_gr_high_ref + Tangy19_gr_lw_ref)
Tangy19_gr_mod_ref

#20 detectors
Tangy20_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Tangy20_grframe<-data.frame(Tangy20_gr, samp2)
Tangy20_grframelong <- melt(Tangy20_grframe,id.vars="samp2")
Tangy20_grframelong_sum <- ddply(Tangy20_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy20_gr_max <- sum(Tangy20_grframelong_sum $max > max20_Tangypipgr)
Tangy20_gr_max
Tangy20_gr_pres <- sum(Tangy20_grframelong_sum $max > 0)
Tangy20_gr_pres

#number of sites which would be classified as low
Tangy20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy20_grframelong_sum$max)
Tangy20_gr_lw_ref
#number of sites which would be classified as high
Tangy20_gr_high_ref <- sum( Tangy20_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy20_gr_high_ref
#number of sites which would be classified as moderate
Tangy20_gr_mod_ref <- 1000 - (Tangy20_gr_high_ref + Tangy20_gr_lw_ref)
Tangy20_gr_mod_ref

#21 detectors
Tangy21_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Tangy21_grframe<-data.frame(Tangy21_gr, samp2)
Tangy21_grframelong <- melt(Tangy21_grframe,id.vars="samp2")
Tangy21_grframelong_sum <- ddply(Tangy21_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy21_gr_max <- sum(Tangy21_grframelong_sum $max > max20_Tangypipgr)
Tangy21_gr_max
Tangy21_gr_pres <- sum(Tangy21_grframelong_sum $max > 0)
Tangy21_gr_pres

#number of sites which would be classified as low
Tangy21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy21_grframelong_sum$max)
Tangy21_gr_lw_ref
#number of sites which would be classified as high
Tangy21_gr_high_ref <- sum( Tangy21_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy21_gr_high_ref
#number of sites which would be classified as moderate
Tangy21_gr_mod_ref <- 1000 - (Tangy21_gr_high_ref + Tangy21_gr_lw_ref)
Tangy21_gr_mod_ref

#22 detectors
Tangy22_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Tangy22_grframe<-data.frame(Tangy22_gr, samp2)
Tangy22_grframelong <- melt(Tangy22_grframe,id.vars="samp2")
Tangy22_grframelong_sum <- ddply(Tangy22_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy22_gr_max <- sum(Tangy22_grframelong_sum $max > max20_Tangypipgr)
Tangy22_gr_max
Tangy22_gr_pres <- sum(Tangy22_grframelong_sum $max > 0)
Tangy22_gr_pres

#number of sites which would be classified as low
Tangy22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy22_grframelong_sum$max)
Tangy22_gr_lw_ref
#number of sites which would be classified as high
Tangy22_gr_high_ref <- sum( Tangy22_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy22_gr_high_ref
#number of sites which would be classified as moderate
Tangy22_gr_mod_ref <- 1000 - (Tangy22_gr_high_ref + Tangy22_gr_lw_ref)
Tangy22_gr_mod_ref

#23 detectors
Tangy23_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Tangy23_grframe<-data.frame(Tangy23_gr, samp2)
Tangy23_grframelong <- melt(Tangy23_grframe,id.vars="samp2")
Tangy23_grframelong_sum <- ddply(Tangy23_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy23_gr_max <- sum(Tangy23_grframelong_sum $max > max20_Tangypipgr)
Tangy23_gr_max
Tangy23_gr_pres <- sum(Tangy23_grframelong_sum $max > 0)
Tangy23_gr_pres

#number of sites which would be classified as low
Tangy23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy23_grframelong_sum$max)
Tangy23_gr_lw_ref
#number of sites which would be classified as high
Tangy23_gr_high_ref <- sum( Tangy23_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy23_gr_high_ref
#number of sites which would be classified as moderate
Tangy23_gr_mod_ref <- 1000 - (Tangy23_gr_high_ref + Tangy23_gr_lw_ref)
Tangy23_gr_mod_ref

#24 detectors
Tangy24_gr<-(replicate(1000, (sample(Tangypipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Tangy24_grframe<-data.frame(Tangy24_gr, samp2)
Tangy24_grframelong <- melt(Tangy24_grframe,id.vars="samp2")
Tangy24_grframelong_sum <- ddply(Tangy24_grframelong, "variable", summarise,
                                 N    = length(value),
                                 max  = max(value))
Tangy24_gr_max <- sum(Tangy24_grframelong_sum $max > max20_Tangypipgr)
Tangy24_gr_max
Tangy24_gr_pres <- sum(Tangy24_grframelong_sum $max > 0)
Tangy24_gr_pres

#number of sites which would be classified as low
Tangy24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Tangy24_grframelong_sum$max)
Tangy24_gr_lw_ref
#number of sites which would be classified as high
Tangy24_gr_high_ref <- sum( Tangy24_grframelong_sum$max > allsppgr_ppip_ref_high)
Tangy24_gr_high_ref
#number of sites which would be classified as moderate
Tangy24_gr_mod_ref <- 1000 - (Tangy24_gr_high_ref + Tangy24_gr_lw_ref)
Tangy24_gr_mod_ref

Present<-c(Tangy1_gr_pres,Tangy2_gr_pres,
           Tangy3_gr_pres,Tangy4_gr_pres,
           Tangy5_gr_pres,Tangy6_gr_pres,
           Tangy7_gr_pres,Tangy8_gr_pres,
           Tangy9_gr_pres,Tangy10_gr_pres,
           Tangy11_gr_pres,Tangy12_gr_pres,
           Tangy13_gr_pres,Tangy14_gr_pres,
           Tangy15_gr_pres,Tangy16_gr_pres,
           Tangy17_gr_pres,Tangy18_gr_pres,
           Tangy19_gr_pres,Tangy20_gr_pres,
           Tangy21_gr_pres,Tangy22_gr_pres,
           Tangy23_gr_pres,Tangy24_gr_pres)


Maximum<-c(Tangy1_gr_max,Tangy2_gr_max,
           Tangy3_gr_max,Tangy4_gr_max,
           Tangy5_gr_max,Tangy6_gr_max,
           Tangy7_gr_max,Tangy8_gr_max,
           Tangy9_gr_max,Tangy10_gr_max,
           Tangy11_gr_max,Tangy12_gr_max,
           Tangy13_gr_max,Tangy14_gr_max,
           Tangy15_gr_max,Tangy16_gr_max,
           Tangy17_gr_max,Tangy18_gr_max,
           Tangy19_gr_max,Tangy20_gr_max,
           Tangy21_gr_max,Tangy22_gr_max,
           Tangy23_gr_max,Tangy24_gr_max)

Low<-c(Tangy1_gr_lw_ref, Tangy2_gr_lw_ref, Tangy3_gr_lw_ref,
       Tangy4_gr_lw_ref, Tangy5_gr_lw_ref, Tangy6_gr_lw_ref,
       Tangy7_gr_lw_ref, Tangy8_gr_lw_ref, Tangy9_gr_lw_ref,
       Tangy10_gr_lw_ref, Tangy11_gr_lw_ref, Tangy12_gr_lw_ref, 
       Tangy13_gr_lw_ref, Tangy14_gr_lw_ref, Tangy15_gr_lw_ref, 
       Tangy16_gr_lw_ref, Tangy17_gr_lw_ref, Tangy18_gr_lw_ref, 
       Tangy19_gr_lw_ref, Tangy20_gr_lw_ref, Tangy21_gr_lw_ref,
       Tangy22_gr_lw_ref,Tangy23_gr_lw_ref,Tangy24_gr_lw_ref)

Moderate<-c(Tangy1_gr_mod_ref, Tangy2_gr_mod_ref, Tangy3_gr_mod_ref,
            Tangy4_gr_mod_ref, Tangy5_gr_mod_ref, Tangy6_gr_mod_ref,
            Tangy7_gr_mod_ref, Tangy8_gr_mod_ref, Tangy9_gr_mod_ref,
            Tangy10_gr_mod_ref, Tangy11_gr_mod_ref, Tangy12_gr_mod_ref, 
            Tangy13_gr_mod_ref, Tangy14_gr_mod_ref, Tangy15_gr_mod_ref, 
            Tangy16_gr_mod_ref, Tangy17_gr_mod_ref, Tangy18_gr_mod_ref, 
            Tangy19_gr_mod_ref, Tangy20_gr_mod_ref, Tangy21_gr_mod_ref,
            Tangy22_gr_mod_ref,Tangy23_gr_mod_ref,Tangy24_gr_mod_ref)

High<-c(Tangy1_gr_high_ref, Tangy2_gr_high_ref, Tangy3_gr_high_ref,
        Tangy4_gr_high_ref, Tangy5_gr_high_ref, Tangy6_gr_high_ref,
        Tangy7_gr_high_ref, Tangy8_gr_high_ref, Tangy9_gr_high_ref,
        Tangy10_gr_high_ref, Tangy11_gr_high_ref, Tangy12_gr_high_ref, 
        Tangy13_gr_high_ref, Tangy14_gr_high_ref, Tangy15_gr_high_ref, 
        Tangy16_gr_high_ref, Tangy17_gr_high_ref, Tangy18_gr_high_ref, 
        Tangy19_gr_high_ref, Tangy20_gr_high_ref, Tangy21_gr_high_ref,
        Tangy22_gr_high_ref,Tangy23_gr_high_ref,Tangy24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Tangygr",24)
Lowsite <- Tangylow
Modsite <- Tangymod
Highsite <-Tangyhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Tangygr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                            Site, Low, Moderate, High,
                            Lowsite, Modsite, Highsite)

##Toddleburn

Toddleburnpipgr<-subset(allspp4gr_ppip, Site=="Toddleburn")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Toddleburnpipgr<-max(Toddleburnpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Toddleburnpipgr<- (max_Toddleburnpipgr/100)*80

##calculate the site classification (reference range)

Toddleburnhigh<- max_Toddleburnpipgr > allsppgr_ppip_ref_high

Toddleburnlow<- allsppgr_ppip_ref_low > max_Toddleburnpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Toddleburnpipgr
Toddleburnmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Toddleburn1_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 1, replace=F))))
Toddleburn1_gr_max <- sum(Toddleburn1_gr > max20_Toddleburnpipgr)
Toddleburn1_gr_max
Toddleburn1_gr_pres <- sum(Toddleburn1_gr > 0)
Toddleburn1_gr_pres
#number of sites which would be classified as low
Toddleburn1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn1_gr)
Toddleburn1_gr_lw_ref
#number of sites which would be classified as high
Toddleburn1_gr_high_ref <- sum( Toddleburn1_gr > allsppgr_ppip_ref_high)
Toddleburn1_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn1_gr_mod_ref <- 1000 - (Toddleburn1_gr_high_ref + Toddleburn1_gr_lw_ref)
Toddleburn1_gr_mod_ref


#2 nights
Toddleburn2_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Toddleburn2_grframe<-data.frame(Toddleburn2_gr, samp2)
Toddleburn2_grframelong <- melt(Toddleburn2_grframe,id.vars="samp2")
Toddleburn2_grframelong_sum <- ddply(Toddleburn2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn2_gr_max <- sum(Toddleburn2_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn2_gr_max
Toddleburn2_gr_pres <- sum(Toddleburn2_grframelong_sum $max > 0)
Toddleburn2_gr_pres

#number of sites which would be classified as low
Toddleburn2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn2_grframelong_sum$max)
Toddleburn2_gr_lw_ref
#number of sites which would be classified as high
Toddleburn2_gr_high_ref <- sum( Toddleburn2_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn2_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn2_gr_mod_ref <- 1000 - (Toddleburn2_gr_high_ref + Toddleburn2_gr_lw_ref)
Toddleburn2_gr_mod_ref


#3 nights
Toddleburn3_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Toddleburn3_grframe<-data.frame(Toddleburn3_gr, samp2)
Toddleburn3_grframelong <- melt(Toddleburn3_grframe,id.vars="samp2")
Toddleburn3_grframelong_sum <- ddply(Toddleburn3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn3_gr_max <- sum(Toddleburn3_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn3_gr_max
Toddleburn3_gr_pres <- sum(Toddleburn3_grframelong_sum $max > 0)
Toddleburn3_gr_pres

#number of sites which would be classified as low
Toddleburn3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn3_grframelong_sum$max)
Toddleburn3_gr_lw_ref
#number of sites which would be classified as high
Toddleburn3_gr_high_ref <- sum( Toddleburn3_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn3_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn3_gr_mod_ref <- 1000 - (Toddleburn3_gr_high_ref + Toddleburn3_gr_lw_ref)
Toddleburn3_gr_mod_ref

#4 nights
Toddleburn4_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Toddleburn4_grframe<-data.frame(Toddleburn4_gr, samp2)
Toddleburn4_grframelong <- melt(Toddleburn4_grframe,id.vars="samp2")
Toddleburn4_grframelong_sum <- ddply(Toddleburn4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn4_gr_max <- sum(Toddleburn4_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn4_gr_max
Toddleburn4_gr_pres <- sum(Toddleburn4_grframelong_sum $max > 0)
Toddleburn4_gr_pres

#number of sites which would be classified as low
Toddleburn4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn4_grframelong_sum$max)
Toddleburn4_gr_lw_ref
#number of sites which would be classified as high
Toddleburn4_gr_high_ref <- sum( Toddleburn4_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn4_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn4_gr_mod_ref <- 1000 - (Toddleburn4_gr_high_ref + Toddleburn4_gr_lw_ref)
Toddleburn4_gr_mod_ref

#5 nights
Toddleburn5_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Toddleburn5_grframe<-data.frame(Toddleburn5_gr, samp2)
Toddleburn5_grframelong <- melt(Toddleburn5_grframe,id.vars="samp2")
Toddleburn5_grframelong_sum <- ddply(Toddleburn5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn5_gr_max <- sum(Toddleburn5_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn5_gr_max
Toddleburn5_gr_pres <- sum(Toddleburn5_grframelong_sum $max > 0)
Toddleburn5_gr_pres

#number of sites which would be classified as low
Toddleburn5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn5_grframelong_sum$max)
Toddleburn5_gr_lw_ref
#number of sites which would be classified as high
Toddleburn5_gr_high_ref <- sum( Toddleburn5_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn5_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn5_gr_mod_ref <- 1000 - (Toddleburn5_gr_high_ref + Toddleburn5_gr_lw_ref)
Toddleburn5_gr_mod_ref

#6 nights
Toddleburn6_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Toddleburn6_grframe<-data.frame(Toddleburn6_gr, samp2)
Toddleburn6_grframelong <- melt(Toddleburn6_grframe,id.vars="samp2")
Toddleburn6_grframelong_sum <- ddply(Toddleburn6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn6_gr_max <- sum(Toddleburn6_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn6_gr_max
Toddleburn6_gr_pres <- sum(Toddleburn6_grframelong_sum $max > 0)
Toddleburn6_gr_pres

#number of sites which would be classified as low
Toddleburn6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn6_grframelong_sum$max)
Toddleburn6_gr_lw_ref
#number of sites which would be classified as high
Toddleburn6_gr_high_ref <- sum( Toddleburn6_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn6_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn6_gr_mod_ref <- 1000 - (Toddleburn6_gr_high_ref + Toddleburn6_gr_lw_ref)
Toddleburn6_gr_mod_ref

#7 nights
Toddleburn7_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Toddleburn7_grframe<-data.frame(Toddleburn7_gr, samp2)
Toddleburn7_grframelong <- melt(Toddleburn7_grframe,id.vars="samp2")
Toddleburn7_grframelong_sum <- ddply(Toddleburn7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn7_gr_max <- sum(Toddleburn7_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn7_gr_max
Toddleburn7_gr_pres <- sum(Toddleburn7_grframelong_sum $max > 0)
Toddleburn7_gr_pres

#number of sites which would be classified as low
Toddleburn7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn7_grframelong_sum$max)
Toddleburn7_gr_lw_ref
#number of sites which would be classified as high
Toddleburn7_gr_high_ref <- sum( Toddleburn7_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn7_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn7_gr_mod_ref <- 1000 - (Toddleburn7_gr_high_ref + Toddleburn7_gr_lw_ref)
Toddleburn7_gr_mod_ref

#8 nights
Toddleburn8_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Toddleburn8_grframe<-data.frame(Toddleburn8_gr, samp2)
Toddleburn8_grframelong <- melt(Toddleburn8_grframe,id.vars="samp2")
Toddleburn8_grframelong_sum <- ddply(Toddleburn8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn8_gr_max <- sum(Toddleburn8_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn8_gr_max
Toddleburn8_gr_pres <- sum(Toddleburn8_grframelong_sum $max > 0)
Toddleburn8_gr_pres

#number of sites which would be classified as low
Toddleburn8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn8_grframelong_sum$max)
Toddleburn8_gr_lw_ref
#number of sites which would be classified as high
Toddleburn8_gr_high_ref <- sum( Toddleburn8_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn8_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn8_gr_mod_ref <- 1000 - (Toddleburn8_gr_high_ref + Toddleburn8_gr_lw_ref)
Toddleburn8_gr_mod_ref

#9 nights
Toddleburn9_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Toddleburn9_grframe<-data.frame(Toddleburn9_gr, samp2)
Toddleburn9_grframelong <- melt(Toddleburn9_grframe,id.vars="samp2")
Toddleburn9_grframelong_sum <- ddply(Toddleburn9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Toddleburn9_gr_max <- sum(Toddleburn9_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn9_gr_max
Toddleburn9_gr_pres <- sum(Toddleburn9_grframelong_sum $max > 0)
Toddleburn9_gr_pres

#number of sites which would be classified as low
Toddleburn9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn9_grframelong_sum$max)
Toddleburn9_gr_lw_ref
#number of sites which would be classified as high
Toddleburn9_gr_high_ref <- sum( Toddleburn9_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn9_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn9_gr_mod_ref <- 1000 - (Toddleburn9_gr_high_ref + Toddleburn9_gr_lw_ref)
Toddleburn9_gr_mod_ref

#10 detectors
Toddleburn10_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Toddleburn10_grframe<-data.frame(Toddleburn10_gr, samp2)
Toddleburn10_grframelong <- melt(Toddleburn10_grframe,id.vars="samp2")
Toddleburn10_grframelong_sum <- ddply(Toddleburn10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn10_gr_max <- sum(Toddleburn10_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn10_gr_max
Toddleburn10_gr_pres <- sum(Toddleburn10_grframelong_sum $max > 0)
Toddleburn10_gr_pres

#number of sites which would be classified as low
Toddleburn10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn10_grframelong_sum$max)
Toddleburn10_gr_lw_ref
#number of sites which would be classified as high
Toddleburn10_gr_high_ref <- sum( Toddleburn10_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn10_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn10_gr_mod_ref <- 1000 - (Toddleburn10_gr_high_ref + Toddleburn10_gr_lw_ref)
Toddleburn10_gr_mod_ref

#11 detectors
Toddleburn11_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Toddleburn11_grframe<-data.frame(Toddleburn11_gr, samp2)
Toddleburn11_grframelong <- melt(Toddleburn11_grframe,id.vars="samp2")
Toddleburn11_grframelong_sum <- ddply(Toddleburn11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn11_gr_max <- sum(Toddleburn11_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn11_gr_max
Toddleburn11_gr_pres <- sum(Toddleburn11_grframelong_sum $max > 0)
Toddleburn11_gr_pres

#number of sites which would be classified as low
Toddleburn11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn11_grframelong_sum$max)
Toddleburn11_gr_lw_ref
#number of sites which would be classified as high
Toddleburn11_gr_high_ref <- sum( Toddleburn11_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn11_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn11_gr_mod_ref <- 1000 - (Toddleburn11_gr_high_ref + Toddleburn11_gr_lw_ref)
Toddleburn11_gr_mod_ref

#12 detectors
Toddleburn12_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Toddleburn12_grframe<-data.frame(Toddleburn12_gr, samp2)
Toddleburn12_grframelong <- melt(Toddleburn12_grframe,id.vars="samp2")
Toddleburn12_grframelong_sum <- ddply(Toddleburn12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn12_gr_max <- sum(Toddleburn12_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn12_gr_max
Toddleburn12_gr_pres <- sum(Toddleburn12_grframelong_sum $max > 0)
Toddleburn12_gr_pres

#number of sites which would be classified as low
Toddleburn12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn12_grframelong_sum$max)
Toddleburn12_gr_lw_ref
#number of sites which would be classified as high
Toddleburn12_gr_high_ref <- sum( Toddleburn12_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn12_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn12_gr_mod_ref <- 1000 - (Toddleburn12_gr_high_ref + Toddleburn12_gr_lw_ref)
Toddleburn12_gr_mod_ref

#13 detectors
Toddleburn13_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Toddleburn13_grframe<-data.frame(Toddleburn13_gr, samp2)
Toddleburn13_grframelong <- melt(Toddleburn13_grframe,id.vars="samp2")
Toddleburn13_grframelong_sum <- ddply(Toddleburn13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn13_gr_max <- sum(Toddleburn13_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn13_gr_max
Toddleburn13_gr_pres <- sum(Toddleburn13_grframelong_sum $max > 0)
Toddleburn13_gr_pres

#number of sites which would be classified as low
Toddleburn13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn13_grframelong_sum$max)
Toddleburn13_gr_lw_ref
#number of sites which would be classified as high
Toddleburn13_gr_high_ref <- sum( Toddleburn13_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn13_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn13_gr_mod_ref <- 1000 - (Toddleburn13_gr_high_ref + Toddleburn13_gr_lw_ref)
Toddleburn13_gr_mod_ref

#14 detectors
Toddleburn14_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Toddleburn14_grframe<-data.frame(Toddleburn14_gr, samp2)
Toddleburn14_grframelong <- melt(Toddleburn14_grframe,id.vars="samp2")
Toddleburn14_grframelong_sum <- ddply(Toddleburn14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn14_gr_max <- sum(Toddleburn14_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn14_gr_max
Toddleburn14_gr_pres <- sum(Toddleburn14_grframelong_sum $max > 0)
Toddleburn14_gr_pres

#number of sites which would be classified as low
Toddleburn14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn14_grframelong_sum$max)
Toddleburn14_gr_lw_ref
#number of sites which would be classified as high
Toddleburn14_gr_high_ref <- sum( Toddleburn14_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn14_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn14_gr_mod_ref <- 1000 - (Toddleburn14_gr_high_ref + Toddleburn14_gr_lw_ref)
Toddleburn14_gr_mod_ref

#15 detectors
Toddleburn15_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Toddleburn15_grframe<-data.frame(Toddleburn15_gr, samp2)
Toddleburn15_grframelong <- melt(Toddleburn15_grframe,id.vars="samp2")
Toddleburn15_grframelong_sum <- ddply(Toddleburn15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn15_gr_max <- sum(Toddleburn15_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn15_gr_max
Toddleburn15_gr_pres <- sum(Toddleburn15_grframelong_sum $max > 0)
Toddleburn15_gr_pres

#number of sites which would be classified as low
Toddleburn15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn15_grframelong_sum$max)
Toddleburn15_gr_lw_ref
#number of sites which would be classified as high
Toddleburn15_gr_high_ref <- sum( Toddleburn15_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn15_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn15_gr_mod_ref <- 1000 - (Toddleburn15_gr_high_ref + Toddleburn15_gr_lw_ref)
Toddleburn15_gr_mod_ref

#16 detectors
Toddleburn16_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Toddleburn16_grframe<-data.frame(Toddleburn16_gr, samp2)
Toddleburn16_grframelong <- melt(Toddleburn16_grframe,id.vars="samp2")
Toddleburn16_grframelong_sum <- ddply(Toddleburn16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn16_gr_max <- sum(Toddleburn16_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn16_gr_max
Toddleburn16_gr_pres <- sum(Toddleburn16_grframelong_sum $max > 0)
Toddleburn16_gr_pres

#number of sites which would be classified as low
Toddleburn16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn16_grframelong_sum$max)
Toddleburn16_gr_lw_ref
#number of sites which would be classified as high
Toddleburn16_gr_high_ref <- sum( Toddleburn16_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn16_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn16_gr_mod_ref <- 1000 - (Toddleburn16_gr_high_ref + Toddleburn16_gr_lw_ref)
Toddleburn16_gr_mod_ref

#17 detectors
Toddleburn17_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Toddleburn17_grframe<-data.frame(Toddleburn17_gr, samp2)
Toddleburn17_grframelong <- melt(Toddleburn17_grframe,id.vars="samp2")
Toddleburn17_grframelong_sum <- ddply(Toddleburn17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn17_gr_max <- sum(Toddleburn17_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn17_gr_max
Toddleburn17_gr_pres <- sum(Toddleburn17_grframelong_sum $max > 0)
Toddleburn17_gr_pres

#number of sites which would be classified as low
Toddleburn17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn17_grframelong_sum$max)
Toddleburn17_gr_lw_ref
#number of sites which would be classified as high
Toddleburn17_gr_high_ref <- sum( Toddleburn17_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn17_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn17_gr_mod_ref <- 1000 - (Toddleburn17_gr_high_ref + Toddleburn17_gr_lw_ref)
Toddleburn17_gr_mod_ref

#18 detectors
Toddleburn18_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Toddleburn18_grframe<-data.frame(Toddleburn18_gr, samp2)
Toddleburn18_grframelong <- melt(Toddleburn18_grframe,id.vars="samp2")
Toddleburn18_grframelong_sum <- ddply(Toddleburn18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn18_gr_max <- sum(Toddleburn18_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn18_gr_max
Toddleburn18_gr_pres <- sum(Toddleburn18_grframelong_sum $max > 0)
Toddleburn18_gr_pres

#number of sites which would be classified as low
Toddleburn18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn18_grframelong_sum$max)
Toddleburn18_gr_lw_ref
#number of sites which would be classified as high
Toddleburn18_gr_high_ref <- sum( Toddleburn18_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn18_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn18_gr_mod_ref <- 1000 - (Toddleburn18_gr_high_ref + Toddleburn18_gr_lw_ref)
Toddleburn18_gr_mod_ref

#19 detectors
Toddleburn19_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Toddleburn19_grframe<-data.frame(Toddleburn19_gr, samp2)
Toddleburn19_grframelong <- melt(Toddleburn19_grframe,id.vars="samp2")
Toddleburn19_grframelong_sum <- ddply(Toddleburn19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn19_gr_max <- sum(Toddleburn19_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn19_gr_max
Toddleburn19_gr_pres <- sum(Toddleburn19_grframelong_sum $max > 0)
Toddleburn19_gr_pres

#number of sites which would be classified as low
Toddleburn19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn19_grframelong_sum$max)
Toddleburn19_gr_lw_ref
#number of sites which would be classified as high
Toddleburn19_gr_high_ref <- sum( Toddleburn19_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn19_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn19_gr_mod_ref <- 1000 - (Toddleburn19_gr_high_ref + Toddleburn19_gr_lw_ref)
Toddleburn19_gr_mod_ref

#20 detectors
Toddleburn20_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Toddleburn20_grframe<-data.frame(Toddleburn20_gr, samp2)
Toddleburn20_grframelong <- melt(Toddleburn20_grframe,id.vars="samp2")
Toddleburn20_grframelong_sum <- ddply(Toddleburn20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn20_gr_max <- sum(Toddleburn20_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn20_gr_max
Toddleburn20_gr_pres <- sum(Toddleburn20_grframelong_sum $max > 0)
Toddleburn20_gr_pres

#number of sites which would be classified as low
Toddleburn20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn20_grframelong_sum$max)
Toddleburn20_gr_lw_ref
#number of sites which would be classified as high
Toddleburn20_gr_high_ref <- sum( Toddleburn20_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn20_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn20_gr_mod_ref <- 1000 - (Toddleburn20_gr_high_ref + Toddleburn20_gr_lw_ref)
Toddleburn20_gr_mod_ref

#21 detectors
Toddleburn21_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Toddleburn21_grframe<-data.frame(Toddleburn21_gr, samp2)
Toddleburn21_grframelong <- melt(Toddleburn21_grframe,id.vars="samp2")
Toddleburn21_grframelong_sum <- ddply(Toddleburn21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn21_gr_max <- sum(Toddleburn21_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn21_gr_max
Toddleburn21_gr_pres <- sum(Toddleburn21_grframelong_sum $max > 0)
Toddleburn21_gr_pres

#number of sites which would be classified as low
Toddleburn21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn21_grframelong_sum$max)
Toddleburn21_gr_lw_ref
#number of sites which would be classified as high
Toddleburn21_gr_high_ref <- sum( Toddleburn21_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn21_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn21_gr_mod_ref <- 1000 - (Toddleburn21_gr_high_ref + Toddleburn21_gr_lw_ref)
Toddleburn21_gr_mod_ref

#22 detectors
Toddleburn22_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Toddleburn22_grframe<-data.frame(Toddleburn22_gr, samp2)
Toddleburn22_grframelong <- melt(Toddleburn22_grframe,id.vars="samp2")
Toddleburn22_grframelong_sum <- ddply(Toddleburn22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn22_gr_max <- sum(Toddleburn22_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn22_gr_max
Toddleburn22_gr_pres <- sum(Toddleburn22_grframelong_sum $max > 0)
Toddleburn22_gr_pres

#number of sites which would be classified as low
Toddleburn22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn22_grframelong_sum$max)
Toddleburn22_gr_lw_ref
#number of sites which would be classified as high
Toddleburn22_gr_high_ref <- sum( Toddleburn22_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn22_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn22_gr_mod_ref <- 1000 - (Toddleburn22_gr_high_ref + Toddleburn22_gr_lw_ref)
Toddleburn22_gr_mod_ref

#23 detectors
Toddleburn23_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Toddleburn23_grframe<-data.frame(Toddleburn23_gr, samp2)
Toddleburn23_grframelong <- melt(Toddleburn23_grframe,id.vars="samp2")
Toddleburn23_grframelong_sum <- ddply(Toddleburn23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn23_gr_max <- sum(Toddleburn23_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn23_gr_max
Toddleburn23_gr_pres <- sum(Toddleburn23_grframelong_sum $max > 0)
Toddleburn23_gr_pres

#number of sites which would be classified as low
Toddleburn23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn23_grframelong_sum$max)
Toddleburn23_gr_lw_ref
#number of sites which would be classified as high
Toddleburn23_gr_high_ref <- sum( Toddleburn23_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn23_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn23_gr_mod_ref <- 1000 - (Toddleburn23_gr_high_ref + Toddleburn23_gr_lw_ref)
Toddleburn23_gr_mod_ref

#24 detectors
Toddleburn24_gr<-(replicate(1000, (sample(Toddleburnpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Toddleburn24_grframe<-data.frame(Toddleburn24_gr, samp2)
Toddleburn24_grframelong <- melt(Toddleburn24_grframe,id.vars="samp2")
Toddleburn24_grframelong_sum <- ddply(Toddleburn24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Toddleburn24_gr_max <- sum(Toddleburn24_grframelong_sum $max > max20_Toddleburnpipgr)
Toddleburn24_gr_max
Toddleburn24_gr_pres <- sum(Toddleburn24_grframelong_sum $max > 0)
Toddleburn24_gr_pres

#number of sites which would be classified as low
Toddleburn24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Toddleburn24_grframelong_sum$max)
Toddleburn24_gr_lw_ref
#number of sites which would be classified as high
Toddleburn24_gr_high_ref <- sum( Toddleburn24_grframelong_sum$max > allsppgr_ppip_ref_high)
Toddleburn24_gr_high_ref
#number of sites which would be classified as moderate
Toddleburn24_gr_mod_ref <- 1000 - (Toddleburn24_gr_high_ref + Toddleburn24_gr_lw_ref)
Toddleburn24_gr_mod_ref

Present<-c(Toddleburn1_gr_pres,Toddleburn2_gr_pres,
           Toddleburn3_gr_pres,Toddleburn4_gr_pres,
           Toddleburn5_gr_pres,Toddleburn6_gr_pres,
           Toddleburn7_gr_pres,Toddleburn8_gr_pres,
           Toddleburn9_gr_pres,Toddleburn10_gr_pres,
           Toddleburn11_gr_pres,Toddleburn12_gr_pres,
           Toddleburn13_gr_pres,Toddleburn14_gr_pres,
           Toddleburn15_gr_pres,Toddleburn16_gr_pres,
           Toddleburn17_gr_pres,Toddleburn18_gr_pres,
           Toddleburn19_gr_pres,Toddleburn20_gr_pres,
           Toddleburn21_gr_pres,Toddleburn22_gr_pres,
           Toddleburn23_gr_pres,Toddleburn24_gr_pres)


Maximum<-c(Toddleburn1_gr_max,Toddleburn2_gr_max,
           Toddleburn3_gr_max,Toddleburn4_gr_max,
           Toddleburn5_gr_max,Toddleburn6_gr_max,
           Toddleburn7_gr_max,Toddleburn8_gr_max,
           Toddleburn9_gr_max,Toddleburn10_gr_max,
           Toddleburn11_gr_max,Toddleburn12_gr_max,
           Toddleburn13_gr_max,Toddleburn14_gr_max,
           Toddleburn15_gr_max,Toddleburn16_gr_max,
           Toddleburn17_gr_max,Toddleburn18_gr_max,
           Toddleburn19_gr_max,Toddleburn20_gr_max,
           Toddleburn21_gr_max,Toddleburn22_gr_max,
           Toddleburn23_gr_max,Toddleburn24_gr_max)

Low<-c(Toddleburn1_gr_lw_ref, Toddleburn2_gr_lw_ref, Toddleburn3_gr_lw_ref,
       Toddleburn4_gr_lw_ref, Toddleburn5_gr_lw_ref, Toddleburn6_gr_lw_ref,
       Toddleburn7_gr_lw_ref, Toddleburn8_gr_lw_ref, Toddleburn9_gr_lw_ref,
       Toddleburn10_gr_lw_ref, Toddleburn11_gr_lw_ref, Toddleburn12_gr_lw_ref, 
       Toddleburn13_gr_lw_ref, Toddleburn14_gr_lw_ref, Toddleburn15_gr_lw_ref, 
       Toddleburn16_gr_lw_ref, Toddleburn17_gr_lw_ref, Toddleburn18_gr_lw_ref, 
       Toddleburn19_gr_lw_ref, Toddleburn20_gr_lw_ref, Toddleburn21_gr_lw_ref,
       Toddleburn22_gr_lw_ref,Toddleburn23_gr_lw_ref,Toddleburn24_gr_lw_ref)

Moderate<-c(Toddleburn1_gr_mod_ref, Toddleburn2_gr_mod_ref, Toddleburn3_gr_mod_ref,
            Toddleburn4_gr_mod_ref, Toddleburn5_gr_mod_ref, Toddleburn6_gr_mod_ref,
            Toddleburn7_gr_mod_ref, Toddleburn8_gr_mod_ref, Toddleburn9_gr_mod_ref,
            Toddleburn10_gr_mod_ref, Toddleburn11_gr_mod_ref, Toddleburn12_gr_mod_ref, 
            Toddleburn13_gr_mod_ref, Toddleburn14_gr_mod_ref, Toddleburn15_gr_mod_ref, 
            Toddleburn16_gr_mod_ref, Toddleburn17_gr_mod_ref, Toddleburn18_gr_mod_ref, 
            Toddleburn19_gr_mod_ref, Toddleburn20_gr_mod_ref, Toddleburn21_gr_mod_ref,
            Toddleburn22_gr_mod_ref,Toddleburn23_gr_mod_ref,Toddleburn24_gr_mod_ref)

High<-c(Toddleburn1_gr_high_ref, Toddleburn2_gr_high_ref, Toddleburn3_gr_high_ref,
        Toddleburn4_gr_high_ref, Toddleburn5_gr_high_ref, Toddleburn6_gr_high_ref,
        Toddleburn7_gr_high_ref, Toddleburn8_gr_high_ref, Toddleburn9_gr_high_ref,
        Toddleburn10_gr_high_ref, Toddleburn11_gr_high_ref, Toddleburn12_gr_high_ref, 
        Toddleburn13_gr_high_ref, Toddleburn14_gr_high_ref, Toddleburn15_gr_high_ref, 
        Toddleburn16_gr_high_ref, Toddleburn17_gr_high_ref, Toddleburn18_gr_high_ref, 
        Toddleburn19_gr_high_ref, Toddleburn20_gr_high_ref, Toddleburn21_gr_high_ref,
        Toddleburn22_gr_high_ref,Toddleburn23_gr_high_ref,Toddleburn24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Toddleburngr",24)
Lowsite <- Toddleburnlow
Modsite <- Toddleburnmod
Highsite <-Toddleburnhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Toddleburngr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##TweenBridgeMoor

TweenBridgeMoorpipgr<-subset(allspp4gr_ppip, Site=="TweenBridgeMoor")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_TweenBridgeMoorpipgr<-max(TweenBridgeMoorpipgr$Passes)

#calculate 20% from maximum nightly record

max20_TweenBridgeMoorpipgr<- (max_TweenBridgeMoorpipgr/100)*80

##calculate the site classification (reference range)

TweenBridgeMoorhigh<- max_TweenBridgeMoorpipgr > allsppgr_ppip_ref_high

TweenBridgeMoorlow<- allsppgr_ppip_ref_low > max_TweenBridgeMoorpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_TweenBridgeMoorpipgr
TweenBridgeMoormod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
TweenBridgeMoor1_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 1, replace=F))))
TweenBridgeMoor1_gr_max <- sum(TweenBridgeMoor1_gr > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor1_gr_max
TweenBridgeMoor1_gr_pres <- sum(TweenBridgeMoor1_gr > 0)
TweenBridgeMoor1_gr_pres
#number of sites which would be classified as low
TweenBridgeMoor1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor1_gr)
TweenBridgeMoor1_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor1_gr_high_ref <- sum( TweenBridgeMoor1_gr > allsppgr_ppip_ref_high)
TweenBridgeMoor1_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor1_gr_mod_ref <- 1000 - (TweenBridgeMoor1_gr_high_ref + TweenBridgeMoor1_gr_lw_ref)
TweenBridgeMoor1_gr_mod_ref


#2 nights
TweenBridgeMoor2_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
TweenBridgeMoor2_grframe<-data.frame(TweenBridgeMoor2_gr, samp2)
TweenBridgeMoor2_grframelong <- melt(TweenBridgeMoor2_grframe,id.vars="samp2")
TweenBridgeMoor2_grframelong_sum <- ddply(TweenBridgeMoor2_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor2_gr_max <- sum(TweenBridgeMoor2_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor2_gr_max
TweenBridgeMoor2_gr_pres <- sum(TweenBridgeMoor2_grframelong_sum $max > 0)
TweenBridgeMoor2_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor2_grframelong_sum$max)
TweenBridgeMoor2_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor2_gr_high_ref <- sum( TweenBridgeMoor2_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor2_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor2_gr_mod_ref <- 1000 - (TweenBridgeMoor2_gr_high_ref + TweenBridgeMoor2_gr_lw_ref)
TweenBridgeMoor2_gr_mod_ref


#3 nights
TweenBridgeMoor3_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
TweenBridgeMoor3_grframe<-data.frame(TweenBridgeMoor3_gr, samp2)
TweenBridgeMoor3_grframelong <- melt(TweenBridgeMoor3_grframe,id.vars="samp2")
TweenBridgeMoor3_grframelong_sum <- ddply(TweenBridgeMoor3_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor3_gr_max <- sum(TweenBridgeMoor3_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor3_gr_max
TweenBridgeMoor3_gr_pres <- sum(TweenBridgeMoor3_grframelong_sum $max > 0)
TweenBridgeMoor3_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor3_grframelong_sum$max)
TweenBridgeMoor3_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor3_gr_high_ref <- sum( TweenBridgeMoor3_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor3_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor3_gr_mod_ref <- 1000 - (TweenBridgeMoor3_gr_high_ref + TweenBridgeMoor3_gr_lw_ref)
TweenBridgeMoor3_gr_mod_ref

#4 nights
TweenBridgeMoor4_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
TweenBridgeMoor4_grframe<-data.frame(TweenBridgeMoor4_gr, samp2)
TweenBridgeMoor4_grframelong <- melt(TweenBridgeMoor4_grframe,id.vars="samp2")
TweenBridgeMoor4_grframelong_sum <- ddply(TweenBridgeMoor4_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor4_gr_max <- sum(TweenBridgeMoor4_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor4_gr_max
TweenBridgeMoor4_gr_pres <- sum(TweenBridgeMoor4_grframelong_sum $max > 0)
TweenBridgeMoor4_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor4_grframelong_sum$max)
TweenBridgeMoor4_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor4_gr_high_ref <- sum( TweenBridgeMoor4_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor4_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor4_gr_mod_ref <- 1000 - (TweenBridgeMoor4_gr_high_ref + TweenBridgeMoor4_gr_lw_ref)
TweenBridgeMoor4_gr_mod_ref

#5 nights
TweenBridgeMoor5_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
TweenBridgeMoor5_grframe<-data.frame(TweenBridgeMoor5_gr, samp2)
TweenBridgeMoor5_grframelong <- melt(TweenBridgeMoor5_grframe,id.vars="samp2")
TweenBridgeMoor5_grframelong_sum <- ddply(TweenBridgeMoor5_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor5_gr_max <- sum(TweenBridgeMoor5_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor5_gr_max
TweenBridgeMoor5_gr_pres <- sum(TweenBridgeMoor5_grframelong_sum $max > 0)
TweenBridgeMoor5_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor5_grframelong_sum$max)
TweenBridgeMoor5_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor5_gr_high_ref <- sum( TweenBridgeMoor5_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor5_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor5_gr_mod_ref <- 1000 - (TweenBridgeMoor5_gr_high_ref + TweenBridgeMoor5_gr_lw_ref)
TweenBridgeMoor5_gr_mod_ref

#6 nights
TweenBridgeMoor6_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
TweenBridgeMoor6_grframe<-data.frame(TweenBridgeMoor6_gr, samp2)
TweenBridgeMoor6_grframelong <- melt(TweenBridgeMoor6_grframe,id.vars="samp2")
TweenBridgeMoor6_grframelong_sum <- ddply(TweenBridgeMoor6_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor6_gr_max <- sum(TweenBridgeMoor6_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor6_gr_max
TweenBridgeMoor6_gr_pres <- sum(TweenBridgeMoor6_grframelong_sum $max > 0)
TweenBridgeMoor6_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor6_grframelong_sum$max)
TweenBridgeMoor6_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor6_gr_high_ref <- sum( TweenBridgeMoor6_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor6_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor6_gr_mod_ref <- 1000 - (TweenBridgeMoor6_gr_high_ref + TweenBridgeMoor6_gr_lw_ref)
TweenBridgeMoor6_gr_mod_ref

#7 nights
TweenBridgeMoor7_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
TweenBridgeMoor7_grframe<-data.frame(TweenBridgeMoor7_gr, samp2)
TweenBridgeMoor7_grframelong <- melt(TweenBridgeMoor7_grframe,id.vars="samp2")
TweenBridgeMoor7_grframelong_sum <- ddply(TweenBridgeMoor7_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor7_gr_max <- sum(TweenBridgeMoor7_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor7_gr_max
TweenBridgeMoor7_gr_pres <- sum(TweenBridgeMoor7_grframelong_sum $max > 0)
TweenBridgeMoor7_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor7_grframelong_sum$max)
TweenBridgeMoor7_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor7_gr_high_ref <- sum( TweenBridgeMoor7_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor7_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor7_gr_mod_ref <- 1000 - (TweenBridgeMoor7_gr_high_ref + TweenBridgeMoor7_gr_lw_ref)
TweenBridgeMoor7_gr_mod_ref

#8 nights
TweenBridgeMoor8_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
TweenBridgeMoor8_grframe<-data.frame(TweenBridgeMoor8_gr, samp2)
TweenBridgeMoor8_grframelong <- melt(TweenBridgeMoor8_grframe,id.vars="samp2")
TweenBridgeMoor8_grframelong_sum <- ddply(TweenBridgeMoor8_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor8_gr_max <- sum(TweenBridgeMoor8_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor8_gr_max
TweenBridgeMoor8_gr_pres <- sum(TweenBridgeMoor8_grframelong_sum $max > 0)
TweenBridgeMoor8_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor8_grframelong_sum$max)
TweenBridgeMoor8_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor8_gr_high_ref <- sum( TweenBridgeMoor8_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor8_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor8_gr_mod_ref <- 1000 - (TweenBridgeMoor8_gr_high_ref + TweenBridgeMoor8_gr_lw_ref)
TweenBridgeMoor8_gr_mod_ref

#9 nights
TweenBridgeMoor9_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
TweenBridgeMoor9_grframe<-data.frame(TweenBridgeMoor9_gr, samp2)
TweenBridgeMoor9_grframelong <- melt(TweenBridgeMoor9_grframe,id.vars="samp2")
TweenBridgeMoor9_grframelong_sum <- ddply(TweenBridgeMoor9_grframelong, "variable", summarise,
                                          N    = length(value),
                                          max  = max(value))
TweenBridgeMoor9_gr_max <- sum(TweenBridgeMoor9_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor9_gr_max
TweenBridgeMoor9_gr_pres <- sum(TweenBridgeMoor9_grframelong_sum $max > 0)
TweenBridgeMoor9_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor9_grframelong_sum$max)
TweenBridgeMoor9_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor9_gr_high_ref <- sum( TweenBridgeMoor9_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor9_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor9_gr_mod_ref <- 1000 - (TweenBridgeMoor9_gr_high_ref + TweenBridgeMoor9_gr_lw_ref)
TweenBridgeMoor9_gr_mod_ref

#10 detectors
TweenBridgeMoor10_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
TweenBridgeMoor10_grframe<-data.frame(TweenBridgeMoor10_gr, samp2)
TweenBridgeMoor10_grframelong <- melt(TweenBridgeMoor10_grframe,id.vars="samp2")
TweenBridgeMoor10_grframelong_sum <- ddply(TweenBridgeMoor10_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor10_gr_max <- sum(TweenBridgeMoor10_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor10_gr_max
TweenBridgeMoor10_gr_pres <- sum(TweenBridgeMoor10_grframelong_sum $max > 0)
TweenBridgeMoor10_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor10_grframelong_sum$max)
TweenBridgeMoor10_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor10_gr_high_ref <- sum( TweenBridgeMoor10_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor10_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor10_gr_mod_ref <- 1000 - (TweenBridgeMoor10_gr_high_ref + TweenBridgeMoor10_gr_lw_ref)
TweenBridgeMoor10_gr_mod_ref

#11 detectors
TweenBridgeMoor11_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
TweenBridgeMoor11_grframe<-data.frame(TweenBridgeMoor11_gr, samp2)
TweenBridgeMoor11_grframelong <- melt(TweenBridgeMoor11_grframe,id.vars="samp2")
TweenBridgeMoor11_grframelong_sum <- ddply(TweenBridgeMoor11_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor11_gr_max <- sum(TweenBridgeMoor11_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor11_gr_max
TweenBridgeMoor11_gr_pres <- sum(TweenBridgeMoor11_grframelong_sum $max > 0)
TweenBridgeMoor11_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor11_grframelong_sum$max)
TweenBridgeMoor11_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor11_gr_high_ref <- sum( TweenBridgeMoor11_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor11_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor11_gr_mod_ref <- 1000 - (TweenBridgeMoor11_gr_high_ref + TweenBridgeMoor11_gr_lw_ref)
TweenBridgeMoor11_gr_mod_ref

#12 detectors
TweenBridgeMoor12_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
TweenBridgeMoor12_grframe<-data.frame(TweenBridgeMoor12_gr, samp2)
TweenBridgeMoor12_grframelong <- melt(TweenBridgeMoor12_grframe,id.vars="samp2")
TweenBridgeMoor12_grframelong_sum <- ddply(TweenBridgeMoor12_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor12_gr_max <- sum(TweenBridgeMoor12_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor12_gr_max
TweenBridgeMoor12_gr_pres <- sum(TweenBridgeMoor12_grframelong_sum $max > 0)
TweenBridgeMoor12_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor12_grframelong_sum$max)
TweenBridgeMoor12_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor12_gr_high_ref <- sum( TweenBridgeMoor12_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor12_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor12_gr_mod_ref <- 1000 - (TweenBridgeMoor12_gr_high_ref + TweenBridgeMoor12_gr_lw_ref)
TweenBridgeMoor12_gr_mod_ref

#13 detectors
TweenBridgeMoor13_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
TweenBridgeMoor13_grframe<-data.frame(TweenBridgeMoor13_gr, samp2)
TweenBridgeMoor13_grframelong <- melt(TweenBridgeMoor13_grframe,id.vars="samp2")
TweenBridgeMoor13_grframelong_sum <- ddply(TweenBridgeMoor13_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor13_gr_max <- sum(TweenBridgeMoor13_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor13_gr_max
TweenBridgeMoor13_gr_pres <- sum(TweenBridgeMoor13_grframelong_sum $max > 0)
TweenBridgeMoor13_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor13_grframelong_sum$max)
TweenBridgeMoor13_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor13_gr_high_ref <- sum( TweenBridgeMoor13_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor13_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor13_gr_mod_ref <- 1000 - (TweenBridgeMoor13_gr_high_ref + TweenBridgeMoor13_gr_lw_ref)
TweenBridgeMoor13_gr_mod_ref

#14 detectors
TweenBridgeMoor14_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
TweenBridgeMoor14_grframe<-data.frame(TweenBridgeMoor14_gr, samp2)
TweenBridgeMoor14_grframelong <- melt(TweenBridgeMoor14_grframe,id.vars="samp2")
TweenBridgeMoor14_grframelong_sum <- ddply(TweenBridgeMoor14_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor14_gr_max <- sum(TweenBridgeMoor14_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor14_gr_max
TweenBridgeMoor14_gr_pres <- sum(TweenBridgeMoor14_grframelong_sum $max > 0)
TweenBridgeMoor14_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor14_grframelong_sum$max)
TweenBridgeMoor14_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor14_gr_high_ref <- sum( TweenBridgeMoor14_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor14_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor14_gr_mod_ref <- 1000 - (TweenBridgeMoor14_gr_high_ref + TweenBridgeMoor14_gr_lw_ref)
TweenBridgeMoor14_gr_mod_ref

#15 detectors
TweenBridgeMoor15_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
TweenBridgeMoor15_grframe<-data.frame(TweenBridgeMoor15_gr, samp2)
TweenBridgeMoor15_grframelong <- melt(TweenBridgeMoor15_grframe,id.vars="samp2")
TweenBridgeMoor15_grframelong_sum <- ddply(TweenBridgeMoor15_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor15_gr_max <- sum(TweenBridgeMoor15_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor15_gr_max
TweenBridgeMoor15_gr_pres <- sum(TweenBridgeMoor15_grframelong_sum $max > 0)
TweenBridgeMoor15_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor15_grframelong_sum$max)
TweenBridgeMoor15_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor15_gr_high_ref <- sum( TweenBridgeMoor15_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor15_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor15_gr_mod_ref <- 1000 - (TweenBridgeMoor15_gr_high_ref + TweenBridgeMoor15_gr_lw_ref)
TweenBridgeMoor15_gr_mod_ref

#16 detectors
TweenBridgeMoor16_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
TweenBridgeMoor16_grframe<-data.frame(TweenBridgeMoor16_gr, samp2)
TweenBridgeMoor16_grframelong <- melt(TweenBridgeMoor16_grframe,id.vars="samp2")
TweenBridgeMoor16_grframelong_sum <- ddply(TweenBridgeMoor16_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor16_gr_max <- sum(TweenBridgeMoor16_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor16_gr_max
TweenBridgeMoor16_gr_pres <- sum(TweenBridgeMoor16_grframelong_sum $max > 0)
TweenBridgeMoor16_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor16_grframelong_sum$max)
TweenBridgeMoor16_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor16_gr_high_ref <- sum( TweenBridgeMoor16_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor16_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor16_gr_mod_ref <- 1000 - (TweenBridgeMoor16_gr_high_ref + TweenBridgeMoor16_gr_lw_ref)
TweenBridgeMoor16_gr_mod_ref

#17 detectors
TweenBridgeMoor17_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
TweenBridgeMoor17_grframe<-data.frame(TweenBridgeMoor17_gr, samp2)
TweenBridgeMoor17_grframelong <- melt(TweenBridgeMoor17_grframe,id.vars="samp2")
TweenBridgeMoor17_grframelong_sum <- ddply(TweenBridgeMoor17_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor17_gr_max <- sum(TweenBridgeMoor17_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor17_gr_max
TweenBridgeMoor17_gr_pres <- sum(TweenBridgeMoor17_grframelong_sum $max > 0)
TweenBridgeMoor17_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor17_grframelong_sum$max)
TweenBridgeMoor17_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor17_gr_high_ref <- sum( TweenBridgeMoor17_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor17_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor17_gr_mod_ref <- 1000 - (TweenBridgeMoor17_gr_high_ref + TweenBridgeMoor17_gr_lw_ref)
TweenBridgeMoor17_gr_mod_ref

#18 detectors
TweenBridgeMoor18_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
TweenBridgeMoor18_grframe<-data.frame(TweenBridgeMoor18_gr, samp2)
TweenBridgeMoor18_grframelong <- melt(TweenBridgeMoor18_grframe,id.vars="samp2")
TweenBridgeMoor18_grframelong_sum <- ddply(TweenBridgeMoor18_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor18_gr_max <- sum(TweenBridgeMoor18_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor18_gr_max
TweenBridgeMoor18_gr_pres <- sum(TweenBridgeMoor18_grframelong_sum $max > 0)
TweenBridgeMoor18_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor18_grframelong_sum$max)
TweenBridgeMoor18_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor18_gr_high_ref <- sum( TweenBridgeMoor18_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor18_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor18_gr_mod_ref <- 1000 - (TweenBridgeMoor18_gr_high_ref + TweenBridgeMoor18_gr_lw_ref)
TweenBridgeMoor18_gr_mod_ref

#19 detectors
TweenBridgeMoor19_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
TweenBridgeMoor19_grframe<-data.frame(TweenBridgeMoor19_gr, samp2)
TweenBridgeMoor19_grframelong <- melt(TweenBridgeMoor19_grframe,id.vars="samp2")
TweenBridgeMoor19_grframelong_sum <- ddply(TweenBridgeMoor19_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor19_gr_max <- sum(TweenBridgeMoor19_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor19_gr_max
TweenBridgeMoor19_gr_pres <- sum(TweenBridgeMoor19_grframelong_sum $max > 0)
TweenBridgeMoor19_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor19_grframelong_sum$max)
TweenBridgeMoor19_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor19_gr_high_ref <- sum( TweenBridgeMoor19_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor19_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor19_gr_mod_ref <- 1000 - (TweenBridgeMoor19_gr_high_ref + TweenBridgeMoor19_gr_lw_ref)
TweenBridgeMoor19_gr_mod_ref

#20 detectors
TweenBridgeMoor20_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
TweenBridgeMoor20_grframe<-data.frame(TweenBridgeMoor20_gr, samp2)
TweenBridgeMoor20_grframelong <- melt(TweenBridgeMoor20_grframe,id.vars="samp2")
TweenBridgeMoor20_grframelong_sum <- ddply(TweenBridgeMoor20_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor20_gr_max <- sum(TweenBridgeMoor20_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor20_gr_max
TweenBridgeMoor20_gr_pres <- sum(TweenBridgeMoor20_grframelong_sum $max > 0)
TweenBridgeMoor20_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor20_grframelong_sum$max)
TweenBridgeMoor20_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor20_gr_high_ref <- sum( TweenBridgeMoor20_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor20_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor20_gr_mod_ref <- 1000 - (TweenBridgeMoor20_gr_high_ref + TweenBridgeMoor20_gr_lw_ref)
TweenBridgeMoor20_gr_mod_ref

#21 detectors
TweenBridgeMoor21_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
TweenBridgeMoor21_grframe<-data.frame(TweenBridgeMoor21_gr, samp2)
TweenBridgeMoor21_grframelong <- melt(TweenBridgeMoor21_grframe,id.vars="samp2")
TweenBridgeMoor21_grframelong_sum <- ddply(TweenBridgeMoor21_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor21_gr_max <- sum(TweenBridgeMoor21_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor21_gr_max
TweenBridgeMoor21_gr_pres <- sum(TweenBridgeMoor21_grframelong_sum $max > 0)
TweenBridgeMoor21_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor21_grframelong_sum$max)
TweenBridgeMoor21_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor21_gr_high_ref <- sum( TweenBridgeMoor21_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor21_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor21_gr_mod_ref <- 1000 - (TweenBridgeMoor21_gr_high_ref + TweenBridgeMoor21_gr_lw_ref)
TweenBridgeMoor21_gr_mod_ref

#22 detectors
TweenBridgeMoor22_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
TweenBridgeMoor22_grframe<-data.frame(TweenBridgeMoor22_gr, samp2)
TweenBridgeMoor22_grframelong <- melt(TweenBridgeMoor22_grframe,id.vars="samp2")
TweenBridgeMoor22_grframelong_sum <- ddply(TweenBridgeMoor22_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor22_gr_max <- sum(TweenBridgeMoor22_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor22_gr_max
TweenBridgeMoor22_gr_pres <- sum(TweenBridgeMoor22_grframelong_sum $max > 0)
TweenBridgeMoor22_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor22_grframelong_sum$max)
TweenBridgeMoor22_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor22_gr_high_ref <- sum( TweenBridgeMoor22_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor22_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor22_gr_mod_ref <- 1000 - (TweenBridgeMoor22_gr_high_ref + TweenBridgeMoor22_gr_lw_ref)
TweenBridgeMoor22_gr_mod_ref

#23 detectors
TweenBridgeMoor23_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
TweenBridgeMoor23_grframe<-data.frame(TweenBridgeMoor23_gr, samp2)
TweenBridgeMoor23_grframelong <- melt(TweenBridgeMoor23_grframe,id.vars="samp2")
TweenBridgeMoor23_grframelong_sum <- ddply(TweenBridgeMoor23_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor23_gr_max <- sum(TweenBridgeMoor23_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor23_gr_max
TweenBridgeMoor23_gr_pres <- sum(TweenBridgeMoor23_grframelong_sum $max > 0)
TweenBridgeMoor23_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor23_grframelong_sum$max)
TweenBridgeMoor23_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor23_gr_high_ref <- sum( TweenBridgeMoor23_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor23_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor23_gr_mod_ref <- 1000 - (TweenBridgeMoor23_gr_high_ref + TweenBridgeMoor23_gr_lw_ref)
TweenBridgeMoor23_gr_mod_ref

#24 detectors
TweenBridgeMoor24_gr<-(replicate(1000, (sample(TweenBridgeMoorpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
TweenBridgeMoor24_grframe<-data.frame(TweenBridgeMoor24_gr, samp2)
TweenBridgeMoor24_grframelong <- melt(TweenBridgeMoor24_grframe,id.vars="samp2")
TweenBridgeMoor24_grframelong_sum <- ddply(TweenBridgeMoor24_grframelong, "variable", summarise,
                                           N    = length(value),
                                           max  = max(value))
TweenBridgeMoor24_gr_max <- sum(TweenBridgeMoor24_grframelong_sum $max > max20_TweenBridgeMoorpipgr)
TweenBridgeMoor24_gr_max
TweenBridgeMoor24_gr_pres <- sum(TweenBridgeMoor24_grframelong_sum $max > 0)
TweenBridgeMoor24_gr_pres

#number of sites which would be classified as low
TweenBridgeMoor24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= TweenBridgeMoor24_grframelong_sum$max)
TweenBridgeMoor24_gr_lw_ref
#number of sites which would be classified as high
TweenBridgeMoor24_gr_high_ref <- sum( TweenBridgeMoor24_grframelong_sum$max > allsppgr_ppip_ref_high)
TweenBridgeMoor24_gr_high_ref
#number of sites which would be classified as moderate
TweenBridgeMoor24_gr_mod_ref <- 1000 - (TweenBridgeMoor24_gr_high_ref + TweenBridgeMoor24_gr_lw_ref)
TweenBridgeMoor24_gr_mod_ref

Present<-c(TweenBridgeMoor1_gr_pres,TweenBridgeMoor2_gr_pres,
           TweenBridgeMoor3_gr_pres,TweenBridgeMoor4_gr_pres,
           TweenBridgeMoor5_gr_pres,TweenBridgeMoor6_gr_pres,
           TweenBridgeMoor7_gr_pres,TweenBridgeMoor8_gr_pres,
           TweenBridgeMoor9_gr_pres,TweenBridgeMoor10_gr_pres,
           TweenBridgeMoor11_gr_pres,TweenBridgeMoor12_gr_pres,
           TweenBridgeMoor13_gr_pres,TweenBridgeMoor14_gr_pres,
           TweenBridgeMoor15_gr_pres,TweenBridgeMoor16_gr_pres,
           TweenBridgeMoor17_gr_pres,TweenBridgeMoor18_gr_pres,
           TweenBridgeMoor19_gr_pres,TweenBridgeMoor20_gr_pres,
           TweenBridgeMoor21_gr_pres,TweenBridgeMoor22_gr_pres,
           TweenBridgeMoor23_gr_pres,TweenBridgeMoor24_gr_pres)


Maximum<-c(TweenBridgeMoor1_gr_max,TweenBridgeMoor2_gr_max,
           TweenBridgeMoor3_gr_max,TweenBridgeMoor4_gr_max,
           TweenBridgeMoor5_gr_max,TweenBridgeMoor6_gr_max,
           TweenBridgeMoor7_gr_max,TweenBridgeMoor8_gr_max,
           TweenBridgeMoor9_gr_max,TweenBridgeMoor10_gr_max,
           TweenBridgeMoor11_gr_max,TweenBridgeMoor12_gr_max,
           TweenBridgeMoor13_gr_max,TweenBridgeMoor14_gr_max,
           TweenBridgeMoor15_gr_max,TweenBridgeMoor16_gr_max,
           TweenBridgeMoor17_gr_max,TweenBridgeMoor18_gr_max,
           TweenBridgeMoor19_gr_max,TweenBridgeMoor20_gr_max,
           TweenBridgeMoor21_gr_max,TweenBridgeMoor22_gr_max,
           TweenBridgeMoor23_gr_max,TweenBridgeMoor24_gr_max)

Low<-c(TweenBridgeMoor1_gr_lw_ref, TweenBridgeMoor2_gr_lw_ref, TweenBridgeMoor3_gr_lw_ref,
       TweenBridgeMoor4_gr_lw_ref, TweenBridgeMoor5_gr_lw_ref, TweenBridgeMoor6_gr_lw_ref,
       TweenBridgeMoor7_gr_lw_ref, TweenBridgeMoor8_gr_lw_ref, TweenBridgeMoor9_gr_lw_ref,
       TweenBridgeMoor10_gr_lw_ref, TweenBridgeMoor11_gr_lw_ref, TweenBridgeMoor12_gr_lw_ref, 
       TweenBridgeMoor13_gr_lw_ref, TweenBridgeMoor14_gr_lw_ref, TweenBridgeMoor15_gr_lw_ref, 
       TweenBridgeMoor16_gr_lw_ref, TweenBridgeMoor17_gr_lw_ref, TweenBridgeMoor18_gr_lw_ref, 
       TweenBridgeMoor19_gr_lw_ref, TweenBridgeMoor20_gr_lw_ref, TweenBridgeMoor21_gr_lw_ref,
       TweenBridgeMoor22_gr_lw_ref,TweenBridgeMoor23_gr_lw_ref,TweenBridgeMoor24_gr_lw_ref)

Moderate<-c(TweenBridgeMoor1_gr_mod_ref, TweenBridgeMoor2_gr_mod_ref, TweenBridgeMoor3_gr_mod_ref,
            TweenBridgeMoor4_gr_mod_ref, TweenBridgeMoor5_gr_mod_ref, TweenBridgeMoor6_gr_mod_ref,
            TweenBridgeMoor7_gr_mod_ref, TweenBridgeMoor8_gr_mod_ref, TweenBridgeMoor9_gr_mod_ref,
            TweenBridgeMoor10_gr_mod_ref, TweenBridgeMoor11_gr_mod_ref, TweenBridgeMoor12_gr_mod_ref, 
            TweenBridgeMoor13_gr_mod_ref, TweenBridgeMoor14_gr_mod_ref, TweenBridgeMoor15_gr_mod_ref, 
            TweenBridgeMoor16_gr_mod_ref, TweenBridgeMoor17_gr_mod_ref, TweenBridgeMoor18_gr_mod_ref, 
            TweenBridgeMoor19_gr_mod_ref, TweenBridgeMoor20_gr_mod_ref, TweenBridgeMoor21_gr_mod_ref,
            TweenBridgeMoor22_gr_mod_ref,TweenBridgeMoor23_gr_mod_ref,TweenBridgeMoor24_gr_mod_ref)

High<-c(TweenBridgeMoor1_gr_high_ref, TweenBridgeMoor2_gr_high_ref, TweenBridgeMoor3_gr_high_ref,
        TweenBridgeMoor4_gr_high_ref, TweenBridgeMoor5_gr_high_ref, TweenBridgeMoor6_gr_high_ref,
        TweenBridgeMoor7_gr_high_ref, TweenBridgeMoor8_gr_high_ref, TweenBridgeMoor9_gr_high_ref,
        TweenBridgeMoor10_gr_high_ref, TweenBridgeMoor11_gr_high_ref, TweenBridgeMoor12_gr_high_ref, 
        TweenBridgeMoor13_gr_high_ref, TweenBridgeMoor14_gr_high_ref, TweenBridgeMoor15_gr_high_ref, 
        TweenBridgeMoor16_gr_high_ref, TweenBridgeMoor17_gr_high_ref, TweenBridgeMoor18_gr_high_ref, 
        TweenBridgeMoor19_gr_high_ref, TweenBridgeMoor20_gr_high_ref, TweenBridgeMoor21_gr_high_ref,
        TweenBridgeMoor22_gr_high_ref,TweenBridgeMoor23_gr_high_ref,TweenBridgeMoor24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("TweenBridgeMoorgr",24)
Lowsite <- TweenBridgeMoorlow
Modsite <- TweenBridgeMoormod
Highsite <-TweenBridgeMoorhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



TweenBridgeMoorgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                      Site, Low, Moderate, High,
                                      Lowsite, Modsite, Highsite)

##Walkway

Walkwaypipgr<-subset(allspp4gr_ppip, Site=="Walkway")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Walkwaypipgr<-max(Walkwaypipgr$Passes)

#calculate 20% from maximum nightly record

max20_Walkwaypipgr<- (max_Walkwaypipgr/100)*80

##calculate the site classification (reference range)

Walkwayhigh<- max_Walkwaypipgr > allsppgr_ppip_ref_high

Walkwaylow<- allsppgr_ppip_ref_low > max_Walkwaypipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Walkwaypipgr
Walkwaymod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Walkway1_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 1, replace=F))))
Walkway1_gr_max <- sum(Walkway1_gr > max20_Walkwaypipgr)
Walkway1_gr_max
Walkway1_gr_pres <- sum(Walkway1_gr > 0)
Walkway1_gr_pres
#number of sites which would be classified as low
Walkway1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway1_gr)
Walkway1_gr_lw_ref
#number of sites which would be classified as high
Walkway1_gr_high_ref <- sum( Walkway1_gr > allsppgr_ppip_ref_high)
Walkway1_gr_high_ref
#number of sites which would be classified as moderate
Walkway1_gr_mod_ref <- 1000 - (Walkway1_gr_high_ref + Walkway1_gr_lw_ref)
Walkway1_gr_mod_ref


#2 nights
Walkway2_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Walkway2_grframe<-data.frame(Walkway2_gr, samp2)
Walkway2_grframelong <- melt(Walkway2_grframe,id.vars="samp2")
Walkway2_grframelong_sum <- ddply(Walkway2_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway2_gr_max <- sum(Walkway2_grframelong_sum $max > max20_Walkwaypipgr)
Walkway2_gr_max
Walkway2_gr_pres <- sum(Walkway2_grframelong_sum $max > 0)
Walkway2_gr_pres

#number of sites which would be classified as low
Walkway2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway2_grframelong_sum$max)
Walkway2_gr_lw_ref
#number of sites which would be classified as high
Walkway2_gr_high_ref <- sum( Walkway2_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway2_gr_high_ref
#number of sites which would be classified as moderate
Walkway2_gr_mod_ref <- 1000 - (Walkway2_gr_high_ref + Walkway2_gr_lw_ref)
Walkway2_gr_mod_ref


#3 nights
Walkway3_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Walkway3_grframe<-data.frame(Walkway3_gr, samp2)
Walkway3_grframelong <- melt(Walkway3_grframe,id.vars="samp2")
Walkway3_grframelong_sum <- ddply(Walkway3_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway3_gr_max <- sum(Walkway3_grframelong_sum $max > max20_Walkwaypipgr)
Walkway3_gr_max
Walkway3_gr_pres <- sum(Walkway3_grframelong_sum $max > 0)
Walkway3_gr_pres

#number of sites which would be classified as low
Walkway3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway3_grframelong_sum$max)
Walkway3_gr_lw_ref
#number of sites which would be classified as high
Walkway3_gr_high_ref <- sum( Walkway3_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway3_gr_high_ref
#number of sites which would be classified as moderate
Walkway3_gr_mod_ref <- 1000 - (Walkway3_gr_high_ref + Walkway3_gr_lw_ref)
Walkway3_gr_mod_ref

#4 nights
Walkway4_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Walkway4_grframe<-data.frame(Walkway4_gr, samp2)
Walkway4_grframelong <- melt(Walkway4_grframe,id.vars="samp2")
Walkway4_grframelong_sum <- ddply(Walkway4_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway4_gr_max <- sum(Walkway4_grframelong_sum $max > max20_Walkwaypipgr)
Walkway4_gr_max
Walkway4_gr_pres <- sum(Walkway4_grframelong_sum $max > 0)
Walkway4_gr_pres

#number of sites which would be classified as low
Walkway4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway4_grframelong_sum$max)
Walkway4_gr_lw_ref
#number of sites which would be classified as high
Walkway4_gr_high_ref <- sum( Walkway4_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway4_gr_high_ref
#number of sites which would be classified as moderate
Walkway4_gr_mod_ref <- 1000 - (Walkway4_gr_high_ref + Walkway4_gr_lw_ref)
Walkway4_gr_mod_ref

#5 nights
Walkway5_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Walkway5_grframe<-data.frame(Walkway5_gr, samp2)
Walkway5_grframelong <- melt(Walkway5_grframe,id.vars="samp2")
Walkway5_grframelong_sum <- ddply(Walkway5_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway5_gr_max <- sum(Walkway5_grframelong_sum $max > max20_Walkwaypipgr)
Walkway5_gr_max
Walkway5_gr_pres <- sum(Walkway5_grframelong_sum $max > 0)
Walkway5_gr_pres

#number of sites which would be classified as low
Walkway5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway5_grframelong_sum$max)
Walkway5_gr_lw_ref
#number of sites which would be classified as high
Walkway5_gr_high_ref <- sum( Walkway5_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway5_gr_high_ref
#number of sites which would be classified as moderate
Walkway5_gr_mod_ref <- 1000 - (Walkway5_gr_high_ref + Walkway5_gr_lw_ref)
Walkway5_gr_mod_ref

#6 nights
Walkway6_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Walkway6_grframe<-data.frame(Walkway6_gr, samp2)
Walkway6_grframelong <- melt(Walkway6_grframe,id.vars="samp2")
Walkway6_grframelong_sum <- ddply(Walkway6_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway6_gr_max <- sum(Walkway6_grframelong_sum $max > max20_Walkwaypipgr)
Walkway6_gr_max
Walkway6_gr_pres <- sum(Walkway6_grframelong_sum $max > 0)
Walkway6_gr_pres

#number of sites which would be classified as low
Walkway6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway6_grframelong_sum$max)
Walkway6_gr_lw_ref
#number of sites which would be classified as high
Walkway6_gr_high_ref <- sum( Walkway6_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway6_gr_high_ref
#number of sites which would be classified as moderate
Walkway6_gr_mod_ref <- 1000 - (Walkway6_gr_high_ref + Walkway6_gr_lw_ref)
Walkway6_gr_mod_ref

#7 nights
Walkway7_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Walkway7_grframe<-data.frame(Walkway7_gr, samp2)
Walkway7_grframelong <- melt(Walkway7_grframe,id.vars="samp2")
Walkway7_grframelong_sum <- ddply(Walkway7_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway7_gr_max <- sum(Walkway7_grframelong_sum $max > max20_Walkwaypipgr)
Walkway7_gr_max
Walkway7_gr_pres <- sum(Walkway7_grframelong_sum $max > 0)
Walkway7_gr_pres

#number of sites which would be classified as low
Walkway7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway7_grframelong_sum$max)
Walkway7_gr_lw_ref
#number of sites which would be classified as high
Walkway7_gr_high_ref <- sum( Walkway7_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway7_gr_high_ref
#number of sites which would be classified as moderate
Walkway7_gr_mod_ref <- 1000 - (Walkway7_gr_high_ref + Walkway7_gr_lw_ref)
Walkway7_gr_mod_ref

#8 nights
Walkway8_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Walkway8_grframe<-data.frame(Walkway8_gr, samp2)
Walkway8_grframelong <- melt(Walkway8_grframe,id.vars="samp2")
Walkway8_grframelong_sum <- ddply(Walkway8_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway8_gr_max <- sum(Walkway8_grframelong_sum $max > max20_Walkwaypipgr)
Walkway8_gr_max
Walkway8_gr_pres <- sum(Walkway8_grframelong_sum $max > 0)
Walkway8_gr_pres

#number of sites which would be classified as low
Walkway8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway8_grframelong_sum$max)
Walkway8_gr_lw_ref
#number of sites which would be classified as high
Walkway8_gr_high_ref <- sum( Walkway8_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway8_gr_high_ref
#number of sites which would be classified as moderate
Walkway8_gr_mod_ref <- 1000 - (Walkway8_gr_high_ref + Walkway8_gr_lw_ref)
Walkway8_gr_mod_ref

#9 nights
Walkway9_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Walkway9_grframe<-data.frame(Walkway9_gr, samp2)
Walkway9_grframelong <- melt(Walkway9_grframe,id.vars="samp2")
Walkway9_grframelong_sum <- ddply(Walkway9_grframelong, "variable", summarise,
                                  N    = length(value),
                                  max  = max(value))
Walkway9_gr_max <- sum(Walkway9_grframelong_sum $max > max20_Walkwaypipgr)
Walkway9_gr_max
Walkway9_gr_pres <- sum(Walkway9_grframelong_sum $max > 0)
Walkway9_gr_pres

#number of sites which would be classified as low
Walkway9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway9_grframelong_sum$max)
Walkway9_gr_lw_ref
#number of sites which would be classified as high
Walkway9_gr_high_ref <- sum( Walkway9_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway9_gr_high_ref
#number of sites which would be classified as moderate
Walkway9_gr_mod_ref <- 1000 - (Walkway9_gr_high_ref + Walkway9_gr_lw_ref)
Walkway9_gr_mod_ref

#10 detectors
Walkway10_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Walkway10_grframe<-data.frame(Walkway10_gr, samp2)
Walkway10_grframelong <- melt(Walkway10_grframe,id.vars="samp2")
Walkway10_grframelong_sum <- ddply(Walkway10_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway10_gr_max <- sum(Walkway10_grframelong_sum $max > max20_Walkwaypipgr)
Walkway10_gr_max
Walkway10_gr_pres <- sum(Walkway10_grframelong_sum $max > 0)
Walkway10_gr_pres

#number of sites which would be classified as low
Walkway10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway10_grframelong_sum$max)
Walkway10_gr_lw_ref
#number of sites which would be classified as high
Walkway10_gr_high_ref <- sum( Walkway10_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway10_gr_high_ref
#number of sites which would be classified as moderate
Walkway10_gr_mod_ref <- 1000 - (Walkway10_gr_high_ref + Walkway10_gr_lw_ref)
Walkway10_gr_mod_ref

#11 detectors
Walkway11_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Walkway11_grframe<-data.frame(Walkway11_gr, samp2)
Walkway11_grframelong <- melt(Walkway11_grframe,id.vars="samp2")
Walkway11_grframelong_sum <- ddply(Walkway11_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway11_gr_max <- sum(Walkway11_grframelong_sum $max > max20_Walkwaypipgr)
Walkway11_gr_max
Walkway11_gr_pres <- sum(Walkway11_grframelong_sum $max > 0)
Walkway11_gr_pres

#number of sites which would be classified as low
Walkway11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway11_grframelong_sum$max)
Walkway11_gr_lw_ref
#number of sites which would be classified as high
Walkway11_gr_high_ref <- sum( Walkway11_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway11_gr_high_ref
#number of sites which would be classified as moderate
Walkway11_gr_mod_ref <- 1000 - (Walkway11_gr_high_ref + Walkway11_gr_lw_ref)
Walkway11_gr_mod_ref

#12 detectors
Walkway12_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Walkway12_grframe<-data.frame(Walkway12_gr, samp2)
Walkway12_grframelong <- melt(Walkway12_grframe,id.vars="samp2")
Walkway12_grframelong_sum <- ddply(Walkway12_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway12_gr_max <- sum(Walkway12_grframelong_sum $max > max20_Walkwaypipgr)
Walkway12_gr_max
Walkway12_gr_pres <- sum(Walkway12_grframelong_sum $max > 0)
Walkway12_gr_pres

#number of sites which would be classified as low
Walkway12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway12_grframelong_sum$max)
Walkway12_gr_lw_ref
#number of sites which would be classified as high
Walkway12_gr_high_ref <- sum( Walkway12_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway12_gr_high_ref
#number of sites which would be classified as moderate
Walkway12_gr_mod_ref <- 1000 - (Walkway12_gr_high_ref + Walkway12_gr_lw_ref)
Walkway12_gr_mod_ref

#13 detectors
Walkway13_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Walkway13_grframe<-data.frame(Walkway13_gr, samp2)
Walkway13_grframelong <- melt(Walkway13_grframe,id.vars="samp2")
Walkway13_grframelong_sum <- ddply(Walkway13_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway13_gr_max <- sum(Walkway13_grframelong_sum $max > max20_Walkwaypipgr)
Walkway13_gr_max
Walkway13_gr_pres <- sum(Walkway13_grframelong_sum $max > 0)
Walkway13_gr_pres

#number of sites which would be classified as low
Walkway13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway13_grframelong_sum$max)
Walkway13_gr_lw_ref
#number of sites which would be classified as high
Walkway13_gr_high_ref <- sum( Walkway13_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway13_gr_high_ref
#number of sites which would be classified as moderate
Walkway13_gr_mod_ref <- 1000 - (Walkway13_gr_high_ref + Walkway13_gr_lw_ref)
Walkway13_gr_mod_ref

#14 detectors
Walkway14_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Walkway14_grframe<-data.frame(Walkway14_gr, samp2)
Walkway14_grframelong <- melt(Walkway14_grframe,id.vars="samp2")
Walkway14_grframelong_sum <- ddply(Walkway14_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway14_gr_max <- sum(Walkway14_grframelong_sum $max > max20_Walkwaypipgr)
Walkway14_gr_max
Walkway14_gr_pres <- sum(Walkway14_grframelong_sum $max > 0)
Walkway14_gr_pres

#number of sites which would be classified as low
Walkway14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway14_grframelong_sum$max)
Walkway14_gr_lw_ref
#number of sites which would be classified as high
Walkway14_gr_high_ref <- sum( Walkway14_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway14_gr_high_ref
#number of sites which would be classified as moderate
Walkway14_gr_mod_ref <- 1000 - (Walkway14_gr_high_ref + Walkway14_gr_lw_ref)
Walkway14_gr_mod_ref

#15 detectors
Walkway15_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Walkway15_grframe<-data.frame(Walkway15_gr, samp2)
Walkway15_grframelong <- melt(Walkway15_grframe,id.vars="samp2")
Walkway15_grframelong_sum <- ddply(Walkway15_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway15_gr_max <- sum(Walkway15_grframelong_sum $max > max20_Walkwaypipgr)
Walkway15_gr_max
Walkway15_gr_pres <- sum(Walkway15_grframelong_sum $max > 0)
Walkway15_gr_pres

#number of sites which would be classified as low
Walkway15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway15_grframelong_sum$max)
Walkway15_gr_lw_ref
#number of sites which would be classified as high
Walkway15_gr_high_ref <- sum( Walkway15_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway15_gr_high_ref
#number of sites which would be classified as moderate
Walkway15_gr_mod_ref <- 1000 - (Walkway15_gr_high_ref + Walkway15_gr_lw_ref)
Walkway15_gr_mod_ref

#16 detectors
Walkway16_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Walkway16_grframe<-data.frame(Walkway16_gr, samp2)
Walkway16_grframelong <- melt(Walkway16_grframe,id.vars="samp2")
Walkway16_grframelong_sum <- ddply(Walkway16_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway16_gr_max <- sum(Walkway16_grframelong_sum $max > max20_Walkwaypipgr)
Walkway16_gr_max
Walkway16_gr_pres <- sum(Walkway16_grframelong_sum $max > 0)
Walkway16_gr_pres

#number of sites which would be classified as low
Walkway16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway16_grframelong_sum$max)
Walkway16_gr_lw_ref
#number of sites which would be classified as high
Walkway16_gr_high_ref <- sum( Walkway16_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway16_gr_high_ref
#number of sites which would be classified as moderate
Walkway16_gr_mod_ref <- 1000 - (Walkway16_gr_high_ref + Walkway16_gr_lw_ref)
Walkway16_gr_mod_ref

#17 detectors
Walkway17_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Walkway17_grframe<-data.frame(Walkway17_gr, samp2)
Walkway17_grframelong <- melt(Walkway17_grframe,id.vars="samp2")
Walkway17_grframelong_sum <- ddply(Walkway17_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway17_gr_max <- sum(Walkway17_grframelong_sum $max > max20_Walkwaypipgr)
Walkway17_gr_max
Walkway17_gr_pres <- sum(Walkway17_grframelong_sum $max > 0)
Walkway17_gr_pres

#number of sites which would be classified as low
Walkway17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway17_grframelong_sum$max)
Walkway17_gr_lw_ref
#number of sites which would be classified as high
Walkway17_gr_high_ref <- sum( Walkway17_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway17_gr_high_ref
#number of sites which would be classified as moderate
Walkway17_gr_mod_ref <- 1000 - (Walkway17_gr_high_ref + Walkway17_gr_lw_ref)
Walkway17_gr_mod_ref

#18 detectors
Walkway18_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Walkway18_grframe<-data.frame(Walkway18_gr, samp2)
Walkway18_grframelong <- melt(Walkway18_grframe,id.vars="samp2")
Walkway18_grframelong_sum <- ddply(Walkway18_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway18_gr_max <- sum(Walkway18_grframelong_sum $max > max20_Walkwaypipgr)
Walkway18_gr_max
Walkway18_gr_pres <- sum(Walkway18_grframelong_sum $max > 0)
Walkway18_gr_pres

#number of sites which would be classified as low
Walkway18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway18_grframelong_sum$max)
Walkway18_gr_lw_ref
#number of sites which would be classified as high
Walkway18_gr_high_ref <- sum( Walkway18_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway18_gr_high_ref
#number of sites which would be classified as moderate
Walkway18_gr_mod_ref <- 1000 - (Walkway18_gr_high_ref + Walkway18_gr_lw_ref)
Walkway18_gr_mod_ref

#19 detectors
Walkway19_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Walkway19_grframe<-data.frame(Walkway19_gr, samp2)
Walkway19_grframelong <- melt(Walkway19_grframe,id.vars="samp2")
Walkway19_grframelong_sum <- ddply(Walkway19_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway19_gr_max <- sum(Walkway19_grframelong_sum $max > max20_Walkwaypipgr)
Walkway19_gr_max
Walkway19_gr_pres <- sum(Walkway19_grframelong_sum $max > 0)
Walkway19_gr_pres

#number of sites which would be classified as low
Walkway19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway19_grframelong_sum$max)
Walkway19_gr_lw_ref
#number of sites which would be classified as high
Walkway19_gr_high_ref <- sum( Walkway19_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway19_gr_high_ref
#number of sites which would be classified as moderate
Walkway19_gr_mod_ref <- 1000 - (Walkway19_gr_high_ref + Walkway19_gr_lw_ref)
Walkway19_gr_mod_ref

#20 detectors
Walkway20_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Walkway20_grframe<-data.frame(Walkway20_gr, samp2)
Walkway20_grframelong <- melt(Walkway20_grframe,id.vars="samp2")
Walkway20_grframelong_sum <- ddply(Walkway20_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway20_gr_max <- sum(Walkway20_grframelong_sum $max > max20_Walkwaypipgr)
Walkway20_gr_max
Walkway20_gr_pres <- sum(Walkway20_grframelong_sum $max > 0)
Walkway20_gr_pres

#number of sites which would be classified as low
Walkway20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway20_grframelong_sum$max)
Walkway20_gr_lw_ref
#number of sites which would be classified as high
Walkway20_gr_high_ref <- sum( Walkway20_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway20_gr_high_ref
#number of sites which would be classified as moderate
Walkway20_gr_mod_ref <- 1000 - (Walkway20_gr_high_ref + Walkway20_gr_lw_ref)
Walkway20_gr_mod_ref

#21 detectors
Walkway21_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Walkway21_grframe<-data.frame(Walkway21_gr, samp2)
Walkway21_grframelong <- melt(Walkway21_grframe,id.vars="samp2")
Walkway21_grframelong_sum <- ddply(Walkway21_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway21_gr_max <- sum(Walkway21_grframelong_sum $max > max20_Walkwaypipgr)
Walkway21_gr_max
Walkway21_gr_pres <- sum(Walkway21_grframelong_sum $max > 0)
Walkway21_gr_pres

#number of sites which would be classified as low
Walkway21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway21_grframelong_sum$max)
Walkway21_gr_lw_ref
#number of sites which would be classified as high
Walkway21_gr_high_ref <- sum( Walkway21_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway21_gr_high_ref
#number of sites which would be classified as moderate
Walkway21_gr_mod_ref <- 1000 - (Walkway21_gr_high_ref + Walkway21_gr_lw_ref)
Walkway21_gr_mod_ref

#22 detectors
Walkway22_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Walkway22_grframe<-data.frame(Walkway22_gr, samp2)
Walkway22_grframelong <- melt(Walkway22_grframe,id.vars="samp2")
Walkway22_grframelong_sum <- ddply(Walkway22_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway22_gr_max <- sum(Walkway22_grframelong_sum $max > max20_Walkwaypipgr)
Walkway22_gr_max
Walkway22_gr_pres <- sum(Walkway22_grframelong_sum $max > 0)
Walkway22_gr_pres

#number of sites which would be classified as low
Walkway22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway22_grframelong_sum$max)
Walkway22_gr_lw_ref
#number of sites which would be classified as high
Walkway22_gr_high_ref <- sum( Walkway22_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway22_gr_high_ref
#number of sites which would be classified as moderate
Walkway22_gr_mod_ref <- 1000 - (Walkway22_gr_high_ref + Walkway22_gr_lw_ref)
Walkway22_gr_mod_ref

#23 detectors
Walkway23_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Walkway23_grframe<-data.frame(Walkway23_gr, samp2)
Walkway23_grframelong <- melt(Walkway23_grframe,id.vars="samp2")
Walkway23_grframelong_sum <- ddply(Walkway23_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway23_gr_max <- sum(Walkway23_grframelong_sum $max > max20_Walkwaypipgr)
Walkway23_gr_max
Walkway23_gr_pres <- sum(Walkway23_grframelong_sum $max > 0)
Walkway23_gr_pres

#number of sites which would be classified as low
Walkway23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway23_grframelong_sum$max)
Walkway23_gr_lw_ref
#number of sites which would be classified as high
Walkway23_gr_high_ref <- sum( Walkway23_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway23_gr_high_ref
#number of sites which would be classified as moderate
Walkway23_gr_mod_ref <- 1000 - (Walkway23_gr_high_ref + Walkway23_gr_lw_ref)
Walkway23_gr_mod_ref

#24 detectors
Walkway24_gr<-(replicate(1000, (sample(Walkwaypipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Walkway24_grframe<-data.frame(Walkway24_gr, samp2)
Walkway24_grframelong <- melt(Walkway24_grframe,id.vars="samp2")
Walkway24_grframelong_sum <- ddply(Walkway24_grframelong, "variable", summarise,
                                   N    = length(value),
                                   max  = max(value))
Walkway24_gr_max <- sum(Walkway24_grframelong_sum $max > max20_Walkwaypipgr)
Walkway24_gr_max
Walkway24_gr_pres <- sum(Walkway24_grframelong_sum $max > 0)
Walkway24_gr_pres

#number of sites which would be classified as low
Walkway24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Walkway24_grframelong_sum$max)
Walkway24_gr_lw_ref
#number of sites which would be classified as high
Walkway24_gr_high_ref <- sum( Walkway24_grframelong_sum$max > allsppgr_ppip_ref_high)
Walkway24_gr_high_ref
#number of sites which would be classified as moderate
Walkway24_gr_mod_ref <- 1000 - (Walkway24_gr_high_ref + Walkway24_gr_lw_ref)
Walkway24_gr_mod_ref

Present<-c(Walkway1_gr_pres,Walkway2_gr_pres,
           Walkway3_gr_pres,Walkway4_gr_pres,
           Walkway5_gr_pres,Walkway6_gr_pres,
           Walkway7_gr_pres,Walkway8_gr_pres,
           Walkway9_gr_pres,Walkway10_gr_pres,
           Walkway11_gr_pres,Walkway12_gr_pres,
           Walkway13_gr_pres,Walkway14_gr_pres,
           Walkway15_gr_pres,Walkway16_gr_pres,
           Walkway17_gr_pres,Walkway18_gr_pres,
           Walkway19_gr_pres,Walkway20_gr_pres,
           Walkway21_gr_pres,Walkway22_gr_pres,
           Walkway23_gr_pres,Walkway24_gr_pres)


Maximum<-c(Walkway1_gr_max,Walkway2_gr_max,
           Walkway3_gr_max,Walkway4_gr_max,
           Walkway5_gr_max,Walkway6_gr_max,
           Walkway7_gr_max,Walkway8_gr_max,
           Walkway9_gr_max,Walkway10_gr_max,
           Walkway11_gr_max,Walkway12_gr_max,
           Walkway13_gr_max,Walkway14_gr_max,
           Walkway15_gr_max,Walkway16_gr_max,
           Walkway17_gr_max,Walkway18_gr_max,
           Walkway19_gr_max,Walkway20_gr_max,
           Walkway21_gr_max,Walkway22_gr_max,
           Walkway23_gr_max,Walkway24_gr_max)

Low<-c(Walkway1_gr_lw_ref, Walkway2_gr_lw_ref, Walkway3_gr_lw_ref,
       Walkway4_gr_lw_ref, Walkway5_gr_lw_ref, Walkway6_gr_lw_ref,
       Walkway7_gr_lw_ref, Walkway8_gr_lw_ref, Walkway9_gr_lw_ref,
       Walkway10_gr_lw_ref, Walkway11_gr_lw_ref, Walkway12_gr_lw_ref, 
       Walkway13_gr_lw_ref, Walkway14_gr_lw_ref, Walkway15_gr_lw_ref, 
       Walkway16_gr_lw_ref, Walkway17_gr_lw_ref, Walkway18_gr_lw_ref, 
       Walkway19_gr_lw_ref, Walkway20_gr_lw_ref, Walkway21_gr_lw_ref,
       Walkway22_gr_lw_ref,Walkway23_gr_lw_ref,Walkway24_gr_lw_ref)

Moderate<-c(Walkway1_gr_mod_ref, Walkway2_gr_mod_ref, Walkway3_gr_mod_ref,
            Walkway4_gr_mod_ref, Walkway5_gr_mod_ref, Walkway6_gr_mod_ref,
            Walkway7_gr_mod_ref, Walkway8_gr_mod_ref, Walkway9_gr_mod_ref,
            Walkway10_gr_mod_ref, Walkway11_gr_mod_ref, Walkway12_gr_mod_ref, 
            Walkway13_gr_mod_ref, Walkway14_gr_mod_ref, Walkway15_gr_mod_ref, 
            Walkway16_gr_mod_ref, Walkway17_gr_mod_ref, Walkway18_gr_mod_ref, 
            Walkway19_gr_mod_ref, Walkway20_gr_mod_ref, Walkway21_gr_mod_ref,
            Walkway22_gr_mod_ref,Walkway23_gr_mod_ref,Walkway24_gr_mod_ref)

High<-c(Walkway1_gr_high_ref, Walkway2_gr_high_ref, Walkway3_gr_high_ref,
        Walkway4_gr_high_ref, Walkway5_gr_high_ref, Walkway6_gr_high_ref,
        Walkway7_gr_high_ref, Walkway8_gr_high_ref, Walkway9_gr_high_ref,
        Walkway10_gr_high_ref, Walkway11_gr_high_ref, Walkway12_gr_high_ref, 
        Walkway13_gr_high_ref, Walkway14_gr_high_ref, Walkway15_gr_high_ref, 
        Walkway16_gr_high_ref, Walkway17_gr_high_ref, Walkway18_gr_high_ref, 
        Walkway19_gr_high_ref, Walkway20_gr_high_ref, Walkway21_gr_high_ref,
        Walkway22_gr_high_ref,Walkway23_gr_high_ref,Walkway24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Walkwaygr",24)
Lowsite <- Walkwaylow
Modsite <- Walkwaymod
Highsite <-Walkwayhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Walkwaygr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                              Site, Low, Moderate, High,
                              Lowsite, Modsite, Highsite)

##WardlawWood

WardlawWoodpipgr<-subset(allspp4gr_ppip, Site=="WardlawWood")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_WardlawWoodpipgr<-max(WardlawWoodpipgr$Passes)

#calculate 20% from maximum nightly record

max20_WardlawWoodpipgr<- (max_WardlawWoodpipgr/100)*80

##calculate the site classification (reference range)

WardlawWoodhigh<- max_WardlawWoodpipgr > allsppgr_ppip_ref_high

WardlawWoodlow<- allsppgr_ppip_ref_low > max_WardlawWoodpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_WardlawWoodpipgr
WardlawWoodmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
WardlawWood1_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 1, replace=F))))
WardlawWood1_gr_max <- sum(WardlawWood1_gr > max20_WardlawWoodpipgr)
WardlawWood1_gr_max
WardlawWood1_gr_pres <- sum(WardlawWood1_gr > 0)
WardlawWood1_gr_pres
#number of sites which would be classified as low
WardlawWood1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood1_gr)
WardlawWood1_gr_lw_ref
#number of sites which would be classified as high
WardlawWood1_gr_high_ref <- sum( WardlawWood1_gr > allsppgr_ppip_ref_high)
WardlawWood1_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood1_gr_mod_ref <- 1000 - (WardlawWood1_gr_high_ref + WardlawWood1_gr_lw_ref)
WardlawWood1_gr_mod_ref


#2 nights
WardlawWood2_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
WardlawWood2_grframe<-data.frame(WardlawWood2_gr, samp2)
WardlawWood2_grframelong <- melt(WardlawWood2_grframe,id.vars="samp2")
WardlawWood2_grframelong_sum <- ddply(WardlawWood2_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood2_gr_max <- sum(WardlawWood2_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood2_gr_max
WardlawWood2_gr_pres <- sum(WardlawWood2_grframelong_sum $max > 0)
WardlawWood2_gr_pres

#number of sites which would be classified as low
WardlawWood2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood2_grframelong_sum$max)
WardlawWood2_gr_lw_ref
#number of sites which would be classified as high
WardlawWood2_gr_high_ref <- sum( WardlawWood2_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood2_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood2_gr_mod_ref <- 1000 - (WardlawWood2_gr_high_ref + WardlawWood2_gr_lw_ref)
WardlawWood2_gr_mod_ref


#3 nights
WardlawWood3_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
WardlawWood3_grframe<-data.frame(WardlawWood3_gr, samp2)
WardlawWood3_grframelong <- melt(WardlawWood3_grframe,id.vars="samp2")
WardlawWood3_grframelong_sum <- ddply(WardlawWood3_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood3_gr_max <- sum(WardlawWood3_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood3_gr_max
WardlawWood3_gr_pres <- sum(WardlawWood3_grframelong_sum $max > 0)
WardlawWood3_gr_pres

#number of sites which would be classified as low
WardlawWood3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood3_grframelong_sum$max)
WardlawWood3_gr_lw_ref
#number of sites which would be classified as high
WardlawWood3_gr_high_ref <- sum( WardlawWood3_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood3_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood3_gr_mod_ref <- 1000 - (WardlawWood3_gr_high_ref + WardlawWood3_gr_lw_ref)
WardlawWood3_gr_mod_ref

#4 nights
WardlawWood4_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
WardlawWood4_grframe<-data.frame(WardlawWood4_gr, samp2)
WardlawWood4_grframelong <- melt(WardlawWood4_grframe,id.vars="samp2")
WardlawWood4_grframelong_sum <- ddply(WardlawWood4_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood4_gr_max <- sum(WardlawWood4_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood4_gr_max
WardlawWood4_gr_pres <- sum(WardlawWood4_grframelong_sum $max > 0)
WardlawWood4_gr_pres

#number of sites which would be classified as low
WardlawWood4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood4_grframelong_sum$max)
WardlawWood4_gr_lw_ref
#number of sites which would be classified as high
WardlawWood4_gr_high_ref <- sum( WardlawWood4_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood4_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood4_gr_mod_ref <- 1000 - (WardlawWood4_gr_high_ref + WardlawWood4_gr_lw_ref)
WardlawWood4_gr_mod_ref

#5 nights
WardlawWood5_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
WardlawWood5_grframe<-data.frame(WardlawWood5_gr, samp2)
WardlawWood5_grframelong <- melt(WardlawWood5_grframe,id.vars="samp2")
WardlawWood5_grframelong_sum <- ddply(WardlawWood5_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood5_gr_max <- sum(WardlawWood5_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood5_gr_max
WardlawWood5_gr_pres <- sum(WardlawWood5_grframelong_sum $max > 0)
WardlawWood5_gr_pres

#number of sites which would be classified as low
WardlawWood5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood5_grframelong_sum$max)
WardlawWood5_gr_lw_ref
#number of sites which would be classified as high
WardlawWood5_gr_high_ref <- sum( WardlawWood5_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood5_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood5_gr_mod_ref <- 1000 - (WardlawWood5_gr_high_ref + WardlawWood5_gr_lw_ref)
WardlawWood5_gr_mod_ref

#6 nights
WardlawWood6_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
WardlawWood6_grframe<-data.frame(WardlawWood6_gr, samp2)
WardlawWood6_grframelong <- melt(WardlawWood6_grframe,id.vars="samp2")
WardlawWood6_grframelong_sum <- ddply(WardlawWood6_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood6_gr_max <- sum(WardlawWood6_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood6_gr_max
WardlawWood6_gr_pres <- sum(WardlawWood6_grframelong_sum $max > 0)
WardlawWood6_gr_pres

#number of sites which would be classified as low
WardlawWood6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood6_grframelong_sum$max)
WardlawWood6_gr_lw_ref
#number of sites which would be classified as high
WardlawWood6_gr_high_ref <- sum( WardlawWood6_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood6_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood6_gr_mod_ref <- 1000 - (WardlawWood6_gr_high_ref + WardlawWood6_gr_lw_ref)
WardlawWood6_gr_mod_ref

#7 nights
WardlawWood7_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
WardlawWood7_grframe<-data.frame(WardlawWood7_gr, samp2)
WardlawWood7_grframelong <- melt(WardlawWood7_grframe,id.vars="samp2")
WardlawWood7_grframelong_sum <- ddply(WardlawWood7_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood7_gr_max <- sum(WardlawWood7_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood7_gr_max
WardlawWood7_gr_pres <- sum(WardlawWood7_grframelong_sum $max > 0)
WardlawWood7_gr_pres

#number of sites which would be classified as low
WardlawWood7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood7_grframelong_sum$max)
WardlawWood7_gr_lw_ref
#number of sites which would be classified as high
WardlawWood7_gr_high_ref <- sum( WardlawWood7_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood7_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood7_gr_mod_ref <- 1000 - (WardlawWood7_gr_high_ref + WardlawWood7_gr_lw_ref)
WardlawWood7_gr_mod_ref

#8 nights
WardlawWood8_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
WardlawWood8_grframe<-data.frame(WardlawWood8_gr, samp2)
WardlawWood8_grframelong <- melt(WardlawWood8_grframe,id.vars="samp2")
WardlawWood8_grframelong_sum <- ddply(WardlawWood8_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood8_gr_max <- sum(WardlawWood8_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood8_gr_max
WardlawWood8_gr_pres <- sum(WardlawWood8_grframelong_sum $max > 0)
WardlawWood8_gr_pres

#number of sites which would be classified as low
WardlawWood8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood8_grframelong_sum$max)
WardlawWood8_gr_lw_ref
#number of sites which would be classified as high
WardlawWood8_gr_high_ref <- sum( WardlawWood8_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood8_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood8_gr_mod_ref <- 1000 - (WardlawWood8_gr_high_ref + WardlawWood8_gr_lw_ref)
WardlawWood8_gr_mod_ref

#9 nights
WardlawWood9_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
WardlawWood9_grframe<-data.frame(WardlawWood9_gr, samp2)
WardlawWood9_grframelong <- melt(WardlawWood9_grframe,id.vars="samp2")
WardlawWood9_grframelong_sum <- ddply(WardlawWood9_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WardlawWood9_gr_max <- sum(WardlawWood9_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood9_gr_max
WardlawWood9_gr_pres <- sum(WardlawWood9_grframelong_sum $max > 0)
WardlawWood9_gr_pres

#number of sites which would be classified as low
WardlawWood9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood9_grframelong_sum$max)
WardlawWood9_gr_lw_ref
#number of sites which would be classified as high
WardlawWood9_gr_high_ref <- sum( WardlawWood9_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood9_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood9_gr_mod_ref <- 1000 - (WardlawWood9_gr_high_ref + WardlawWood9_gr_lw_ref)
WardlawWood9_gr_mod_ref

#10 detectors
WardlawWood10_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
WardlawWood10_grframe<-data.frame(WardlawWood10_gr, samp2)
WardlawWood10_grframelong <- melt(WardlawWood10_grframe,id.vars="samp2")
WardlawWood10_grframelong_sum <- ddply(WardlawWood10_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood10_gr_max <- sum(WardlawWood10_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood10_gr_max
WardlawWood10_gr_pres <- sum(WardlawWood10_grframelong_sum $max > 0)
WardlawWood10_gr_pres

#number of sites which would be classified as low
WardlawWood10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood10_grframelong_sum$max)
WardlawWood10_gr_lw_ref
#number of sites which would be classified as high
WardlawWood10_gr_high_ref <- sum( WardlawWood10_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood10_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood10_gr_mod_ref <- 1000 - (WardlawWood10_gr_high_ref + WardlawWood10_gr_lw_ref)
WardlawWood10_gr_mod_ref

#11 detectors
WardlawWood11_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
WardlawWood11_grframe<-data.frame(WardlawWood11_gr, samp2)
WardlawWood11_grframelong <- melt(WardlawWood11_grframe,id.vars="samp2")
WardlawWood11_grframelong_sum <- ddply(WardlawWood11_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood11_gr_max <- sum(WardlawWood11_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood11_gr_max
WardlawWood11_gr_pres <- sum(WardlawWood11_grframelong_sum $max > 0)
WardlawWood11_gr_pres

#number of sites which would be classified as low
WardlawWood11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood11_grframelong_sum$max)
WardlawWood11_gr_lw_ref
#number of sites which would be classified as high
WardlawWood11_gr_high_ref <- sum( WardlawWood11_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood11_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood11_gr_mod_ref <- 1000 - (WardlawWood11_gr_high_ref + WardlawWood11_gr_lw_ref)
WardlawWood11_gr_mod_ref

#12 detectors
WardlawWood12_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
WardlawWood12_grframe<-data.frame(WardlawWood12_gr, samp2)
WardlawWood12_grframelong <- melt(WardlawWood12_grframe,id.vars="samp2")
WardlawWood12_grframelong_sum <- ddply(WardlawWood12_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood12_gr_max <- sum(WardlawWood12_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood12_gr_max
WardlawWood12_gr_pres <- sum(WardlawWood12_grframelong_sum $max > 0)
WardlawWood12_gr_pres

#number of sites which would be classified as low
WardlawWood12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood12_grframelong_sum$max)
WardlawWood12_gr_lw_ref
#number of sites which would be classified as high
WardlawWood12_gr_high_ref <- sum( WardlawWood12_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood12_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood12_gr_mod_ref <- 1000 - (WardlawWood12_gr_high_ref + WardlawWood12_gr_lw_ref)
WardlawWood12_gr_mod_ref

#13 detectors
WardlawWood13_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
WardlawWood13_grframe<-data.frame(WardlawWood13_gr, samp2)
WardlawWood13_grframelong <- melt(WardlawWood13_grframe,id.vars="samp2")
WardlawWood13_grframelong_sum <- ddply(WardlawWood13_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood13_gr_max <- sum(WardlawWood13_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood13_gr_max
WardlawWood13_gr_pres <- sum(WardlawWood13_grframelong_sum $max > 0)
WardlawWood13_gr_pres

#number of sites which would be classified as low
WardlawWood13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood13_grframelong_sum$max)
WardlawWood13_gr_lw_ref
#number of sites which would be classified as high
WardlawWood13_gr_high_ref <- sum( WardlawWood13_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood13_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood13_gr_mod_ref <- 1000 - (WardlawWood13_gr_high_ref + WardlawWood13_gr_lw_ref)
WardlawWood13_gr_mod_ref

#14 detectors
WardlawWood14_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
WardlawWood14_grframe<-data.frame(WardlawWood14_gr, samp2)
WardlawWood14_grframelong <- melt(WardlawWood14_grframe,id.vars="samp2")
WardlawWood14_grframelong_sum <- ddply(WardlawWood14_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood14_gr_max <- sum(WardlawWood14_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood14_gr_max
WardlawWood14_gr_pres <- sum(WardlawWood14_grframelong_sum $max > 0)
WardlawWood14_gr_pres

#number of sites which would be classified as low
WardlawWood14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood14_grframelong_sum$max)
WardlawWood14_gr_lw_ref
#number of sites which would be classified as high
WardlawWood14_gr_high_ref <- sum( WardlawWood14_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood14_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood14_gr_mod_ref <- 1000 - (WardlawWood14_gr_high_ref + WardlawWood14_gr_lw_ref)
WardlawWood14_gr_mod_ref

#15 detectors
WardlawWood15_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
WardlawWood15_grframe<-data.frame(WardlawWood15_gr, samp2)
WardlawWood15_grframelong <- melt(WardlawWood15_grframe,id.vars="samp2")
WardlawWood15_grframelong_sum <- ddply(WardlawWood15_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood15_gr_max <- sum(WardlawWood15_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood15_gr_max
WardlawWood15_gr_pres <- sum(WardlawWood15_grframelong_sum $max > 0)
WardlawWood15_gr_pres

#number of sites which would be classified as low
WardlawWood15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood15_grframelong_sum$max)
WardlawWood15_gr_lw_ref
#number of sites which would be classified as high
WardlawWood15_gr_high_ref <- sum( WardlawWood15_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood15_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood15_gr_mod_ref <- 1000 - (WardlawWood15_gr_high_ref + WardlawWood15_gr_lw_ref)
WardlawWood15_gr_mod_ref

#16 detectors
WardlawWood16_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
WardlawWood16_grframe<-data.frame(WardlawWood16_gr, samp2)
WardlawWood16_grframelong <- melt(WardlawWood16_grframe,id.vars="samp2")
WardlawWood16_grframelong_sum <- ddply(WardlawWood16_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood16_gr_max <- sum(WardlawWood16_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood16_gr_max
WardlawWood16_gr_pres <- sum(WardlawWood16_grframelong_sum $max > 0)
WardlawWood16_gr_pres

#number of sites which would be classified as low
WardlawWood16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood16_grframelong_sum$max)
WardlawWood16_gr_lw_ref
#number of sites which would be classified as high
WardlawWood16_gr_high_ref <- sum( WardlawWood16_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood16_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood16_gr_mod_ref <- 1000 - (WardlawWood16_gr_high_ref + WardlawWood16_gr_lw_ref)
WardlawWood16_gr_mod_ref

#17 detectors
WardlawWood17_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
WardlawWood17_grframe<-data.frame(WardlawWood17_gr, samp2)
WardlawWood17_grframelong <- melt(WardlawWood17_grframe,id.vars="samp2")
WardlawWood17_grframelong_sum <- ddply(WardlawWood17_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood17_gr_max <- sum(WardlawWood17_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood17_gr_max
WardlawWood17_gr_pres <- sum(WardlawWood17_grframelong_sum $max > 0)
WardlawWood17_gr_pres

#number of sites which would be classified as low
WardlawWood17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood17_grframelong_sum$max)
WardlawWood17_gr_lw_ref
#number of sites which would be classified as high
WardlawWood17_gr_high_ref <- sum( WardlawWood17_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood17_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood17_gr_mod_ref <- 1000 - (WardlawWood17_gr_high_ref + WardlawWood17_gr_lw_ref)
WardlawWood17_gr_mod_ref

#18 detectors
WardlawWood18_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
WardlawWood18_grframe<-data.frame(WardlawWood18_gr, samp2)
WardlawWood18_grframelong <- melt(WardlawWood18_grframe,id.vars="samp2")
WardlawWood18_grframelong_sum <- ddply(WardlawWood18_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood18_gr_max <- sum(WardlawWood18_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood18_gr_max
WardlawWood18_gr_pres <- sum(WardlawWood18_grframelong_sum $max > 0)
WardlawWood18_gr_pres

#number of sites which would be classified as low
WardlawWood18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood18_grframelong_sum$max)
WardlawWood18_gr_lw_ref
#number of sites which would be classified as high
WardlawWood18_gr_high_ref <- sum( WardlawWood18_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood18_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood18_gr_mod_ref <- 1000 - (WardlawWood18_gr_high_ref + WardlawWood18_gr_lw_ref)
WardlawWood18_gr_mod_ref

#19 detectors
WardlawWood19_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
WardlawWood19_grframe<-data.frame(WardlawWood19_gr, samp2)
WardlawWood19_grframelong <- melt(WardlawWood19_grframe,id.vars="samp2")
WardlawWood19_grframelong_sum <- ddply(WardlawWood19_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood19_gr_max <- sum(WardlawWood19_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood19_gr_max
WardlawWood19_gr_pres <- sum(WardlawWood19_grframelong_sum $max > 0)
WardlawWood19_gr_pres

#number of sites which would be classified as low
WardlawWood19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood19_grframelong_sum$max)
WardlawWood19_gr_lw_ref
#number of sites which would be classified as high
WardlawWood19_gr_high_ref <- sum( WardlawWood19_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood19_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood19_gr_mod_ref <- 1000 - (WardlawWood19_gr_high_ref + WardlawWood19_gr_lw_ref)
WardlawWood19_gr_mod_ref

#20 detectors
WardlawWood20_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
WardlawWood20_grframe<-data.frame(WardlawWood20_gr, samp2)
WardlawWood20_grframelong <- melt(WardlawWood20_grframe,id.vars="samp2")
WardlawWood20_grframelong_sum <- ddply(WardlawWood20_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood20_gr_max <- sum(WardlawWood20_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood20_gr_max
WardlawWood20_gr_pres <- sum(WardlawWood20_grframelong_sum $max > 0)
WardlawWood20_gr_pres

#number of sites which would be classified as low
WardlawWood20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood20_grframelong_sum$max)
WardlawWood20_gr_lw_ref
#number of sites which would be classified as high
WardlawWood20_gr_high_ref <- sum( WardlawWood20_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood20_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood20_gr_mod_ref <- 1000 - (WardlawWood20_gr_high_ref + WardlawWood20_gr_lw_ref)
WardlawWood20_gr_mod_ref

#21 detectors
WardlawWood21_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
WardlawWood21_grframe<-data.frame(WardlawWood21_gr, samp2)
WardlawWood21_grframelong <- melt(WardlawWood21_grframe,id.vars="samp2")
WardlawWood21_grframelong_sum <- ddply(WardlawWood21_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood21_gr_max <- sum(WardlawWood21_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood21_gr_max
WardlawWood21_gr_pres <- sum(WardlawWood21_grframelong_sum $max > 0)
WardlawWood21_gr_pres

#number of sites which would be classified as low
WardlawWood21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood21_grframelong_sum$max)
WardlawWood21_gr_lw_ref
#number of sites which would be classified as high
WardlawWood21_gr_high_ref <- sum( WardlawWood21_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood21_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood21_gr_mod_ref <- 1000 - (WardlawWood21_gr_high_ref + WardlawWood21_gr_lw_ref)
WardlawWood21_gr_mod_ref

#22 detectors
WardlawWood22_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
WardlawWood22_grframe<-data.frame(WardlawWood22_gr, samp2)
WardlawWood22_grframelong <- melt(WardlawWood22_grframe,id.vars="samp2")
WardlawWood22_grframelong_sum <- ddply(WardlawWood22_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood22_gr_max <- sum(WardlawWood22_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood22_gr_max
WardlawWood22_gr_pres <- sum(WardlawWood22_grframelong_sum $max > 0)
WardlawWood22_gr_pres

#number of sites which would be classified as low
WardlawWood22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood22_grframelong_sum$max)
WardlawWood22_gr_lw_ref
#number of sites which would be classified as high
WardlawWood22_gr_high_ref <- sum( WardlawWood22_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood22_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood22_gr_mod_ref <- 1000 - (WardlawWood22_gr_high_ref + WardlawWood22_gr_lw_ref)
WardlawWood22_gr_mod_ref

#23 detectors
WardlawWood23_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
WardlawWood23_grframe<-data.frame(WardlawWood23_gr, samp2)
WardlawWood23_grframelong <- melt(WardlawWood23_grframe,id.vars="samp2")
WardlawWood23_grframelong_sum <- ddply(WardlawWood23_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood23_gr_max <- sum(WardlawWood23_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood23_gr_max
WardlawWood23_gr_pres <- sum(WardlawWood23_grframelong_sum $max > 0)
WardlawWood23_gr_pres

#number of sites which would be classified as low
WardlawWood23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood23_grframelong_sum$max)
WardlawWood23_gr_lw_ref
#number of sites which would be classified as high
WardlawWood23_gr_high_ref <- sum( WardlawWood23_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood23_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood23_gr_mod_ref <- 1000 - (WardlawWood23_gr_high_ref + WardlawWood23_gr_lw_ref)
WardlawWood23_gr_mod_ref

#24 detectors
WardlawWood24_gr<-(replicate(1000, (sample(WardlawWoodpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
WardlawWood24_grframe<-data.frame(WardlawWood24_gr, samp2)
WardlawWood24_grframelong <- melt(WardlawWood24_grframe,id.vars="samp2")
WardlawWood24_grframelong_sum <- ddply(WardlawWood24_grframelong, "variable", summarise,
                                       N    = length(value),
                                       max  = max(value))
WardlawWood24_gr_max <- sum(WardlawWood24_grframelong_sum $max > max20_WardlawWoodpipgr)
WardlawWood24_gr_max
WardlawWood24_gr_pres <- sum(WardlawWood24_grframelong_sum $max > 0)
WardlawWood24_gr_pres

#number of sites which would be classified as low
WardlawWood24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WardlawWood24_grframelong_sum$max)
WardlawWood24_gr_lw_ref
#number of sites which would be classified as high
WardlawWood24_gr_high_ref <- sum( WardlawWood24_grframelong_sum$max > allsppgr_ppip_ref_high)
WardlawWood24_gr_high_ref
#number of sites which would be classified as moderate
WardlawWood24_gr_mod_ref <- 1000 - (WardlawWood24_gr_high_ref + WardlawWood24_gr_lw_ref)
WardlawWood24_gr_mod_ref

Present<-c(WardlawWood1_gr_pres,WardlawWood2_gr_pres,
           WardlawWood3_gr_pres,WardlawWood4_gr_pres,
           WardlawWood5_gr_pres,WardlawWood6_gr_pres,
           WardlawWood7_gr_pres,WardlawWood8_gr_pres,
           WardlawWood9_gr_pres,WardlawWood10_gr_pres,
           WardlawWood11_gr_pres,WardlawWood12_gr_pres,
           WardlawWood13_gr_pres,WardlawWood14_gr_pres,
           WardlawWood15_gr_pres,WardlawWood16_gr_pres,
           WardlawWood17_gr_pres,WardlawWood18_gr_pres,
           WardlawWood19_gr_pres,WardlawWood20_gr_pres,
           WardlawWood21_gr_pres,WardlawWood22_gr_pres,
           WardlawWood23_gr_pres,WardlawWood24_gr_pres)


Maximum<-c(WardlawWood1_gr_max,WardlawWood2_gr_max,
           WardlawWood3_gr_max,WardlawWood4_gr_max,
           WardlawWood5_gr_max,WardlawWood6_gr_max,
           WardlawWood7_gr_max,WardlawWood8_gr_max,
           WardlawWood9_gr_max,WardlawWood10_gr_max,
           WardlawWood11_gr_max,WardlawWood12_gr_max,
           WardlawWood13_gr_max,WardlawWood14_gr_max,
           WardlawWood15_gr_max,WardlawWood16_gr_max,
           WardlawWood17_gr_max,WardlawWood18_gr_max,
           WardlawWood19_gr_max,WardlawWood20_gr_max,
           WardlawWood21_gr_max,WardlawWood22_gr_max,
           WardlawWood23_gr_max,WardlawWood24_gr_max)

Low<-c(WardlawWood1_gr_lw_ref, WardlawWood2_gr_lw_ref, WardlawWood3_gr_lw_ref,
       WardlawWood4_gr_lw_ref, WardlawWood5_gr_lw_ref, WardlawWood6_gr_lw_ref,
       WardlawWood7_gr_lw_ref, WardlawWood8_gr_lw_ref, WardlawWood9_gr_lw_ref,
       WardlawWood10_gr_lw_ref, WardlawWood11_gr_lw_ref, WardlawWood12_gr_lw_ref, 
       WardlawWood13_gr_lw_ref, WardlawWood14_gr_lw_ref, WardlawWood15_gr_lw_ref, 
       WardlawWood16_gr_lw_ref, WardlawWood17_gr_lw_ref, WardlawWood18_gr_lw_ref, 
       WardlawWood19_gr_lw_ref, WardlawWood20_gr_lw_ref, WardlawWood21_gr_lw_ref,
       WardlawWood22_gr_lw_ref,WardlawWood23_gr_lw_ref,WardlawWood24_gr_lw_ref)

Moderate<-c(WardlawWood1_gr_mod_ref, WardlawWood2_gr_mod_ref, WardlawWood3_gr_mod_ref,
            WardlawWood4_gr_mod_ref, WardlawWood5_gr_mod_ref, WardlawWood6_gr_mod_ref,
            WardlawWood7_gr_mod_ref, WardlawWood8_gr_mod_ref, WardlawWood9_gr_mod_ref,
            WardlawWood10_gr_mod_ref, WardlawWood11_gr_mod_ref, WardlawWood12_gr_mod_ref, 
            WardlawWood13_gr_mod_ref, WardlawWood14_gr_mod_ref, WardlawWood15_gr_mod_ref, 
            WardlawWood16_gr_mod_ref, WardlawWood17_gr_mod_ref, WardlawWood18_gr_mod_ref, 
            WardlawWood19_gr_mod_ref, WardlawWood20_gr_mod_ref, WardlawWood21_gr_mod_ref,
            WardlawWood22_gr_mod_ref,WardlawWood23_gr_mod_ref,WardlawWood24_gr_mod_ref)

High<-c(WardlawWood1_gr_high_ref, WardlawWood2_gr_high_ref, WardlawWood3_gr_high_ref,
        WardlawWood4_gr_high_ref, WardlawWood5_gr_high_ref, WardlawWood6_gr_high_ref,
        WardlawWood7_gr_high_ref, WardlawWood8_gr_high_ref, WardlawWood9_gr_high_ref,
        WardlawWood10_gr_high_ref, WardlawWood11_gr_high_ref, WardlawWood12_gr_high_ref, 
        WardlawWood13_gr_high_ref, WardlawWood14_gr_high_ref, WardlawWood15_gr_high_ref, 
        WardlawWood16_gr_high_ref, WardlawWood17_gr_high_ref, WardlawWood18_gr_high_ref, 
        WardlawWood19_gr_high_ref, WardlawWood20_gr_high_ref, WardlawWood21_gr_high_ref,
        WardlawWood22_gr_high_ref,WardlawWood23_gr_high_ref,WardlawWood24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("WardlawWoodgr",24)
Lowsite <- WardlawWoodlow
Modsite <- WardlawWoodmod
Highsite <-WardlawWoodhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



WardlawWoodgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                  Site, Low, Moderate, High,
                                  Lowsite, Modsite, Highsite)

##WestDurham

WestDurhampipgr<-subset(allspp4gr_ppip, Site=="WestDurham")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_WestDurhampipgr<-max(WestDurhampipgr$Passes)

#calculate 20% from maximum nightly record

max20_WestDurhampipgr<- (max_WestDurhampipgr/100)*80

##calculate the site classification (reference range)

WestDurhamhigh<- max_WestDurhampipgr > allsppgr_ppip_ref_high

WestDurhamlow<- allsppgr_ppip_ref_low > max_WestDurhampipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_WestDurhampipgr
WestDurhammod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
WestDurham1_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 1, replace=F))))
WestDurham1_gr_max <- sum(WestDurham1_gr > max20_WestDurhampipgr)
WestDurham1_gr_max
WestDurham1_gr_pres <- sum(WestDurham1_gr > 0)
WestDurham1_gr_pres
#number of sites which would be classified as low
WestDurham1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham1_gr)
WestDurham1_gr_lw_ref
#number of sites which would be classified as high
WestDurham1_gr_high_ref <- sum( WestDurham1_gr > allsppgr_ppip_ref_high)
WestDurham1_gr_high_ref
#number of sites which would be classified as moderate
WestDurham1_gr_mod_ref <- 1000 - (WestDurham1_gr_high_ref + WestDurham1_gr_lw_ref)
WestDurham1_gr_mod_ref


#2 nights
WestDurham2_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
WestDurham2_grframe<-data.frame(WestDurham2_gr, samp2)
WestDurham2_grframelong <- melt(WestDurham2_grframe,id.vars="samp2")
WestDurham2_grframelong_sum <- ddply(WestDurham2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham2_gr_max <- sum(WestDurham2_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham2_gr_max
WestDurham2_gr_pres <- sum(WestDurham2_grframelong_sum $max > 0)
WestDurham2_gr_pres

#number of sites which would be classified as low
WestDurham2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham2_grframelong_sum$max)
WestDurham2_gr_lw_ref
#number of sites which would be classified as high
WestDurham2_gr_high_ref <- sum( WestDurham2_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham2_gr_high_ref
#number of sites which would be classified as moderate
WestDurham2_gr_mod_ref <- 1000 - (WestDurham2_gr_high_ref + WestDurham2_gr_lw_ref)
WestDurham2_gr_mod_ref


#3 nights
WestDurham3_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
WestDurham3_grframe<-data.frame(WestDurham3_gr, samp2)
WestDurham3_grframelong <- melt(WestDurham3_grframe,id.vars="samp2")
WestDurham3_grframelong_sum <- ddply(WestDurham3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham3_gr_max <- sum(WestDurham3_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham3_gr_max
WestDurham3_gr_pres <- sum(WestDurham3_grframelong_sum $max > 0)
WestDurham3_gr_pres

#number of sites which would be classified as low
WestDurham3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham3_grframelong_sum$max)
WestDurham3_gr_lw_ref
#number of sites which would be classified as high
WestDurham3_gr_high_ref <- sum( WestDurham3_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham3_gr_high_ref
#number of sites which would be classified as moderate
WestDurham3_gr_mod_ref <- 1000 - (WestDurham3_gr_high_ref + WestDurham3_gr_lw_ref)
WestDurham3_gr_mod_ref

#4 nights
WestDurham4_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
WestDurham4_grframe<-data.frame(WestDurham4_gr, samp2)
WestDurham4_grframelong <- melt(WestDurham4_grframe,id.vars="samp2")
WestDurham4_grframelong_sum <- ddply(WestDurham4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham4_gr_max <- sum(WestDurham4_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham4_gr_max
WestDurham4_gr_pres <- sum(WestDurham4_grframelong_sum $max > 0)
WestDurham4_gr_pres

#number of sites which would be classified as low
WestDurham4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham4_grframelong_sum$max)
WestDurham4_gr_lw_ref
#number of sites which would be classified as high
WestDurham4_gr_high_ref <- sum( WestDurham4_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham4_gr_high_ref
#number of sites which would be classified as moderate
WestDurham4_gr_mod_ref <- 1000 - (WestDurham4_gr_high_ref + WestDurham4_gr_lw_ref)
WestDurham4_gr_mod_ref

#5 nights
WestDurham5_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
WestDurham5_grframe<-data.frame(WestDurham5_gr, samp2)
WestDurham5_grframelong <- melt(WestDurham5_grframe,id.vars="samp2")
WestDurham5_grframelong_sum <- ddply(WestDurham5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham5_gr_max <- sum(WestDurham5_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham5_gr_max
WestDurham5_gr_pres <- sum(WestDurham5_grframelong_sum $max > 0)
WestDurham5_gr_pres

#number of sites which would be classified as low
WestDurham5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham5_grframelong_sum$max)
WestDurham5_gr_lw_ref
#number of sites which would be classified as high
WestDurham5_gr_high_ref <- sum( WestDurham5_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham5_gr_high_ref
#number of sites which would be classified as moderate
WestDurham5_gr_mod_ref <- 1000 - (WestDurham5_gr_high_ref + WestDurham5_gr_lw_ref)
WestDurham5_gr_mod_ref

#6 nights
WestDurham6_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
WestDurham6_grframe<-data.frame(WestDurham6_gr, samp2)
WestDurham6_grframelong <- melt(WestDurham6_grframe,id.vars="samp2")
WestDurham6_grframelong_sum <- ddply(WestDurham6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham6_gr_max <- sum(WestDurham6_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham6_gr_max
WestDurham6_gr_pres <- sum(WestDurham6_grframelong_sum $max > 0)
WestDurham6_gr_pres

#number of sites which would be classified as low
WestDurham6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham6_grframelong_sum$max)
WestDurham6_gr_lw_ref
#number of sites which would be classified as high
WestDurham6_gr_high_ref <- sum( WestDurham6_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham6_gr_high_ref
#number of sites which would be classified as moderate
WestDurham6_gr_mod_ref <- 1000 - (WestDurham6_gr_high_ref + WestDurham6_gr_lw_ref)
WestDurham6_gr_mod_ref

#7 nights
WestDurham7_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
WestDurham7_grframe<-data.frame(WestDurham7_gr, samp2)
WestDurham7_grframelong <- melt(WestDurham7_grframe,id.vars="samp2")
WestDurham7_grframelong_sum <- ddply(WestDurham7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham7_gr_max <- sum(WestDurham7_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham7_gr_max
WestDurham7_gr_pres <- sum(WestDurham7_grframelong_sum $max > 0)
WestDurham7_gr_pres

#number of sites which would be classified as low
WestDurham7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham7_grframelong_sum$max)
WestDurham7_gr_lw_ref
#number of sites which would be classified as high
WestDurham7_gr_high_ref <- sum( WestDurham7_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham7_gr_high_ref
#number of sites which would be classified as moderate
WestDurham7_gr_mod_ref <- 1000 - (WestDurham7_gr_high_ref + WestDurham7_gr_lw_ref)
WestDurham7_gr_mod_ref

#8 nights
WestDurham8_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
WestDurham8_grframe<-data.frame(WestDurham8_gr, samp2)
WestDurham8_grframelong <- melt(WestDurham8_grframe,id.vars="samp2")
WestDurham8_grframelong_sum <- ddply(WestDurham8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham8_gr_max <- sum(WestDurham8_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham8_gr_max
WestDurham8_gr_pres <- sum(WestDurham8_grframelong_sum $max > 0)
WestDurham8_gr_pres

#number of sites which would be classified as low
WestDurham8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham8_grframelong_sum$max)
WestDurham8_gr_lw_ref
#number of sites which would be classified as high
WestDurham8_gr_high_ref <- sum( WestDurham8_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham8_gr_high_ref
#number of sites which would be classified as moderate
WestDurham8_gr_mod_ref <- 1000 - (WestDurham8_gr_high_ref + WestDurham8_gr_lw_ref)
WestDurham8_gr_mod_ref

#9 nights
WestDurham9_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
WestDurham9_grframe<-data.frame(WestDurham9_gr, samp2)
WestDurham9_grframelong <- melt(WestDurham9_grframe,id.vars="samp2")
WestDurham9_grframelong_sum <- ddply(WestDurham9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
WestDurham9_gr_max <- sum(WestDurham9_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham9_gr_max
WestDurham9_gr_pres <- sum(WestDurham9_grframelong_sum $max > 0)
WestDurham9_gr_pres

#number of sites which would be classified as low
WestDurham9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham9_grframelong_sum$max)
WestDurham9_gr_lw_ref
#number of sites which would be classified as high
WestDurham9_gr_high_ref <- sum( WestDurham9_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham9_gr_high_ref
#number of sites which would be classified as moderate
WestDurham9_gr_mod_ref <- 1000 - (WestDurham9_gr_high_ref + WestDurham9_gr_lw_ref)
WestDurham9_gr_mod_ref

#10 detectors
WestDurham10_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
WestDurham10_grframe<-data.frame(WestDurham10_gr, samp2)
WestDurham10_grframelong <- melt(WestDurham10_grframe,id.vars="samp2")
WestDurham10_grframelong_sum <- ddply(WestDurham10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham10_gr_max <- sum(WestDurham10_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham10_gr_max
WestDurham10_gr_pres <- sum(WestDurham10_grframelong_sum $max > 0)
WestDurham10_gr_pres

#number of sites which would be classified as low
WestDurham10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham10_grframelong_sum$max)
WestDurham10_gr_lw_ref
#number of sites which would be classified as high
WestDurham10_gr_high_ref <- sum( WestDurham10_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham10_gr_high_ref
#number of sites which would be classified as moderate
WestDurham10_gr_mod_ref <- 1000 - (WestDurham10_gr_high_ref + WestDurham10_gr_lw_ref)
WestDurham10_gr_mod_ref

#11 detectors
WestDurham11_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
WestDurham11_grframe<-data.frame(WestDurham11_gr, samp2)
WestDurham11_grframelong <- melt(WestDurham11_grframe,id.vars="samp2")
WestDurham11_grframelong_sum <- ddply(WestDurham11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham11_gr_max <- sum(WestDurham11_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham11_gr_max
WestDurham11_gr_pres <- sum(WestDurham11_grframelong_sum $max > 0)
WestDurham11_gr_pres

#number of sites which would be classified as low
WestDurham11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham11_grframelong_sum$max)
WestDurham11_gr_lw_ref
#number of sites which would be classified as high
WestDurham11_gr_high_ref <- sum( WestDurham11_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham11_gr_high_ref
#number of sites which would be classified as moderate
WestDurham11_gr_mod_ref <- 1000 - (WestDurham11_gr_high_ref + WestDurham11_gr_lw_ref)
WestDurham11_gr_mod_ref

#12 detectors
WestDurham12_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
WestDurham12_grframe<-data.frame(WestDurham12_gr, samp2)
WestDurham12_grframelong <- melt(WestDurham12_grframe,id.vars="samp2")
WestDurham12_grframelong_sum <- ddply(WestDurham12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham12_gr_max <- sum(WestDurham12_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham12_gr_max
WestDurham12_gr_pres <- sum(WestDurham12_grframelong_sum $max > 0)
WestDurham12_gr_pres

#number of sites which would be classified as low
WestDurham12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham12_grframelong_sum$max)
WestDurham12_gr_lw_ref
#number of sites which would be classified as high
WestDurham12_gr_high_ref <- sum( WestDurham12_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham12_gr_high_ref
#number of sites which would be classified as moderate
WestDurham12_gr_mod_ref <- 1000 - (WestDurham12_gr_high_ref + WestDurham12_gr_lw_ref)
WestDurham12_gr_mod_ref

#13 detectors
WestDurham13_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
WestDurham13_grframe<-data.frame(WestDurham13_gr, samp2)
WestDurham13_grframelong <- melt(WestDurham13_grframe,id.vars="samp2")
WestDurham13_grframelong_sum <- ddply(WestDurham13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham13_gr_max <- sum(WestDurham13_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham13_gr_max
WestDurham13_gr_pres <- sum(WestDurham13_grframelong_sum $max > 0)
WestDurham13_gr_pres

#number of sites which would be classified as low
WestDurham13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham13_grframelong_sum$max)
WestDurham13_gr_lw_ref
#number of sites which would be classified as high
WestDurham13_gr_high_ref <- sum( WestDurham13_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham13_gr_high_ref
#number of sites which would be classified as moderate
WestDurham13_gr_mod_ref <- 1000 - (WestDurham13_gr_high_ref + WestDurham13_gr_lw_ref)
WestDurham13_gr_mod_ref

#14 detectors
WestDurham14_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
WestDurham14_grframe<-data.frame(WestDurham14_gr, samp2)
WestDurham14_grframelong <- melt(WestDurham14_grframe,id.vars="samp2")
WestDurham14_grframelong_sum <- ddply(WestDurham14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham14_gr_max <- sum(WestDurham14_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham14_gr_max
WestDurham14_gr_pres <- sum(WestDurham14_grframelong_sum $max > 0)
WestDurham14_gr_pres

#number of sites which would be classified as low
WestDurham14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham14_grframelong_sum$max)
WestDurham14_gr_lw_ref
#number of sites which would be classified as high
WestDurham14_gr_high_ref <- sum( WestDurham14_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham14_gr_high_ref
#number of sites which would be classified as moderate
WestDurham14_gr_mod_ref <- 1000 - (WestDurham14_gr_high_ref + WestDurham14_gr_lw_ref)
WestDurham14_gr_mod_ref

#15 detectors
WestDurham15_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
WestDurham15_grframe<-data.frame(WestDurham15_gr, samp2)
WestDurham15_grframelong <- melt(WestDurham15_grframe,id.vars="samp2")
WestDurham15_grframelong_sum <- ddply(WestDurham15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham15_gr_max <- sum(WestDurham15_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham15_gr_max
WestDurham15_gr_pres <- sum(WestDurham15_grframelong_sum $max > 0)
WestDurham15_gr_pres

#number of sites which would be classified as low
WestDurham15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham15_grframelong_sum$max)
WestDurham15_gr_lw_ref
#number of sites which would be classified as high
WestDurham15_gr_high_ref <- sum( WestDurham15_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham15_gr_high_ref
#number of sites which would be classified as moderate
WestDurham15_gr_mod_ref <- 1000 - (WestDurham15_gr_high_ref + WestDurham15_gr_lw_ref)
WestDurham15_gr_mod_ref

#16 detectors
WestDurham16_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
WestDurham16_grframe<-data.frame(WestDurham16_gr, samp2)
WestDurham16_grframelong <- melt(WestDurham16_grframe,id.vars="samp2")
WestDurham16_grframelong_sum <- ddply(WestDurham16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham16_gr_max <- sum(WestDurham16_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham16_gr_max
WestDurham16_gr_pres <- sum(WestDurham16_grframelong_sum $max > 0)
WestDurham16_gr_pres

#number of sites which would be classified as low
WestDurham16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham16_grframelong_sum$max)
WestDurham16_gr_lw_ref
#number of sites which would be classified as high
WestDurham16_gr_high_ref <- sum( WestDurham16_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham16_gr_high_ref
#number of sites which would be classified as moderate
WestDurham16_gr_mod_ref <- 1000 - (WestDurham16_gr_high_ref + WestDurham16_gr_lw_ref)
WestDurham16_gr_mod_ref

#17 detectors
WestDurham17_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
WestDurham17_grframe<-data.frame(WestDurham17_gr, samp2)
WestDurham17_grframelong <- melt(WestDurham17_grframe,id.vars="samp2")
WestDurham17_grframelong_sum <- ddply(WestDurham17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham17_gr_max <- sum(WestDurham17_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham17_gr_max
WestDurham17_gr_pres <- sum(WestDurham17_grframelong_sum $max > 0)
WestDurham17_gr_pres

#number of sites which would be classified as low
WestDurham17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham17_grframelong_sum$max)
WestDurham17_gr_lw_ref
#number of sites which would be classified as high
WestDurham17_gr_high_ref <- sum( WestDurham17_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham17_gr_high_ref
#number of sites which would be classified as moderate
WestDurham17_gr_mod_ref <- 1000 - (WestDurham17_gr_high_ref + WestDurham17_gr_lw_ref)
WestDurham17_gr_mod_ref

#18 detectors
WestDurham18_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
WestDurham18_grframe<-data.frame(WestDurham18_gr, samp2)
WestDurham18_grframelong <- melt(WestDurham18_grframe,id.vars="samp2")
WestDurham18_grframelong_sum <- ddply(WestDurham18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham18_gr_max <- sum(WestDurham18_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham18_gr_max
WestDurham18_gr_pres <- sum(WestDurham18_grframelong_sum $max > 0)
WestDurham18_gr_pres

#number of sites which would be classified as low
WestDurham18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham18_grframelong_sum$max)
WestDurham18_gr_lw_ref
#number of sites which would be classified as high
WestDurham18_gr_high_ref <- sum( WestDurham18_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham18_gr_high_ref
#number of sites which would be classified as moderate
WestDurham18_gr_mod_ref <- 1000 - (WestDurham18_gr_high_ref + WestDurham18_gr_lw_ref)
WestDurham18_gr_mod_ref

#19 detectors
WestDurham19_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
WestDurham19_grframe<-data.frame(WestDurham19_gr, samp2)
WestDurham19_grframelong <- melt(WestDurham19_grframe,id.vars="samp2")
WestDurham19_grframelong_sum <- ddply(WestDurham19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham19_gr_max <- sum(WestDurham19_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham19_gr_max
WestDurham19_gr_pres <- sum(WestDurham19_grframelong_sum $max > 0)
WestDurham19_gr_pres

#number of sites which would be classified as low
WestDurham19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham19_grframelong_sum$max)
WestDurham19_gr_lw_ref
#number of sites which would be classified as high
WestDurham19_gr_high_ref <- sum( WestDurham19_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham19_gr_high_ref
#number of sites which would be classified as moderate
WestDurham19_gr_mod_ref <- 1000 - (WestDurham19_gr_high_ref + WestDurham19_gr_lw_ref)
WestDurham19_gr_mod_ref

#20 detectors
WestDurham20_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
WestDurham20_grframe<-data.frame(WestDurham20_gr, samp2)
WestDurham20_grframelong <- melt(WestDurham20_grframe,id.vars="samp2")
WestDurham20_grframelong_sum <- ddply(WestDurham20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham20_gr_max <- sum(WestDurham20_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham20_gr_max
WestDurham20_gr_pres <- sum(WestDurham20_grframelong_sum $max > 0)
WestDurham20_gr_pres

#number of sites which would be classified as low
WestDurham20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham20_grframelong_sum$max)
WestDurham20_gr_lw_ref
#number of sites which would be classified as high
WestDurham20_gr_high_ref <- sum( WestDurham20_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham20_gr_high_ref
#number of sites which would be classified as moderate
WestDurham20_gr_mod_ref <- 1000 - (WestDurham20_gr_high_ref + WestDurham20_gr_lw_ref)
WestDurham20_gr_mod_ref

#21 detectors
WestDurham21_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
WestDurham21_grframe<-data.frame(WestDurham21_gr, samp2)
WestDurham21_grframelong <- melt(WestDurham21_grframe,id.vars="samp2")
WestDurham21_grframelong_sum <- ddply(WestDurham21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham21_gr_max <- sum(WestDurham21_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham21_gr_max
WestDurham21_gr_pres <- sum(WestDurham21_grframelong_sum $max > 0)
WestDurham21_gr_pres

#number of sites which would be classified as low
WestDurham21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham21_grframelong_sum$max)
WestDurham21_gr_lw_ref
#number of sites which would be classified as high
WestDurham21_gr_high_ref <- sum( WestDurham21_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham21_gr_high_ref
#number of sites which would be classified as moderate
WestDurham21_gr_mod_ref <- 1000 - (WestDurham21_gr_high_ref + WestDurham21_gr_lw_ref)
WestDurham21_gr_mod_ref

#22 detectors
WestDurham22_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
WestDurham22_grframe<-data.frame(WestDurham22_gr, samp2)
WestDurham22_grframelong <- melt(WestDurham22_grframe,id.vars="samp2")
WestDurham22_grframelong_sum <- ddply(WestDurham22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham22_gr_max <- sum(WestDurham22_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham22_gr_max
WestDurham22_gr_pres <- sum(WestDurham22_grframelong_sum $max > 0)
WestDurham22_gr_pres

#number of sites which would be classified as low
WestDurham22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham22_grframelong_sum$max)
WestDurham22_gr_lw_ref
#number of sites which would be classified as high
WestDurham22_gr_high_ref <- sum( WestDurham22_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham22_gr_high_ref
#number of sites which would be classified as moderate
WestDurham22_gr_mod_ref <- 1000 - (WestDurham22_gr_high_ref + WestDurham22_gr_lw_ref)
WestDurham22_gr_mod_ref

#23 detectors
WestDurham23_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
WestDurham23_grframe<-data.frame(WestDurham23_gr, samp2)
WestDurham23_grframelong <- melt(WestDurham23_grframe,id.vars="samp2")
WestDurham23_grframelong_sum <- ddply(WestDurham23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham23_gr_max <- sum(WestDurham23_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham23_gr_max
WestDurham23_gr_pres <- sum(WestDurham23_grframelong_sum $max > 0)
WestDurham23_gr_pres

#number of sites which would be classified as low
WestDurham23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham23_grframelong_sum$max)
WestDurham23_gr_lw_ref
#number of sites which would be classified as high
WestDurham23_gr_high_ref <- sum( WestDurham23_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham23_gr_high_ref
#number of sites which would be classified as moderate
WestDurham23_gr_mod_ref <- 1000 - (WestDurham23_gr_high_ref + WestDurham23_gr_lw_ref)
WestDurham23_gr_mod_ref

#24 detectors
WestDurham24_gr<-(replicate(1000, (sample(WestDurhampipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
WestDurham24_grframe<-data.frame(WestDurham24_gr, samp2)
WestDurham24_grframelong <- melt(WestDurham24_grframe,id.vars="samp2")
WestDurham24_grframelong_sum <- ddply(WestDurham24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
WestDurham24_gr_max <- sum(WestDurham24_grframelong_sum $max > max20_WestDurhampipgr)
WestDurham24_gr_max
WestDurham24_gr_pres <- sum(WestDurham24_grframelong_sum $max > 0)
WestDurham24_gr_pres

#number of sites which would be classified as low
WestDurham24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= WestDurham24_grframelong_sum$max)
WestDurham24_gr_lw_ref
#number of sites which would be classified as high
WestDurham24_gr_high_ref <- sum( WestDurham24_grframelong_sum$max > allsppgr_ppip_ref_high)
WestDurham24_gr_high_ref
#number of sites which would be classified as moderate
WestDurham24_gr_mod_ref <- 1000 - (WestDurham24_gr_high_ref + WestDurham24_gr_lw_ref)
WestDurham24_gr_mod_ref

Present<-c(WestDurham1_gr_pres,WestDurham2_gr_pres,
           WestDurham3_gr_pres,WestDurham4_gr_pres,
           WestDurham5_gr_pres,WestDurham6_gr_pres,
           WestDurham7_gr_pres,WestDurham8_gr_pres,
           WestDurham9_gr_pres,WestDurham10_gr_pres,
           WestDurham11_gr_pres,WestDurham12_gr_pres,
           WestDurham13_gr_pres,WestDurham14_gr_pres,
           WestDurham15_gr_pres,WestDurham16_gr_pres,
           WestDurham17_gr_pres,WestDurham18_gr_pres,
           WestDurham19_gr_pres,WestDurham20_gr_pres,
           WestDurham21_gr_pres,WestDurham22_gr_pres,
           WestDurham23_gr_pres,WestDurham24_gr_pres)


Maximum<-c(WestDurham1_gr_max,WestDurham2_gr_max,
           WestDurham3_gr_max,WestDurham4_gr_max,
           WestDurham5_gr_max,WestDurham6_gr_max,
           WestDurham7_gr_max,WestDurham8_gr_max,
           WestDurham9_gr_max,WestDurham10_gr_max,
           WestDurham11_gr_max,WestDurham12_gr_max,
           WestDurham13_gr_max,WestDurham14_gr_max,
           WestDurham15_gr_max,WestDurham16_gr_max,
           WestDurham17_gr_max,WestDurham18_gr_max,
           WestDurham19_gr_max,WestDurham20_gr_max,
           WestDurham21_gr_max,WestDurham22_gr_max,
           WestDurham23_gr_max,WestDurham24_gr_max)

Low<-c(WestDurham1_gr_lw_ref, WestDurham2_gr_lw_ref, WestDurham3_gr_lw_ref,
       WestDurham4_gr_lw_ref, WestDurham5_gr_lw_ref, WestDurham6_gr_lw_ref,
       WestDurham7_gr_lw_ref, WestDurham8_gr_lw_ref, WestDurham9_gr_lw_ref,
       WestDurham10_gr_lw_ref, WestDurham11_gr_lw_ref, WestDurham12_gr_lw_ref, 
       WestDurham13_gr_lw_ref, WestDurham14_gr_lw_ref, WestDurham15_gr_lw_ref, 
       WestDurham16_gr_lw_ref, WestDurham17_gr_lw_ref, WestDurham18_gr_lw_ref, 
       WestDurham19_gr_lw_ref, WestDurham20_gr_lw_ref, WestDurham21_gr_lw_ref,
       WestDurham22_gr_lw_ref,WestDurham23_gr_lw_ref,WestDurham24_gr_lw_ref)

Moderate<-c(WestDurham1_gr_mod_ref, WestDurham2_gr_mod_ref, WestDurham3_gr_mod_ref,
            WestDurham4_gr_mod_ref, WestDurham5_gr_mod_ref, WestDurham6_gr_mod_ref,
            WestDurham7_gr_mod_ref, WestDurham8_gr_mod_ref, WestDurham9_gr_mod_ref,
            WestDurham10_gr_mod_ref, WestDurham11_gr_mod_ref, WestDurham12_gr_mod_ref, 
            WestDurham13_gr_mod_ref, WestDurham14_gr_mod_ref, WestDurham15_gr_mod_ref, 
            WestDurham16_gr_mod_ref, WestDurham17_gr_mod_ref, WestDurham18_gr_mod_ref, 
            WestDurham19_gr_mod_ref, WestDurham20_gr_mod_ref, WestDurham21_gr_mod_ref,
            WestDurham22_gr_mod_ref,WestDurham23_gr_mod_ref,WestDurham24_gr_mod_ref)

High<-c(WestDurham1_gr_high_ref, WestDurham2_gr_high_ref, WestDurham3_gr_high_ref,
        WestDurham4_gr_high_ref, WestDurham5_gr_high_ref, WestDurham6_gr_high_ref,
        WestDurham7_gr_high_ref, WestDurham8_gr_high_ref, WestDurham9_gr_high_ref,
        WestDurham10_gr_high_ref, WestDurham11_gr_high_ref, WestDurham12_gr_high_ref, 
        WestDurham13_gr_high_ref, WestDurham14_gr_high_ref, WestDurham15_gr_high_ref, 
        WestDurham16_gr_high_ref, WestDurham17_gr_high_ref, WestDurham18_gr_high_ref, 
        WestDurham19_gr_high_ref, WestDurham20_gr_high_ref, WestDurham21_gr_high_ref,
        WestDurham22_gr_high_ref,WestDurham23_gr_high_ref,WestDurham24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("WestDurhamgr",24)
Lowsite <- WestDurhamlow
Modsite <- WestDurhammod
Highsite <-WestDurhamhigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



WestDurhamgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Yelvertoft

Yelvertoftpipgr<-subset(allspp4gr_ppip, Site=="Yelvertoft")



#Look at ground first

#.	Determine the maximum nightly record of bat activity (per detector per night)
#for a site

max_Yelvertoftpipgr<-max(Yelvertoftpipgr$Passes)

#calculate 20% from maximum nightly record

max20_Yelvertoftpipgr<- (max_Yelvertoftpipgr/100)*80

##calculate the site classification (reference range)

Yelvertofthigh<- max_Yelvertoftpipgr > allsppgr_ppip_ref_high

Yelvertoftlow<- allsppgr_ppip_ref_low > max_Yelvertoftpipgr
#longer code for mod
is.between <- function(x, a, b) {
  x > a & x < b
}
x <- max_Yelvertoftpipgr
Yelvertoftmod<- is.between(x, allsppgr_ppip_ref_low, allsppgr_ppip_ref_high)

###############################
########## this is if we want to just select from all data combined
##see below for stratifying by night or recording
Yelvertoft1_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 1, replace=F))))
Yelvertoft1_gr_max <- sum(Yelvertoft1_gr > max20_Yelvertoftpipgr)
Yelvertoft1_gr_max
Yelvertoft1_gr_pres <- sum(Yelvertoft1_gr > 0)
Yelvertoft1_gr_pres
#number of sites which would be classified as low
Yelvertoft1_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft1_gr)
Yelvertoft1_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft1_gr_high_ref <- sum( Yelvertoft1_gr > allsppgr_ppip_ref_high)
Yelvertoft1_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft1_gr_mod_ref <- 1000 - (Yelvertoft1_gr_high_ref + Yelvertoft1_gr_lw_ref)
Yelvertoft1_gr_mod_ref


#2 nights
Yelvertoft2_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 2, replace=F))))
samp2<-c(1,2)
Yelvertoft2_grframe<-data.frame(Yelvertoft2_gr, samp2)
Yelvertoft2_grframelong <- melt(Yelvertoft2_grframe,id.vars="samp2")
Yelvertoft2_grframelong_sum <- ddply(Yelvertoft2_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft2_gr_max <- sum(Yelvertoft2_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft2_gr_max
Yelvertoft2_gr_pres <- sum(Yelvertoft2_grframelong_sum $max > 0)
Yelvertoft2_gr_pres

#number of sites which would be classified as low
Yelvertoft2_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft2_grframelong_sum$max)
Yelvertoft2_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft2_gr_high_ref <- sum( Yelvertoft2_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft2_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft2_gr_mod_ref <- 1000 - (Yelvertoft2_gr_high_ref + Yelvertoft2_gr_lw_ref)
Yelvertoft2_gr_mod_ref


#3 nights
Yelvertoft3_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 3, replace=F))))
samp2<-c(1:3)
Yelvertoft3_grframe<-data.frame(Yelvertoft3_gr, samp2)
Yelvertoft3_grframelong <- melt(Yelvertoft3_grframe,id.vars="samp2")
Yelvertoft3_grframelong_sum <- ddply(Yelvertoft3_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft3_gr_max <- sum(Yelvertoft3_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft3_gr_max
Yelvertoft3_gr_pres <- sum(Yelvertoft3_grframelong_sum $max > 0)
Yelvertoft3_gr_pres

#number of sites which would be classified as low
Yelvertoft3_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft3_grframelong_sum$max)
Yelvertoft3_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft3_gr_high_ref <- sum( Yelvertoft3_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft3_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft3_gr_mod_ref <- 1000 - (Yelvertoft3_gr_high_ref + Yelvertoft3_gr_lw_ref)
Yelvertoft3_gr_mod_ref

#4 nights
Yelvertoft4_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 4, replace=F))))
samp2<-c(1:4)
Yelvertoft4_grframe<-data.frame(Yelvertoft4_gr, samp2)
Yelvertoft4_grframelong <- melt(Yelvertoft4_grframe,id.vars="samp2")
Yelvertoft4_grframelong_sum <- ddply(Yelvertoft4_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft4_gr_max <- sum(Yelvertoft4_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft4_gr_max
Yelvertoft4_gr_pres <- sum(Yelvertoft4_grframelong_sum $max > 0)
Yelvertoft4_gr_pres

#number of sites which would be classified as low
Yelvertoft4_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft4_grframelong_sum$max)
Yelvertoft4_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft4_gr_high_ref <- sum( Yelvertoft4_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft4_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft4_gr_mod_ref <- 1000 - (Yelvertoft4_gr_high_ref + Yelvertoft4_gr_lw_ref)
Yelvertoft4_gr_mod_ref

#5 nights
Yelvertoft5_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 5, replace=F))))
samp2<-c(1:5)
Yelvertoft5_grframe<-data.frame(Yelvertoft5_gr, samp2)
Yelvertoft5_grframelong <- melt(Yelvertoft5_grframe,id.vars="samp2")
Yelvertoft5_grframelong_sum <- ddply(Yelvertoft5_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft5_gr_max <- sum(Yelvertoft5_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft5_gr_max
Yelvertoft5_gr_pres <- sum(Yelvertoft5_grframelong_sum $max > 0)
Yelvertoft5_gr_pres

#number of sites which would be classified as low
Yelvertoft5_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft5_grframelong_sum$max)
Yelvertoft5_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft5_gr_high_ref <- sum( Yelvertoft5_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft5_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft5_gr_mod_ref <- 1000 - (Yelvertoft5_gr_high_ref + Yelvertoft5_gr_lw_ref)
Yelvertoft5_gr_mod_ref

#6 nights
Yelvertoft6_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 6, replace=F))))
samp2<-c(1:6)
Yelvertoft6_grframe<-data.frame(Yelvertoft6_gr, samp2)
Yelvertoft6_grframelong <- melt(Yelvertoft6_grframe,id.vars="samp2")
Yelvertoft6_grframelong_sum <- ddply(Yelvertoft6_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft6_gr_max <- sum(Yelvertoft6_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft6_gr_max
Yelvertoft6_gr_pres <- sum(Yelvertoft6_grframelong_sum $max > 0)
Yelvertoft6_gr_pres

#number of sites which would be classified as low
Yelvertoft6_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft6_grframelong_sum$max)
Yelvertoft6_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft6_gr_high_ref <- sum( Yelvertoft6_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft6_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft6_gr_mod_ref <- 1000 - (Yelvertoft6_gr_high_ref + Yelvertoft6_gr_lw_ref)
Yelvertoft6_gr_mod_ref

#7 nights
Yelvertoft7_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 7, replace=F))))
samp2<-c(1:7)
Yelvertoft7_grframe<-data.frame(Yelvertoft7_gr, samp2)
Yelvertoft7_grframelong <- melt(Yelvertoft7_grframe,id.vars="samp2")
Yelvertoft7_grframelong_sum <- ddply(Yelvertoft7_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft7_gr_max <- sum(Yelvertoft7_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft7_gr_max
Yelvertoft7_gr_pres <- sum(Yelvertoft7_grframelong_sum $max > 0)
Yelvertoft7_gr_pres

#number of sites which would be classified as low
Yelvertoft7_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft7_grframelong_sum$max)
Yelvertoft7_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft7_gr_high_ref <- sum( Yelvertoft7_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft7_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft7_gr_mod_ref <- 1000 - (Yelvertoft7_gr_high_ref + Yelvertoft7_gr_lw_ref)
Yelvertoft7_gr_mod_ref

#8 nights
Yelvertoft8_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 8, replace=F))))
samp2<-c(1:8)
Yelvertoft8_grframe<-data.frame(Yelvertoft8_gr, samp2)
Yelvertoft8_grframelong <- melt(Yelvertoft8_grframe,id.vars="samp2")
Yelvertoft8_grframelong_sum <- ddply(Yelvertoft8_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft8_gr_max <- sum(Yelvertoft8_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft8_gr_max
Yelvertoft8_gr_pres <- sum(Yelvertoft8_grframelong_sum $max > 0)
Yelvertoft8_gr_pres

#number of sites which would be classified as low
Yelvertoft8_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft8_grframelong_sum$max)
Yelvertoft8_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft8_gr_high_ref <- sum( Yelvertoft8_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft8_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft8_gr_mod_ref <- 1000 - (Yelvertoft8_gr_high_ref + Yelvertoft8_gr_lw_ref)
Yelvertoft8_gr_mod_ref

#9 nights
Yelvertoft9_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 9, replace=F))))
samp2<-c(1:9)
Yelvertoft9_grframe<-data.frame(Yelvertoft9_gr, samp2)
Yelvertoft9_grframelong <- melt(Yelvertoft9_grframe,id.vars="samp2")
Yelvertoft9_grframelong_sum <- ddply(Yelvertoft9_grframelong, "variable", summarise,
                                     N    = length(value),
                                     max  = max(value))
Yelvertoft9_gr_max <- sum(Yelvertoft9_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft9_gr_max
Yelvertoft9_gr_pres <- sum(Yelvertoft9_grframelong_sum $max > 0)
Yelvertoft9_gr_pres

#number of sites which would be classified as low
Yelvertoft9_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft9_grframelong_sum$max)
Yelvertoft9_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft9_gr_high_ref <- sum( Yelvertoft9_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft9_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft9_gr_mod_ref <- 1000 - (Yelvertoft9_gr_high_ref + Yelvertoft9_gr_lw_ref)
Yelvertoft9_gr_mod_ref

#10 detectors
Yelvertoft10_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 10, replace=F))))
samp2<-c(1:10)
Yelvertoft10_grframe<-data.frame(Yelvertoft10_gr, samp2)
Yelvertoft10_grframelong <- melt(Yelvertoft10_grframe,id.vars="samp2")
Yelvertoft10_grframelong_sum <- ddply(Yelvertoft10_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft10_gr_max <- sum(Yelvertoft10_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft10_gr_max
Yelvertoft10_gr_pres <- sum(Yelvertoft10_grframelong_sum $max > 0)
Yelvertoft10_gr_pres

#number of sites which would be classified as low
Yelvertoft10_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft10_grframelong_sum$max)
Yelvertoft10_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft10_gr_high_ref <- sum( Yelvertoft10_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft10_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft10_gr_mod_ref <- 1000 - (Yelvertoft10_gr_high_ref + Yelvertoft10_gr_lw_ref)
Yelvertoft10_gr_mod_ref

#11 detectors
Yelvertoft11_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 11, replace=F))))
samp2<-c(1:11)
Yelvertoft11_grframe<-data.frame(Yelvertoft11_gr, samp2)
Yelvertoft11_grframelong <- melt(Yelvertoft11_grframe,id.vars="samp2")
Yelvertoft11_grframelong_sum <- ddply(Yelvertoft11_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft11_gr_max <- sum(Yelvertoft11_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft11_gr_max
Yelvertoft11_gr_pres <- sum(Yelvertoft11_grframelong_sum $max > 0)
Yelvertoft11_gr_pres

#number of sites which would be classified as low
Yelvertoft11_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft11_grframelong_sum$max)
Yelvertoft11_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft11_gr_high_ref <- sum( Yelvertoft11_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft11_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft11_gr_mod_ref <- 1000 - (Yelvertoft11_gr_high_ref + Yelvertoft11_gr_lw_ref)
Yelvertoft11_gr_mod_ref

#12 detectors
Yelvertoft12_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 12, replace=F))))
samp2<-c(1:12)
Yelvertoft12_grframe<-data.frame(Yelvertoft12_gr, samp2)
Yelvertoft12_grframelong <- melt(Yelvertoft12_grframe,id.vars="samp2")
Yelvertoft12_grframelong_sum <- ddply(Yelvertoft12_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft12_gr_max <- sum(Yelvertoft12_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft12_gr_max
Yelvertoft12_gr_pres <- sum(Yelvertoft12_grframelong_sum $max > 0)
Yelvertoft12_gr_pres

#number of sites which would be classified as low
Yelvertoft12_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft12_grframelong_sum$max)
Yelvertoft12_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft12_gr_high_ref <- sum( Yelvertoft12_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft12_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft12_gr_mod_ref <- 1000 - (Yelvertoft12_gr_high_ref + Yelvertoft12_gr_lw_ref)
Yelvertoft12_gr_mod_ref

#13 detectors
Yelvertoft13_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 13, replace=F))))
samp2<-c(1:13)
Yelvertoft13_grframe<-data.frame(Yelvertoft13_gr, samp2)
Yelvertoft13_grframelong <- melt(Yelvertoft13_grframe,id.vars="samp2")
Yelvertoft13_grframelong_sum <- ddply(Yelvertoft13_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft13_gr_max <- sum(Yelvertoft13_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft13_gr_max
Yelvertoft13_gr_pres <- sum(Yelvertoft13_grframelong_sum $max > 0)
Yelvertoft13_gr_pres

#number of sites which would be classified as low
Yelvertoft13_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft13_grframelong_sum$max)
Yelvertoft13_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft13_gr_high_ref <- sum( Yelvertoft13_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft13_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft13_gr_mod_ref <- 1000 - (Yelvertoft13_gr_high_ref + Yelvertoft13_gr_lw_ref)
Yelvertoft13_gr_mod_ref

#14 detectors
Yelvertoft14_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 14, replace=F))))
samp2<-c(1:14)
Yelvertoft14_grframe<-data.frame(Yelvertoft14_gr, samp2)
Yelvertoft14_grframelong <- melt(Yelvertoft14_grframe,id.vars="samp2")
Yelvertoft14_grframelong_sum <- ddply(Yelvertoft14_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft14_gr_max <- sum(Yelvertoft14_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft14_gr_max
Yelvertoft14_gr_pres <- sum(Yelvertoft14_grframelong_sum $max > 0)
Yelvertoft14_gr_pres

#number of sites which would be classified as low
Yelvertoft14_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft14_grframelong_sum$max)
Yelvertoft14_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft14_gr_high_ref <- sum( Yelvertoft14_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft14_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft14_gr_mod_ref <- 1000 - (Yelvertoft14_gr_high_ref + Yelvertoft14_gr_lw_ref)
Yelvertoft14_gr_mod_ref

#15 detectors
Yelvertoft15_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 15, replace=F))))
samp2<-c(1:15)
Yelvertoft15_grframe<-data.frame(Yelvertoft15_gr, samp2)
Yelvertoft15_grframelong <- melt(Yelvertoft15_grframe,id.vars="samp2")
Yelvertoft15_grframelong_sum <- ddply(Yelvertoft15_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft15_gr_max <- sum(Yelvertoft15_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft15_gr_max
Yelvertoft15_gr_pres <- sum(Yelvertoft15_grframelong_sum $max > 0)
Yelvertoft15_gr_pres

#number of sites which would be classified as low
Yelvertoft15_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft15_grframelong_sum$max)
Yelvertoft15_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft15_gr_high_ref <- sum( Yelvertoft15_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft15_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft15_gr_mod_ref <- 1000 - (Yelvertoft15_gr_high_ref + Yelvertoft15_gr_lw_ref)
Yelvertoft15_gr_mod_ref

#16 detectors
Yelvertoft16_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 16, replace=F))))
samp2<-c(1:16)
Yelvertoft16_grframe<-data.frame(Yelvertoft16_gr, samp2)
Yelvertoft16_grframelong <- melt(Yelvertoft16_grframe,id.vars="samp2")
Yelvertoft16_grframelong_sum <- ddply(Yelvertoft16_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft16_gr_max <- sum(Yelvertoft16_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft16_gr_max
Yelvertoft16_gr_pres <- sum(Yelvertoft16_grframelong_sum $max > 0)
Yelvertoft16_gr_pres

#number of sites which would be classified as low
Yelvertoft16_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft16_grframelong_sum$max)
Yelvertoft16_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft16_gr_high_ref <- sum( Yelvertoft16_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft16_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft16_gr_mod_ref <- 1000 - (Yelvertoft16_gr_high_ref + Yelvertoft16_gr_lw_ref)
Yelvertoft16_gr_mod_ref

#17 detectors
Yelvertoft17_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 17, replace=F))))
samp2<-c(1:17)
Yelvertoft17_grframe<-data.frame(Yelvertoft17_gr, samp2)
Yelvertoft17_grframelong <- melt(Yelvertoft17_grframe,id.vars="samp2")
Yelvertoft17_grframelong_sum <- ddply(Yelvertoft17_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft17_gr_max <- sum(Yelvertoft17_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft17_gr_max
Yelvertoft17_gr_pres <- sum(Yelvertoft17_grframelong_sum $max > 0)
Yelvertoft17_gr_pres

#number of sites which would be classified as low
Yelvertoft17_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft17_grframelong_sum$max)
Yelvertoft17_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft17_gr_high_ref <- sum( Yelvertoft17_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft17_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft17_gr_mod_ref <- 1000 - (Yelvertoft17_gr_high_ref + Yelvertoft17_gr_lw_ref)
Yelvertoft17_gr_mod_ref

#18 detectors
Yelvertoft18_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 18, replace=F))))
samp2<-c(1:18)
Yelvertoft18_grframe<-data.frame(Yelvertoft18_gr, samp2)
Yelvertoft18_grframelong <- melt(Yelvertoft18_grframe,id.vars="samp2")
Yelvertoft18_grframelong_sum <- ddply(Yelvertoft18_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft18_gr_max <- sum(Yelvertoft18_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft18_gr_max
Yelvertoft18_gr_pres <- sum(Yelvertoft18_grframelong_sum $max > 0)
Yelvertoft18_gr_pres

#number of sites which would be classified as low
Yelvertoft18_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft18_grframelong_sum$max)
Yelvertoft18_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft18_gr_high_ref <- sum( Yelvertoft18_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft18_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft18_gr_mod_ref <- 1000 - (Yelvertoft18_gr_high_ref + Yelvertoft18_gr_lw_ref)
Yelvertoft18_gr_mod_ref

#19 detectors
Yelvertoft19_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 19, replace=F))))
samp2<-c(1:19)
Yelvertoft19_grframe<-data.frame(Yelvertoft19_gr, samp2)
Yelvertoft19_grframelong <- melt(Yelvertoft19_grframe,id.vars="samp2")
Yelvertoft19_grframelong_sum <- ddply(Yelvertoft19_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft19_gr_max <- sum(Yelvertoft19_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft19_gr_max
Yelvertoft19_gr_pres <- sum(Yelvertoft19_grframelong_sum $max > 0)
Yelvertoft19_gr_pres

#number of sites which would be classified as low
Yelvertoft19_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft19_grframelong_sum$max)
Yelvertoft19_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft19_gr_high_ref <- sum( Yelvertoft19_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft19_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft19_gr_mod_ref <- 1000 - (Yelvertoft19_gr_high_ref + Yelvertoft19_gr_lw_ref)
Yelvertoft19_gr_mod_ref

#20 detectors
Yelvertoft20_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 20, replace=F))))
samp2<-c(1:20)
Yelvertoft20_grframe<-data.frame(Yelvertoft20_gr, samp2)
Yelvertoft20_grframelong <- melt(Yelvertoft20_grframe,id.vars="samp2")
Yelvertoft20_grframelong_sum <- ddply(Yelvertoft20_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft20_gr_max <- sum(Yelvertoft20_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft20_gr_max
Yelvertoft20_gr_pres <- sum(Yelvertoft20_grframelong_sum $max > 0)
Yelvertoft20_gr_pres

#number of sites which would be classified as low
Yelvertoft20_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft20_grframelong_sum$max)
Yelvertoft20_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft20_gr_high_ref <- sum( Yelvertoft20_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft20_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft20_gr_mod_ref <- 1000 - (Yelvertoft20_gr_high_ref + Yelvertoft20_gr_lw_ref)
Yelvertoft20_gr_mod_ref

#21 detectors
Yelvertoft21_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 21, replace=F))))
samp2<-c(1:21)
Yelvertoft21_grframe<-data.frame(Yelvertoft21_gr, samp2)
Yelvertoft21_grframelong <- melt(Yelvertoft21_grframe,id.vars="samp2")
Yelvertoft21_grframelong_sum <- ddply(Yelvertoft21_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft21_gr_max <- sum(Yelvertoft21_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft21_gr_max
Yelvertoft21_gr_pres <- sum(Yelvertoft21_grframelong_sum $max > 0)
Yelvertoft21_gr_pres

#number of sites which would be classified as low
Yelvertoft21_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft21_grframelong_sum$max)
Yelvertoft21_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft21_gr_high_ref <- sum( Yelvertoft21_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft21_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft21_gr_mod_ref <- 1000 - (Yelvertoft21_gr_high_ref + Yelvertoft21_gr_lw_ref)
Yelvertoft21_gr_mod_ref

#22 detectors
Yelvertoft22_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 22, replace=F))))
samp2<-c(1:22)
Yelvertoft22_grframe<-data.frame(Yelvertoft22_gr, samp2)
Yelvertoft22_grframelong <- melt(Yelvertoft22_grframe,id.vars="samp2")
Yelvertoft22_grframelong_sum <- ddply(Yelvertoft22_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft22_gr_max <- sum(Yelvertoft22_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft22_gr_max
Yelvertoft22_gr_pres <- sum(Yelvertoft22_grframelong_sum $max > 0)
Yelvertoft22_gr_pres

#number of sites which would be classified as low
Yelvertoft22_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft22_grframelong_sum$max)
Yelvertoft22_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft22_gr_high_ref <- sum( Yelvertoft22_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft22_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft22_gr_mod_ref <- 1000 - (Yelvertoft22_gr_high_ref + Yelvertoft22_gr_lw_ref)
Yelvertoft22_gr_mod_ref

#23 detectors
Yelvertoft23_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 23, replace=F))))
samp2<-c(1:23)
Yelvertoft23_grframe<-data.frame(Yelvertoft23_gr, samp2)
Yelvertoft23_grframelong <- melt(Yelvertoft23_grframe,id.vars="samp2")
Yelvertoft23_grframelong_sum <- ddply(Yelvertoft23_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft23_gr_max <- sum(Yelvertoft23_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft23_gr_max
Yelvertoft23_gr_pres <- sum(Yelvertoft23_grframelong_sum $max > 0)
Yelvertoft23_gr_pres

#number of sites which would be classified as low
Yelvertoft23_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft23_grframelong_sum$max)
Yelvertoft23_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft23_gr_high_ref <- sum( Yelvertoft23_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft23_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft23_gr_mod_ref <- 1000 - (Yelvertoft23_gr_high_ref + Yelvertoft23_gr_lw_ref)
Yelvertoft23_gr_mod_ref

#24 detectors
Yelvertoft24_gr<-(replicate(1000, (sample(Yelvertoftpipgr$Passes, 24, replace=F))))
samp2<-c(1:24)
Yelvertoft24_grframe<-data.frame(Yelvertoft24_gr, samp2)
Yelvertoft24_grframelong <- melt(Yelvertoft24_grframe,id.vars="samp2")
Yelvertoft24_grframelong_sum <- ddply(Yelvertoft24_grframelong, "variable", summarise,
                                      N    = length(value),
                                      max  = max(value))
Yelvertoft24_gr_max <- sum(Yelvertoft24_grframelong_sum $max > max20_Yelvertoftpipgr)
Yelvertoft24_gr_max
Yelvertoft24_gr_pres <- sum(Yelvertoft24_grframelong_sum $max > 0)
Yelvertoft24_gr_pres

#number of sites which would be classified as low
Yelvertoft24_gr_lw_ref <- sum(allsppgr_ppip_ref_low >= Yelvertoft24_grframelong_sum$max)
Yelvertoft24_gr_lw_ref
#number of sites which would be classified as high
Yelvertoft24_gr_high_ref <- sum( Yelvertoft24_grframelong_sum$max > allsppgr_ppip_ref_high)
Yelvertoft24_gr_high_ref
#number of sites which would be classified as moderate
Yelvertoft24_gr_mod_ref <- 1000 - (Yelvertoft24_gr_high_ref + Yelvertoft24_gr_lw_ref)
Yelvertoft24_gr_mod_ref

Present<-c(Yelvertoft1_gr_pres,Yelvertoft2_gr_pres,
           Yelvertoft3_gr_pres,Yelvertoft4_gr_pres,
           Yelvertoft5_gr_pres,Yelvertoft6_gr_pres,
           Yelvertoft7_gr_pres,Yelvertoft8_gr_pres,
           Yelvertoft9_gr_pres,Yelvertoft10_gr_pres,
           Yelvertoft11_gr_pres,Yelvertoft12_gr_pres,
           Yelvertoft13_gr_pres,Yelvertoft14_gr_pres,
           Yelvertoft15_gr_pres,Yelvertoft16_gr_pres,
           Yelvertoft17_gr_pres,Yelvertoft18_gr_pres,
           Yelvertoft19_gr_pres,Yelvertoft20_gr_pres,
           Yelvertoft21_gr_pres,Yelvertoft22_gr_pres,
           Yelvertoft23_gr_pres,Yelvertoft24_gr_pres)


Maximum<-c(Yelvertoft1_gr_max,Yelvertoft2_gr_max,
           Yelvertoft3_gr_max,Yelvertoft4_gr_max,
           Yelvertoft5_gr_max,Yelvertoft6_gr_max,
           Yelvertoft7_gr_max,Yelvertoft8_gr_max,
           Yelvertoft9_gr_max,Yelvertoft10_gr_max,
           Yelvertoft11_gr_max,Yelvertoft12_gr_max,
           Yelvertoft13_gr_max,Yelvertoft14_gr_max,
           Yelvertoft15_gr_max,Yelvertoft16_gr_max,
           Yelvertoft17_gr_max,Yelvertoft18_gr_max,
           Yelvertoft19_gr_max,Yelvertoft20_gr_max,
           Yelvertoft21_gr_max,Yelvertoft22_gr_max,
           Yelvertoft23_gr_max,Yelvertoft24_gr_max)

Low<-c(Yelvertoft1_gr_lw_ref, Yelvertoft2_gr_lw_ref, Yelvertoft3_gr_lw_ref,
       Yelvertoft4_gr_lw_ref, Yelvertoft5_gr_lw_ref, Yelvertoft6_gr_lw_ref,
       Yelvertoft7_gr_lw_ref, Yelvertoft8_gr_lw_ref, Yelvertoft9_gr_lw_ref,
       Yelvertoft10_gr_lw_ref, Yelvertoft11_gr_lw_ref, Yelvertoft12_gr_lw_ref, 
       Yelvertoft13_gr_lw_ref, Yelvertoft14_gr_lw_ref, Yelvertoft15_gr_lw_ref, 
       Yelvertoft16_gr_lw_ref, Yelvertoft17_gr_lw_ref, Yelvertoft18_gr_lw_ref, 
       Yelvertoft19_gr_lw_ref, Yelvertoft20_gr_lw_ref, Yelvertoft21_gr_lw_ref,
       Yelvertoft22_gr_lw_ref,Yelvertoft23_gr_lw_ref,Yelvertoft24_gr_lw_ref)

Moderate<-c(Yelvertoft1_gr_mod_ref, Yelvertoft2_gr_mod_ref, Yelvertoft3_gr_mod_ref,
            Yelvertoft4_gr_mod_ref, Yelvertoft5_gr_mod_ref, Yelvertoft6_gr_mod_ref,
            Yelvertoft7_gr_mod_ref, Yelvertoft8_gr_mod_ref, Yelvertoft9_gr_mod_ref,
            Yelvertoft10_gr_mod_ref, Yelvertoft11_gr_mod_ref, Yelvertoft12_gr_mod_ref, 
            Yelvertoft13_gr_mod_ref, Yelvertoft14_gr_mod_ref, Yelvertoft15_gr_mod_ref, 
            Yelvertoft16_gr_mod_ref, Yelvertoft17_gr_mod_ref, Yelvertoft18_gr_mod_ref, 
            Yelvertoft19_gr_mod_ref, Yelvertoft20_gr_mod_ref, Yelvertoft21_gr_mod_ref,
            Yelvertoft22_gr_mod_ref,Yelvertoft23_gr_mod_ref,Yelvertoft24_gr_mod_ref)

High<-c(Yelvertoft1_gr_high_ref, Yelvertoft2_gr_high_ref, Yelvertoft3_gr_high_ref,
        Yelvertoft4_gr_high_ref, Yelvertoft5_gr_high_ref, Yelvertoft6_gr_high_ref,
        Yelvertoft7_gr_high_ref, Yelvertoft8_gr_high_ref, Yelvertoft9_gr_high_ref,
        Yelvertoft10_gr_high_ref, Yelvertoft11_gr_high_ref, Yelvertoft12_gr_high_ref, 
        Yelvertoft13_gr_high_ref, Yelvertoft14_gr_high_ref, Yelvertoft15_gr_high_ref, 
        Yelvertoft16_gr_high_ref, Yelvertoft17_gr_high_ref, Yelvertoft18_gr_high_ref, 
        Yelvertoft19_gr_high_ref, Yelvertoft20_gr_high_ref, Yelvertoft21_gr_high_ref,
        Yelvertoft22_gr_high_ref,Yelvertoft23_gr_high_ref,Yelvertoft24_gr_high_ref)

Effort<- c(1:24)
Site<-rep("Yelvertoftgr",24)
Lowsite <- Yelvertoftlow
Modsite <- Yelvertoftmod
Highsite <-Yelvertofthigh
Species <- rep("Commonpip", 24)
Location <- rep("Ground", 24)



Yelvertoftgr_results<-data.frame(Species, Location, Present, Maximum, Effort, 
                                 Site, Low, Moderate, High,
                                 Lowsite, Modsite, Highsite)

##Full list of sites

full_list_of_sites<-rbind(Alltwalisgr_results,AnSuidhegr_results,Artfieldgr_results,
                   Bambersfarmgr_results,BickerFengr_results,Blackhillgr_results,
                   Bowbeatgr_results,CarlandCrossgr_results,CarnoIIgr_results,
                   Causeymiregr_results,Cemmaesgr_results,Conisholmegr_results,
                   Craigengeltgr_results,DeepingStNicholasgr_results,Drumderggr_results,
                   FairburnEstategr_results,Ferndalegr_results,Forssgr_results,
                   FourBurrowsgr_results,Fullabrookgr_results,GlassMoorgr_results,
                   Goonhillygr_results,HillofTowiegr_results,Lissettgr_results,
                   Lochelbankgr_results,Lowcagr_results,Lynemouthgr_results,
                   Maesgwyngr_results,MilourHillgr_results,MynyddGordugr_results,
                   MynyddYBetwsgr_results,NorthRhinsgr_results,Oldsidegr_results,
                   Otterhamgr_results,OutNewtongr_results,PantYWalgr_results,
                   Pendinegr_results,RedTilegr_results,Roosgr_results,
                   Swinfordgr_results,Tangygr_results,Toddleburngr_results,
                   TweenBridgeMoorgr_results,Walkwaygr_results,WardlawWoodgr_results,
                   WestDurhamgr_results,Yelvertoftgr_results)


##Sites which had a minimum of 24 datapoints
##minimise again.. 
ppip_gr_res<-rbind(Alltwalisgr_results,AnSuidhegr_results,Artfieldgr_results,
                   Bambersfarmgr_results,BickerFengr_results,Blackhillgr_results,
                   Bowbeatgr_results,CarlandCrossgr_results,CarnoIIgr_results,
                   Causeymiregr_results,Cemmaesgr_results,Conisholmegr_results,
                   Craigengeltgr_results,DeepingStNicholasgr_results,Drumderggr_results,
                   FairburnEstategr_results,Ferndalegr_results,Forssgr_results,
                   FourBurrowsgr_results,Fullabrookgr_results,GlassMoorgr_results,
                   Goonhillygr_results,HillofTowiegr_results,Lissettgr_results,
                   Lochelbankgr_results,Lowcagr_results,Lynemouthgr_results,
                   Maesgwyngr_results,MilourHillgr_results,MynyddGordugr_results,
                   MynyddYBetwsgr_results,NorthRhinsgr_results,Oldsidegr_results,
                   Otterhamgr_results,OutNewtongr_results,PantYWalgr_results,
                   Pendinegr_results,RedTilegr_results,Roosgr_results,
                   Swinfordgr_results,Tangygr_results,Toddleburngr_results,
                   TweenBridgeMoorgr_results,Walkwaygr_results,WardlawWoodgr_results,
                   WestDurhamgr_results,Yelvertoftgr_results)
ppip_gr_res
head(ppip_gr_res)

ppip_gr_res$Maximum<-ppip_gr_res$Maximum/10
ppip_gr_res$ Present<-ppip_gr_res$ Present/10
ppip_gr_res$ Low<-ppip_gr_res$ Low/10
ppip_gr_res$Moderate<-ppip_gr_res$Moderate/10
ppip_gr_res$ High<-ppip_gr_res$ High/10

###export this so its saved rather than having to run the code all over again

write.csv(ppip_gr_res, "Finalpip_gr_results.csv")



#now summarise the data

summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
  library(plyr)
  
  # New version of length which can handle NA's: if na.rm==T, don't count them
  length2 <- function (x, na.rm=FALSE) {
    if (na.rm) sum(!is.na(x))
    else       length(x)
  }
  
  # This does the summary. For each group's data frame, return a vector with
  # N, mean, and sd
  datac <- ddply(data, groupvars, .drop=.drop,
                 .fun = function(xx, col) {
                   c(N    = length2(xx[[col]], na.rm=na.rm),
                     mean = mean   (xx[[col]], na.rm=na.rm),
                     sd   = sd     (xx[[col]], na.rm=na.rm)
                   )
                 },
                 measurevar
  )
# Rename the "mean" column    
  datac <- rename(datac, c("mean" = measurevar))
  
  datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean
  
  # Confidence interval multiplier for standard error
  # Calculate t-statistic for confidence interval: 
  # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
  ciMult <- qt(conf.interval/2 + .5, datac$N-1)
  datac$ci <- datac$se * ciMult
  
  return(datac)
}
##now work out summary table

Finalppip_gr_max <- summarySE(ppip_gr_res, measurevar="Maximum", groupvars=c("Effort"))
Finalppip_gr_pres <- summarySE(ppip_gr_res, measurevar="Present", groupvars=c("Effort"))

#now plot
##############
#percetange of sites within 20% max pass rate
# Use 95% confidence interval instead of SEM
ppip_gr_max <- ggplot(Finalppip_gr_max, aes(x=Effort , y=Maximum)) + 
  geom_errorbar(aes(ymin=Maximum-se, ymax=Maximum+se), width=.1) +
  geom_line() +
  geom_point() +
  xlab("Nights of surveying effort")+
  ylab("  Percentage of sites within 20% 
       maximum pass rate (95% CI)")+
  ylim(0,100)+
  theme_bw() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_rect(linetype="blank"),
        axis.line=element_line(size=0.5),
        axis.title.x=element_text(size=20),
        axis.text.x  = element_text(size=16),
        axis.text.y  = element_text(size=16),
        axis.title.y=element_text(size=20))
ppip_gr_max
png ('Common_pip_Ground_MaxPass.png', width = 7.25, height = 8, units = 'in', res=600)
ppip_gr_max
dev.off()

##Probability of detection
# Use 95% confidence interval instead of SEM
ppip_gr_det <- ggplot(Finalppip_gr_pres, aes(x=Effort , y=Present)) + 
  geom_errorbar(aes(ymin=Present-se, ymax=Present+se), width=.1) +
  geom_line() +
  geom_point() +
  xlab("Nights of surveying effort")+
  ylab(" Probability of detection (%)")+
  ylim(0,100)+
  theme_bw() +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_rect(linetype="blank"),
        axis.line=element_line(size=0.5),
        axis.title.x=element_text(size=20),
        axis.text.x  = element_text(size=16),
        axis.text.y  = element_text(size=16),
        axis.title.y=element_text(size=20))
ppip_gr_det
png ('Common_pip_Ground_Detect.png', width = 7.25, height = 8, units = 'in', res=600)
ppip_gr_det
dev.off()
